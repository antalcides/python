(function($){function maybeCall(thing,ctx){return(typeof thing=='function')?(thing.call(ctx)):thing;};function isElementInDOM(ele){while(ele=ele.parentNode){if(ele==document)return true;}
return false;};function Tipsy(element,options){this.$element=$(element);this.options=options;this.enabled=true;this.fixTitle();};Tipsy.prototype={show:function(){var title=this.getTitle();if(title&&this.enabled){var $tip=this.tip();$tip.find('.tipsy-inner')[this.options.html?'html':'text'](title);$tip[0].className='tipsy';$tip.remove().css({top:0,left:0,visibility:'hidden',display:'block'}).prependTo(document.body);var pos=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,gravity=maybeCall(this.options.gravity,this.$element[0]);var tp;switch(gravity.charAt(0)){case'n':tp={top:pos.top+pos.height+this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case's':tp={top:pos.top-actualHeight-this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case'e':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth-this.options.offset};break;case'w':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width+this.options.offset};break;}
if(gravity.length==2){if(gravity.charAt(1)=='w'){tp.left=pos.left+pos.width/2-15;}else{tp.left=pos.left+pos.width/2-actualWidth+15;}}
$tip.css(tp).addClass('tipsy-'+gravity);$tip.find('.tipsy-arrow')[0].className='tipsy-arrow tipsy-arrow-'+gravity.charAt(0);if(this.options.className){$tip.addClass(maybeCall(this.options.className,this.$element[0]));}
if(this.options.fade){$tip.stop().css({opacity:0,display:'block',visibility:'visible'}).animate({opacity:this.options.opacity});}else{$tip.css({visibility:'visible',opacity:this.options.opacity});}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){$(this).remove();});}else{this.tip().remove();}},fixTitle:function(){var $e=this.$element;if($e.attr('title')||typeof($e.attr('original-title'))!='string'){$e.attr('original-title',$e.attr('title')||'').removeAttr('title');}},getTitle:function(){var title,$e=this.$element,o=this.options;this.fixTitle();var title,o=this.options;if(typeof o.title=='string'){title=$e.attr(o.title=='title'?'original-title':o.title);}else if(typeof o.title=='function'){title=o.title.call($e[0]);}
title=(''+title).replace(/(^\s*|\s*$)/,"");return title||o.fallback;},tip:function(){if(!this.$tip){this.$tip=$('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');this.$tip.data('tipsy-pointee',this.$element[0]);}
return this.$tip;},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null;}},enable:function(){this.enabled=true;},disable:function(){this.enabled=false;},toggleEnabled:function(){this.enabled=!this.enabled;}};$.fn.tipsy=function(options){if(options===true){return this.data('tipsy');}else if(typeof options=='string'){var tipsy=this.data('tipsy');if(tipsy)tipsy[options]();return this;}
options=$.extend({},$.fn.tipsy.defaults,options);function get(ele){var tipsy=$.data(ele,'tipsy');if(!tipsy){tipsy=new Tipsy(ele,$.fn.tipsy.elementOptions(ele,options));$.data(ele,'tipsy',tipsy);}
return tipsy;}
function enter(){var tipsy=get(this);tipsy.hoverState='in';if(options.delayIn==0){tipsy.show();}else{tipsy.fixTitle();setTimeout(function(){if(tipsy.hoverState=='in')tipsy.show();},options.delayIn);}};function leave(){var tipsy=get(this);tipsy.hoverState='out';if(options.delayOut==0){tipsy.hide();}else{setTimeout(function(){if(tipsy.hoverState=='out')tipsy.hide();},options.delayOut);}};if(!options.live)this.each(function(){get(this);});if(options.trigger!='manual'){var binder=options.live?'live':'bind',eventIn=options.trigger=='hover'?'mouseenter':'focus',eventOut=options.trigger=='hover'?'mouseleave':'blur';this[binder](eventIn,enter)[binder](eventOut,leave);}
return this;};$.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:false,fallback:'',gravity:'n',html:false,live:false,offset:0,opacity:0.8,title:'title',trigger:'hover'};$.fn.tipsy.revalidate=function(){$('.tipsy').each(function(){var pointee=$.data(this,'tipsy-pointee');if(!pointee||!isElementInDOM(pointee)){$(this).remove();}});};$.fn.tipsy.elementOptions=function(ele,options){return $.metadata?$.extend({},options,$(ele).metadata()):options;};$.fn.tipsy.autoNS=function(){return $(this).offset().top>($(document).scrollTop()+$(window).height()/2)?'s':'n';};$.fn.tipsy.autoWE=function(){return $(this).offset().left>($(document).scrollLeft()+$(window).width()/2)?'e':'w';};$.fn.tipsy.autoBounds=function(margin,prefer){return function(){var dir={ns:prefer[0],ew:(prefer.length>1?prefer[1]:false)},boundTop=$(document).scrollTop()+margin,boundLeft=$(document).scrollLeft()+margin,$this=$(this);if($this.offset().top<boundTop)dir.ns='n';if($this.offset().left<boundLeft)dir.ew='w';if($(window).width()+$(document).scrollLeft()-$this.offset().left<margin)dir.ew='e';if($(window).height()+$(document).scrollTop()-$this.offset().top<margin)dir.ns='s';return dir.ns+(dir.ew?dir.ew:'');}};})(jQuery);(function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"1.8.23",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function h(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var e=d==="Width"?["Left","Right"]:["Top","Bottom"],f=d.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?g["inner"+d].call(this):this.each(function(){a(this).css(f,h(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?g["outer"+d].call(this,b):this.each(function(){a(this).css(f,h(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight,a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.curCSS||(a.curCSS=a.css),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})})(jQuery);;(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){return c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}}),d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;return e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e,f&&e.charAt(0)==="_"?h:(f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b)return h=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))}),h)}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e,f,g=this.options[b];d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent;if(f)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(jQuery);;(function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(c)return;this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=this._mouseStart(b)!==!1;if(!this._mouseStarted)return b.preventDefault(),!0}return!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0},_mouseMove:function(b){return!a.browser.msie||document.documentMode>=9||!!b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(jQuery);;(function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e="center",f={},g=a.fn.position,h=a.fn.offset;a.fn.position=function(b){if(!b||!b.of)return g.apply(this,arguments);b=a.extend({},b);var h=a(b.of),i=h[0],j=(b.collision||"flip").split(" "),k=b.offset?b.offset.split(" "):[0,0],l,m,n;return i.nodeType===9?(l=h.width(),m=h.height(),n={top:0,left:0}):i.setTimeout?(l=h.width(),m=h.height(),n={top:h.scrollTop(),left:h.scrollLeft()}):i.preventDefault?(b.at="left top",l=m=0,n={top:b.of.pageY,left:b.of.pageX}):(l=h.outerWidth(),m=h.outerHeight(),n=h.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" ");a.length===1&&(a=c.test(a[0])?a.concat([e]):d.test(a[0])?[e].concat(a):[e,e]),a[0]=c.test(a[0])?a[0]:e,a[1]=d.test(a[1])?a[1]:e,b[this]=a}),j.length===1&&(j[1]=j[0]),k[0]=parseInt(k[0],10)||0,k.length===1&&(k[1]=k[0]),k[1]=parseInt(k[1],10)||0,b.at[0]==="right"?n.left+=l:b.at[0]===e&&(n.left+=l/2),b.at[1]==="bottom"?n.top+=m:b.at[1]===e&&(n.top+=m/2),n.left+=k[0],n.top+=k[1],this.each(function(){var c=a(this),d=c.outerWidth(),g=c.outerHeight(),h=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,o=d+h+(parseInt(a.curCSS(this,"marginRight",!0))||0),p=g+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0),q=a.extend({},n),r;b.my[0]==="right"?q.left-=d:b.my[0]===e&&(q.left-=d/2),b.my[1]==="bottom"?q.top-=g:b.my[1]===e&&(q.top-=g/2),f.fractions||(q.left=Math.round(q.left),q.top=Math.round(q.top)),r={left:q.left-h,top:q.top-i},a.each(["left","top"],function(c,e){a.ui.position[j[c]]&&a.ui.position[j[c]][e](q,{targetWidth:l,targetHeight:m,elemWidth:d,elemHeight:g,collisionPosition:r,collisionWidth:o,collisionHeight:p,offset:k,my:b.my,at:b.at})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(q,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window),e=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=e>0?b.left-e:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window),e=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=e>0?b.top-e:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]===e)return;var d=a(window),f=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),g=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,h=c.at[0]==="left"?c.targetWidth:-c.targetWidth,i=-2*c.offset[0];b.left+=c.collisionPosition.left<0?g+h+i:f>0?g+h+i:0},top:function(b,c){if(c.at[1]===e)return;var d=a(window),f=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),g=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,h=c.at[1]==="top"?c.targetHeight:-c.targetHeight,i=-2*c.offset[1];b.top+=c.collisionPosition.top<0?g+h+i:f>0?g+h+i:0}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0,h={top:c.top-e.top+f,left:c.left-e.left+g};"using"in c?c.using.call(b,h):d.css(h)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?a.isFunction(b)?this.each(function(c){a(this).offset(b.call(this,c,a(this).offset()))}):this.each(function(){a.offset.setOffset(this,b)}):h.call(this)}),a.curCSS||(a.curCSS=a.css),function(){var b=document.getElementsByTagName("body")[0],c=document.createElement("div"),d,e,g,h,i;d=document.createElement(b?"div":"body"),g={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},b&&a.extend(g,{position:"absolute",left:"-1000px",top:"-1000px"});for(var j in g)d.style[j]=g[j];d.appendChild(c),e=b||document.documentElement,e.insertBefore(d,e.firstChild),c.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",h=a(c).offset(function(a,b){return b}).offset(),d.innerHTML="",e.removeChild(d),i=h.top+h.left+(b?2e3:0),f.fractions=i>21&&i<22}()})(jQuery);;(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!this.element.data("draggable"))return;return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(c.iframeFix&&a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);var d=this.element[0],e=!1;while(d&&(d=d.parentNode))d==document&&(e=!0);if(!e&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var f=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){f._trigger("stop",b)!==!1&&f._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){return this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)}),c},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment),d=c[0];if(!d)return;var e=c.offset(),f=a(d).css("overflow")!="hidden";this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();h=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else h=this.containment;b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top)}if(c.grid){var j=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;g=h?j-this.offset.click.top<h[1]||j-this.offset.click.top>h[3]?j-this.offset.click.top<h[1]?j+c.grid[1]:j-c.grid[1]:j:j;var k=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=h?k-this.offset.click.left<h[0]||k-this.offset.click.left>h[2]?k-this.offset.click.left<h[0]?k+c.grid[0]:k-c.grid[0]:k:k}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.23"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this,f=function(b){var c=this.offset.click.top,d=this.offset.click.left,e=this.positionAbs.top,f=this.positionAbs.left,g=b.height,h=b.width,i=b.top,j=b.left;return a.ui.isOver(e+c,f+d,i,j,g,h)};a.each(d.sortables,function(f){this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c){var d=a("body"),e=a(this).data("draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(b,c){var d=a(this).data("draggable").options;d._cursor&&a("body").css("cursor",d._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(b,c){var d=a(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=!1;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c){var d=a(this).data("draggable"),e=d.options;d.snapElements=[],a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,j=i+d.helperProportions.height;for(var k=d.snapElements.length-1;k>=0;k--){var l=d.snapElements[k].left,m=l+d.snapElements[k].width,n=d.snapElements[k].top,o=n+d.snapElements[k].height;if(!(l-f<g&&g<m+f&&n-f<i&&i<o+f||l-f<g&&g<m+f&&n-f<j&&j<o+f||l-f<h&&h<m+f&&n-f<i&&i<o+f||l-f<h&&h<m+f&&n-f<j&&j<o+f)){d.snapElements[k].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1;continue}if(e.snapMode!="inner"){var p=Math.abs(n-j)<=f,q=Math.abs(o-i)<=f,r=Math.abs(l-h)<=f,s=Math.abs(m-g)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n-d.helperProportions.height,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var t=p||q||r||s;if(e.snapMode!="outer"){var p=Math.abs(n-i)<=f,q=Math.abs(o-j)<=f,r=Math.abs(l-g)<=f,s=Math.abs(m-h)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o-d.helperProportions.height,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[k].snapping&&(p||q||r||s||t)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=p||q||r||s||t}}}),a.ui.plugin.add("draggable","stack",{start:function(b,c){var d=a(this).data("draggable").options,e=a.makeArray(a(d.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(!e.length)return;var f=parseInt(e[0].style.zIndex)||0;a(e).each(function(a){this.style.zIndex=f+a}),this[0].style.zIndex=f+e.length}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);;(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){var b=a.ui.ddmanager.droppables[this.options.scope];for(var c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"),this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return;this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return;this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0])return!1;var e=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return e=!0,!1}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"1.8.23"}),a.ui.intersect=function(b,c,d){if(!c.offset)return!1;var e=(b.positionAbs||b.position.absolute).left,f=e+b.helperProportions.width,g=(b.positionAbs||b.position.absolute).top,h=g+b.helperProportions.height,i=c.offset.left,j=i+c.proportions.width,k=c.offset.top,l=k+c.proportions.height;switch(d){case"fit":return i<=e&&f<=j&&k<=g&&h<=l;case"intersect":return i<e+b.helperProportions.width/2&&f-b.helperProportions.width/2<j&&k<g+b.helperProportions.height/2&&h-b.helperProportions.height/2<l;case"pointer":var m=(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,n=(b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,o=a.ui.isOver(n,m,k,i,c.proportions.height,c.proportions.width);return o;case"touch":return(g>=k&&g<=l||h>=k&&h<=l||g<k&&h>l)&&(e>=i&&e<=j||f>=i&&f<=j||e<i&&f>j);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d=a.ui.ddmanager.droppables[b.options.scope]||[],e=c?c.type:null,f=(b.currentItem||b.element).find(":data(droppable)").andSelf();g:for(var h=0;h<d.length;h++){if(d[h].options.disabled||b&&!d[h].accept.call(d[h].element[0],b.currentItem||b.element))continue;for(var i=0;i<f.length;i++)if(f[i]==d[h].element[0]){d[h].proportions.height=0;continue g}d[h].visible=d[h].element.css("display")!="none";if(!d[h].visible)continue;e=="mousedown"&&d[h]._activate.call(d[h],c),d[h].offset=d[h].element.offset(),d[h].proportions={width:d[h].element[0].offsetWidth,height:d[h].element[0].offsetHeight}}},drop:function(b,c){var d=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c))}),d},dragStart:function(b,c){b.element.parents(":not(body,html)").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var d=a.ui.intersect(b,this,this.options.tolerance),e=!d&&this.isover==1?"isout":d&&this.isover==0?"isover":null;if(!e)return;var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))})},dragStop:function(b,c){b.element.parents(":not(body,html)").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}})(jQuery);;(function(a,b){a.widget("ui.resizable",a.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var b=this,c=this.options;this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=c.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var e=0;e<d.length;e++){var f=a.trim(d[e]),g="ui-resizable-"+f,h=a('<div class="ui-resizable-handle '+g+'"></div>');h.css({zIndex:c.zIndex}),"se"==f&&h.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[f]=".ui-resizable-"+f,this.element.append(h)}}this._renderAxis=function(b){b=b||this.element;for(var c in this.handles){this.handles[c].constructor==String&&(this.handles[c]=a(this.handles[c],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var d=a(this.handles[c],this.element),e=0;e=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth();var f=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join("");b.css(f,e),this._proportionallyResize()}if(!a(this.handles[c]).length)continue}},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}}),c.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").hover(function(){if(c.disabled)return;a(this).removeClass("ui-resizable-autohide"),b._handles.show()},function(){if(c.disabled)return;b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var c=this.element;c.after(this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_mouseCapture:function(b){var c=!1;for(var d in this.handles)a(this.handles[d])[0]==b.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(b){var d=this.options,e=this.element.position(),f=this.element;this.resizing=!0,this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()},(f.is(".ui-draggable")||/absolute/.test(f.css("position")))&&f.css({position:"absolute",top:e.top,left:e.left}),this._renderProxy();var g=c(this.helper.css("left")),h=c(this.helper.css("top"));d.containment&&(g+=a(d.containment).scrollLeft()||0,h+=a(d.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:g,top:h},this.size=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalSize=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()},this.originalPosition={left:g,top:h},this.sizeDiff={width:f.outerWidth()-f.width(),height:f.outerHeight()-f.height()},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio=typeof d.aspectRatio=="number"?d.aspectRatio:this.originalSize.width/this.originalSize.height||1;var i=a(".ui-resizable-"+this.axis).css("cursor");return a("body").css("cursor",i=="auto"?this.axis+"-resize":i),f.addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c=this.helper,d=this.options,e={},f=this,g=this.originalMousePosition,h=this.axis,i=b.pageX-g.left||0,j=b.pageY-g.top||0,k=this._change[h];if(!k)return!1;var l=k.apply(this,[b,i,j]),m=a.browser.msie&&a.browser.version<7,n=this.sizeDiff;this._updateVirtualBoundaries(b.shiftKey);if(this._aspectRatio||b.shiftKey)l=this._updateRatio(l,b);return l=this._respectSize(l,b),this._propagate("resize",b),c.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger("resize",b,this.ui()),!1},_mouseStop:function(b){this.resizing=!1;var c=this.options,d=this;if(this._helper){var e=this._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:d.sizeDiff.height,h=f?0:d.sizeDiff.width,i={width:d.helper.width()-h,height:d.helper.height()-g},j=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,k=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;c.animate||this.element.css(a.extend(i,{top:k,left:j})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()}return a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b=this.options,c,e,f,g,h;h={minWidth:d(b.minWidth)?b.minWidth:0,maxWidth:d(b.maxWidth)?b.maxWidth:Infinity,minHeight:d(b.minHeight)?b.minHeight:0,maxHeight:d(b.maxHeight)?b.maxHeight:Infinity};if(this._aspectRatio||a)c=h.minHeight*this.aspectRatio,f=h.minWidth/this.aspectRatio,e=h.maxHeight*this.aspectRatio,g=h.maxWidth/this.aspectRatio,c>h.minWidth&&(h.minWidth=c),f>h.minHeight&&(h.minHeight=f),e<h.maxWidth&&(h.maxWidth=e),g<h.maxHeight&&(h.maxHeight=g);this._vBoundaries=h},_updateCache:function(a){var b=this.options;this.offset=this.helper.offset(),d(a.left)&&(this.position.left=a.left),d(a.top)&&(this.position.top=a.top),d(a.height)&&(this.size.height=a.height),d(a.width)&&(this.size.width=a.width)},_updateRatio:function(a,b){var c=this.options,e=this.position,f=this.size,g=this.axis;return d(a.height)?a.width=a.height*this.aspectRatio:d(a.width)&&(a.height=a.width/this.aspectRatio),g=="sw"&&(a.left=e.left+(f.width-a.width),a.top=null),g=="nw"&&(a.top=e.top+(f.height-a.height),a.left=e.left+(f.width-a.width)),a},_respectSize:function(a,b){var c=this.helper,e=this._vBoundaries,f=this._aspectRatio||b.shiftKey,g=this.axis,h=d(a.width)&&e.maxWidth&&e.maxWidth<a.width,i=d(a.height)&&e.maxHeight&&e.maxHeight<a.height,j=d(a.width)&&e.minWidth&&e.minWidth>a.width,k=d(a.height)&&e.minHeight&&e.minHeight>a.height;j&&(a.width=e.minWidth),k&&(a.height=e.minHeight),h&&(a.width=e.maxWidth),i&&(a.height=e.maxHeight);var l=this.originalPosition.left+this.originalSize.width,m=this.position.top+this.size.height,n=/sw|nw|w/.test(g),o=/nw|ne|n/.test(g);j&&n&&(a.left=l-e.minWidth),h&&n&&(a.left=l-e.maxWidth),k&&o&&(a.top=m-e.minHeight),i&&o&&(a.top=m-e.maxHeight);var p=!a.width&&!a.height;return p&&!a.left&&a.top?a.top=null:p&&!a.top&&a.left&&(a.left=null),a},_proportionallyResize:function(){var b=this.options;if(!this._proportionallyResizeElements.length)return;var c=this.helper||this.element;for(var d=0;d<this._proportionallyResizeElements.length;d++){var e=this._proportionallyResizeElements[d];if(!this.borderDif){var f=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],g=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=a.map(f,function(a,b){var c=parseInt(a,10)||0,d=parseInt(g[b],10)||0;return c+d})}if(!a.browser.msie||!a(c).is(":hidden")&&!a(c).parents(":hidden").length)e.css({height:c.height()-this.borderDif[0]-this.borderDif[2]||0,width:c.width()-this.borderDif[1]-this.borderDif[3]||0});else continue}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var d=a.browser.msie&&a.browser.version<7,e=d?1:0,f=d?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+f,height:this.element.outerHeight()+f,position:"absolute",left:this.elementOffset.left-e+"px",top:this.elementOffset.top-e+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b,c){return{width:this.originalSize.width+b}},w:function(a,b,c){var d=this.options,e=this.originalSize,f=this.originalPosition;return{left:f.left+b,width:e.width-b}},n:function(a,b,c){var d=this.options,e=this.originalSize,f=this.originalPosition;return{top:f.top+c,height:e.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),b!="resize"&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.extend(a.ui.resizable,{version:"1.8.23"}),a.ui.plugin.add("resizable","alsoResize",{start:function(b,c){var d=a(this).data("resizable"),e=d.options,f=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};typeof e.alsoResize=="object"&&!e.alsoResize.parentNode?e.alsoResize.length?(e.alsoResize=e.alsoResize[0],f(e.alsoResize)):a.each(e.alsoResize,function(a){f(a)}):f(e.alsoResize)},resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};typeof e.alsoResize=="object"&&!e.alsoResize.nodeType?a.each(e.alsoResize,function(a,b){i(a,b)}):i(e.alsoResize)},stop:function(b,c){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","animate",{stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),h=g&&a.ui.hasScroll(f[0],"left")?0:d.sizeDiff.height,i=g?0:d.sizeDiff.width,j={width:d.size.width-i,height:d.size.height-h},k=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null,l=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;d.element.animate(a.extend(j,l&&k?{top:l,left:k}:{}),{duration:e.animateDuration,easing:e.animateEasing,step:function(){var c={width:parseInt(d.element.css("width"),10),height:parseInt(d.element.css("height"),10),top:parseInt(d.element.css("top"),10),left:parseInt(d.element.css("left"),10)};f&&f.length&&a(f[0]).css({width:c.width,height:c.height}),d._updateCache(c),d._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(b,d){var e=a(this).data("resizable"),f=e.options,g=e.element,h=f.containment,i=h instanceof a?h.get(0):/parent/.test(h)?g.parent().get(0):h;if(!i)return;e.containerElement=a(i);if(/document/.test(h)||h==document)e.containerOffset={left:0,top:0},e.containerPosition={left:0,top:0},e.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var j=a(i),k=[];a(["Top","Right","Left","Bottom"]).each(function(a,b){k[a]=c(j.css("padding"+b))}),e.containerOffset=j.offset(),e.containerPosition=j.position(),e.containerSize={height:j.innerHeight()-k[3],width:j.innerWidth()-k[1]};var l=e.containerOffset,m=e.containerSize.height,n=e.containerSize.width,o=a.ui.hasScroll(i,"left")?i.scrollWidth:n,p=a.ui.hasScroll(i)?i.scrollHeight:m;e.parentData={element:i,left:l.left,top:l.top,width:o,height:p}}},resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.containerSize,g=d.containerOffset,h=d.size,i=d.position,j=d._aspectRatio||b.shiftKey,k={top:0,left:0},l=d.containerElement;l[0]!=document&&/static/.test(l.css("position"))&&(k=g),i.left<(d._helper?g.left:0)&&(d.size.width=d.size.width+(d._helper?d.position.left-g.left:d.position.left-k.left),j&&(d.size.height=d.size.width/d.aspectRatio),d.position.left=e.helper?g.left:0),i.top<(d._helper?g.top:0)&&(d.size.height=d.size.height+(d._helper?d.position.top-g.top:d.position.top),j&&(d.size.width=d.size.height*d.aspectRatio),d.position.top=d._helper?g.top:0),d.offset.left=d.parentData.left+d.position.left,d.offset.top=d.parentData.top+d.position.top;var m=Math.abs((d._helper?d.offset.left-k.left:d.offset.left-k.left)+d.sizeDiff.width),n=Math.abs((d._helper?d.offset.top-k.top:d.offset.top-g.top)+d.sizeDiff.height),o=d.containerElement.get(0)==d.element.parent().get(0),p=/relative|absolute/.test(d.containerElement.css("position"));o&&p&&(m-=d.parentData.left),m+d.size.width>=d.parentData.width&&(d.size.width=d.parentData.width-m,j&&(d.size.height=d.size.width/d.aspectRatio)),n+d.size.height>=d.parentData.height&&(d.size.height=d.parentData.height-n,j&&(d.size.width=d.size.height*d.aspectRatio))},stop:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.position,g=d.containerOffset,h=d.containerPosition,i=d.containerElement,j=a(d.helper),k=j.offset(),l=j.outerWidth()-d.sizeDiff.width,m=j.outerHeight()-d.sizeDiff.height;d._helper&&!e.animate&&/relative/.test(i.css("position"))&&a(this).css({left:k.left-h.left-g.left,width:l,height:m}),d._helper&&!e.animate&&/static/.test(i.css("position"))&&a(this).css({left:k.left-h.left-g.left,width:l,height:m})}}),a.ui.plugin.add("resizable","ghost",{start:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.size;d.ghost=d.originalElement.clone(),d.ghost.css({opacity:.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost=="string"?e.ghost:""),d.ghost.appendTo(d.helper)},resize:function(b,c){var d=a(this).data("resizable"),e=d.options;d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(b,c){var d=a(this).data("resizable"),e=d.options;d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(b,c){var d=a(this).data("resizable"),e=d.options,f=d.size,g=d.originalSize,h=d.originalPosition,i=d.axis,j=e._aspectRatio||b.shiftKey;e.grid=typeof e.grid=="number"?[e.grid,e.grid]:e.grid;var k=Math.round((f.width-g.width)/(e.grid[0]||1))*(e.grid[0]||1),l=Math.round((f.height-g.height)/(e.grid[1]||1))*(e.grid[1]||1);/^(se|s|e)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l):/^(ne)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l,d.position.top=h.top-l):/^(sw)$/.test(i)?(d.size.width=g.width+k,d.size.height=g.height+l,d.position.left=h.left-k):(d.size.width=g.width+k,d.size.height=g.height+l,d.position.top=h.top-l,d.position.left=h.left-k)}});var c=function(a){return parseInt(a,10)||0},d=function(a){return!isNaN(parseInt(a,10))}})(jQuery);;(function(a,b){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable"),this.dragged=!1;var c;this.refresh=function(){c=a(b.options.filter,b.element[0]),c.addClass("ui-selectee"),c.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=c.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){return this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"),this._mouseDestroy(),this},_mouseStart:function(b){var c=this;this.opos=[b.pageX,b.pageY];if(this.options.disabled)return;var d=this.options;this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,!b.metaKey&&!b.ctrlKey&&(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().andSelf().each(function(){var d=a.data(this,"selectable-item");if(d){var e=!b.metaKey&&!b.ctrlKey||!d.$element.hasClass("ui-selected");return d.$element.removeClass(e?"ui-unselecting":"ui-selected").addClass(e?"ui-selecting":"ui-unselecting"),d.unselecting=!e,d.selecting=e,d.selected=e,e?c._trigger("selecting",b,{selecting:d.element}):c._trigger("unselecting",b,{unselecting:d.element}),!1}})},_mouseDrag:function(b){var c=this;this.dragged=!0;if(this.options.disabled)return;var d=this.options,e=this.opos[0],f=this.opos[1],g=b.pageX,h=b.pageY;if(e>g){var i=g;g=e,e=i}if(f>h){var i=h;h=f,f=i}return this.helper.css({left:e,top:f,width:g-e,height:h-f}),this.selectees.each(function(){var i=a.data(this,"selectable-item");if(!i||i.element==c.element[0])return;var j=!1;d.tolerance=="touch"?j=!(i.left>g||i.right<e||i.top>h||i.bottom<f):d.tolerance=="fit"&&(j=i.left>e&&i.right<g&&i.top>f&&i.bottom<h),j?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,c._trigger("selecting",b,{selecting:i.element}))):(i.selecting&&((b.metaKey||b.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),c._trigger("unselecting",b,{unselecting:i.element}))),i.selected&&!b.metaKey&&!b.ctrlKey&&!i.startselected&&(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,c._trigger("unselecting",b,{unselecting:i.element})))}),!1},_mouseStop:function(b){var c=this;this.dragged=!1;var d=this.options;return a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}}),a.extend(a.ui.selectable,{version:"1.8.23"})})(jQuery);;(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){a.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var b=this.items.length-1;b>=0;b--)this.items[b].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this,g=a(b.target).parents().each(function(){if(a.data(this,d.widgetName+"-item")==f)return e=a(this),!1});a.data(b.target,d.widgetName+"-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var h=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(h=!0)});if(!h)return!1}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,c,d){var e=this.options,f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),e.containment&&this._setContainment(),e.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",e.cursor)),e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity)),e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!d)for(var g=this.containers.length-1;g>=0;g--)this.containers[g]._trigger("activate",b,f._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,d=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),d!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],g=f.item[0],h=this._intersectsWithPointer(f);if(!h)continue;if(g!=this.currentItem[0]&&this.placeholder[h==1?"next":"prev"]()[0]!=g&&!a.ui.contains(this.placeholder[0],g)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],g):!0)){this.direction=h==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(f))this._rearrange(b,f);else break;this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(!b)return;a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0,a(this.helper).animate({left:e.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l=d+j>h&&d+j<i&&b+k>f&&b+k<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?l:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=this.options.axis==="x"||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),d=this.options.axis==="y"||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&g=="right"||f=="down"?2:1:f&&(f=="down"?2:1):!1},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&d||f=="left"&&!d:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=this,d=[],e=[],f=this._connectWith();if(f&&b)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&e.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=e.length-1;g>=0;g--)e[g][0].each(function(){d.push(this)});return a(d)},_removeCurrentsFromItems:function(){var a=this.currentItem.find(":data("+this.widgetName+"-item)");for(var b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,d=this,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],f=this._connectWith();if(f&&this.ready)for(var g=f.length-1;g>=0;g--){var h=a(f[g]);for(var i=h.length-1;i>=0;i--){var j=a.data(h[i],this.widgetName);j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}}for(var g=e.length-1;g>=0;g--){var k=e[g][1],l=e[g][0];for(var i=0,m=l.length;i<m;i++){var n=a(l[i]);n.data(this.widgetName+"-item",k),c.push({item:n,instance:k,width:0,height:0,left:0,top:0})}}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var d=this.items[c];if(d.instance!=this.currentContainer&&this.currentContainer&&d.item[0]!=this.currentItem[0])continue;var e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;b||(d.width=e.outerWidth(),d.height=e.outerHeight());var f=e.offset();d.left=f.left,d.top=f.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var c=this.containers.length-1;c>=0;c--){var f=this.containers[c].element.offset();this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight()}return this},_createPlaceholder:function(b){var c=b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return e||(b.style.visibility="hidden"),b},update:function(a,b){if(e&&!d.forcePlaceholderSize)return;b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){var c=null,d=null;for(var e=this.containers.length-1;e>=0;e--){if(a.ui.contains(this.currentItem[0],this.containers[e].element[0]))continue;if(this._intersectsWith(this.containers[e].containerCache)){if(c&&a.ui.contains(this.containers[e].element[0],c.element[0]))continue;c=this.containers[e],d=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0)}if(!c)return;if(this.containers.length===1)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){var f=1e4,g=null,h=this.positionAbs[this.containers[d].floating?"left":"top"];for(var i=this.items.length-1;i>=0;i--){if(!a.ui.contains(this.containers[d].element[0],this.items[i].item[0]))continue;var j=this.containers[d].floating?this.items[i].item.offset().left:this.items[i].item.offset().top;Math.abs(j-h)<f&&(f=Math.abs(j-h),g=this.items[i],this.direction=j-h>0?"down":"up")}if(!g&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[d],g?this._rearrange(b,g,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;return d.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(d[0].style.width==""||c.forceHelperSize)&&d.width(this.currentItem.width()),(d[0].style.height==""||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],d=a(b.containment).offset(),e=a(c).css("overflow")!="hidden";this.containment=[d.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,d.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,d.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=b.pageX,g=b.pageY;if(this.originalPosition){this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top));if(c.grid){var h=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1];g=this.containment?h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3]?h-this.offset.click.top<this.containment[1]?h+c.grid[1]:h-c.grid[1]:h:h;var i=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0];f=this.containment?i-this.offset.click.left<this.containment[0]||i-this.offset.click.left>this.containment[2]?i-this.offset.click.left<this.containment[0]?i+c.grid[0]:i-c.grid[0]:i:i}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var d=[],e=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(var f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(var f=this.containers.length-1;f>=0;f--)c||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(var f=0;f<d.length;f++)d[f].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.23"})})(jQuery);;(function(a,b){var c=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,c=this.element[0].ownerDocument,d;this.isMultiLine=this.element.is("textarea"),this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(b.options.disabled||b.element.propAttr("readOnly"))return;d=!1;var e=a.ui.keyCode;switch(c.keyCode){case e.PAGE_UP:b._move("previousPage",c);break;case e.PAGE_DOWN:b._move("nextPage",c);break;case e.UP:b._keyEvent("previous",c);break;case e.DOWN:b._keyEvent("next",c);break;case e.ENTER:case e.NUMPAD_ENTER:b.menu.active&&(d=!0,c.preventDefault());case e.TAB:if(!b.menu.active)return;b.menu.select(c);break;case e.ESCAPE:b.element.val(b.term),b.close(c);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){b.term!=b.element.val()&&(b.selectedItem=null,b.search(null,c))},b.options.delay)}}).bind("keypress.autocomplete",function(a){d&&(d=!1,a.preventDefault())}).bind("focus.autocomplete",function(){if(b.options.disabled)return;b.selectedItem=null,b.previous=b.element.val()}).bind("blur.autocomplete",function(a){if(b.options.disabled)return;clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a),b._change(a)},150)}),this._initSource(),this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",c)[0]).mousedown(function(c){var d=b.menu.element[0];a(c.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&c.target!==d&&!a.ui.contains(d,c.target)&&b.close()})},1),setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,c){var d=c.item.data("item.autocomplete");!1!==b._trigger("focus",a,{item:d})&&/^key/.test(a.originalEvent.type)&&b.element.val(d.value)},selected:function(a,d){var e=d.item.data("item.autocomplete"),f=b.previous;b.element[0]!==c.activeElement&&(b.element.focus(),b.previous=f,setTimeout(function(){b.previous=f,b.selectedItem=e},1)),!1!==b._trigger("select",a,{item:e})&&b.element.val(e.value),b.term=b.element.val(),b.close(a),b.selectedItem=e},blur:function(a,c){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),a.fn.bgiframe&&this.menu.element.bgiframe(),b.beforeunloadHandler=function(){b.element.removeAttr("autocomplete")},a(window).bind("beforeunload",b.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),a(window).unbind("beforeunload",this.beforeunloadHandler),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="source"&&this._initSource(),b==="appendTo"&&this.menu.element.appendTo(a(c||"body",this.element[0].ownerDocument)[0]),b==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var b=this,c,d;a.isArray(this.options.source)?(c=this.options.source,this.source=function(b,d){d(a.ui.autocomplete.filter(c,b.term))}):typeof this.options.source=="string"?(d=this.options.source,this.source=function(c,e){b.xhr&&b.xhr.abort(),b.xhr=a.ajax({url:d,data:c,dataType:"json",success:function(a,b){e(a)},error:function(){e([])}})}):this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val(),this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)===!1)return;return this._search(a)},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:a},this._response())},_response:function(){var a=this,b=++c;return function(d){b===c&&a.__response(d),a.pending--,a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){!this.options.disabled&&a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close()},close:function(a){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b=="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b),this.menu.deactivate(),this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new a.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItem(b,c)})},_renderItem:function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label)).appendTo(b)},_move:function(a,b){if(!this.menu.element.is(":visible")){this.search(null,b);return}if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term),this.menu.deactivate();return}this.menu[a](b)},widget:function(){return this.menu.element},_keyEvent:function(a,b){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(a,b),b.preventDefault()}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}})})(jQuery),function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){if(!a(c.target).closest(".ui-menu-item a").length)return;c.preventDefault(),b.select(c)}),this.refresh()},refresh:function(){var b=this,c=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");c.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var c=b.offset().top-this.element.offset().top,d=this.element.scrollTop(),e=this.element.height();c<0?this.element.scrollTop(d+c):c>=e&&this.element.scrollTop(d+c-e+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",a,{item:b})},deactivate:function(){if(!this.active)return;this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,b,c){if(!this.active){this.activate(c,this.element.children(b));return}var d=this.active[a+"All"](".ui-menu-item").eq(0);d.length?this.activate(c,d):this.activate(c,this.element.children(b))},nextPage:function(b){if(this.hasScroll()){if(!this.active||this.last()){this.activate(b,this.element.children(".ui-menu-item:first"));return}var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c-d+a(this).height();return b<10&&b>-10});e.length||(e=this.element.children(".ui-menu-item:last")),this.activate(b,e)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll()){if(!this.active||this.first()){this.activate(b,this.element.children(".ui-menu-item:last"));return}var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c+d-a(this).height();return b<10&&b>-10});e.length||(e=this.element.children(".ui-menu-item:first")),this.activate(b,e)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})}(jQuery);;(function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=d.values&&d.values.length||1,h=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(d.disabled?" ui-slider-disabled ui-disabled":"")),this.range=a([]),d.range&&(d.range===!0&&(d.values||(d.values=[this._valueMin(),this._valueMin()]),d.values.length&&d.values.length!==2&&(d.values=[d.values[0],d.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(d.range==="min"||d.range==="max"?" ui-slider-range-"+d.range:"")));for(var i=e.length;i<g;i+=1)h.push(f);this.handles=e.add(a(h.join("")).appendTo(b.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){d.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){d.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")}),this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)}),this.handles.keydown(function(d){var e=a(this).data("index.ui-slider-handle"),f,g,h,i;if(b.options.disabled)return;switch(d.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:d.preventDefault();if(!b._keySliding){b._keySliding=!0,a(this).addClass("ui-state-active"),f=b._start(d,e);if(f===!1)return}}i=b.options.step,b.options.values&&b.options.values.length?g=h=b.values(e):g=h=b.value();switch(d.keyCode){case a.ui.keyCode.HOME:h=b._valueMin();break;case a.ui.keyCode.END:h=b._valueMax();break;case a.ui.keyCode.PAGE_UP:h=b._trimAlignValue(g+(b._valueMax()-b._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:h=b._trimAlignValue(g-(b._valueMax()-b._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(g===b._valueMax())return;h=b._trimAlignValue(g+i);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(g===b._valueMin())return;h=b._trimAlignValue(g-i)}b._slide(d,e,h)}).keyup(function(c){var d=a(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(c,d),b._change(c,d),a(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options,d,e,f,g,h,i,j,k,l;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),d={x:b.pageX,y:b.pageY},e=this._normValueFromMouse(d),f=this._valueMax()-this._valueMin()+1,h=this,this.handles.each(function(b){var c=Math.abs(e-h.values(b));f>c&&(f=c,g=a(this),i=b)}),c.range===!0&&this.values(1)===c.min&&(i+=1,g=a(this.handles[i])),j=this._start(b,i),j===!1?!1:(this._mouseSliding=!0,h._handleIndex=i,g.addClass("ui-state-active").focus(),k=g.offset(),l=!a(b.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:b.pageX-k.left-g.width()/2,top:b.pageY-k.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,i,e),this._animateOff=!0,!0))},_mouseStart:function(a){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return this.orientation==="horizontal"?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),d<0&&(d=0),this.orientation==="vertical"&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),this.options.values.length===2&&this.options.range===!0&&(b===0&&c>d||b===1&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c,!0))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("change",a,c)}},value:function(a){if(arguments.length){this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(b,c){var d,e,f;if(arguments.length>1){this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);return}if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();d=this.options.values,e=arguments[0];for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments);switch(b){case"disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b),b;c=this.options.values.slice();for(d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return Math.abs(c)*2>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,c=this.options,d=this,e=this._animateOff?!1:c.animate,f,g={},h,i,j,k;this.options.values&&this.options.values.length?this.handles.each(function(b,i){f=(d.values(b)-d._valueMin())/(d._valueMax()-d._valueMin())*100,g[d.orientation==="horizontal"?"left":"bottom"]=f+"%",a(this).stop(1,1)[e?"animate":"css"](g,c.animate),d.options.range===!0&&(d.orientation==="horizontal"?(b===0&&d.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},c.animate),b===1&&d.range[e?"animate":"css"]({width:f-h+"%"},{queue:!1,duration:c.animate})):(b===0&&d.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},c.animate),b===1&&d.range[e?"animate":"css"]({height:f-h+"%"},{queue:!1,duration:c.animate}))),h=f}):(i=this.value(),j=this._valueMin(),k=this._valueMax(),f=k!==j?(i-j)/(k-j)*100:0,g[d.orientation==="horizontal"?"left":"bottom"]=f+"%",this.handle.stop(1,1)[e?"animate":"css"](g,c.animate),b==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[e?"animate":"css"]({width:f+"%"},c.animate),b==="max"&&this.orientation==="horizontal"&&this.range[e?"animate":"css"]({width:100-f+"%"},{queue:!1,duration:c.animate}),b==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},c.animate),b==="max"&&this.orientation==="vertical"&&this.range[e?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:c.animate}))}}),a.extend(a.ui.slider,{version:"1.8.23"})})(jQuery);;(function(a,b){function e(){return++c}function f(){return++d}var c=0,d=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,b){if(a=="selected"){if(this.options.collapsible&&b==this.options.selected)return;this.select(b)}else this.options[a]=b,this._tabify()},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+e()},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+f());return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(c){function m(b,c){b.css("display",""),!a.support.opacity&&c.opacity&&b[0].style.removeAttribute("filter")}var d=this,e=this.options,f=/^#.+/;this.list=this.element.find("ol,ul").eq(0),this.lis=a(" > li:has(a[href])",this.list),this.anchors=this.lis.map(function(){return a("a",this)[0]}),this.panels=a([]),this.anchors.each(function(b,c){var g=a(c).attr("href"),h=g.split("#")[0],i;h&&(h===location.toString().split("#")[0]||(i=a("base")[0])&&h===i.href)&&(g=c.hash,c.href=g);if(f.test(g))d.panels=d.panels.add(d.element.find(d._sanitizeSelector(g)));else if(g&&g!=="#"){a.data(c,"href.tabs",g),a.data(c,"load.tabs",g.replace(/#.*$/,""));var j=d._tabId(c);c.href="#"+j;var k=d.element.find("#"+j);k.length||(k=a(e.panelTemplate).attr("id",j).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(d.panels[b-1]||d.list),k.data("destroy.tabs",!0)),d.panels=d.panels.add(k)}else e.disabled.push(b)}),c?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),e.selected===b?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash)return e.selected=a,!1}),typeof e.selected!="number"&&e.cookie&&(e.selected=parseInt(d._cookie(),10)),typeof e.selected!="number"&&this.lis.filter(".ui-tabs-selected").length&&(e.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))),e.selected=e.selected||(this.lis.length?0:-1)):e.selected===null&&(e.selected=-1),e.selected=e.selected>=0&&this.anchors[e.selected]||e.selected<0?e.selected:0,e.disabled=a.unique(e.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a,b){return d.lis.index(a)}))).sort(),a.inArray(e.selected,e.disabled)!=-1&&e.disabled.splice(a.inArray(e.selected,e.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),e.selected>=0&&this.anchors.length&&(d.element.find(d._sanitizeSelector(d.anchors[e.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(e.selected).addClass("ui-tabs-selected ui-state-active"),d.element.queue("tabs",function(){d._trigger("show",null,d._ui(d.anchors[e.selected],d.element.find(d._sanitizeSelector(d.anchors[e.selected].hash))[0]))}),this.load(e.selected)),a(window).bind("unload",function(){d.lis.add(d.anchors).unbind(".tabs"),d.lis=d.anchors=d.panels=null})):e.selected=this.lis.index(this.lis.filter(".ui-tabs-selected")),this.element[e.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible"),e.cookie&&this._cookie(e.selected,e.cookie);for(var g=0,h;h=this.lis[g];g++)a(h)[a.inArray(g,e.disabled)!=-1&&!a(h).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");e.cache===!1&&this.anchors.removeData("cache.tabs"),this.lis.add(this.anchors).unbind(".tabs");if(e.event!=="mouseover"){var i=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)},j=function(a,b){b.removeClass("ui-state-"+a)};this.lis.bind("mouseover.tabs",function(){i("hover",a(this))}),this.lis.bind("mouseout.tabs",function(){j("hover",a(this))}),this.anchors.bind("focus.tabs",function(){i("focus",a(this).closest("li"))}),this.anchors.bind("blur.tabs",function(){j("focus",a(this).closest("li"))})}var k,l;e.fx&&(a.isArray(e.fx)?(k=e.fx[0],l=e.fx[1]):k=l=e.fx);var n=l?function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.hide().removeClass("ui-tabs-hide").animate(l,l.duration||"normal",function(){m(c,l),d._trigger("show",null,d._ui(b,c[0]))})}:function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.removeClass("ui-tabs-hide"),d._trigger("show",null,d._ui(b,c[0]))},o=k?function(a,b){b.animate(k,k.duration||"normal",function(){d.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),m(b,k),d.element.dequeue("tabs")})}:function(a,b,c){d.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),d.element.dequeue("tabs")};this.anchors.bind(e.event+".tabs",function(){var b=this,c=a(b).closest("li"),f=d.panels.filter(":not(.ui-tabs-hide)"),g=d.element.find(d._sanitizeSelector(b.hash));if(c.hasClass("ui-tabs-selected")&&!e.collapsible||c.hasClass("ui-state-disabled")||c.hasClass("ui-state-processing")||d.panels.filter(":animated").length||d._trigger("select",null,d._ui(this,g[0]))===!1)return this.blur(),!1;e.selected=d.anchors.index(this),d.abort();if(e.collapsible){if(c.hasClass("ui-tabs-selected"))return e.selected=-1,e.cookie&&d._cookie(e.selected,e.cookie),d.element.queue("tabs",function(){o(b,f)}).dequeue("tabs"),this.blur(),!1;if(!f.length)return e.cookie&&d._cookie(e.selected,e.cookie),d.element.queue("tabs",function(){n(b,g)}),d.load(d.anchors.index(this)),this.blur(),!1}e.cookie&&d._cookie(e.selected,e.cookie);if(g.length)f.length&&d.element.queue("tabs",function(){o(b,f)}),d.element.queue("tabs",function(){n(b,g)}),d.load(d.anchors.index(this));else throw"jQuery UI Tabs: Mismatching fragment identifier.";a.browser.msie&&this.blur()}),this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(a){return typeof a=="string"&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},destroy:function(){var b=this.options;return this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var b=a.data(this,"href.tabs");b&&(this.href=b);var c=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){c.removeData(b+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}),b.cookie&&this._cookie(null,b.cookie),this},add:function(c,d,e){e===b&&(e=this.anchors.length);var f=this,g=this.options,h=a(g.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),i=c.indexOf("#")?this._tabId(a("a",h)[0]):c.replace("#","");h.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var j=f.element.find("#"+i);return j.length||(j=a(g.panelTemplate).attr("id",i).data("destroy.tabs",!0)),j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),e>=this.lis.length?(h.appendTo(this.list),j.appendTo(this.list[0].parentNode)):(h.insertBefore(this.lis[e]),j.insertBefore(this.panels[e])),g.disabled=a.map(g.disabled,function(a,b){return a>=e?++a:a}),this._tabify(),this.anchors.length==1&&(g.selected=0,h.addClass("ui-tabs-selected ui-state-active"),j.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){f._trigger("show",null,f._ui(f.anchors[0],f.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[e],this.panels[e])),this},remove:function(b){b=this._getIndex(b);var c=this.options,d=this.lis.eq(b).remove(),e=this.panels.eq(b).remove();return d.hasClass("ui-tabs-selected")&&this.anchors.length>1&&this.select(b+(b+1<this.anchors.length?1:-1)),c.disabled=a.map(a.grep(c.disabled,function(a,c){return a!=b}),function(a,c){return a>=b?--a:a}),this._tabify(),this._trigger("remove",null,this._ui(d.find("a")[0],e[0])),this},enable:function(b){b=this._getIndex(b);var c=this.options;if(a.inArray(b,c.disabled)==-1)return;return this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=a.grep(c.disabled,function(a,c){return a!=b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b])),this},disable:function(a){a=this._getIndex(a);var b=this,c=this.options;return a!=c.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),c.disabled.push(a),c.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a]))),this},select:function(a){a=this._getIndex(a);if(a==-1)if(this.options.collapsible&&this.options.selected!=-1)a=this.options.selected;else return this;return this.anchors.eq(a).trigger(this.options.event+".tabs"),this},load:function(b){b=this._getIndex(b);var c=this,d=this.options,e=this.anchors.eq(b)[0],f=a.data(e,"load.tabs");this.abort();if(!f||this.element.queue("tabs").length!==0&&a.data(e,"cache.tabs")){this.element.dequeue("tabs");return}this.lis.eq(b).addClass("ui-state-processing");if(d.spinner){var g=a("span",e);g.data("label.tabs",g.html()).html(d.spinner)}return this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:f,success:function(f,g){c.element.find(c._sanitizeSelector(e.hash)).html(f),c._cleanup(),d.cache&&a.data(e,"cache.tabs",!0),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.success(f,g)}catch(h){}},error:function(a,f,g){c._cleanup(),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.error(a,f,b,e)}catch(g){}}})),c.element.dequeue("tabs"),this},abort:function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup(),this},url:function(a,b){return this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",b),this},length:function(){return this.anchors.length}}),a.extend(a.ui.tabs,{version:"1.8.23"}),a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,d=this.options,e=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation),c.rotation=setTimeout(function(){var a=d.selected;c.select(++a<c.anchors.length?a:0)},a),b&&b.stopPropagation()}),f=c._unrotate||(c._unrotate=b?function(a){e()}:function(a){a.clientX&&c.rotate(null)});return a?(this.element.bind("tabsshow",e),this.anchors.bind(d.event+".tabs",f),e()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",e),this.anchors.unbind(d.event+".tabs",f),delete this._rotate,delete this._unrotate),this}})})(jQuery);;(function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(a){var b="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return a.bind("mouseout",function(a){var c=$(a.target).closest(b);if(!c.length)return;c.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(c){var d=$(c.target).closest(b);if($.datepicker._isDisabledDatepicker(instActive.inline?a.parent()[0]:instActive.input[0])||!d.length)return;d.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),d.addClass("ui-state-hover"),d.hasClass("ui-datepicker-prev")&&d.addClass("ui-datepicker-prev-hover"),d.hasClass("ui-datepicker-next")&&d.addClass("ui-datepicker-next-hover")})}function extendRemove(a,b){$.extend(a,b);for(var c in b)if(b[c]==null||b[c]==undefined)a[c]=b[c];return a}function isArray(a){return a&&($.browser.safari&&typeof a=="object"&&a.length||a.constructor&&a.constructor.toString().match(/\Array\(\)/))}$.extend($.ui,{datepicker:{version:"1.8.23"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return extendRemove(this._defaults,a||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(a,b){var c=a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:c,input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(a,b){var c=$(a);b.append=$([]),b.trigger=$([]);if(c.hasClass(this.markerClassName))return;this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),$.data(a,PROP_NAME,b),b.settings.disabled&&this._disableDatepicker(a)},_attachments:function(a,b){var c=this._get(b,"appendText"),d=this._get(b,"isRTL");b.append&&b.append.remove(),c&&(b.append=$('<span class="'+this._appendClass+'">'+c+"</span>"),a[d?"before":"after"](b.append)),a.unbind("focus",this._showDatepicker),b.trigger&&b.trigger.remove();var e=this._get(b,"showOn");(e=="focus"||e=="both")&&a.focus(this._showDatepicker);if(e=="button"||e=="both"){var f=this._get(b,"buttonText"),g=this._get(b,"buttonImage");b.trigger=$(this._get(b,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:g,alt:f,title:f}):$('<button type="button"></button>').addClass(this._triggerClass).html(g==""?f:$("<img/>").attr({src:g,alt:f,title:f}))),a[d?"before":"after"](b.trigger),b.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==a[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=a[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(a[0])):$.datepicker._showDatepicker(a[0]),!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){var b=0,c=0;for(var d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort"))),b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=$(a);if(c.hasClass(this.markerClassName))return;c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),$.data(a,PROP_NAME,b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),b.dpDiv.css("display","block")},_dialogDatepicker:function(a,b,c,d,e){var f=this._dialogInst;if(!f){this.uuid+=1;var g="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+g+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),f=this._dialogInst=this._newInst(this._dialogInput,!1),f.settings={},$.data(this._dialogInput[0],PROP_NAME,f)}extendRemove(f.settings,d||{}),b=b&&b.constructor==Date?this._formatDate(f,b):b,this._dialogInput.val(b),this._pos=e?e.length?e:[e.pageX,e.pageY]:null;if(!this._pos){var h=document.documentElement.clientWidth,i=document.documentElement.clientHeight,j=document.documentElement.scrollLeft||document.body.scrollLeft,k=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[h/2-100+j,i/2-150+k]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),f.settings.onSelect=c,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,f),this},_destroyDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!b.hasClass(this.markerClassName))return;var d=a.nodeName.toLowerCase();$.removeData(a,PROP_NAME),d=="input"?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(d=="div"||d=="span")&&b.removeClass(this.markerClassName).empty()},_enableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!b.hasClass(this.markerClassName))return;var d=a.nodeName.toLowerCase();if(d=="input")a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().removeClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b})},_disableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!b.hasClass(this.markerClassName))return;var d=a.nodeName.toLowerCase();if(d=="input")a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().addClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b}),this._disabledInputs[this._disabledInputs.length]=a},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return $.data(a,PROP_NAME)}catch(b){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(a,b,c){var d=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?$.extend({},$.datepicker._defaults):d?b=="all"?$.extend({},d.settings):this._get(d,b):null;var e=b||{};typeof b=="string"&&(e={},e[b]=c);if(d){this._curInst==d&&this._hideDatepicker();var f=this._getDateDatepicker(a,!0),g=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max");extendRemove(d.settings,e),g!==null&&e.dateFormat!==undefined&&e.minDate===undefined&&(d.settings.minDate=this._formatDate(d,g)),h!==null&&e.dateFormat!==undefined&&e.maxDate===undefined&&(d.settings.maxDate=this._formatDate(d,h)),this._attachments($(a),d),this._autoSize(d),this._setDate(d,f),this._updateAlternate(d),this._updateDatepicker(d)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(a){var b=$.datepicker._getInst(a.target),c=!0,d=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if($.datepicker._datepickerShowing)switch(a.keyCode){case 9:$.datepicker._hideDatepicker(),c=!1;break;case 13:var e=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",b.dpDiv);e[0]&&$.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,e[0]);var f=$.datepicker._get(b,"onSelect");if(f){var g=$.datepicker._formatDate(b);f.apply(b.input?b.input[0]:null,[g,b])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&$.datepicker._clearDate(a.target),c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&$.datepicker._gotoToday(a.target),c=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?1:-1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,-7,"D"),c=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?-1:1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,7,"D"),c=a.ctrlKey||a.metaKey;break;default:c=!1}else a.keyCode==36&&a.ctrlKey?$.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=$.datepicker._getInst(a.target);if($.datepicker._get(b,"constrainInput")){var c=$.datepicker._possibleChars($.datepicker._get(b,"dateFormat")),d=String.fromCharCode(a.charCode==undefined?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||d<" "||!c||c.indexOf(d)>-1}},_doKeyUp:function(a){var b=$.datepicker._getInst(a.target);if(b.input.val()!=b.lastVal)try{var c=$.datepicker.parseDate($.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,$.datepicker._getFormatConfig(b));c&&($.datepicker._setDateFromField(b),$.datepicker._updateAlternate(b),$.datepicker._updateDatepicker(b))}catch(d){$.datepicker.log(d)}return!0},_showDatepicker:function(a){a=a.target||a,a.nodeName.toLowerCase()!="input"&&(a=$("input",a.parentNode)[0]);if($.datepicker._isDisabledDatepicker(a)||$.datepicker._lastInput==a)return;var b=$.datepicker._getInst(a);$.datepicker._curInst&&$.datepicker._curInst!=b&&($.datepicker._curInst.dpDiv.stop(!0,!0),b&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var c=$.datepicker._get(b,"beforeShow"),d=c?c.apply(a,[a,b]):{};if(d===!1)return;extendRemove(b.settings,d),b.lastVal=null,$.datepicker._lastInput=a,$.datepicker._setDateFromField(b),$.datepicker._inDialog&&(a.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(a),$.datepicker._pos[1]+=a.offsetHeight);var e=!1;$(a).parents().each(function(){return e|=$(this).css("position")=="fixed",!e}),e&&$.browser.opera&&($.datepicker._pos[0]-=document.documentElement.scrollLeft,$.datepicker._pos[1]-=document.documentElement.scrollTop);var f={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(b),f=$.datepicker._checkOffset(b,f,e),b.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":e?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});if(!b.inline){var g=$.datepicker._get(b,"showAnim"),h=$.datepicker._get(b,"duration"),i=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(!!a.length){var c=$.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex($(a).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects[g]?b.dpDiv.show(g,$.datepicker._get(b,"showOptions"),h,i):b.dpDiv[g||"show"](g?h:null,i),(!g||!h)&&i(),b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus(),$.datepicker._curInst=b}},_updateDatepicker:function(a){var b=this;b.maxRows=4;var c=$.datepicker._getBorders(a.dpDiv);instActive=a,a.dpDiv.empty().append(this._generateHTML(a)),this._attachHandlers(a);var d=a.dpDiv.find("iframe.ui-datepicker-cover");!d.length||d.css({left:-c[0],top:-c[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}),a.dpDiv.find("."+this._dayOverClass+" a").mouseover();var e=this._getNumberOfMonths(a),f=e[1],g=17;a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),f>1&&a.dpDiv.addClass("ui-datepicker-multi-"+f).css("width",g*f+"em"),a.dpDiv[(e[0]!=1||e[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a==$.datepicker._curInst&&$.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var h=a.yearshtml;setTimeout(function(){h===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),h=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var d=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),f=a.input?a.input.outerWidth():0,g=a.input?a.input.outerHeight():0,h=document.documentElement.clientWidth+(c?0:$(document).scrollLeft()),i=document.documentElement.clientHeight+(c?0:$(document).scrollTop());return b.left-=this._get(a,"isRTL")?d-f:0,b.left-=c&&b.left==a.input.offset().left?$(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+g?$(document).scrollTop():0,b.left-=Math.min(b.left,b.left+d>h&&h>d?Math.abs(b.left+d-h):0),b.top-=Math.min(b.top,b.top+e>i&&i>e?Math.abs(e+g):0),b},_findPos:function(a){var b=this._getInst(a),c=this._get(b,"isRTL");while(a&&(a.type=="hidden"||a.nodeType!=1||$.expr.filters.hidden(a)))a=a[c?"previousSibling":"nextSibling"];var d=$(a).offset();return[d.left,d.top]},_hideDatepicker:function(a){var b=this._curInst;if(!b||a&&b!=$.data(a,PROP_NAME))return;if(this._datepickerShowing){var c=this._get(b,"showAnim"),d=this._get(b,"duration"),e=function(){$.datepicker._tidyDialog(b)};$.effects&&$.effects[c]?b.dpDiv.hide(c,$.datepicker._get(b,"showOptions"),d,e):b.dpDiv[c=="slideDown"?"slideUp":c=="fadeIn"?"fadeOut":"hide"](c?d:null,e),c||e(),this._datepickerShowing=!1;var f=this._get(b,"onClose");f&&f.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(!$.datepicker._curInst)return;var b=$(a.target),c=$.datepicker._getInst(b[0]);(b[0].id!=$.datepicker._mainDivId&&b.parents("#"+$.datepicker._mainDivId).length==0&&!b.hasClass($.datepicker.markerClassName)&&!b.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||b.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=c)&&$.datepicker._hideDatepicker()},_adjustDate:function(a,b,c){var d=$(a),e=this._getInst(d[0]);if(this._isDisabledDatepicker(d[0]))return;this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e)},_gotoToday:function(a){var b=$(a),c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay)c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear;else{var d=new Date;c.selectedDay=d.getDate(),c.drawMonth=c.selectedMonth=d.getMonth(),c.drawYear=c.selectedYear=d.getFullYear()}this._notifyChange(c),this._adjustDate(b)},_selectMonthYear:function(a,b,c){var d=$(a),e=this._getInst(d[0]);e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(d)},_selectDay:function(a,b,c,d){var e=$(a);if($(d).hasClass(this._unselectableClass)||this._isDisabledDatepicker(e[0]))return;var f=this._getInst(e[0]);f.selectedDay=f.currentDay=$("a",d).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))},_clearDate:function(a){var b=$(a),c=this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(a,b){var c=$(a),d=this._getInst(c[0]);b=b!=null?b:this._formatDate(d),d.input&&d.input.val(b),this._updateAlternate(d);var e=this._get(d,"onSelect");e?e.apply(d.input?d.input[0]:null,[b,d]):d.input&&d.input.trigger("change"),d.inline?this._updateDatepicker(d):(this._hideDatepicker(),this._lastInput=d.input[0],typeof d.input[0]!="object"&&d.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),d=this._getDate(a),e=this.formatDate(c,d,this._getFormatConfig(a));$(b).each(function(){$(this).val(e)})}},noWeekends:function(a){var b=a.getDay();return[b>0&&b<6,""]},iso8601Week:function(a){var b=new Date(a.getTime());b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b=="object"?b.toString():b+"";if(b=="")return null;var d=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;d=typeof d!="string"?d:(new Date).getFullYear()%100+parseInt(d,10);var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=-1,j=-1,k=-1,l=-1,m=!1,n=function(b){var c=s+1<a.length&&a.charAt(s+1)==b;return c&&s++,c},o=function(a){var c=n(a),d=a=="@"?14:a=="!"?20:a=="y"&&c?4:a=="o"?3:2,e=new RegExp("^\\d{1,"+d+"}"),f=b.substring(r).match(e);if(!f)throw"Missing number at position "+r;return r+=f[0].length,parseInt(f[0],10)},p=function(a,c,d){var e=$.map(n(a)?d:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),f=-1;$.each(e,function(a,c){var d=c[1];if(b.substr(r,d.length).toLowerCase()==d.toLowerCase())return f=c[0],r+=d.length,!1});if(f!=-1)return f+1;throw"Unknown name at position "+r},q=function(){if(b.charAt(r)!=a.charAt(s))throw"Unexpected literal at position "+r;r++},r=0;for(var s=0;s<a.length;s++)if(m)a.charAt(s)=="'"&&!n("'")?m=!1:q();else switch(a.charAt(s)){case"d":k=o("d");break;case"D":p("D",e,f);break;case"o":l=o("o");break;case"m":j=o("m");break;case"M":j=p("M",g,h);break;case"y":i=o("y");break;case"@":var t=new Date(o("@"));i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"!":var t=new Date((o("!")-this._ticksTo1970)/1e4);i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"'":n("'")?q():m=!0;break;default:q()}if(r<b.length)throw"Extra/unparsed characters found in date: "+b.substring(r);i==-1?i=(new Date).getFullYear():i<100&&(i+=(new Date).getFullYear()-(new Date).getFullYear()%100+(i<=d?0:-100));if(l>-1){j=1,k=l;do{var u=this._getDaysInMonth(i,j-1);if(k<=u)break;j++,k-=u}while(!0)}var t=this._daylightSavingAdjust(new Date(i,j-1,k));if(t.getFullYear()!=i||t.getMonth()+1!=j||t.getDate()!=k)throw"Invalid date";return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,h=function(b){var c=m+1<a.length&&a.charAt(m+1)==b;return c&&m++,c},i=function(a,b,c){var d=""+b;if(h(a))while(d.length<c)d="0"+d;return d},j=function(a,b,c,d){return h(a)?d[b]:c[b]},k="",l=!1;if(b)for(var m=0;m<a.length;m++)if(l)a.charAt(m)=="'"&&!h("'")?l=!1:k+=a.charAt(m);else switch(a.charAt(m)){case"d":k+=i("d",b.getDate(),2);break;case"D":k+=j("D",b.getDay(),d,e);break;case"o":k+=i("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":k+=i("m",b.getMonth()+1,2);break;case"M":k+=j("M",b.getMonth(),f,g);break;case"y":k+=h("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":k+=b.getTime();break;case"!":k+=b.getTime()*1e4+this._ticksTo1970;break;case"'":h("'")?k+="'":l=!0;break;default:k+=a.charAt(m)}return k},_possibleChars:function(a){var b="",c=!1,d=function(b){var c=e+1<a.length&&a.charAt(e+1)==b;return c&&e++,c};for(var e=0;e<a.length;e++)if(c)a.charAt(e)=="'"&&!d("'")?c=!1:b+=a.charAt(e);else switch(a.charAt(e)){case"d":case"m":case"y":case"@":b+="0123456789";break;case"D":case"M":return null;case"'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}return b},_get:function(a,b){return a.settings[b]!==undefined?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()==a.lastVal)return;var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,d,g)||f}catch(h){this.log(h),d=b?"":d}a.selectedDay=e.getDate(),a.drawMonth=a.selectedMonth=e.getMonth(),a.drawYear=a.selectedYear=e.getFullYear(),a.currentDay=d?e.getDate():0,a.currentMonth=d?e.getMonth():0,a.currentYear=d?e.getFullYear():0,this._adjustInstDate(a)},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var d=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},e=function(b){try{return $.datepicker.parseDate($.datepicker._get(a,"dateFormat"),b,$.datepicker._getFormatConfig(a))}catch(c){}var d=(b.toLowerCase().match(/^c/)?$.datepicker._getDate(a):null)||new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(b);while(i){switch(i[2]||"d"){case"d":case"D":g+=parseInt(i[1],10);break;case"w":case"W":g+=parseInt(i[1],10)*7;break;case"m":case"M":f+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f));break;case"y":case"Y":e+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f))}i=h.exec(b)}return new Date(e,f,g)},f=b==null||b===""?c:typeof b=="string"?e(b):typeof b=="number"?isNaN(b)?c:d(b):new Date(b.getTime());return f=f&&f.toString()=="Invalid Date"?c:f,f&&(f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0)),this._daylightSavingAdjust(f)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_attachHandlers:function(a){var b=this._get(a,"stepMonths"),c="#"+a.id.replace(/\\\\/g,"\\");a.dpDiv.find("[data-handler]").map(function(){var a={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(c,-b,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(c,+b,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(c)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(c,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(c,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(c,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),a[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),d=this._get(a,"showButtonPanel"),e=this._get(a,"hideIfNoPrevNext"),f=this._get(a,"navigationAsDateFormat"),g=this._getNumberOfMonths(a),h=this._get(a,"showCurrentAtPos"),i=this._get(a,"stepMonths"),j=g[0]!=1||g[1]!=1,k=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),l=this._getMinMaxDate(a,"min"),m=this._getMinMaxDate(a,"max"),n=a.drawMonth-h,o=a.drawYear;n<0&&(n+=12,o--);if(m){var p=this._daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth()-g[0]*g[1]+1,m.getDate()));p=l&&p<l?l:p;while(this._daylightSavingAdjust(new Date(o,n,1))>p)n--,n<0&&(n=11,o--)}a.drawMonth=n,a.drawYear=o;var q=this._get(a,"prevText");q=f?this.formatDate(q,this._daylightSavingAdjust(new Date(o,n-i,1)),this._getFormatConfig(a)):q;var r=this._canAdjustMonth(a,-1,o,n)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>":e?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>",s=this._get(a,"nextText");s=f?this.formatDate(s,this._daylightSavingAdjust(new Date(o,n+i,1)),this._getFormatConfig(a)):s;var t=this._canAdjustMonth(a,1,o,n)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":e?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>",u=this._get(a,"currentText"),v=this._get(a,"gotoCurrent")&&a.currentDay?k:b;u=f?this.formatDate(u,v,this._getFormatConfig(a)):u;var w=a.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(a,"closeText")+"</button>",x=d?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?w:"")+(this._isInRange(a,v)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+u+"</button>":"")+(c?"":w)+"</div>":"",y=parseInt(this._get(a,"firstDay"),10);y=isNaN(y)?0:y;var z=this._get(a,"showWeek"),A=this._get(a,"dayNames"),B=this._get(a,"dayNamesShort"),C=this._get(a,"dayNamesMin"),D=this._get(a,"monthNames"),E=this._get(a,"monthNamesShort"),F=this._get(a,"beforeShowDay"),G=this._get(a,"showOtherMonths"),H=this._get(a,"selectOtherMonths"),I=this._get(a,"calculateWeek")||this.iso8601Week,J=this._getDefaultDate(a),K="";for(var L=0;L<g[0];L++){var M="";this.maxRows=4;for(var N=0;N<g[1];N++){var O=this._daylightSavingAdjust(new Date(o,n,a.selectedDay)),P=" ui-corner-all",Q="";if(j){Q+='<div class="ui-datepicker-group';if(g[1]>1)switch(N){case 0:Q+=" ui-datepicker-group-first",P=" ui-corner-"+(c?"right":"left");break;case g[1]-1:Q+=" ui-datepicker-group-last",P=" ui-corner-"+(c?"left":"right");break;default:Q+=" ui-datepicker-group-middle",P=""}Q+='">'}Q+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+P+'">'+(/all|left/.test(P)&&L==0?c?t:r:"")+(/all|right/.test(P)&&L==0?c?r:t:"")+this._generateMonthYearHeader(a,n,o,l,m,L>0||N>0,D,E)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var R=z?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(var S=0;S<7;S++){var T=(S+y)%7;R+="<th"+((S+y+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+A[T]+'">'+C[T]+"</span></th>"}Q+=R+"</tr></thead><tbody>";var U=this._getDaysInMonth(o,n);o==a.selectedYear&&n==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,U));var V=(this._getFirstDayOfMonth(o,n)-y+7)%7,W=Math.ceil((V+U)/7),X=j?this.maxRows>W?this.maxRows:W:W;this.maxRows=X;var Y=this._daylightSavingAdjust(new Date(o,n,1-V));for(var Z=0;Z<X;Z++){Q+="<tr>";var _=z?'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(Y)+"</td>":"";for(var S=0;S<7;S++){var ba=F?F.apply(a.input?a.input[0]:null,[Y]):[!0,""],bb=Y.getMonth()!=n,bc=bb&&!H||!ba[0]||l&&Y<l||m&&Y>m;_+='<td class="'+((S+y+6)%7>=5?" ui-datepicker-week-end":"")+(bb?" ui-datepicker-other-month":"")+(Y.getTime()==O.getTime()&&n==a.selectedMonth&&a._keyEvent||J.getTime()==Y.getTime()&&J.getTime()==O.getTime()?" "+this._dayOverClass:"")+(bc?" "+this._unselectableClass+" ui-state-disabled":"")+(bb&&!G?"":" "+ba[1]+(Y.getTime()==k.getTime()?" "+this._currentClass:"")+(Y.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!bb||G)&&ba[2]?' title="'+ba[2]+'"':"")+(bc?"":' data-handler="selectDay" data-event="click" data-month="'+Y.getMonth()+'" data-year="'+Y.getFullYear()+'"')+">"+(bb&&!G?"&#xa0;":bc?'<span class="ui-state-default">'+Y.getDate()+"</span>":'<a class="ui-state-default'+(Y.getTime()==b.getTime()?" ui-state-highlight":"")+(Y.getTime()==k.getTime()?" ui-state-active":"")+(bb?" ui-priority-secondary":"")+'" href="#">'+Y.getDate()+"</a>")+"</td>",Y.setDate(Y.getDate()+1),Y=this._daylightSavingAdjust(Y)}Q+=_+"</tr>"}n++,n>11&&(n=0,o++),Q+="</tbody></table>"+(j?"</div>"+(g[0]>0&&N==g[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),M+=Q}K+=M}return K+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),a._keyEvent=!1,K},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i=this._get(a,"changeMonth"),j=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),l='<div class="ui-datepicker-title">',m="";if(f||!i)m+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{var n=d&&d.getFullYear()==c,o=e&&e.getFullYear()==c;m+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var p=0;p<12;p++)(!n||p>=d.getMonth())&&(!o||p<=e.getMonth())&&(m+='<option value="'+p+'"'+(p==b?' selected="selected"':"")+">"+h[p]+"</option>");m+="</select>"}k||(l+=m+(f||!i||!j?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(f||!j)l+='<span class="ui-datepicker-year">'+c+"</span>";else{var q=this._get(a,"yearRange").split(":"),r=(new Date).getFullYear(),s=function(a){var b=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?r+parseInt(a,10):parseInt(a,10);return isNaN(b)?r:b},t=s(q[0]),u=Math.max(t,s(q[1]||""));t=d?Math.max(t,d.getFullYear()):t,u=e?Math.min(u,e.getFullYear()):u,a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;t<=u;t++)a.yearshtml+='<option value="'+t+'"'+(t==c?' selected="selected"':"")+">"+t+"</option>";a.yearshtml+="</select>",l+=a.yearshtml,a.yearshtml=null}}return l+=this._get(a,"yearSuffix"),k&&(l+=(f||!i||!j?"&#xa0;":"")+m),l+="</div>",l},_adjustInstDate:function(a,b,c){var d=a.drawYear+(c=="Y"?b:0),e=a.drawMonth+(c=="M"?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+(c=="D"?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),(c=="M"||c=="Y")&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&b<c?c:b;return e=d&&e>d?d:e,e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(b<0?b:e[0]*e[1]),1));return b<0&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),$.fn.datepicker=function(a){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv),$.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return typeof a!="string"||a!="isDisabled"&&a!="getDate"&&a!="widget"?a=="option"&&arguments.length==2&&typeof arguments[1]=="string"?$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this].concat(b)):$.datepicker._attachDatepicker(this,a)}):$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.8.23",window["DP_jQuery_"+dpuuid]=$})(jQuery);;(function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove(),a.Widget.prototype.destroy.apply(this,arguments)},value:function(a){return a===b?this._value():(this._setOption("value",a),this)},_setOption:function(b,c){b==="value"&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;return typeof a!="number"&&(a=0),Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change")),this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%"),this.element.attr("aria-valuenow",a)}}),a.extend(a.ui.progressbar,{version:"1.8.23"})})(jQuery);;jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};(function($){function maybeCall(thing,ctx){return(typeof thing=='function')?(thing.call(ctx)):thing;};function isElementInDOM(ele){while(ele=ele.parentNode){if(ele==document)return true;}
return false;};function Tipsy(element,options){this.$element=$(element);this.options=options;this.enabled=true;this.fixTitle();};Tipsy.prototype={show:function(){var title=this.getTitle();if(title&&this.enabled){var $tip=this.tip();$tip.find('.tipsy-inner')[this.options.html?'html':'text'](title);$tip[0].className='tipsy';$tip.remove().css({top:0,left:0,visibility:'hidden',display:'block'}).prependTo(document.body);var pos=$.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight,gravity=maybeCall(this.options.gravity,this.$element[0]);var tp;switch(gravity.charAt(0)){case'n':tp={top:pos.top+pos.height+this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case's':tp={top:pos.top-actualHeight-this.options.offset,left:pos.left+pos.width/2-actualWidth/2};break;case'e':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth-this.options.offset};break;case'w':tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width+this.options.offset};break;}
if(gravity.length==2){if(gravity.charAt(1)=='w'){tp.left=pos.left+pos.width/2-15;}else{tp.left=pos.left+pos.width/2-actualWidth+15;}}
$tip.css(tp).addClass('tipsy-'+gravity);$tip.find('.tipsy-arrow')[0].className='tipsy-arrow tipsy-arrow-'+gravity.charAt(0);if(this.options.className){$tip.addClass(maybeCall(this.options.className,this.$element[0]));}
if(this.options.fade){$tip.stop().css({opacity:0,display:'block',visibility:'visible'}).animate({opacity:this.options.opacity});}else{$tip.css({visibility:'visible',opacity:this.options.opacity});}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){$(this).remove();});}else{this.tip().remove();}},fixTitle:function(){var $e=this.$element;if($e.attr('title')||typeof($e.attr('original-title'))!='string'){$e.attr('original-title',$e.attr('title')||'').removeAttr('title');}},getTitle:function(){var title,$e=this.$element,o=this.options;this.fixTitle();var title,o=this.options;if(typeof o.title=='string'){title=$e.attr(o.title=='title'?'original-title':o.title);}else if(typeof o.title=='function'){title=o.title.call($e[0]);}
title=(''+title).replace(/(^\s*|\s*$)/,"");return title||o.fallback;},tip:function(){if(!this.$tip){this.$tip=$('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');this.$tip.data('tipsy-pointee',this.$element[0]);}
return this.$tip;},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null;}},enable:function(){this.enabled=true;},disable:function(){this.enabled=false;},toggleEnabled:function(){this.enabled=!this.enabled;}};$.fn.tipsy=function(options){if(options===true){return this.data('tipsy');}else if(typeof options=='string'){var tipsy=this.data('tipsy');if(tipsy)tipsy[options]();return this;}
options=$.extend({},$.fn.tipsy.defaults,options);function get(ele){var tipsy=$.data(ele,'tipsy');if(!tipsy){tipsy=new Tipsy(ele,$.fn.tipsy.elementOptions(ele,options));$.data(ele,'tipsy',tipsy);}
return tipsy;}
function enter(){var tipsy=get(this);tipsy.hoverState='in';if(options.delayIn==0){tipsy.show();}else{tipsy.fixTitle();setTimeout(function(){if(tipsy.hoverState=='in')tipsy.show();},options.delayIn);}};function leave(){var tipsy=get(this);tipsy.hoverState='out';if(options.delayOut==0){tipsy.hide();}else{setTimeout(function(){if(tipsy.hoverState=='out')tipsy.hide();},options.delayOut);}};if(!options.live)this.each(function(){get(this);});if(options.trigger!='manual'){var binder=options.live?'live':'bind',eventIn=options.trigger=='hover'?'mouseenter':'focus',eventOut=options.trigger=='hover'?'mouseleave':'blur';this[binder](eventIn,enter)[binder](eventOut,leave);}
return this;};$.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:false,fallback:'',gravity:'n',html:false,live:false,offset:0,opacity:0.8,title:'title',trigger:'hover'};$.fn.tipsy.revalidate=function(){$('.tipsy').each(function(){var pointee=$.data(this,'tipsy-pointee');if(!pointee||!isElementInDOM(pointee)){$(this).remove();}});};$.fn.tipsy.elementOptions=function(ele,options){return $.metadata?$.extend({},options,$(ele).metadata()):options;};$.fn.tipsy.autoNS=function(){return $(this).offset().top>($(document).scrollTop()+$(window).height()/2)?'s':'n';};$.fn.tipsy.autoWE=function(){return $(this).offset().left>($(document).scrollLeft()+$(window).width()/2)?'e':'w';};$.fn.tipsy.autoBounds=function(margin,prefer){return function(){var dir={ns:prefer[0],ew:(prefer.length>1?prefer[1]:false)},boundTop=$(document).scrollTop()+margin,boundLeft=$(document).scrollLeft()+margin,$this=$(this);if($this.offset().top<boundTop)dir.ns='n';if($this.offset().left<boundLeft)dir.ew='w';if($(window).width()+$(document).scrollLeft()-$this.offset().left<margin)dir.ew='e';if($(window).height()+$(document).scrollTop()-$this.offset().top<margin)dir.ns='s';return dir.ns+(dir.ew?dir.ew:'');}};})(jQuery);(function(jQuery){var ValidationErrors=new Array();jQuery.fn.validate=function(options){options=jQuery.extend({expression:"return true;",message:"",error_message_class:"error--inline",error_container_class:"control-group",live:true},options);var SelfID=jQuery(this).attr("id");var unix_time=new Date();unix_time=parseInt(unix_time.getTime()/1000);if(!jQuery(this).parents('form:first').attr("id")){jQuery(this).parents('form:first').attr("id","Form_"+unix_time);}
var FormID=jQuery(this).parents('form:first').attr("id");if(!((typeof(ValidationErrors[FormID])=='object')&&(ValidationErrors[FormID]instanceof Array))){ValidationErrors[FormID]=new Array();}
if(options['live']){if(jQuery(this).find('input').length>0){jQuery(this).find('input').bind('blur',function(){if(validate_field("#"+SelfID,options)){if(options.callback_success)
options.callback_success(this);}
else{if(options.callback_failure)
options.callback_failure(this);}});jQuery(this).find('input').bind('focus keypress click',function(){jQuery("#"+SelfID).next('.'+options['error_message_class']).remove();jQuery("#"+SelfID).parents("."+options['error_container_class']).removeClass('error');});}
else{jQuery(this).bind('blur',function(){validate_field(this);});jQuery(this).bind('focus keypress',function(){var jQueryObjectBeforeErrorMessage=getjQueryObjectBeforeErrorMessage(jQuery(this));jQueryObjectBeforeErrorMessage.next('.'+options['error_message_class']).fadeOut("fast",function(){jQuery(this).remove();});jQuery(this).parents("."+options['error_container_class']).removeClass('error');});}}
jQuery(this).parents("form").submit(function(){if(validate_field('#'+SelfID)){return true;}
else
return false;});function validate_field(id){var self=jQuery(id).attr("id");var expression='function Validate(){'+options['expression'].replace(/VAL/g,'jQuery(\'#'+self+'\').val()')+'} Validate()';var validation_state=eval(expression);if(!validation_state){jQueryObjectBeforeErrorMessage=getjQueryObjectBeforeErrorMessage(jQuery(id));if(jQueryObjectBeforeErrorMessage.next('.'+options['error_message_class']).length==0){jQueryObjectBeforeErrorMessage.after('<span class="'+options['error_message_class']+'">'+options['message']+'</span>');jQuery(id).parents("div."+options['error_container_class']).addClass("error");}
if(ValidationErrors[FormID].join("|").search(id)==-1)
ValidationErrors[FormID].push(id);return false;}
else{for(var i=0;i<ValidationErrors[FormID].length;i++){if(ValidationErrors[FormID][i]==id)
ValidationErrors[FormID].splice(i,1);}
return true;}}
function getjQueryObjectBeforeErrorMessage(inputjQueryObject)
{if(inputjQueryObject.next().hasClass("add-on"))
{return inputjQueryObject.next();}
return inputjQueryObject;}};jQuery.fn.validated=function(callback){jQuery(this).each(function(){if(this.tagName=="FORM"){jQuery(this).submit(function(){if(ValidationErrors[jQuery(this).attr("id")].length==0)
callback();return false;});}});};})(jQuery);(function(){function write(buffer,offs){for(var i=2;i<arguments.length;i++){for(var j=0;j<arguments[i].length;j++){buffer[offs++]=arguments[i].charAt(j);}}}
function byte2(w){return String.fromCharCode((w>>8)&255,w&255);}
function byte4(w){return String.fromCharCode((w>>24)&255,(w>>16)&255,(w>>8)&255,w&255);}
function byte2lsb(w){return String.fromCharCode(w&255,(w>>8)&255);}
window.PNGlib=function(width,height,depth){this.width=width;this.height=height;this.depth=depth;this.pix_size=height*(width+1);this.data_size=2+this.pix_size+5*Math.floor((0xfffe+this.pix_size)/0xffff)+4;this.ihdr_offs=0;this.ihdr_size=4+4+13+4;this.plte_offs=this.ihdr_offs+this.ihdr_size;this.plte_size=4+4+3*depth+4;this.trns_offs=this.plte_offs+this.plte_size;this.trns_size=4+4+depth+4;this.idat_offs=this.trns_offs+this.trns_size;this.idat_size=4+4+this.data_size+4;this.iend_offs=this.idat_offs+this.idat_size;this.iend_size=4+4+4;this.buffer_size=this.iend_offs+this.iend_size;this.buffer=new Array();this.palette=new Object();this.pindex=0;var _crc32=new Array();for(var i=0;i<this.buffer_size;i++){this.buffer[i]="\x00";}
write(this.buffer,this.ihdr_offs,byte4(this.ihdr_size-12),'IHDR',byte4(width),byte4(height),"\x08\x03");write(this.buffer,this.plte_offs,byte4(this.plte_size-12),'PLTE');write(this.buffer,this.trns_offs,byte4(this.trns_size-12),'tRNS');write(this.buffer,this.idat_offs,byte4(this.idat_size-12),'IDAT');write(this.buffer,this.iend_offs,byte4(this.iend_size-12),'IEND');var header=((8+(7<<4))<<8)|(3<<6);header+=31-(header%31);write(this.buffer,this.idat_offs+8,byte2(header));for(var i=0;(i<<16)-1<this.pix_size;i++){var size,bits;if(i+0xffff<this.pix_size){size=0xffff;bits="\x00";}else{size=this.pix_size-(i<<16)-i;bits="\x01";}
write(this.buffer,this.idat_offs+8+2+(i<<16)+(i<<2),bits,byte2lsb(size),byte2lsb(~size));}
for(var i=0;i<256;i++){var c=i;for(var j=0;j<8;j++){if(c&1){c=-306674912^((c>>1)&0x7fffffff);}else{c=(c>>1)&0x7fffffff;}}
_crc32[i]=c;}
this.index=function(x,y){var i=y*(this.width+1)+x+1;var j=this.idat_offs+8+2+5*Math.floor((i/0xffff)+1)+i;return j;}
this.color=function(red,green,blue,alpha){alpha=alpha>=0?alpha:255;var color=(((((alpha<<8)|red)<<8)|green)<<8)|blue;if(typeof this.palette[color]=="undefined"){if(this.pindex==this.depth){return"\x00";}
var ndx=this.plte_offs+8+3*this.pindex;this.buffer[ndx+0]=String.fromCharCode(red);this.buffer[ndx+1]=String.fromCharCode(green);this.buffer[ndx+2]=String.fromCharCode(blue);this.buffer[this.trns_offs+8+this.pindex]=String.fromCharCode(alpha);this.palette[color]=String.fromCharCode(this.pindex++);}
return this.palette[color];}
this.getBase64=function(){var s=this.getDump();var ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var c1,c2,c3,e1,e2,e3,e4;var l=s.length;var i=0;var r="";do{c1=s.charCodeAt(i);e1=c1>>2;c2=s.charCodeAt(i+1);e2=((c1&3)<<4)|(c2>>4);c3=s.charCodeAt(i+2);if(l<i+2){e3=64;}else{e3=((c2&0xf)<<2)|(c3>>6);}
if(l<i+3){e4=64;}else{e4=c3&0x3f;}
r+=ch.charAt(e1)+ch.charAt(e2)+ch.charAt(e3)+ch.charAt(e4);}while((i+=3)<l);return r;}
this.getDump=function(){var BASE=65521;var NMAX=5552;var s1=1;var s2=0;var n=NMAX;for(var y=0;y<this.height;y++){for(var x=-1;x<this.width;x++){s1+=this.buffer[this.index(x,y)].charCodeAt(0);s2+=s1;if((n-=1)==0){s1%=BASE;s2%=BASE;n=NMAX;}}}
s1%=BASE;s2%=BASE;write(this.buffer,this.idat_offs+this.idat_size-8,byte4((s2<<16)|s1));function crc32(png,offs,size){var crc=-1;for(var i=4;i<size-4;i+=1){crc=_crc32[(crc^png[offs+i].charCodeAt(0))&0xff]^((crc>>8)&0x00ffffff);}
write(png,offs+size-4,byte4(crc^-1));}
crc32(this.buffer,this.ihdr_offs,this.ihdr_size);crc32(this.buffer,this.plte_offs,this.plte_size);crc32(this.buffer,this.trns_offs,this.trns_size);crc32(this.buffer,this.idat_offs,this.idat_size);crc32(this.buffer,this.iend_offs,this.iend_size);return"\211PNG\r\n\032\n"+this.buffer.join('');}}})();(function(){var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random;function tinycolor(color,opts){color=(color)?color:'';opts=opts||{};if(typeof color=="object"&&color.hasOwnProperty("_tc_id")){return color;}
var rgb=inputToRGB(color);var r=rgb.r,g=rgb.g,b=rgb.b,a=rgb.a,roundA=mathRound(100*a)/100,format=opts.format||rgb.format;return{ok:rgb.ok,format:format,_tc_id:tinyCounter++,alpha:a,getAlpha:function(){return a;},setAlpha:function(value){a=boundAlpha(value);roundA=mathRound(100*a)/100;},toHsv:function(){var hsv=rgbToHsv(r,g,b);return{h:hsv.h*360,s:hsv.s,v:hsv.v,a:a};},toHsvString:function(){var hsv=rgbToHsv(r,g,b);var h=mathRound(hsv.h*360),s=mathRound(hsv.s*100),v=mathRound(hsv.v*100);return(a==1)?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+roundA+")";},toHsl:function(){var hsl=rgbToHsl(r,g,b);return{h:hsl.h*360,s:hsl.s,l:hsl.l,a:a};},toHslString:function(){var hsl=rgbToHsl(r,g,b);var h=mathRound(hsl.h*360),s=mathRound(hsl.s*100),l=mathRound(hsl.l*100);return(a==1)?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+roundA+")";},toHex:function(allow3Char){return rgbToHex(r,g,b,allow3Char);},toHexString:function(allow3Char){return'#'+this.toHex(allow3Char);},toHex8:function(){return rgbaToHex(r,g,b,a);},toHex8String:function(){return'#'+this.toHex8();},toRgb:function(){return{r:mathRound(r),g:mathRound(g),b:mathRound(b),a:a};},toRgbString:function(){return(a==1)?"rgb("+mathRound(r)+", "+mathRound(g)+", "+mathRound(b)+")":"rgba("+mathRound(r)+", "+mathRound(g)+", "+mathRound(b)+", "+roundA+")";},toPercentageRgb:function(){return{r:mathRound(bound01(r,255)*100)+"%",g:mathRound(bound01(g,255)*100)+"%",b:mathRound(bound01(b,255)*100)+"%",a:a};},toPercentageRgbString:function(){return(a==1)?"rgb("+mathRound(bound01(r,255)*100)+"%, "+mathRound(bound01(g,255)*100)+"%, "+mathRound(bound01(b,255)*100)+"%)":"rgba("+mathRound(bound01(r,255)*100)+"%, "+mathRound(bound01(g,255)*100)+"%, "+mathRound(bound01(b,255)*100)+"%, "+roundA+")";},toName:function(){if(a===0){return"transparent";}
return hexNames[rgbToHex(r,g,b,true)]||false;},toFilter:function(secondColor){var hex8String='#'+rgbaToHex(r,g,b,a);var secondHex8String=hex8String;var gradientType=opts&&opts.gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String=s.toHex8String();}
return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")";},toString:function(format){var formatSet=!!format;format=format||this.format;var formattedString=false;var hasAlphaAndFormatNotSet=!formatSet&&a<1&&a>0;var formatWithAlpha=hasAlphaAndFormatNotSet&&(format==="hex"||format==="hex6"||format==="hex3"||format==="name");if(format==="rgb"){formattedString=this.toRgbString();}
if(format==="prgb"){formattedString=this.toPercentageRgbString();}
if(format==="hex"||format==="hex6"){formattedString=this.toHexString();}
if(format==="hex3"){formattedString=this.toHexString(true);}
if(format==="hex8"){formattedString=this.toHex8String();}
if(format==="name"){formattedString=this.toName();}
if(format==="hsl"){formattedString=this.toHslString();}
if(format==="hsv"){formattedString=this.toHsvString();}
if(formatWithAlpha){return this.toRgbString();}
return formattedString||this.toHexString();}};}
tinycolor.fromRatio=function(color,opts){if(typeof color=="object"){var newColor={};for(var i in color){if(color.hasOwnProperty(i)){if(i==="a"){newColor[i]=color[i];}
else{newColor[i]=convertToPercentage(color[i]);}}}
color=newColor;}
return tinycolor(color,opts);};function inputToRGB(color){var rgb={r:0,g:0,b:0};var a=1;var ok=false;var format=false;if(typeof color=="string"){color=stringInputToObject(color);}
if(typeof color=="object"){if(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")){rgb=rgbToRgb(color.r,color.g,color.b);ok=true;format=String(color.r).substr(-1)==="%"?"prgb":"rgb";}
else if(color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")){color.s=convertToPercentage(color.s);color.v=convertToPercentage(color.v);rgb=hsvToRgb(color.h,color.s,color.v);ok=true;format="hsv";}
else if(color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")){color.s=convertToPercentage(color.s);color.l=convertToPercentage(color.l);rgb=hslToRgb(color.h,color.s,color.l);ok=true;format="hsl";}
if(color.hasOwnProperty("a")){a=color.a;}}
a=boundAlpha(a);return{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a};}
function rgbToRgb(r,g,b){var range01=isBound01(r,g,b);var max=range01?1:255;return{r:bound01(r,max)*255,g:bound01(g,max)*255,b:bound01(b,max)*255};}
function rgbToHsl(r,g,b){r=bound01(r,255);g=bound01(g,255);b=bound01(b,255);var max=mathMax(r,g,b),min=mathMin(r,g,b);var h,s,l=(max+min)/2;if(max==min){h=s=0;}
else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}
h/=6;}
return{h:h,s:s,l:l};}
function hslToRgb(h,s,l){var r,g,b;h=bound01(h,360);s=bound01(s,100);l=bound01(l,100);function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p;}
if(s===0){r=g=b=l;}
else{var q=l<0.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}
return{r:r*255,g:g*255,b:b*255};}
function rgbToHsv(r,g,b){r=bound01(r,255);g=bound01(g,255);b=bound01(b,255);var max=mathMax(r,g,b),min=mathMin(r,g,b);var h,s,v=max;var d=max-min;s=max===0?0:d/max;if(max==min){h=0;}
else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}
h/=6;}
return{h:h,s:s,v:v};}
function hsvToRgb(h,s,v){h=bound01(h,360)*6;s=bound01(s,100);v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:r*255,g:g*255,b:b*255};}
function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];if(allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)){return hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0);}
return hex.join("");}
function rgbaToHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("");}
tinycolor.equals=function(color1,color2){if(!color1||!color2){return false;}
return tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString();};tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()});};tinycolor.desaturate=function(color,amount){amount=(amount===0)?0:(amount||10);var hsl=tinycolor(color).toHsl();hsl.s-=amount/100;hsl.s=clamp01(hsl.s);return tinycolor(hsl);};tinycolor.saturate=function(color,amount){amount=(amount===0)?0:(amount||10);var hsl=tinycolor(color).toHsl();hsl.s+=amount/100;hsl.s=clamp01(hsl.s);return tinycolor(hsl);};tinycolor.greyscale=function(color){return tinycolor.desaturate(color,100);};tinycolor.lighten=function(color,amount){amount=(amount===0)?0:(amount||10);var hsl=tinycolor(color).toHsl();hsl.l+=amount/100;hsl.l=clamp01(hsl.l);return tinycolor(hsl);};tinycolor.darken=function(color,amount){amount=(amount===0)?0:(amount||10);var hsl=tinycolor(color).toHsl();hsl.l-=amount/100;hsl.l=clamp01(hsl.l);return tinycolor(hsl);};tinycolor.complement=function(color){var hsl=tinycolor(color).toHsl();hsl.h=(hsl.h+180)%360;return tinycolor(hsl);};tinycolor.triad=function(color){var hsl=tinycolor(color).toHsl();var h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})];};tinycolor.tetrad=function(color){var hsl=tinycolor(color).toHsl();var h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})];};tinycolor.splitcomplement=function(color){var hsl=tinycolor(color).toHsl();var h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})];};tinycolor.analogous=function(color,results,slices){results=results||6;slices=slices||30;var hsl=tinycolor(color).toHsl();var part=360/slices;var ret=[tinycolor(color)];for(hsl.h=((hsl.h-(part*results>>1))+720)%360;--results;){hsl.h=(hsl.h+part)%360;ret.push(tinycolor(hsl));}
return ret;};tinycolor.monochromatic=function(color,results){results=results||6;var hsv=tinycolor(color).toHsv();var h=hsv.h,s=hsv.s,v=hsv.v;var ret=[];var modification=1/results;while(results--){ret.push(tinycolor({h:h,s:s,v:v}));v=(v+modification)%1;}
return ret;};tinycolor.readability=function(color1,color2){var a=tinycolor(color1).toRgb();var b=tinycolor(color2).toRgb();var brightnessA=(a.r*299+a.g*587+a.b*114)/1000;var brightnessB=(b.r*299+b.g*587+b.b*114)/1000;var colorDiff=(Math.max(a.r,b.r)-Math.min(a.r,b.r)+
Math.max(a.g,b.g)-Math.min(a.g,b.g)+
Math.max(a.b,b.b)-Math.min(a.b,b.b));return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff};};tinycolor.readable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500;};tinycolor.mostReadable=function(baseColor,colorList){var bestColor=null;var bestScore=0;var bestIsReadable=false;for(var i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]);var readable=readability.brightness>125&&readability.color>500;var score=3*(readability.brightness/125)+(readability.color/500);if((readable&&!bestIsReadable)||(readable&&bestIsReadable&&score>bestScore)||((!readable)&&(!bestIsReadable)&&score>bestScore)){bestIsReadable=readable;bestScore=score;bestColor=tinycolor(colorList[i]);}}
return bestColor;};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var hexNames=tinycolor.hexNames=flip(names);function flip(o){var flipped={};for(var i in o){if(o.hasOwnProperty(i)){flipped[o[i]]=i;}}
return flipped;}
function boundAlpha(a){a=parseFloat(a);if(isNaN(a)||a<0||a>1){a=1;}
return a;}
function bound01(n,max){if(isOnePointZero(n)){n="100%";}
var processPercent=isPercentage(n);n=mathMin(max,mathMax(0,parseFloat(n)));if(processPercent){n=parseInt(n*max,10)/100;}
if((math.abs(n-max)<0.000001)){return 1;}
return(n%max)/parseFloat(max);}
function clamp01(val){return mathMin(1,mathMax(0,val));}
function parseIntFromHex(val){return parseInt(val,16);}
function isOnePointZero(n){return hasDecimalPoint(n)&&parseFloat(n)===1;}
function hasDecimalPoint(n){return typeof n=="string"&&n.indexOf('.')!=-1;}
function isBound01(r,g,b){return[r,g,b].reduce(function(p,n){return p&&hasDecimalPoint(n)&&parseFloat(n)<=1;},true);}
function isPercentage(n){return typeof n==="string"&&n.indexOf('%')!=-1;}
function pad2(c){return c.length==1?'0'+c:''+c;}
function convertToPercentage(n){if(n<=1){n=(n*100)+"%";}
return n;}
function convertDecimalToHex(d){return Math.round(parseFloat(d)*255).toString(16);}
function convertHexToDecimal(h){return(parseIntFromHex(h)/255);}
var matchers=(function(){var CSS_INTEGER="[-\\+]?\\d+%?";var CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?";var CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")";var PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";var PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};})();function stringInputToObject(color){color=color.replace(trimLeft,'').replace(trimRight,'').toLowerCase();var named=false;if(names[color]){color=names[color];named=true;}
else if(color=='transparent'){return{r:0,g:0,b:0,a:0,format:"name"};}
var match;if((match=matchers.rgb.exec(color))){return{r:match[1],g:match[2],b:match[3]};}
if((match=matchers.rgba.exec(color))){return{r:match[1],g:match[2],b:match[3],a:match[4]};}
if((match=matchers.hsl.exec(color))){return{h:match[1],s:match[2],l:match[3]};}
if((match=matchers.hsla.exec(color))){return{h:match[1],s:match[2],l:match[3],a:match[4]};}
if((match=matchers.hsv.exec(color))){return{h:match[1],s:match[2],v:match[3]};}
if((match=matchers.hex8.exec(color))){return{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"};}
if((match=matchers.hex6.exec(color))){return{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"};}
if((match=matchers.hex3.exec(color))){return{r:parseIntFromHex(match[1]+''+match[1]),g:parseIntFromHex(match[2]+''+match[2]),b:parseIntFromHex(match[3]+''+match[3]),format:named?"name":"hex"};}
return false;}
if(typeof module!=="undefined"&&module.exports){module.exports=tinycolor;}
else if(typeof define!=="undefined"){define(function(){return tinycolor;});}
else{window.tinycolor=tinycolor;}})();﻿
(function(window,$,undefined){var defaultOpts={beforeShow:noop,move:noop,change:noop,show:noop,hide:noop,color:false,flat:false,showInput:false,allowEmpty:false,showButtons:true,clickoutFiresChange:false,showInitial:false,showPalette:false,showPaletteOnly:false,showSelectionPalette:true,localStorageKey:false,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",clearText:"Clear Color Selection",preferredFormat:false,className:"",showAlpha:false,theme:"sp-light",palette:['fff','000'],selectionPalette:[],disabled:false},spectrums=[],IE=!!/msie/i.exec(window.navigator.userAgent),rgbaSupport=(function(){function contains(str,substr){return!!~(''+str).indexOf(substr);}
var elem=document.createElement('div');var style=elem.style;style.cssText='background-color:rgba(0,0,0,.5)';return contains(style.backgroundColor,'rgba')||contains(style.backgroundColor,'hsla');})(),inputTypeColorSupport=(function(){var colorInput=$("<input type='color' value='!' />")[0];return colorInput.type==="color"&&colorInput.value!=="!";})(),replaceInput=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(''),markup=(function(){var gradientFix="";if(IE){for(var i=1;i<=6;i++){gradientFix+="<div class='sp-"+i+"'></div>";}}
return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",gradientFix,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button class='sp-choose'></button>","</div>","</div>","</div>"].join("");})();function paletteTemplate(p,color,className){var html=[];for(var i=0;i<p.length;i++){var current=p[i];if(current){var tiny=tinycolor(current);var c=tiny.toHsl().l<0.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=(tinycolor.equals(color,current))?" sp-thumb-active":"";var swatchStyle=rgbaSupport?("background-color:"+tiny.toRgbString()):"filter:"+tiny.toFilter();html.push('<span title="'+tiny.toRgbString()+'" data-color="'+tiny.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+swatchStyle+';" /></span>');}else{var cls='sp-clear-display';html.push('<span title="No Color Selected" data-color="" style="background-color:transparent;" class="'+cls+'"></span>');}}
return"<div class='sp-cf "+className+"'>"+html.join('')+"</div>";}
function hideAll(){for(var i=0;i<spectrums.length;i++){if(spectrums[i]){spectrums[i].hide();}}}
function instanceOptions(o,callbackContext){var opts=$.extend({},defaultOpts,o);opts.callbacks={'move':bind(opts.move,callbackContext),'change':bind(opts.change,callbackContext),'show':bind(opts.show,callbackContext),'hide':bind(opts.hide,callbackContext),'beforeShow':bind(opts.beforeShow,callbackContext)};return opts;}
function spectrum(element,o){var opts=instanceOptions(o,element),flat=opts.flat,showSelectionPalette=opts.showSelectionPalette,localStorageKey=opts.localStorageKey,theme=opts.theme,callbacks=opts.callbacks,resize=throttle(reflow,10),visible=false,dragWidth=0,dragHeight=0,dragHelperHeight=0,slideHeight=0,slideWidth=0,alphaWidth=0,alphaSlideHelperWidth=0,slideHelperHeight=0,currentHue=0,currentSaturation=0,currentValue=0,currentAlpha=1,palette=[],paletteArray=[],selectionPalette=opts.selectionPalette.slice(0),maxSelectionSize=opts.maxSelectionSize,draggingClass="sp-dragging",shiftMovementDirection=null;var doc=element.ownerDocument,body=doc.body,boundElement=$(element),disabled=false,container=$(markup,doc).addClass(theme),dragger=container.find(".sp-color"),dragHelper=container.find(".sp-dragger"),slider=container.find(".sp-hue"),slideHelper=container.find(".sp-slider"),alphaSliderInner=container.find(".sp-alpha-inner"),alphaSlider=container.find(".sp-alpha"),alphaSlideHelper=container.find(".sp-alpha-handle"),textInput=container.find(".sp-input"),paletteContainer=container.find(".sp-palette"),initialColorContainer=container.find(".sp-initial"),cancelButton=container.find(".sp-cancel"),clearButton=container.find(".sp-clear"),chooseButton=container.find(".sp-choose"),isInput=boundElement.is("input"),isInputTypeColor=isInput&&inputTypeColorSupport&&boundElement.attr("type")==="color",shouldReplace=isInput&&!flat,replacer=(shouldReplace)?$(replaceInput).addClass(theme).addClass(opts.className):$([]),offsetElement=(shouldReplace)?replacer:boundElement,previewElement=replacer.find(".sp-preview-inner"),initialColor=opts.color||(isInput&&boundElement.val()),colorOnShow=false,preferredFormat=opts.preferredFormat,currentPreferredFormat=preferredFormat,clickoutFiresChange=!opts.showButtons||opts.clickoutFiresChange,isEmpty=!initialColor,allowEmpty=opts.allowEmpty&&!isInputTypeColor;function applyOptions(){if(opts.showPaletteOnly){opts.showPalette=true;}
if(opts.palette){palette=opts.palette.slice(0);paletteArray=$.isArray(palette[0])?palette:[palette];}
container.toggleClass("sp-flat",flat);container.toggleClass("sp-input-disabled",!opts.showInput);container.toggleClass("sp-alpha-enabled",opts.showAlpha);container.toggleClass("sp-clear-enabled",allowEmpty);container.toggleClass("sp-buttons-disabled",!opts.showButtons);container.toggleClass("sp-palette-disabled",!opts.showPalette);container.toggleClass("sp-palette-only",opts.showPaletteOnly);container.toggleClass("sp-initial-disabled",!opts.showInitial);container.addClass(opts.className);reflow();}
function initialize(){if(IE){container.find("*:not(input)").attr("unselectable","on");}
applyOptions();if(shouldReplace){boundElement.after(replacer).hide();}
if(!allowEmpty){clearButton.hide();}
if(flat){boundElement.after(container).hide();}
else{var appendTo=opts.appendTo==="parent"?boundElement.parent():$(opts.appendTo);if(appendTo.length!==1){appendTo=$("body");}
appendTo.append(container);}
if(localStorageKey&&window.localStorage){try{var oldPalette=window.localStorage[localStorageKey].split(",#");if(oldPalette.length>1){delete window.localStorage[localStorageKey];$.each(oldPalette,function(i,c){addColorToSelectionPalette(c);});}}
catch(e){}
try{selectionPalette=window.localStorage[localStorageKey].split(";");}
catch(e){}}
offsetElement.bind("click.spectrum touchstart.spectrum",function(e){if(!disabled){toggle();}
e.stopPropagation();if(!$(e.target).is("input")){e.preventDefault();}});if(boundElement.is(":disabled")||(opts.disabled===true)){disable();}
container.click(stopPropagation);textInput.change(setFromTextInput);textInput.bind("paste",function(){setTimeout(setFromTextInput,1);});textInput.keydown(function(e){if(e.keyCode==13){setFromTextInput();}});cancelButton.text(opts.cancelText);cancelButton.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();hide("cancel");});clearButton.attr("title",opts.clearText);clearButton.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();isEmpty=true;move();if(flat){updateOriginalInput(true);}});chooseButton.text(opts.chooseText);chooseButton.bind("click.spectrum",function(e){e.stopPropagation();e.preventDefault();if(isValid()){updateOriginalInput(true);hide();}});draggable(alphaSlider,function(dragX,dragY,e){currentAlpha=(dragX/alphaWidth);isEmpty=false;if(e.shiftKey){currentAlpha=Math.round(currentAlpha*10)/10;}
move();},dragStart,dragStop);draggable(slider,function(dragX,dragY){currentHue=parseFloat(dragY/slideHeight);isEmpty=false;if(!opts.showAlpha){currentAlpha=1;}
move();},dragStart,dragStop);draggable(dragger,function(dragX,dragY,e){if(!e.shiftKey){shiftMovementDirection=null;}
else if(!shiftMovementDirection){var oldDragX=currentSaturation*dragWidth;var oldDragY=dragHeight-(currentValue*dragHeight);var furtherFromX=Math.abs(dragX-oldDragX)>Math.abs(dragY-oldDragY);shiftMovementDirection=furtherFromX?"x":"y";}
var setSaturation=!shiftMovementDirection||shiftMovementDirection==="x";var setValue=!shiftMovementDirection||shiftMovementDirection==="y";if(setSaturation){currentSaturation=parseFloat(dragX/dragWidth);}
if(setValue){currentValue=parseFloat((dragHeight-dragY)/dragHeight);}
isEmpty=false;if(!opts.showAlpha){currentAlpha=1;}
move();},dragStart,dragStop);if(!!initialColor){set(initialColor);updateUI();currentPreferredFormat=preferredFormat||tinycolor(initialColor).format;addColorToSelectionPalette(initialColor);}
else{updateUI();}
if(flat){show();}
function palletElementClick(e){if(e.data&&e.data.ignore){set($(this).data("color"));move();}
else{set($(this).data("color"));move();updateOriginalInput(true);hide();}
return false;}
var paletteEvent=IE?"mousedown.spectrum":"click.spectrum touchstart.spectrum";paletteContainer.delegate(".sp-thumb-el",paletteEvent,palletElementClick);initialColorContainer.delegate(".sp-thumb-el:nth-child(1)",paletteEvent,{ignore:true},palletElementClick);}
function addColorToSelectionPalette(color){if(showSelectionPalette){var colorRgb=tinycolor(color).toRgbString();if($.inArray(colorRgb,selectionPalette)===-1){selectionPalette.push(colorRgb);while(selectionPalette.length>maxSelectionSize){selectionPalette.shift();}}
if(localStorageKey&&window.localStorage){try{window.localStorage[localStorageKey]=selectionPalette.join(";");}
catch(e){}}}}
function getUniqueSelectionPalette(){var unique=[];var p=selectionPalette;var paletteLookup={};var rgb;if(opts.showPalette){for(var i=0;i<paletteArray.length;i++){for(var j=0;j<paletteArray[i].length;j++){rgb=tinycolor(paletteArray[i][j]).toRgbString();paletteLookup[rgb]=true;}}
for(i=0;i<p.length;i++){rgb=tinycolor(p[i]).toRgbString();if(!paletteLookup.hasOwnProperty(rgb)){unique.push(p[i]);paletteLookup[rgb]=true;}}}
return unique.reverse().slice(0,opts.maxSelectionSize);}
function drawPalette(){var currentColor=get();var html=$.map(paletteArray,function(palette,i){return paletteTemplate(palette,currentColor,"sp-palette-row sp-palette-row-"+i);});if(selectionPalette){html.push(paletteTemplate(getUniqueSelectionPalette(),currentColor,"sp-palette-row sp-palette-row-selection"));}
paletteContainer.html(html.join(""));}
function drawInitial(){if(opts.showInitial){var initial=colorOnShow;var current=get();initialColorContainer.html(paletteTemplate([initial,current],current,"sp-palette-row-initial"));}}
function dragStart(){if(dragHeight<=0||dragWidth<=0||slideHeight<=0){reflow();}
container.addClass(draggingClass);shiftMovementDirection=null;boundElement.trigger('dragstart.spectrum',[get()]);}
function dragStop(){container.removeClass(draggingClass);boundElement.trigger('dragstop.spectrum',[get()]);}
function setFromTextInput(){var value=textInput.val();if((value===null||value==="")&&allowEmpty){set(null);updateOriginalInput(true);}
else{var tiny=tinycolor(value);if(tiny.ok){set(tiny);updateOriginalInput(true);}
else{textInput.addClass("sp-validation-error");}}}
function toggle(){if(visible){hide();}
else{show();}}
function show(){var event=$.Event('beforeShow.spectrum');if(visible){reflow();return;}
boundElement.trigger(event,[get()]);if(callbacks.beforeShow(get())===false||event.isDefaultPrevented()){return;}
hideAll();visible=true;$(doc).bind("click.spectrum",hide);$(window).bind("resize.spectrum",resize);replacer.addClass("sp-active");container.removeClass("sp-hidden");reflow();updateUI();colorOnShow=get();drawInitial();callbacks.show(colorOnShow);boundElement.trigger('show.spectrum',[colorOnShow]);}
function hide(e){if(e&&e.type=="click"&&e.button==2){return;}
if(!visible||flat){return;}
visible=false;$(doc).unbind("click.spectrum",hide);$(window).unbind("resize.spectrum",resize);replacer.removeClass("sp-active");container.addClass("sp-hidden");var colorHasChanged=!tinycolor.equals(get(),colorOnShow);if(colorHasChanged){if(clickoutFiresChange&&e!=="cancel"){updateOriginalInput(true);}
else{revert();}}
callbacks.hide(get());boundElement.trigger('hide.spectrum',[get()]);}
function revert(){set(colorOnShow,true);}
function set(color,ignoreFormatChange){if(tinycolor.equals(color,get())){updateUI();return;}
var newColor,newHsv;if(!color&&allowEmpty){isEmpty=true;}else{isEmpty=false;newColor=tinycolor(color);newHsv=newColor.toHsv();currentHue=(newHsv.h%360)/360;currentSaturation=newHsv.s;currentValue=newHsv.v;currentAlpha=newHsv.a;}
updateUI();if(newColor&&newColor.ok&&!ignoreFormatChange){currentPreferredFormat=preferredFormat||newColor.format;}}
function get(opts){opts=opts||{};if(allowEmpty&&isEmpty){return null;}
return tinycolor.fromRatio({h:currentHue,s:currentSaturation,v:currentValue,a:Math.round(currentAlpha*100)/100},{format:opts.format||currentPreferredFormat});}
function isValid(){return!textInput.hasClass("sp-validation-error");}
function move(){updateUI();callbacks.move(get());boundElement.trigger('move.spectrum',[get()]);}
function updateUI(){textInput.removeClass("sp-validation-error");updateHelperLocations();var flatColor=tinycolor.fromRatio({h:currentHue,s:1,v:1});dragger.css("background-color",flatColor.toHexString());var format=currentPreferredFormat;if(currentAlpha<1&&!(currentAlpha===0&&format==="name")){if(format==="hex"||format==="hex3"||format==="hex6"||format==="name"){format="rgb";}}
var realColor=get({format:format}),displayColor='';previewElement.removeClass("sp-clear-display");previewElement.css('background-color','transparent');if(!realColor&&allowEmpty){previewElement.addClass("sp-clear-display");}
else{var realHex=realColor.toHexString(),realRgb=realColor.toRgbString();if(rgbaSupport||realColor.alpha===1){previewElement.css("background-color",realRgb);}
else{previewElement.css("background-color","transparent");previewElement.css("filter",realColor.toFilter());}
if(opts.showAlpha){var rgb=realColor.toRgb();rgb.a=0;var realAlpha=tinycolor(rgb).toRgbString();var gradient="linear-gradient(left, "+realAlpha+", "+realHex+")";if(IE){alphaSliderInner.css("filter",tinycolor(realAlpha).toFilter({gradientType:1},realHex));}
else{alphaSliderInner.css("background","-webkit-"+gradient);alphaSliderInner.css("background","-moz-"+gradient);alphaSliderInner.css("background","-ms-"+gradient);alphaSliderInner.css("background","linear-gradient(to right, "+realAlpha+", "+realHex+")");}}
displayColor=realColor.toString(format);}
if(opts.showInput){textInput.val(displayColor);}
if(opts.showPalette){drawPalette();}
drawInitial();}
function updateHelperLocations(){var s=currentSaturation;var v=currentValue;if(allowEmpty&&isEmpty){alphaSlideHelper.hide();slideHelper.hide();dragHelper.hide();}
else{alphaSlideHelper.show();slideHelper.show();dragHelper.show();var dragX=s*dragWidth;var dragY=dragHeight-(v*dragHeight);dragX=Math.max(-dragHelperHeight,Math.min(dragWidth-dragHelperHeight,dragX-dragHelperHeight));dragY=Math.max(-dragHelperHeight,Math.min(dragHeight-dragHelperHeight,dragY-dragHelperHeight));dragHelper.css({"top":dragY+"px","left":dragX+"px"});var alphaX=currentAlpha*alphaWidth;alphaSlideHelper.css({"left":(alphaX-(alphaSlideHelperWidth/2))+"px"});var slideY=(currentHue)*slideHeight;slideHelper.css({"top":(slideY-slideHelperHeight)+"px"});}}
function updateOriginalInput(fireCallback){var color=get(),displayColor='',hasChanged=!tinycolor.equals(color,colorOnShow);if(color){displayColor=color.toString(currentPreferredFormat);addColorToSelectionPalette(color);}
if(isInput){boundElement.val(displayColor);}
colorOnShow=color;if(fireCallback&&hasChanged){callbacks.change(color);boundElement.trigger('change',[color]);}}
function reflow(){dragWidth=dragger.width();dragHeight=dragger.height();dragHelperHeight=dragHelper.height();slideWidth=slider.width();slideHeight=slider.height();slideHelperHeight=slideHelper.height();alphaWidth=alphaSlider.width();alphaSlideHelperWidth=alphaSlideHelper.width();if(!flat){container.css("position","absolute");container.offset(getOffset(container,offsetElement));}
updateHelperLocations();if(opts.showPalette){drawPalette();}
boundElement.trigger('reflow.spectrum');}
function destroy(){boundElement.show();offsetElement.unbind("click.spectrum touchstart.spectrum");container.remove();replacer.remove();spectrums[spect.id]=null;}
function option(optionName,optionValue){if(optionName===undefined){return $.extend({},opts);}
if(optionValue===undefined){return opts[optionName];}
opts[optionName]=optionValue;applyOptions();}
function enable(){disabled=false;boundElement.attr("disabled",false);offsetElement.removeClass("sp-disabled");}
function disable(){hide();disabled=true;boundElement.attr("disabled",true);offsetElement.addClass("sp-disabled");}
initialize();var spect={show:show,hide:hide,toggle:toggle,reflow:reflow,option:option,enable:enable,disable:disable,set:function(c){set(c);updateOriginalInput();},get:get,destroy:destroy,container:container};spect.id=spectrums.push(spect)-1;return spect;}
function getOffset(picker,input){var extraY=0;var dpWidth=picker.outerWidth();var dpHeight=picker.outerHeight();var inputHeight=input.outerHeight();var doc=picker[0].ownerDocument;var docElem=doc.documentElement;var viewWidth=docElem.clientWidth+$(doc).scrollLeft();var viewHeight=docElem.clientHeight+$(doc).scrollTop();var offset=input.offset();offset.top+=inputHeight;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,((offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight-extraY):extraY));return offset;}
function noop(){}
function stopPropagation(e){e.stopPropagation();}
function bind(func,obj){var slice=Array.prototype.slice;var args=slice.call(arguments,2);return function(){return func.apply(obj,args.concat(slice.call(arguments)));};}
function draggable(element,onmove,onstart,onstop){onmove=onmove||function(){};onstart=onstart||function(){};onstop=onstop||function(){};var doc=element.ownerDocument||document;var dragging=false;var offset={};var maxHeight=0;var maxWidth=0;var hasTouch=('ontouchstart'in window);var duringDragEvents={};duringDragEvents["selectstart"]=prevent;duringDragEvents["dragstart"]=prevent;duringDragEvents["touchmove mousemove"]=move;duringDragEvents["touchend mouseup"]=stop;function prevent(e){if(e.stopPropagation){e.stopPropagation();}
if(e.preventDefault){e.preventDefault();}
e.returnValue=false;}
function move(e){if(dragging){if(IE&&document.documentMode<9&&!e.button){return stop();}
var touches=e.originalEvent.touches;var pageX=touches?touches[0].pageX:e.pageX;var pageY=touches?touches[0].pageY:e.pageY;var dragX=Math.max(0,Math.min(pageX-offset.left,maxWidth));var dragY=Math.max(0,Math.min(pageY-offset.top,maxHeight));if(hasTouch){prevent(e);}
onmove.apply(element,[dragX,dragY,e]);}}
function start(e){var rightclick=(e.which)?(e.which==3):(e.button==2);var touches=e.originalEvent.touches;if(!rightclick&&!dragging){if(onstart.apply(element,arguments)!==false){dragging=true;maxHeight=$(element).height();maxWidth=$(element).width();offset=$(element).offset();$(doc).bind(duringDragEvents);$(doc.body).addClass("sp-dragging");if(!hasTouch){move(e);}
prevent(e);}}}
function stop(){if(dragging){$(doc).unbind(duringDragEvents);$(doc.body).removeClass("sp-dragging");onstop.apply(element,arguments);}
dragging=false;}
$(element).bind("touchstart mousedown",start);}
function throttle(func,wait,debounce){var timeout;return function(){var context=this,args=arguments;var throttler=function(){timeout=null;func.apply(context,args);};if(debounce)clearTimeout(timeout);if(debounce||!timeout)timeout=setTimeout(throttler,wait);};}
function log(){if(window.console){if(Function.prototype.bind)log=Function.prototype.bind.call(console.log,console);else log=function(){Function.prototype.apply.call(console.log,console,arguments);};log.apply(this,arguments);}}
var dataID="spectrum.id";$.fn.spectrum=function(opts,extra){if(typeof opts=="string"){var returnValue=this;var args=Array.prototype.slice.call(arguments,1);this.each(function(){var spect=spectrums[$(this).data(dataID)];if(spect){var method=spect[opts];if(!method){throw new Error("Spectrum: no such method: '"+opts+"'");}
if(opts=="get"){returnValue=spect.get();}
else if(opts=="container"){returnValue=spect.container;}
else if(opts=="option"){returnValue=spect.option.apply(spect,args);}
else if(opts=="destroy"){spect.destroy();$(this).removeData(dataID);}
else{method.apply(spect,args);}}});return returnValue;}
return this.spectrum("destroy").each(function(){var options=$.extend({},opts,$(this).data());var spect=spectrum(this,options);$(this).data(dataID,spect.id);});};$.fn.spectrum.load=true;$.fn.spectrum.loadOpts={};$.fn.spectrum.draggable=draggable;$.fn.spectrum.defaults=defaultOpts;$.spectrum={};$.spectrum.localization={};$.spectrum.palettes={};$.fn.spectrum.processNativeColorInputs=function(){if(!inputTypeColorSupport){$("input[type=color]").spectrum({preferredFormat:"hex6"});}};$(function(){if($.fn.spectrum.load){$.fn.spectrum.processNativeColorInputs();}});})(window,jQuery);var FBD={has_flash_blocker:false,callback_func:null,fake_embed_1:null,fake_embed_2:null,fake_embed_watcher:null,dom_node_inserted:function(ev){var target=ev.target;if(target.nodeType!=1){return;}
if(target.nodeName.toLowerCase()!='div'){return;}
if(target.className=='ujs_flashblock_placeholder'){FBD.has_flash_blocker=true;if(target.title===''){target.style.position='absolute';target.style.left='-5000px';}
window.setTimeout(FBD.cleanup,0);}else if(target.hasAttribute('bgactive')){FBD.has_flash_blocker=true;if(target.title==document.location.href){target.style.position='absolute';target.style.left='-5000px';}
window.setTimeout(FBD.cleanup,0);}else if(target.hasAttribute('style')&&target.getAttribute('style').indexOf('gofhjkjmkpinhpoiabjplobcaignabnl')!=-1){FBD.has_flash_blocker=true;target.style.position='absolute';target.style.left='-5000px';window.setTimeout(FBD.cleanup,0);}},check_embed_type:function(){if((FBD.fake_embed_1.type=='application/x-shockwave-flash')&&(FBD.fake_embed_2.type!='application/x-shockwave-flash')){FBD.has_flash_blocker=true;FBD.cleanup();}},cleanup:function(){try{document.body.removeEventListener('DOMNodeInserted',FBD.dom_node_inserted,false);}catch(e){}
if(FBD.fake_embed_1){FBD.fake_embed_1.parentNode.removeChild(FBD.fake_embed_1);}
FBD.fake_embed_1=null;if(FBD.fake_embed_2){FBD.fake_embed_2.parentNode.removeChild(FBD.fake_embed_2);}
FBD.fake_embed_2=null;if(FBD.fake_embed_watcher!==null){window.clearInterval(FBD.fake_embed_watcher);FBD.fake_embed_watcher=null;}
var overlays=document.getElementsByTagName('div');for(var i=0;i<overlays.length;i++){var o=overlays[i];if((o.hasAttribute('bgactive')&&o.title==document.location.href)||(o.className=='ujs_flashblock_placeholder'&&o.title==='')){o.parentNode.removeChild(o);}}
FBD.callback_func(FBD.has_flash_blocker);},initialize:function(callback_function){if(false){callback_function(false);return;}
if(window.opera){callback_function(false);return;}
FBD.callback_func=callback_function;document.body.addEventListener('DOMNodeInserted',FBD.dom_node_inserted,false);var e=document.createElement('embed');e.style.position='absolute';e.style.left='-5000px';e.width=10;e.height=10;e.src='';e.type='application/x-shockwave-flash';FBD.fake_embed_1=e;document.body.appendChild(e);var e2=document.createElement('embed');e2.style.position='absolute';e2.style.left='-5000px';e2.width=1;e2.height=1;e2.src='';e2.type='application/x-shockwave-flash';FBD.fake_embed_2=e2;document.body.appendChild(e2);FBD.fake_embed_watcher=window.setInterval(FBD.check_embed_type,100);window.setTimeout(FBD.cleanup,1000);}};!function($){"use strict";var _render=function(obj,p,config){var parent=$(p);var ic=0;var count=0;for(var key in obj){if(!obj.hasOwnProperty(key)){continue;}
count+=1;}
if(count===0){parent.slideUp();parent.parent().find('.fold').removeClass('fold');}
for(var key in obj){if(!obj.hasOwnProperty(key)){continue;}
ic+=1;var coma='',lcurl='',rcurl='',lsqr='',rsqr='',quot='"',colon='';if(config.terminators!==false){if(ic<count){coma=',';}
lcurl='{';rcurl='}';lsqr='[';rsqr=']';colon=':';}
if(obj[key]===null){parent.append('<li><span class="key">'+key+':</span><span class="null"> null </span>'+coma+'</li>');}else if(typeof obj[key]==='boolean'){parent.append('<li><span class="key">'+key+':</span><span class="boolean">'+obj[key]+'</span>'+coma+'</li>');}else if(typeof obj[key]==='number'){parent.append('<li><span class="key">'+key+':</span><span class="number">'+obj[key]+'</span>'+coma+'</li>');}else if(typeof obj[key]==='string'){parent.append('<li><span class="key">'+key+':</span><span class="string">'+quot+obj[key]+quot+'</span>'+coma+'</li>');}else if($.isArray(obj[key])){var arval=$('<li><span class="key">'+key+colon+'</span><span class="fold">'+lsqr+'</span><ul class="array"></ul><span>'+rsqr+'</span>'+coma+'</li>');parent.append(arval);arval.find('.unfold').data('card',_render(obj[key],arval.find('.array'),config));}else{var oval=$('<li><span class="key">'+key+colon+'</span><span class="fold">'+lcurl+'</span><ul class="object"></ul><span>'+rcurl+'</span>'+coma+'</li>');parent.append(oval);oval.find('.unfold').data('card',_render(obj[key],oval.find('.object'),config));}}
return ic;};$(document).on("click",'.jsontree .fold',function(e){e.preventDefault();$(this).addClass('folded').parent().find('ul').eq(0).slideUp();});$(document).on('click','.jsontree .fold.folded',function(e){e.preventDefault();$(this).removeClass('folded').parent().find('ul').eq(0).slideDown();});var JsonTree=function(self,config){var j=$.parseJSON(self.data('jsontree'));self.append('<ul class="jsontree"></ul>');_render([j],self.find('.jsontree'),config);if(!config.collapsibleOuter){self.find('.jsontree .fold').first().removeClass('fold');if(!config.terminators){self.find('.jsontree>li>ul').css('margin-left',0);}}};$.fn.jsontree=function(option,config){return this.each(function(){var self=$(this),data=self.data('jsontree');if(!data){if(typeof option=='string'){data=option;self.data('jsontree',option);}else{data={};self.data('jsontree','');}}
var cfg=$.extend({terminators:true,collapsibleOuter:true},config||{});new JsonTree(self,cfg);});};}(window.jQuery);!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.SceneFrame=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";module.exports=calculateErrors;function calculateAxisErrors(data,params){if(!params||!params.visible){return null}function option(name,value){if(name in params){return params[name]}return value}var result=new Array(data.length);var type=option("type","percent");var symmetric=option("symmetric",true);var value=+option("value",10);var minusValue=+option("valueminus",10);var error=option("array",null);var minusError=option("arrayminus",null);var x,h,l,r,i;if(symmetric){minusValue=value;minusError=error}if(type==="data"&&(!error||!minusError)){return null}for(i=0;i<data.length;++i){x=+data[i];switch(type){case"percent":h=Math.abs(x)*value/100;l=Math.abs(x)*minusValue/100;result[i]=[-l,h];break;case"constant":result[i]=[-minusValue,value];break;case"sqrt":r=Math.sqrt(Math.abs(x));result[i]=[-r,r];break;case"data":result[i]=[+minusError[i]-x,+error[i]-x];break}}return result}function dataLength(array){for(var i=0;i<array.length;++i){if(array[i]){return array[i].length}}return 0}function calculateErrors(data){var errors=[calculateAxisErrors(data.x,data.error_x),calculateAxisErrors(data.y,data.error_y),calculateAxisErrors(data.z,data.error_z)],errorBounds,n=dataLength(errors),i,j,k,bound;if(n===0){return null}errorBounds=new Array(n);for(i=0;i<n;++i){bound=[[0,0,0],[0,0,0]];for(j=0;j<3;++j){if(errors[j]){for(k=0;k<2;++k){bound[k][j]=errors[j][i][k]}}}errorBounds[i]=bound}return errorBounds}},{}],2:[function(require,module,exports){"use strict";module.exports=calculateScaleFactor;var project=require("./project");function calculateScaleFactor(camera,resolution,centerPoint,axis,desiredPixelLength){var p=project(camera,centerPoint);return 2*desiredPixelLength*p[3]/resolution[1]}},{"./project":416}],3:[function(require,module,exports){module.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],4:[function(require,module,exports){module.exports=Gl3dAxes;function Gl3dAxes(config){this.config=config;this.axesNames=["xaxis","yaxis","zaxis"]}var proto=Gl3dAxes.prototype;proto.attributes={showspikes:{type:"boolean",dflt:true},spikesides:{type:"boolean",dflt:true},spikethickness:{type:"number",min:0,dflt:2},spikecolor:{type:"color",dflt:"rgb(0,0,0)"},showbackground:{type:"boolean",dflt:false},backgroundcolor:{type:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{type:"boolean",dflt:true},title:{from:"Axes"},titlefont:{from:"Axes"},type:{from:"Axes"},autorange:{from:"Axes"},rangemode:{from:"Axes"},range:{from:"Axes"},autotick:{from:"Axes"},nticks:{from:"Axes"},tick0:{from:"Axes"},dtick:{from:"Axes"},ticks:{from:"Axes"},mirror:{from:"Axes"},ticklen:{from:"Axes"},tickwidth:{from:"Axes"},tickcolor:{from:"Axes"},showticklabels:{from:"Axes"},tickfont:{from:"Axes"},tickangle:{from:"Axes"},showline:{from:"Axes"},linecolor:{from:"Axes"},linewidth:{from:"Axes"},showgrid:{from:"Axes"},gridcolor:{from:"Axes"},gridwidth:{from:"Axes"},zeroline:{from:"Axes"},zerolinecolor:{from:"Axes"},zerolinewidth:{from:"Axes"}};proto.supplyDefaults=function(layoutIn,layoutOut,options){var _this=this;var Plotly=this.config.Plotly;var Axes=Plotly.Axes;var containerIn,containerOut;function coerce(attr,dflt){return Plotly.Lib.coerce(containerIn,containerOut,_this.attributes,attr,dflt)}function coerceAxis(attr,dflt){return Plotly.Lib.coerce(containerIn,containerOut,Plotly.Axes.attributes,attr,dflt)}for(var j=0;j<this.axesNames.length;j++){var axName=this.axesNames[j];containerIn=layoutIn[axName]||{};containerOut={_id:axName[0]+options.scene,_name:axName};layoutOut[axName]=containerOut=Axes.supplyAxisDefaults(containerIn,containerOut,{font:options.font,letter:axName[0],data:options.data,showGrid:true});coerceAxis("gridcolor","rgb(204, 204, 204)");coerceAxis("title",axName[0]);containerOut.setScale=function(){};if(coerce("showspikes")){coerce("spikesides");coerce("spikethickness");coerce("spikecolor")}if(coerce("showbackground")){coerce("backgroundcolor")}coerce("showaxeslabels")}};proto.initAxes=function(td){var Plotly=this.config.Plotly;var fullLayout=td._fullLayout;delete fullLayout.xaxis;delete fullLayout.yaxis;var scenes=Object.keys(fullLayout).filter(function(k){return k.match(/^scene[0-9]*$/)});for(var i=0;i<scenes.length;++i){var scene=scenes[i];var sceneLayout=fullLayout[scene];for(var j=0;j<3;++j){var axisName=this.axesNames[j];var ax=sceneLayout[axisName];ax._td=td}}}},{}],5:[function(require,module,exports){module.exports=Gl3dLayout;function Gl3dLayout(config){this.config=config}var proto=Gl3dLayout.prototype;proto.sceneLayoutAttributes={bgcolor:{type:"color",dflt:"#fff"},cameraposition:{type:"data_array"},domain:{x:[{type:"number",min:0,max:1,dflt:0},{type:"number",min:0,max:1,dflt:1}],y:[{type:"number",min:0,max:1,dflt:0},{type:"number",min:0,max:1,dflt:1}]}};proto.supplyLayoutDefaults=function(layoutIn,layoutOut,fullData){if(!layoutOut._hasGL3D)return;var _this=this;var scenes=[];var Plotly=this.config.Plotly;var $=this.config.jQuery;for(var i=0;i<fullData.length;++i){var d=fullData[i];if(Plotly.Plots.isGL3D(d.type)){if(scenes.indexOf(d.scene)===-1){scenes.push(d.scene)}}}delete layoutOut.xaxis;delete layoutOut.yaxis;scenes.forEach(function(scene){var sceneLayoutIn=layoutIn[scene]||{};var sceneLayoutOut={};function coerceScene(attr,dflt){return Plotly.Lib.coerce(sceneLayoutIn,sceneLayoutOut,_this.sceneLayoutAttributes,attr,dflt)}coerceScene("bgcolor");coerceScene("cameraposition");coerceScene("domain.x[0]");coerceScene("domain.x[1]");coerceScene("domain.y[0]");coerceScene("domain.y[1]");Plotly.Gl3dAxes.supplyDefaults(sceneLayoutIn,sceneLayoutOut,{font:layoutOut.font,scene:scene,data:fullData});layoutOut[scene]=sceneLayoutOut})}},{}],6:[function(require,module,exports){"use strict";var createLinePlot=require("gl-line-plot"),createScatterPlot=require("gl-scatter-plot"),createErrorBars=require("gl-error-bars"),createMesh=require("gl-simplicial-complex"),triangulate=require("delaunay-triangulate"),DASH_PATTERNS=require("./dashes.json"),proto;module.exports=createLineWithMarkers;function LineWithMarkers(gl,linePlot,scatterPlot,errorBars,textMarkers,delaunayMesh,mode){this.gl=gl;this.linePlot=linePlot;this.scatterPlot=scatterPlot;this.errorBars=errorBars;this.textMarkers=textMarkers;this.delaunayMesh=delaunayMesh;this.mode=mode;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.pickId0=0;this.pickId1=1;this.pickId2=2;this.pickId3=3;this.lineTransparent=false;this.scatterTransparent=false;this.errorTransparent=false;this.textTransparent=false;this.fillTransparent=false;this.meshTransparent=false;this.dataPoints=[];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]]}proto=LineWithMarkers.prototype;proto.supportsTransparency=true;proto.draw=function(cameraParams,transparent){if(this.linePlot&&this.lineTransparent===transparent){this.linePlot.clipBounds=this.clipBounds;this.linePlot.draw(cameraParams)}if(this.scatterPlot&&this.scatterTransparent===transparent){this.scatterPlot.clipBounds=this.clipBounds;this.scatterPlot.axesBounds=this.axesBounds;this.scatterPlot.draw(cameraParams)}if(this.textMarkers&&this.textTransparent===transparent){this.textMarkers.clipBounds=this.clipBounds;this.textMarkers.draw(cameraParams)}if(this.errorBars&&this.errorTransparent===transparent){this.errorBars.clipBounds=this.clipBounds;this.errorBars.draw(cameraParams)}if(this.delaunayMesh&&this.meshTransparent===transparent){this.delaunayMesh.clipBounds=this.clipBounds;this.delaunayMesh.draw(cameraParams)}};proto.drawPick=function(cameraParams){if(this.linePlot){this.linePlot.clipBounds=this.clipBounds;this.linePlot.drawPick(cameraParams)}if(this.scatterPlot){this.scatterPlot.clipBounds=this.clipBounds;this.scatterPlot.axesBounds=this.axesBounds;this.scatterPlot.drawPick(cameraParams)}if(this.textMarkers){this.textMarkers.clipBounds=this.clipBounds;this.textMarkers.drawPick(cameraParams)}if(this.delaunayMesh){this.delaunayMesh.clipBounds=this.clipBounds;this.delaunayMesh.drawPick(cameraParams)}};proto.pick=function(pickResult){var result=null;if(this.linePlot){result=this.linePlot.pick(pickResult)}if(this.scatterPlot){result=result||this.scatterPlot.pick(pickResult)}if(this.textMarkers){result=result||this.textMarkers.pick(pickResult)}if(this.delaunayMesh){result=result||this.delaunayMesh.pick(pickResult)}return result};function isTransparent(color){if(Array.isArray(color[0])){for(var i=0;i<color.length;++i){var c=color[i];if(c.length===4&&c[3]<1){return true}}return false}if(color.length===3){return false}return color[3]<1}function constructDelaunay(points,color,axis){var u=(axis+1)%3;var v=(axis+2)%3;var filteredPoints=[];var filteredIds=[];for(var i=0;i<points.length;++i){var p=points[i];if(isNaN(p[u])||!isFinite(p[u])||isNaN(p[v])||!isFinite(p[v])){continue}filteredPoints.push([p[u],p[v]]);filteredIds.push(i)}var cells=triangulate(filteredPoints);for(var i=0;i<cells.length;++i){var c=cells[i];for(var j=0;j<c.length;++j){c[j]=filteredIds[c[j]]}}return{positions:points,cells:cells,meshColor:color}}proto.update=function(options){var gl=this.gl,lineOptions,scatterOptions,errorOptions,textOptions,dashPattern=DASH_PATTERNS["solid"];options=options||{};if("mode"in options){this.mode=options.mode}if("clipBounds"in options){this.clipBounds=options.clipBounds}if("lineDashes"in options){if(options.lineDashes in DASH_PATTERNS){dashPattern=DASH_PATTERNS[options.lineDashes]}}if("pickId0"in options){this.pickId0=options.pickId0}if("pickId1"in options){this.pickId1=options.pickId1}if("pickId2"in options){this.pickId2=options.pickId2}if("pickId3"in options){this.pickId3=options.pickId3}this.dataPoints=options.position;lineOptions={position:options.position,color:options.lineColor,pickId:this.pickId0,lineWidth:options.lineWidth||1,dashes:dashPattern[0],dashScale:dashPattern[1]};if(this.mode.indexOf("lines")!==-1){this.lineTransparent=isTransparent(options.lineColor);if(this.linePlot)this.linePlot.update(lineOptions);else this.linePlot=createLinePlot(gl,lineOptions)}else if(this.linePlot){this.linePlot.dispose();this.linePlot=null}scatterOptions={position:options.position,color:options.scatterColor,size:options.scatterSize,glyph:options.scatterMarker,orthographic:true,pickId:this.pickId1,lineWidth:options.scatterLineWidth,lineColor:options.scatterLineColor,project:options.project,projectScale:options.projectScale,projectOpacity:options.projectOpacity};if(this.mode.indexOf("markers")!==-1){this.scatterTransparent=isTransparent(options.scatterColor)||isTransparent(options.scatterLineColor);if(this.scatterPlot)this.scatterPlot.update(scatterOptions);else this.scatterPlot=createScatterPlot(gl,scatterOptions)}else if(this.scatterPlot){this.scatterPlot.dispose();this.scatterPlot=null}textOptions={position:options.position,glyph:options.text,color:options.textColor,size:options.textSize,angle:options.textAngle,alignment:options.textOffset,font:options.textFont,orthographic:true,pickId:this.pickId2,lineWidth:0};if(this.textMarkers){this.textTransparent=isTransparent(options.textColor);if(this.mode.indexOf("text")>=0){this.textMarkers.update(textOptions)}else{this.textMarkers.dispose();this.textMarkers=null}}else if(this.mode.indexOf("text")>=0){this.textTransparent=isTransparent(options.textColor);this.textMarkers=createScatterPlot(gl,textOptions)}errorOptions={position:options.position,color:options.errorColor,error:options.errorBounds,lineWidth:options.errorLineWidth,capSize:options.errorCapSize};if(this.errorBars){this.errorTransparent=isTransparent(options.errorColor);if(options.errorBounds){this.errorBars.update(errorOptions)}else{this.errorBars.dispose();this.errorBars=null}}else if(options.errorBounds){this.errorTransparent=isTransparent(options.errorColor);this.errorBars=createErrorBars(gl,errorOptions)}if(options.delaunayAxis>=0){var delaunayOptions=constructDelaunay(options.position,options.delaunayColor,options.delaunayAxis);delaunayOptions.pickId=this.pickId3;this.meshTransparent=isTransparent(options.delaunayColor);if(this.delaunayMesh){this.delaunayMesh.update(delaunayOptions)}else{this.delaunayMesh=createMesh(gl,delaunayOptions)}}else if(this.delaunayMesh){this.delaunayMesh.dispose();this.delaunayMesh=null}var bounds=this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];function mergeBounds(object){if(object){var b=object.bounds;for(var i=0;i<3;++i){bounds[0][i]=Math.min(bounds[0][i],b[0][i]);bounds[1][i]=Math.max(bounds[1][i],b[1][i])}}}mergeBounds(this.scatterPlot);mergeBounds(this.errorBars);mergeBounds(this.linePlot);mergeBounds(this.textMarkers);mergeBounds(this.delaunayMesh)};proto.dispose=function(){if(this.linePlot){this.linePlot.dispose()}if(this.scatterPlot){this.scatterPlot.dispose()}if(this.errorBars){this.errorBars.dispose()}if(this.textMarkers){this.textMarkers.dispose()}if(this.delaunayMesh){this.delaunayMesh.dispose()}};function createLineWithMarkers(gl,options){var plot=new LineWithMarkers(gl,null,null,null,null,"");plot.update(options);return plot}},{"./dashes.json":3,"delaunay-triangulate":28,"gl-error-bars":132,"gl-line-plot":146,"gl-scatter-plot":272,"gl-simplicial-complex":292}],7:[function(require,module,exports){"use strict";var arraytools=function(){var that={};var RGB_REGEX=/^rgba?\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*(,.*)?\)$/;var RGB_GROUP_REGEX=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,?\s*(.*)?\)$/;function isPlainObject(v){return!Array.isArray(v)&&v!==null&&typeof v==="object"}function linspace(start,end,num){var inc=(end-start)/(num-1);var a=[];for(var ii=0;ii<num;ii++)a.push(start+ii*inc);return a}function zip(){var arrays=[].slice.call(arguments);var lengths=arrays.map(function(a){return a.length});var len=Math.min.apply(null,lengths);var zipped=[];for(var i=0;i<len;i++){zipped[i]=[];for(var j=0;j<arrays.length;++j){zipped[i][j]=arrays[j][i]}}return zipped}function zip3(a,b,c){var len=Math.min.apply(null,[a.length,b.length,c.length]);var result=[];for(var n=0;n<len;n++){result.push([a[n],b[n],c[n]])}return result}function sum(A){var acc=0;accumulate(A,acc);function accumulate(x){for(var i=0;i<x.length;i++){if(Array.isArray(x[i]))accumulate(x[i],acc);else acc+=x[i]}}return acc}function copy2D(arr){var carr=[];for(var i=0;i<arr.length;++i){carr[i]=[];for(var j=0;j<arr[i].length;++j){carr[i][j]=arr[i][j]}}return carr}function copy1D(arr){var carr=[];for(var i=0;i<arr.length;++i){carr[i]=arr[i]}return carr}function isEqual(arr1,arr2){if(arr1.length!==arr2.length)return false;for(var i=arr1.length;i--;){if(arr1[i]!==arr2[i])return false}return true}function str2RgbArray(str,twoFiftySix){var rgb,match;if(typeof str!=="string")return str;rgb=[];if(str[0]==="#"){str=str.substr(1);if(str.length===3)str+=str;match=parseInt(str,16);rgb[0]=match>>16&255;rgb[1]=match>>8&255;rgb[2]=match&255}else if(RGB_REGEX.test(str)){match=str.match(RGB_GROUP_REGEX);rgb[0]=parseInt(match[1]);rgb[1]=parseInt(match[2]);rgb[2]=parseInt(match[3])}if(!twoFiftySix){for(var j=0;j<3;++j)rgb[j]=rgb[j]/255}return rgb}function str2RgbaArray(str,twoFiftySix){var rgb,match;if(typeof str!=="string")return str;rgb=[];if(str[0]==="#"){str=str.substr(1);if(str.length===3)str+=str;match=parseInt(str,16);rgb[0]=match>>16&255;rgb[1]=match>>8&255;rgb[2]=match&255}else if(RGB_REGEX.test(str)){match=str.match(RGB_GROUP_REGEX);rgb[0]=parseInt(match[1]);rgb[1]=parseInt(match[2]);rgb[2]=parseInt(match[3]);if(match[4])rgb[3]=parseFloat(match[4]);else rgb[3]=1}if(!twoFiftySix){for(var j=0;j<3;++j)rgb[j]=rgb[j]/255}return rgb}that.isPlainObject=isPlainObject;that.linspace=linspace;that.zip3=zip3;that.sum=sum;that.zip=zip;that.isEqual=isEqual;that.copy2D=copy2D;that.copy1D=copy1D;that.str2RgbArray=str2RgbArray;that.str2RgbaArray=str2RgbaArray;return that};module.exports=arraytools()},{}],8:[function(require,module,exports){var base64=require("base64-js");var ieee754=require("ieee754");var isArray=require("is-array");exports.Buffer=Buffer;exports.SlowBuffer=Buffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;var kMaxLength=1073741823;Buffer.TYPED_ARRAY_SUPPORT=function(){try{var buf=new ArrayBuffer(0);var arr=new Uint8Array(buf);arr.foo=function(){return 42};return 42===arr.foo()&&typeof arr.subarray==="function"&&new Uint8Array(1).subarray(1,1).byteLength===0}catch(e){return false}}();function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var type=typeof subject;var length;if(type==="number")length=subject>0?subject>>>0:0;else if(type==="string"){if(encoding==="base64")subject=base64clean(subject);length=Buffer.byteLength(subject,encoding)}else if(type==="object"&&subject!==null){if(subject.type==="Buffer"&&isArray(subject.data))subject=subject.data;length=+subject.length>0?Math.floor(+subject.length):0}else throw new TypeError("must start with number, buffer, array or string");if(this.length>kMaxLength)throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+kMaxLength.toString(16)+" bytes");var buf;if(Buffer.TYPED_ARRAY_SUPPORT){buf=Buffer._augment(new Uint8Array(length))}else{buf=this;buf.length=length;buf._isBuffer=true}var i;if(Buffer.TYPED_ARRAY_SUPPORT&&typeof subject.byteLength==="number"){buf._set(subject)}else if(isArrayish(subject)){if(Buffer.isBuffer(subject)){for(i=0;i<length;i++)buf[i]=subject.readUInt8(i)}else{for(i=0;i<length;i++)buf[i]=(subject[i]%256+256)%256}}else if(type==="string"){buf.write(subject,0,encoding)}else if(type==="number"&&!Buffer.TYPED_ARRAY_SUPPORT&&!noZero){for(i=0;i<length;i++){buf[i]=0}}return buf}Buffer.isBuffer=function(b){return!!(b!=null&&b._isBuffer)};Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len&&a[i]===b[i];i++){}if(i!==len){x=a[i];y=b[i]}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function(list,totalLength){if(!isArray(list))throw new TypeError("Usage: Buffer.concat(list[, length])");if(list.length===0){return new Buffer(0)}else if(list.length===1){return list[0]}var i;if(totalLength===undefined){totalLength=0;for(i=0;i<list.length;i++){totalLength+=list[i].length}}var buf=new Buffer(totalLength);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};Buffer.byteLength=function(str,encoding){var ret;str=str+"";switch(encoding||"utf8"){case"ascii":case"binary":case"raw":ret=str.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=str.length*2;break;case"hex":ret=str.length>>>1;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"base64":ret=base64ToBytes(str).length;break;default:ret=str.length}return ret};Buffer.prototype.length=undefined;Buffer.prototype.parent=undefined;Buffer.prototype.toString=function(encoding,start,end){var loweredCase=false;start=start>>>0;end=end===undefined||end===Infinity?this.length:end>>>0;if(!encoding)encoding="utf8";if(start<0)start=0;if(end>this.length)end=this.length;if(end<=start)return"";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}};Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function(){var str="";var max=exports.INSPECT_MAX_BYTES;if(this.length>0){str=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str+=" ... "}return"<Buffer "+str+">"};Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return Buffer.compare(this,b)};Buffer.prototype.get=function(offset){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(offset)};Buffer.prototype.set=function(v,offset){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(v,offset)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");if(length>strLen/2){length=strLen/2}for(var i=0;i<length;i++){var byte=parseInt(string.substr(i*2,2),16);if(isNaN(byte))throw new Error("Invalid hex string");buf[offset+i]=byte}return i}function utf8Write(buf,string,offset,length){var charsWritten=blitBuffer(utf8ToBytes(string),buf,offset,length);return charsWritten}function asciiWrite(buf,string,offset,length){var charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){var charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function utf16leWrite(buf,string,offset,length){var charsWritten=blitBuffer(utf16leToBytes(string),buf,offset,length);return charsWritten}Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset)){if(!isFinite(length)){encoding=length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length;length=swap}offset=Number(offset)||0;var remaining=this.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=utf8Write(this,string,offset,length);break;case"ascii":ret=asciiWrite(this,string,offset,length);break;case"binary":ret=binaryWrite(this,string,offset,length);break;case"base64":ret=base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=utf16leWrite(this,string,offset,length);break;default:throw new TypeError("Unknown encoding: "+encoding)}return ret};Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){var res="";var tmp="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){if(buf[i]<=127){res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]);tmp=""}else{tmp+="%"+buf[i].toString(16)}}return res+decodeUtf8Char(tmp)}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++){ret+=String.fromCharCode(buf[i])}return ret}function binarySlice(buf,start,end){return asciiSlice(buf,start,end)}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;if(Buffer.TYPED_ARRAY_SUPPORT){return Buffer._augment(this.subarray(start,end))}else{var sliceLen=end-start;var newBuf=new Buffer(sliceLen,undefined,true);for(var i=0;i<sliceLen;i++){newBuf[i]=this[i+start]}return newBuf}};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUInt8=function(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readInt8=function(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||value<min)throw new TypeError("value is out of bounds");if(offset+ext>buf.length)throw new TypeError("index out of range")}Buffer.prototype.writeUInt8=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);this[offset]=value;return offset+1};function objectWriteUInt16(buf,value,offset,littleEndian){if(value<0)value=65535+value+1;for(var i=0,j=Math.min(buf.length-offset,2);i<j;i++){buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}}Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value;this[offset+1]=value>>>8}else objectWriteUInt16(this,value,offset,true);return offset+2};Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value}else objectWriteUInt16(this,value,offset,false);return offset+2};function objectWriteUInt32(buf,value,offset,littleEndian){if(value<0)value=4294967295+value+1;for(var i=0,j=Math.min(buf.length-offset,4);i<j;i++){buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}}Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value}else objectWriteUInt32(this,value,offset,true);return offset+4};Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value}else objectWriteUInt32(this,value,offset,false);return offset+4};Buffer.prototype.writeInt8=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);if(value<0)value=255+value+1;this[offset]=value;return offset+1};Buffer.prototype.writeInt16LE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value;this[offset+1]=value>>>8}else objectWriteUInt16(this,value,offset,true);return offset+2};Buffer.prototype.writeInt16BE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value}else objectWriteUInt16(this,value,offset,false);return offset+2};Buffer.prototype.writeInt32LE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24}else objectWriteUInt32(this,value,offset,true);return offset+4};Buffer.prototype.writeInt32BE=function(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value}else objectWriteUInt32(this,value,offset,false);return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||value<min)throw new TypeError("value is out of bounds");if(offset+ext>buf.length)throw new TypeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert)checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38);ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert)checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308);ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function(target,target_start,start,end){var source=this;if(!start)start=0;if(!end&&end!==0)end=this.length;if(!target_start)target_start=0;if(end===start)return;if(target.length===0||source.length===0)return;if(end<start)throw new TypeError("sourceEnd < sourceStart");if(target_start<0||target_start>=target.length)throw new TypeError("targetStart out of bounds");if(start<0||start>=source.length)throw new TypeError("sourceStart out of bounds");if(end<0||end>source.length)throw new TypeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-target_start<end-start)end=target.length-target_start+start;var len=end-start;if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT){for(var i=0;i<len;i++){target[i+target_start]=this[i+start]}}else{target._set(this.subarray(start,start+len),target_start)}};Buffer.prototype.fill=function(value,start,end){if(!value)value=0;if(!start)start=0;if(!end)end=this.length;if(end<start)throw new TypeError("end < start");if(end===start)return;if(this.length===0)return;if(start<0||start>=this.length)throw new TypeError("start out of bounds");if(end<0||end>this.length)throw new TypeError("end out of bounds");var i;if(typeof value==="number"){for(i=start;i<end;i++){this[i]=value}}else{var bytes=utf8ToBytes(value.toString());var len=bytes.length;for(i=start;i<end;i++){this[i]=bytes[i%len]}}return this};Buffer.prototype.toArrayBuffer=function(){if(typeof Uint8Array!=="undefined"){if(Buffer.TYPED_ARRAY_SUPPORT){return new Buffer(this).buffer}else{var buf=new Uint8Array(this.length);for(var i=0,len=buf.length;i<len;i+=1){buf[i]=this[i]}return buf.buffer}}else{throw new TypeError("Buffer.toArrayBuffer not supported in this browser")}};var BP=Buffer.prototype;Buffer._augment=function(arr){arr.constructor=Buffer;arr._isBuffer=true;arr._get=arr.get;arr._set=arr.set;arr.get=BP.get;arr.set=BP.set;arr.write=BP.write;arr.toString=BP.toString;arr.toLocaleString=BP.toString;arr.toJSON=BP.toJSON;arr.equals=BP.equals;arr.compare=BP.compare;arr.copy=BP.copy;arr.slice=BP.slice;arr.readUInt8=BP.readUInt8;arr.readUInt16LE=BP.readUInt16LE;arr.readUInt16BE=BP.readUInt16BE;arr.readUInt32LE=BP.readUInt32LE;arr.readUInt32BE=BP.readUInt32BE;arr.readInt8=BP.readInt8;arr.readInt16LE=BP.readInt16LE;arr.readInt16BE=BP.readInt16BE;arr.readInt32LE=BP.readInt32LE;arr.readInt32BE=BP.readInt32BE;arr.readFloatLE=BP.readFloatLE;arr.readFloatBE=BP.readFloatBE;arr.readDoubleLE=BP.readDoubleLE;arr.readDoubleBE=BP.readDoubleBE;arr.writeUInt8=BP.writeUInt8;arr.writeUInt16LE=BP.writeUInt16LE;arr.writeUInt16BE=BP.writeUInt16BE;arr.writeUInt32LE=BP.writeUInt32LE;arr.writeUInt32BE=BP.writeUInt32BE;arr.writeInt8=BP.writeInt8;arr.writeInt16LE=BP.writeInt16LE;arr.writeInt16BE=BP.writeInt16BE;arr.writeInt32LE=BP.writeInt32LE;arr.writeInt32BE=BP.writeInt32BE;arr.writeFloatLE=BP.writeFloatLE;arr.writeFloatBE=BP.writeFloatBE;arr.writeDoubleLE=BP.writeDoubleLE;arr.writeDoubleBE=BP.writeDoubleBE;arr.fill=BP.fill;arr.inspect=BP.inspect;arr.toArrayBuffer=BP.toArrayBuffer;return arr};var INVALID_BASE64_RE=/[^+\/0-9A-z]/g;function base64clean(str){str=stringtrim(str).replace(INVALID_BASE64_RE,"");while(str.length%4!==0){str=str+"="}return str}function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&typeof subject==="object"&&typeof subject.length==="number"}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){var b=str.charCodeAt(i);if(b<=127){byteArray.push(b)}else{var start=i;if(b>=55296&&b<=57343)i++;var h=encodeURIComponent(str.slice(start,i+1)).substr(1).split("%");for(var j=0;j<h.length;j++){byteArray.push(parseInt(h[j],16))}}}return byteArray}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(str)}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}},{"base64-js":9,ieee754:10,"is-array":11}],9:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(exports){"use strict";var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);function decode(elt){var code=elt.charCodeAt(0);if(code===PLUS)return 62;if(code===SLASH)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0;arr=new Arr(b64.length*3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i,extraBytes=uint8.length%3,output="",temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break}return output}exports.toByteArray=b64ToByteArray;exports.fromByteArray=uint8ToBase64})(typeof exports==="undefined"?this.base64js={}:exports)},{}],10:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8);if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=nBytes*8-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],11:[function(require,module,exports){var isArray=Array.isArray;var str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&"[object Array]"==str.call(val)}},{}],12:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type==="error"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}throw TypeError('Uncaught, unspecified "error" event.')}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}}else if(isObject(handler)){len=arguments.length;args=new Array(len-1);for(i=1;i<len;i++)args[i-1]=arguments[i];listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){var m;if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[type].length);if(typeof console.trace==="function"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError("listener must be a function");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit("removeListener",type,listener)}else if(isObject(list)){for(i=length;i-->0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit("removeListener",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else{while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.listenerCount=function(emitter,type){var ret;if(!emitter._events||!emitter._events[type])ret=0;else if(isFunction(emitter._events[type]))ret=1;else ret=emitter._events[type].length;return ret};function isFunction(arg){return typeof arg==="function"}function isNumber(arg){return typeof arg==="number"}function isObject(arg){return typeof arg==="object"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],13:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],14:[function(require,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canMutationObserver=typeof window!=="undefined"&&window.MutationObserver;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}var queue=[];if(canMutationObserver){var hiddenDiv=document.createElement("div");var observer=new MutationObserver(function(){var queueList=queue.slice();queue.length=0;queueList.forEach(function(fn){fn()})});observer.observe(hiddenDiv,{attributes:true});return function nextTick(fn){if(!queue.length){hiddenDiv.setAttribute("yes","no")}queue.push(fn)}}if(canPost){window.addEventListener("message",function(ev){var source=ev.source;if((source===window||source===null)&&ev.data==="process-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],15:[function(require,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},{}],16:[function(require,module,exports){(function(process,global){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}});for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(isUndefined(global.process)){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}if(process.noDeprecation===true){return fn}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set]){if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach(function(val,idx){hash[val]=true});return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)})}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach(function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}});return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2)}else{str="\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce(function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=require("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":15,_process:14,inherits:13}],17:[function(require,module,exports){"use strict";module.exports=incrementalConvexHull;var orient=require("robust-orientation");var compareCell=require("simplicial-complex").compareCells;function compareInt(a,b){return a-b}function Simplex(vertices,adjacent,boundary){this.vertices=vertices;this.adjacent=adjacent;this.boundary=boundary;this.lastVisited=-1}Simplex.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1];this.vertices[1]=t;var u=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=u};function GlueFacet(vertices,cell,index){this.vertices=vertices;this.cell=cell;this.index=index}function compareGlue(a,b){return compareCell(a.vertices,b.vertices)}function bakeOrient(d){var code=["function orient(){var tuple=this.tuple;return test("];for(var i=0;i<=d;++i){if(i>0){code.push(",")}code.push("tuple[",i,"]")}code.push(")}return orient");var proc=new Function("test",code.join(""));var test=orient[d+1];if(!test){test=orient}return proc(test)}var BAKED=[];function Triangulation(dimension,vertices,simplices){this.dimension=dimension;this.vertices=vertices;this.simplices=simplices;this.interior=simplices.filter(function(c){return!c.boundary});this.tuple=new Array(dimension+1);for(var i=0;i<=dimension;++i){this.tuple[i]=this.vertices[i]}var o=BAKED[dimension];if(!o){o=BAKED[dimension]=bakeOrient(dimension)}this.orient=o}var proto=Triangulation.prototype;proto.handleBoundaryDegeneracy=function(cell,point){var d=this.dimension;var n=this.vertices.length-1;var tuple=this.tuple;var verts=this.vertices;var toVisit=[cell];cell.lastVisited=-n;while(toVisit.length>0){cell=toVisit.pop();var cellVerts=cell.vertices;var cellAdj=cell.adjacent;for(var i=0;i<=d;++i){var neighbor=cellAdj[i];if(!neighbor.boundary||neighbor.lastVisited<=-n){continue}var nv=neighbor.vertices;for(var j=0;j<=d;++j){var vv=nv[j];if(vv<0){tuple[j]=point}else{tuple[j]=verts[vv]}}var o=this.orient();if(o>0){return neighbor}neighbor.lastVisited=-n;if(o===0){toVisit.push(neighbor)}}}return null};proto.walk=function(point,random){var n=this.vertices.length-1;var d=this.dimension;var verts=this.vertices;var tuple=this.tuple;var initIndex=random?this.interior.length*Math.random()|0:this.interior.length-1;var cell=this.interior[initIndex];outerLoop:while(!cell.boundary){var cellVerts=cell.vertices;var cellAdj=cell.adjacent;for(var i=0;i<=d;++i){tuple[i]=verts[cellVerts[i]]}cell.lastVisited=n;for(var i=0;i<=d;++i){var neighbor=cellAdj[i];if(neighbor.lastVisited>=n){continue}var prev=tuple[i];tuple[i]=point;var o=this.orient();tuple[i]=prev;if(o<0){cell=neighbor;continue outerLoop}else{if(!neighbor.boundary){neighbor.lastVisited=n}else{neighbor.lastVisited=-n}}}return}return cell};proto.addPeaks=function(point,cell){var n=this.vertices.length-1;var d=this.dimension;var verts=this.vertices;var tuple=this.tuple;var interior=this.interior;var simplices=this.simplices;var tovisit=[cell];cell.lastVisited=n;cell.vertices[cell.vertices.indexOf(-1)]=n;cell.boundary=false;interior.push(cell);var glueFacets=[];while(tovisit.length>0){var cell=tovisit.pop();var cellVerts=cell.vertices;var cellAdj=cell.adjacent;var indexOfN=cellVerts.indexOf(n);if(indexOfN<0){continue}for(var i=0;i<=d;++i){if(i===indexOfN){continue}var neighbor=cellAdj[i];if(!neighbor.boundary||neighbor.lastVisited>=n){continue}var nv=neighbor.vertices;if(neighbor.lastVisited!==-n){var indexOfNeg1=0;for(var j=0;j<=d;++j){if(nv[j]<0){indexOfNeg1=j;tuple[j]=point}else{tuple[j]=verts[nv[j]]}}var o=this.orient();if(o>0){nv[indexOfNeg1]=n;neighbor.boundary=false;interior.push(neighbor);tovisit.push(neighbor);neighbor.lastVisited=n;continue}else{neighbor.lastVisited=-n}}var na=neighbor.adjacent;var vverts=cellVerts.slice();var vadj=cellAdj.slice();var ncell=new Simplex(vverts,vadj,true);simplices.push(ncell);var opposite=na.indexOf(cell);if(opposite<0){continue}na[opposite]=ncell;vadj[indexOfN]=neighbor;vverts[i]=-1;vadj[i]=cell;cellAdj[i]=ncell;ncell.flip();for(var j=0;j<=d;++j){var uu=vverts[j];if(uu<0||uu===n){continue}var nface=new Array(d-1);var nptr=0;for(var k=0;k<=d;++k){var vv=vverts[k];if(vv<0||k===j){continue}nface[nptr++]=vv}glueFacets.push(new GlueFacet(nface,ncell,j))}}}glueFacets.sort(compareGlue);for(var i=0;i+1<glueFacets.length;i+=2){var a=glueFacets[i];var b=glueFacets[i+1];var ai=a.index;var bi=b.index;if(ai<0||bi<0){continue}a.cell.adjacent[a.index]=b.cell;b.cell.adjacent[b.index]=a.cell}};proto.insert=function(point,random){var verts=this.vertices;verts.push(point);var cell=this.walk(point,random);if(!cell){return}var d=this.dimension;var tuple=this.tuple;for(var i=0;i<=d;++i){var vv=cell.vertices[i];if(vv<0){tuple[i]=point}else{tuple[i]=verts[vv]}}var o=this.orient(tuple);if(o<0){return}else if(o===0){cell=this.handleBoundaryDegeneracy(cell,point);if(!cell){return}}this.addPeaks(point,cell)};proto.boundary=function(){var d=this.dimension;var boundary=[];var cells=this.simplices;var nc=cells.length;for(var i=0;i<nc;++i){var c=cells[i];if(c.boundary){var bcell=new Array(d);var cv=c.vertices;var ptr=0;var parity=0;for(var j=0;j<=d;++j){if(cv[j]>=0){bcell[ptr++]=cv[j]}else{parity=j&1}}if(parity===(d&1)){var t=bcell[0];bcell[0]=bcell[1];bcell[1]=t}boundary.push(bcell)}}return boundary};function incrementalConvexHull(points,randomSearch){var n=points.length;if(n===0){throw new Error("Must have at least d+1 points")}var d=points[0].length;if(n<=d){throw new Error("Must input at least d+1 points")}var initialSimplex=points.slice(0,d+1);var o=orient.apply(void 0,initialSimplex);if(o===0){throw new Error("Input not in general position")}var initialCoords=new Array(d+1);for(var i=0;i<=d;++i){initialCoords[i]=i}if(o<0){initialCoords[0]=1;initialCoords[1]=0}var initialCell=new Simplex(initialCoords,new Array(d+1),false);var boundary=initialCell.adjacent;var list=new Array(d+2);for(var i=0;i<=d;++i){var verts=initialCoords.slice();for(var j=0;j<=d;++j){if(j===i){verts[j]=-1}}var t=verts[0];verts[0]=verts[1];verts[1]=t;var cell=new Simplex(verts,new Array(d+1),true);boundary[i]=cell;list[i]=cell}list[d+1]=initialCell;for(var i=0;i<=d;++i){var verts=boundary[i].vertices;var adj=boundary[i].adjacent;for(var j=0;j<=d;++j){var v=verts[j];if(v<0){adj[j]=initialCell;continue}for(var k=0;k<=d;++k){if(boundary[k].vertices.indexOf(v)<0){adj[j]=boundary[k]}}}}var triangles=new Triangulation(d,initialSimplex,list);var useRandom=!!randomSearch;for(var i=d+1;i<n;++i){triangles.insert(points[i],useRandom)}return triangles.boundary()}},{"robust-orientation":23,"simplicial-complex":26}],18:[function(require,module,exports){"use strict";module.exports=fastTwoSum;function fastTwoSum(a,b,result){var x=a+b;var bv=x-a;var av=x-bv;var br=b-bv;var ar=a-av;if(result){result[0]=ar+br;result[1]=x;return result}return[ar+br,x]}},{}],19:[function(require,module,exports){"use strict";var twoProduct=require("two-product");var twoSum=require("two-sum");module.exports=scaleLinearExpansion;function scaleLinearExpansion(e,scale){var n=e.length;if(n===1){var ts=twoProduct(e[0],scale);if(ts[0]){return ts}return[ts[1]]}var g=new Array(2*n);var q=[.1,.1];var t=[.1,.1];var count=0;twoProduct(e[0],scale,q);if(q[0]){g[count++]=q[0]}for(var i=1;i<n;++i){twoProduct(e[i],scale,t);var pq=q[1];twoSum(pq,t[0],q);if(q[0]){g[count++]=q[0]}var a=t[1];var b=q[1];var x=a+b;var bv=x-a;var y=b-bv;q[1]=x;if(y){g[count++]=y}}if(q[1]){g[count++]=q[1]}if(count===0){g[count++]=0}g.length=count;return g}},{"two-product":22,"two-sum":18}],20:[function(require,module,exports){"use strict";module.exports=robustSubtract;function scalarScalar(a,b){var x=a+b;var bv=x-a;var av=x-bv;var br=b-bv;var ar=a-av;var y=ar+br;if(y){return[y,x]}return[x]}function robustSubtract(e,f){var ne=e.length|0;var nf=f.length|0;if(ne===1&&nf===1){return scalarScalar(e[0],-f[0])}var n=ne+nf;var g=new Array(n);var count=0;var eptr=0;var fptr=0;var abs=Math.abs;var ei=e[eptr];var ea=abs(ei);var fi=-f[fptr];var fa=abs(fi);var a,b;if(ea<fa){b=ei;eptr+=1;if(eptr<ne){ei=e[eptr];ea=abs(ei)}}else{b=fi;fptr+=1;if(fptr<nf){fi=-f[fptr];fa=abs(fi)}}if(eptr<ne&&ea<fa||fptr>=nf){a=ei;eptr+=1;if(eptr<ne){ei=e[eptr];ea=abs(ei)}}else{a=fi;fptr+=1;if(fptr<nf){fi=-f[fptr];fa=abs(fi)}}var x=a+b;var bv=x-a;var y=b-bv;var q0=y;var q1=x;var _x,_bv,_av,_br,_ar;while(eptr<ne&&fptr<nf){if(ea<fa){a=ei;eptr+=1;if(eptr<ne){ei=e[eptr];ea=abs(ei)}}else{a=fi;fptr+=1;if(fptr<nf){fi=-f[fptr];fa=abs(fi)}}b=q0;x=a+b;bv=x-a;y=b-bv;if(y){g[count++]=y}_x=q1+x;_bv=_x-q1;_av=_x-_bv;_br=x-_bv;_ar=q1-_av;q0=_ar+_br;q1=_x}while(eptr<ne){a=ei;b=q0;x=a+b;bv=x-a;y=b-bv;if(y){g[count++]=y}_x=q1+x;_bv=_x-q1;_av=_x-_bv;_br=x-_bv;_ar=q1-_av;q0=_ar+_br;q1=_x;eptr+=1;if(eptr<ne){ei=e[eptr]}}while(fptr<nf){a=fi;b=q0;x=a+b;bv=x-a;y=b-bv;if(y){g[count++]=y}_x=q1+x;_bv=_x-q1;_av=_x-_bv;_br=x-_bv;_ar=q1-_av;q0=_ar+_br;q1=_x;fptr+=1;if(fptr<nf){fi=-f[fptr]}}if(q0){g[count++]=q0}if(q1){g[count++]=q1}if(!count){g[count++]=0}g.length=count;return g}},{}],21:[function(require,module,exports){"use strict";module.exports=linearExpansionSum;function scalarScalar(a,b){var x=a+b;var bv=x-a;var av=x-bv;var br=b-bv;var ar=a-av;var y=ar+br;if(y){return[y,x]}return[x]}function linearExpansionSum(e,f){var ne=e.length|0;var nf=f.length|0;if(ne===1&&nf===1){return scalarScalar(e[0],f[0])}var n=ne+nf;var g=new Array(n);var count=0;var eptr=0;var fptr=0;var abs=Math.abs;var ei=e[eptr];var ea=abs(ei);var fi=f[fptr];var fa=abs(fi);var a,b;if(ea<fa){b=ei;eptr+=1;if(eptr<ne){ei=e[eptr];ea=abs(ei)}}else{b=fi;fptr+=1;if(fptr<nf){fi=f[fptr];fa=abs(fi)}}if(eptr<ne&&ea<fa||fptr>=nf){a=ei;eptr+=1;if(eptr<ne){ei=e[eptr];ea=abs(ei)}}else{a=fi;fptr+=1;if(fptr<nf){fi=f[fptr];fa=abs(fi)}}var x=a+b;var bv=x-a;var y=b-bv;var q0=y;var q1=x;var _x,_bv,_av,_br,_ar;while(eptr<ne&&fptr<nf){if(ea<fa){a=ei;eptr+=1;if(eptr<ne){ei=e[eptr];ea=abs(ei)}}else{a=fi;fptr+=1;if(fptr<nf){fi=f[fptr];fa=abs(fi)}}b=q0;x=a+b;bv=x-a;y=b-bv;if(y){g[count++]=y}_x=q1+x;_bv=_x-q1;_av=_x-_bv;_br=x-_bv;_ar=q1-_av;q0=_ar+_br;q1=_x}while(eptr<ne){a=ei;b=q0;x=a+b;bv=x-a;y=b-bv;if(y){g[count++]=y}_x=q1+x;_bv=_x-q1;_av=_x-_bv;_br=x-_bv;_ar=q1-_av;q0=_ar+_br;q1=_x;eptr+=1;if(eptr<ne){ei=e[eptr]}}while(fptr<nf){a=fi;b=q0;x=a+b;bv=x-a;y=b-bv;if(y){g[count++]=y}_x=q1+x;_bv=_x-q1;_av=_x-_bv;_br=x-_bv;_ar=q1-_av;q0=_ar+_br;q1=_x;fptr+=1;if(fptr<nf){fi=f[fptr]}}if(q0){g[count++]=q0}if(q1){g[count++]=q1}if(!count){g[count++]=0}g.length=count;return g}},{}],22:[function(require,module,exports){"use strict";module.exports=twoProduct;var SPLITTER=+(Math.pow(2,27)+1);function twoProduct(a,b,result){var x=a*b;var c=SPLITTER*a;var abig=c-a;var ahi=c-abig;var alo=a-ahi;var d=SPLITTER*b;var bbig=d-b;var bhi=d-bbig;var blo=b-bhi;var err1=x-ahi*bhi;var err2=err1-alo*bhi;var err3=err2-ahi*blo;var y=alo*blo-err3;if(result){result[0]=y;result[1]=x;return result}return[y,x]}},{}],23:[function(require,module,exports){"use strict";var twoProduct=require("two-product");var robustSum=require("robust-sum");var robustScale=require("robust-scale");var robustSubtract=require("robust-subtract");var NUM_EXPAND=5;var EPSILON=1.1102230246251565e-16;var ERRBOUND3=(3+16*EPSILON)*EPSILON;var ERRBOUND4=(7+56*EPSILON)*EPSILON;function cofactor(m,c){var result=new Array(m.length-1);for(var i=1;i<m.length;++i){var r=result[i-1]=new Array(m.length-1);for(var j=0,k=0;j<m.length;++j){if(j===c){continue}r[k++]=m[i][j]}}return result}function matrix(n){var result=new Array(n);for(var i=0;i<n;++i){result[i]=new Array(n);for(var j=0;j<n;++j){result[i][j]=["m",j,"[",n-i-1,"]"].join("")}}return result}function sign(n){if(n&1){return"-"}return""}function generateSum(expr){if(expr.length===1){return expr[0]}else if(expr.length===2){return["sum(",expr[0],",",expr[1],")"].join("")}else{var m=expr.length>>1;return["sum(",generateSum(expr.slice(0,m)),",",generateSum(expr.slice(m)),")"].join("")}}function determinant(m){if(m.length===2){return[["sum(prod(",m[0][0],",",m[1][1],"),prod(-",m[0][1],",",m[1][0],"))"].join("")]}else{var expr=[];for(var i=0;i<m.length;++i){expr.push(["scale(",generateSum(determinant(cofactor(m,i))),",",sign(i),m[0][i],")"].join(""))}return expr}}function orientation(n){var pos=[];var neg=[];var m=matrix(n);var args=[];for(var i=0;i<n;++i){if((i&1)===0){pos.push.apply(pos,determinant(cofactor(m,i)))}else{neg.push.apply(neg,determinant(cofactor(m,i)))}args.push("m"+i)}var posExpr=generateSum(pos);var negExpr=generateSum(neg);var funcName="orientation"+n+"Exact";var code=["function ",funcName,"(",args.join(),"){var p=",posExpr,",n=",negExpr,",d=sub(p,n);return d[d.length-1];};return ",funcName].join("");var proc=new Function("sum","prod","scale","sub",code);return proc(robustSum,twoProduct,robustScale,robustSubtract)}var orientation3Exact=orientation(3);var orientation4Exact=orientation(4);var CACHED=[function orientation0(){return 0},function orientation1(){return 0},function orientation2(a,b){return b[0]-a[0]},function orientation3(a,b,c){var l=(a[1]-c[1])*(b[0]-c[0]);var r=(a[0]-c[0])*(b[1]-c[1]);var det=l-r;var s;if(l>0){if(r<=0){return det}else{s=l+r}}else if(l<0){if(r>=0){return det}else{s=-(l+r)}}else{return det}var tol=ERRBOUND3*s;if(det>=tol||det<=-tol){return det}return orientation3Exact(a,b,c)},function orientation4(a,b,c,d){var adx=a[0]-d[0];var bdx=b[0]-d[0];var cdx=c[0]-d[0];var ady=a[1]-d[1];var bdy=b[1]-d[1];var cdy=c[1]-d[1];var adz=a[2]-d[2];var bdz=b[2]-d[2];var cdz=c[2]-d[2];var bdxcdy=bdx*cdy;var cdxbdy=cdx*bdy;var cdxady=cdx*ady;var adxcdy=adx*cdy;var adxbdy=adx*bdy;var bdxady=bdx*ady;var det=adz*(bdxcdy-cdxbdy)+bdz*(cdxady-adxcdy)+cdz*(adxbdy-bdxady);var permanent=(Math.abs(bdxcdy)+Math.abs(cdxbdy))*Math.abs(adz)+(Math.abs(cdxady)+Math.abs(adxcdy))*Math.abs(bdz)+(Math.abs(adxbdy)+Math.abs(bdxady))*Math.abs(cdz);var tol=ERRBOUND4*permanent;if(det>tol||-det>tol){return det}return orientation4Exact(a,b,c,d)}];function slowOrient(args){var proc=CACHED[args.length];if(!proc){proc=CACHED[args.length]=orientation(args.length)}return proc.apply(undefined,args)}function generateOrientationProc(){while(CACHED.length<=NUM_EXPAND){CACHED.push(orientation(CACHED.length))}var args=[];var procArgs=["slow"];for(var i=0;i<=NUM_EXPAND;++i){args.push("a"+i);procArgs.push("o"+i)}var code=["function getOrientation(",args.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var i=2;i<=NUM_EXPAND;++i){code.push("case ",i,":return o",i,"(",args.slice(0,i).join(),");")}code.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");procArgs.push(code.join(""));var proc=Function.apply(undefined,procArgs);module.exports=proc.apply(undefined,[slowOrient].concat(CACHED));for(var i=0;i<=NUM_EXPAND;++i){module.exports[i]=CACHED[i]}}generateOrientationProc()},{"robust-scale":19,"robust-subtract":20,"robust-sum":21,"two-product":22}],24:[function(require,module,exports){"use strict";"use restrict";var INT_BITS=32;exports.INT_BITS=INT_BITS;exports.INT_MAX=2147483647;exports.INT_MIN=-1<<INT_BITS-1;exports.sign=function(v){return(v>0)-(v<0)};exports.abs=function(v){var mask=v>>INT_BITS-1;return(v^mask)-mask};exports.min=function(x,y){return y^(x^y)&-(x<y)};exports.max=function(x,y){return x^(x^y)&-(x<y)};exports.isPow2=function(v){return!(v&v-1)&&!!v};exports.log2=function(v){var r,shift;r=(v>65535)<<4;v>>>=r;shift=(v>255)<<3;v>>>=shift;r|=shift;shift=(v>15)<<2;v>>>=shift;r|=shift;shift=(v>3)<<1;v>>>=shift;r|=shift;return r|v>>1};exports.log10=function(v){return v>=1e9?9:v>=1e8?8:v>=1e7?7:v>=1e6?6:v>=1e5?5:v>=1e4?4:v>=1e3?3:v>=100?2:v>=10?1:0};exports.popCount=function(v){v=v-(v>>>1&1431655765);v=(v&858993459)+(v>>>2&858993459);return(v+(v>>>4)&252645135)*16843009>>>24};function countTrailingZeros(v){var c=32;v&=-v;if(v)c--;if(v&65535)c-=16;if(v&16711935)c-=8;if(v&252645135)c-=4;if(v&858993459)c-=2;if(v&1431655765)c-=1;return c}exports.countTrailingZeros=countTrailingZeros;exports.nextPow2=function(v){v+=v===0;--v;v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v+1};exports.prevPow2=function(v){v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v-(v>>>1)};exports.parity=function(v){v^=v>>>16;v^=v>>>8;v^=v>>>4;v&=15;return 27030>>>v&1};var REVERSE_TABLE=new Array(256);(function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1){r<<=1;r|=v&1;--s}tab[i]=r<<s&255}})(REVERSE_TABLE);exports.reverse=function(v){return REVERSE_TABLE[v&255]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]};exports.interleave2=function(x,y){x&=65535;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;x=(x|x<<1)&1431655765;y&=65535;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;y=(y|y<<1)&1431655765;return x|y<<1};exports.deinterleave2=function(v,n){v=v>>>n&1431655765;v=(v|v>>>1)&858993459;v=(v|v>>>2)&252645135;v=(v|v>>>4)&16711935;v=(v|v>>>16)&65535;return v<<16>>16};exports.interleave3=function(x,y,z){x&=1023;x=(x|x<<16)&4278190335;x=(x|x<<8)&251719695;x=(x|x<<4)&3272356035;x=(x|x<<2)&1227133513;y&=1023;y=(y|y<<16)&4278190335;y=(y|y<<8)&251719695;y=(y|y<<4)&3272356035;y=(y|y<<2)&1227133513;x|=y<<1;z&=1023;z=(z|z<<16)&4278190335;z=(z|z<<8)&251719695;z=(z|z<<4)&3272356035;z=(z|z<<2)&1227133513;return x|z<<2};exports.deinterleave3=function(v,n){v=v>>>n&1227133513;v=(v|v>>>2)&3272356035;v=(v|v>>>4)&251719695;v=(v|v>>>8)&4278190335;v=(v|v>>>16)&1023;return v<<22>>22};exports.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],25:[function(require,module,exports){"use strict";"use restrict";module.exports=UnionFind;function UnionFind(count){this.roots=new Array(count);this.ranks=new Array(count);for(var i=0;i<count;++i){this.roots[i]=i;this.ranks[i]=0}}var proto=UnionFind.prototype;Object.defineProperty(proto,"length",{get:function(){return this.roots.length}});proto.makeSet=function(){var n=this.roots.length;this.roots.push(n);this.ranks.push(0);return n};proto.find=function(x){var roots=this.roots;while(roots[x]!==x){var y=roots[x];roots[x]=roots[y];x=y}return x};proto.link=function(x,y){var xr=this.find(x),yr=this.find(y);if(xr===yr){return}var ranks=this.ranks,roots=this.roots,xd=ranks[xr],yd=ranks[yr];if(xd<yd){roots[xr]=yr}else if(yd<xd){roots[yr]=xr}else{roots[yr]=xr;++ranks[xr]}}},{}],26:[function(require,module,exports){"use strict";"use restrict";var bits=require("bit-twiddle"),UnionFind=require("union-find");function dimension(cells){var d=0,max=Math.max;for(var i=0,il=cells.length;i<il;++i){d=max(d,cells[i].length)}return d-1}exports.dimension=dimension;function countVertices(cells){var vc=-1,max=Math.max;for(var i=0,il=cells.length;i<il;++i){var c=cells[i];for(var j=0,jl=c.length;j<jl;++j){vc=max(vc,c[j])}}return vc+1}exports.countVertices=countVertices;function cloneCells(cells){var ncells=new Array(cells.length);for(var i=0,il=cells.length;i<il;++i){ncells[i]=cells[i].slice(0)}return ncells}exports.cloneCells=cloneCells;function compareCells(a,b){var n=a.length,t=a.length-b.length,min=Math.min;if(t){return t}switch(n){case 0:return 0;case 1:return a[0]-b[0];case 2:var d=a[0]+a[1]-b[0]-b[1];if(d){return d}return min(a[0],a[1])-min(b[0],b[1]);case 3:var l1=a[0]+a[1],m1=b[0]+b[1];d=l1+a[2]-(m1+b[2]);if(d){return d}var l0=min(a[0],a[1]),m0=min(b[0],b[1]),d=min(l0,a[2])-min(m0,b[2]);if(d){return d}return min(l0+a[2],l1)-min(m0+b[2],m1);default:var as=a.slice(0);as.sort();var bs=b.slice(0);bs.sort();for(var i=0;i<n;++i){t=as[i]-bs[i];if(t){return t}}return 0}}exports.compareCells=compareCells;function compareZipped(a,b){return compareCells(a[0],b[0])}function normalize(cells,attr){if(attr){var len=cells.length;var zipped=new Array(len);for(var i=0;i<len;++i){zipped[i]=[cells[i],attr[i]]}zipped.sort(compareZipped);for(var i=0;i<len;++i){cells[i]=zipped[i][0];attr[i]=zipped[i][1]}return cells}else{cells.sort(compareCells);return cells}}exports.normalize=normalize;function unique(cells){if(cells.length===0){return[]}var ptr=1,len=cells.length;for(var i=1;i<len;++i){var a=cells[i];if(compareCells(a,cells[i-1])){if(i===ptr){ptr++;continue}cells[ptr++]=a}}cells.length=ptr;return cells}exports.unique=unique;function findCell(cells,c){var lo=0,hi=cells.length-1,r=-1;while(lo<=hi){var mid=lo+hi>>1,s=compareCells(cells[mid],c);if(s<=0){if(s===0){r=mid}lo=mid+1}else if(s>0){hi=mid-1}}return r}exports.findCell=findCell;function incidence(from_cells,to_cells){var index=new Array(from_cells.length);for(var i=0,il=index.length;i<il;++i){index[i]=[]}var b=[];for(var i=0,n=to_cells.length;i<n;++i){var c=to_cells[i];var cl=c.length;for(var k=1,kn=1<<cl;k<kn;++k){b.length=bits.popCount(k);var l=0;for(var j=0;j<cl;++j){if(k&1<<j){b[l++]=c[j]}}var idx=findCell(from_cells,b);if(idx<0){continue}while(true){index[idx++].push(i);if(idx>=from_cells.length||compareCells(from_cells[idx],b)!==0){break}}}}return index}exports.incidence=incidence;function dual(cells,vertex_count){if(!vertex_count){return incidence(unique(skeleton(cells,0)),cells,0)}var res=new Array(vertex_count);for(var i=0;i<vertex_count;++i){res[i]=[]}for(var i=0,len=cells.length;i<len;++i){var c=cells[i];for(var j=0,cl=c.length;j<cl;++j){res[c[j]].push(i)}}return res}exports.dual=dual;function explode(cells){var result=[];for(var i=0,il=cells.length;i<il;++i){var c=cells[i],cl=c.length|0;for(var j=1,jl=1<<cl;j<jl;++j){var b=[];for(var k=0;k<cl;++k){if(j>>>k&1){b.push(c[k])}}result.push(b)}}return normalize(result)}exports.explode=explode;function skeleton(cells,n){if(n<0){return[]}var result=[],k0=(1<<n+1)-1;for(var i=0;i<cells.length;++i){var c=cells[i];for(var k=k0;k<1<<c.length;k=bits.nextCombination(k)){var b=new Array(n+1),l=0;for(var j=0;j<c.length;++j){if(k&1<<j){b[l++]=c[j]}}result.push(b)}}return normalize(result)}exports.skeleton=skeleton;function boundary(cells){var res=[];for(var i=0,il=cells.length;i<il;++i){var c=cells[i];for(var j=0,cl=c.length;j<cl;++j){var b=new Array(c.length-1);for(var k=0,l=0;k<cl;++k){if(k!==j){b[l++]=c[k]}}res.push(b)}}return normalize(res)}exports.boundary=boundary;function connectedComponents_dense(cells,vertex_count){var labels=new UnionFind(vertex_count);for(var i=0;i<cells.length;++i){var c=cells[i];for(var j=0;j<c.length;++j){for(var k=j+1;k<c.length;++k){labels.link(c[j],c[k])}}}var components=[],component_labels=labels.ranks;for(var i=0;i<component_labels.length;++i){component_labels[i]=-1}for(var i=0;i<cells.length;++i){var l=labels.find(cells[i][0]);if(component_labels[l]<0){component_labels[l]=components.length;components.push([cells[i].slice(0)])}else{components[component_labels[l]].push(cells[i].slice(0))}}return components}function connectedComponents_sparse(cells){var vertices=unique(normalize(skeleton(cells,0))),labels=new UnionFind(vertices.length);for(var i=0;i<cells.length;++i){var c=cells[i];for(var j=0;j<c.length;++j){var vj=findCell(vertices,[c[j]]);for(var k=j+1;k<c.length;++k){labels.link(vj,findCell(vertices,[c[k]]))}}}var components=[],component_labels=labels.ranks;for(var i=0;i<component_labels.length;++i){component_labels[i]=-1}for(var i=0;i<cells.length;++i){var l=labels.find(findCell(vertices,[cells[i][0]]));if(component_labels[l]<0){component_labels[l]=components.length;components.push([cells[i].slice(0)])}else{components[component_labels[l]].push(cells[i].slice(0))}}return components}function connectedComponents(cells,vertex_count){if(vertex_count){return connectedComponents_dense(cells,vertex_count)}return connectedComponents_sparse(cells)}exports.connectedComponents=connectedComponents},{"bit-twiddle":24,"union-find":25}],27:[function(require,module,exports){"use strict";function unique_pred(list,compare){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i){b=a;a=list[i];if(compare(a,b)){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique_eq(list){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i,b=a){b=a;a=list[i];if(a!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique(list,compare,sorted){if(list.length===0){return list}if(compare){if(!sorted){list.sort(compare)}return unique_pred(list,compare)}if(!sorted){list.sort()}return unique_eq(list)}module.exports=unique},{}],28:[function(require,module,exports){"use strict";var ch=require("incremental-convex-hull");var uniq=require("uniq");module.exports=triangulate;function LiftedPoint(p,i){this.point=p;this.index=i}function compareLifted(a,b){var ap=a.point;var bp=b.point;var d=ap.length;for(var i=0;i<d;++i){var s=bp[i]-ap[i];if(s){return s}}return 0}function triangulate1D(n,points,includePointAtInfinity){if(n===1){if(includePointAtInfinity){return[[-1,0]]}else{return[]}}var lifted=points.map(function(p,i){return[p[0],i]});lifted.sort(function(a,b){return a[0]-b[0]});var cells=new Array(n-1);for(var i=1;i<n;++i){var a=lifted[i-1];var b=lifted[i];cells[i-1]=[a[1],b[1]]}if(includePointAtInfinity){cells.push([-1,cells[0][1]],[cells[n-1][1],-1])}return cells}function triangulate(points,includePointAtInfinity){var n=points.length;if(n===0){return[]}var d=points[0].length;if(d<1){return[]}if(d===1){return triangulate1D(n,points,includePointAtInfinity)}var lifted=new Array(n);var upper=1;for(var i=0;i<n;++i){var p=points[i];var x=new Array(d+1);var l=0;for(var j=0;j<d;++j){var v=p[j];x[j]=v;l+=v*v}x[d]=l;lifted[i]=new LiftedPoint(x,i);upper=Math.max(l,upper)}uniq(lifted,compareLifted);n=lifted.length;var dpoints=new Array(n+d+1);var dindex=new Array(n+d+1);var u=(d+1)*(d+1)*upper;var y=new Array(d+1);for(var i=0;i<=d;++i){y[i]=0}y[d]=u;dpoints[0]=y.slice();dindex[0]=-1;for(var i=0;i<=d;++i){var x=y.slice();x[i]=1;dpoints[i+1]=x;dindex[i+1]=-1}for(var i=0;i<n;++i){var h=lifted[i];dpoints[i+d+1]=h.point;dindex[i+d+1]=h.index}var hull=ch(dpoints,false);if(includePointAtInfinity){hull=hull.filter(function(cell){var count=0;for(var j=0;j<=d;++j){var v=dindex[cell[j]];if(v<0){if(++count>=2){return false}}cell[j]=v}return true})}else{hull=hull.filter(function(cell){for(var i=0;i<=d;++i){var v=dindex[cell[i]];if(v<0){return false}cell[i]=v}return true})}if(d&1){for(var i=0;i<hull.length;++i){var h=hull[i];var x=h[0];h[0]=h[1];h[1]=x}}return hull}},{"incremental-convex-hull":17,uniq:27}],29:[function(require,module,exports){"use strict";module.exports=createAxes;var createStateStack=require("gl-state");var createText=require("./lib/text.js");var createLines=require("./lib/lines.js");var createBackground=require("./lib/background.js");var getCubeProperties=require("./lib/cube.js");var Ticks=require("./lib/ticks.js");var identity=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function Axes(gl){this.gl=gl;this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.autoTicks=true;this.tickSpacing=[1,1,1];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[1,1,1];this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont="sans-serif";this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[1.5,1.5,1.5];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[0,0,0];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[false,false,false];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._firstInit=true;this._text=null;this._lines=null;this._background=createBackground(gl);this._state=createStateStack(gl,[gl.BLEND,gl.BLEND_DST_ALPHA,gl.BLEND_DST_RGB,gl.BLEND_SRC_ALPHA,gl.BLEND_SRC_RGB,gl.BLEND_EQUATION_ALPHA,gl.BLEND_EQUATION_RGB,gl.CULL_FACE,gl.CULL_FACE_MODE,gl.DEPTH_WRITEMASK,gl.DEPTH_TEST,gl.DEPTH_FUNC,gl.LINE_WIDTH])}var proto=Axes.prototype;proto.update=function(options){options=options||{};function parseOption(nest,cons,name){if(name in options){var opt=options[name];var prev=this[name];var next;if(nest?Array.isArray(opt)&&Array.isArray(opt[0]):Array.isArray(opt)){this[name]=next=[cons(opt[0]),cons(opt[1]),cons(opt[2])]}else{this[name]=next=[cons(opt),cons(opt),cons(opt)]}for(var i=0;i<3;++i){if(next[i]!==prev[i]){return true}}}return false}var NUMBER=parseOption.bind(this,false,Number);var BOOLEAN=parseOption.bind(this,false,Boolean);var STRING=parseOption.bind(this,false,String);var COLOR=parseOption.bind(this,true,function(v){if(Array.isArray(v)){if(v.length===3){return[+v[0],+v[1],+v[2],1]}else if(v.length===4){return[+v[0],+v[1],+v[2],+v[3]]}}return[0,0,0,1]});var nextTicks;var ticksUpdate=false;var boundsChanged=false;if("bounds"in options){var bounds=options.bounds;i_loop:for(var i=0;i<2;++i){for(var j=0;j<3;++j){if(bounds[i][j]!==this.bounds[i][j]){this.bounds=options.bounds;boundsChanged=true;break i_loop}}}}if("ticks"in options){nextTicks=options.ticks;ticksUpdate=true;this.autoTicks=false;for(var i=0;i<3;++i){this.tickSpacing[i]=0}}if(NUMBER("tickSpacing")){this.autoTicks=true;boundsChanged=true}if(this._firstInit){if(!("ticks"in options||"tickSpacing"in options)){this.autoTicks=true}boundsChanged=true;ticksUpdate=true;this._firstInit=false}if(boundsChanged&&this.autoTicks){nextTicks=Ticks.create(this.bounds,this.tickSpacing)}if(ticksUpdate){for(var i=0;i<3;++i){nextTicks[i].sort(function(a,b){return a.x-b.x})}if(Ticks.equal(nextTicks,this.ticks)){ticksUpdate=false}else{this.ticks=nextTicks}}BOOLEAN("tickEnable");if(STRING("tickFont")){ticksUpdate=true}NUMBER("tickSize");NUMBER("tickAngle");NUMBER("tickPad");COLOR("tickColor");var labelUpdate=STRING("labels");if(STRING("labelFont")){labelUpdate=true}BOOLEAN("labelEnable");NUMBER("labelSize");NUMBER("labelPad");COLOR("labelColor");BOOLEAN("lineEnable");BOOLEAN("lineMirror");NUMBER("lineWidth");COLOR("lineColor");BOOLEAN("lineTickEnable");BOOLEAN("lineTickMirror");NUMBER("lineTickLength");NUMBER("lineTickWidth");COLOR("lineTickColor");BOOLEAN("gridEnable");NUMBER("gridWidth");COLOR("gridColor");BOOLEAN("zeroEnable");COLOR("zeroLineColor");NUMBER("zeroLineWidth");BOOLEAN("backgroundEnable");COLOR("backgroundColor");if(this._text&&(labelUpdate||ticksUpdate)){this._text.dispose();this._text=null}if(!this._text){this._text=createText(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}if(this._lines&&ticksUpdate){this._lines.dispose();this._lines=null}if(!this._lines){this._lines=createLines(this.gl,this.bounds,this.ticks)}};function computeLineOffset(i,bounds,cubeEdges,cubeAxis){var primalOffset=[0,0,0];var primalMinor=[0,0,0];var dualOffset=[0,0,0];var dualMinor=[0,0,0];var e=cubeEdges[i];for(var j=0;j<3;++j){if(i===j){continue}var a=primalOffset,b=dualOffset,c=primalMinor,d=dualMinor;if(e&1<<j){a=dualOffset;b=primalOffset;c=dualMinor;d=primalMinor}a[j]=bounds[0][j];b[j]=bounds[1][j];if(cubeAxis[j]>0){c[j]=-1}else{d[j]=+1}}return{primalOffset:primalOffset,primalMinor:primalMinor,mirrorOffset:dualOffset,mirrorMinor:dualMinor}}proto.draw=function(params){params=params||{};var model=params.model||identity;var view=params.view||identity;var projection=params.projection||identity;var bounds=this.bounds;var cubeParams=getCubeProperties(model,view,projection,bounds);var cubeEdges=cubeParams.edges;var cubeAxis=cubeParams.axis;var lineOffset=new Array(3);for(var i=0;i<3;++i){lineOffset[i]=computeLineOffset(i,this.bounds,cubeEdges,cubeAxis)}this._state.push();var gl=this.gl;gl.enable(gl.CULL_FACE);gl.cullFace(gl.BACK);gl.enable(gl.DEPTH_TEST);gl.depthMask(false);gl.enable(gl.BLEND);gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);var cubeEnable=[0,0,0];for(var i=0;i<3;++i){if(this.backgroundEnable[i]){cubeEnable[i]=cubeAxis[i]}}this._background.draw(model,view,projection,this.bounds,cubeEnable,this.backgroundColor);gl.depthMask(true);gl.depthFunc(gl.LEQUAL);gl.disable(gl.BLEND);this._lines.bind(model,view,projection,this);for(var i=0;i<3;++i){var x=[0,0,0];if(cubeAxis[i]>0){x[i]=bounds[1][i]}else{x[i]=bounds[0][i]}for(var j=0;j<2;++j){var u=(i+1+j)%3;var v=(i+1+(j^1))%3;if(this.gridEnable[u]){gl.lineWidth(this.gridWidth[u]);this._lines.drawGrid(u,v,this.bounds,x,this.gridColor[u])}}for(var j=0;j<2;++j){var u=(i+1+j)%3;var v=(i+1+(j^1))%3;if(this.zeroEnable[v]){if(bounds[0][v]<=0&&bounds[1][v]>=0){gl.lineWidth(this.zeroLineWidth[v]);this._lines.drawZero(u,this.bounds,x,this.zeroLineColor[v])}}}}for(var i=0;i<3;++i){gl.lineWidth(this.lineWidth[i]);if(this.lineEnable[i]){this._lines.drawAxisLine(i,this.bounds,lineOffset[i].primalOffset,this.lineColor[i])}if(this.lineMirror[i]){this._lines.drawAxisLine(i,this.bounds,lineOffset[i].mirrorOffset,this.lineColor[i])}var primalMinor=lineOffset[i].primalMinor.slice();var mirrorMinor=lineOffset[i].mirrorMinor.slice();var tickLength=this.lineTickLength;for(var j=0;j<3;++j){primalMinor[j]*=tickLength[j];mirrorMinor[j]*=tickLength[j]}gl.lineWidth(this.lineTickWidth[i]);if(this.lineTickEnable[i]){this._lines.drawAxisTicks(i,lineOffset[i].primalOffset,primalMinor,this.lineTickColor[i])}if(this.lineTickMirror[i]){this._lines.drawAxisTicks(i,lineOffset[i].mirrorOffset,mirrorMinor,this.lineTickColor[i])}}this._text.bind(model,view,projection);for(var i=0;i<3;++i){var minor=lineOffset[i].primalMinor;var offset=lineOffset[i].primalOffset.slice();for(var j=0;j<3;++j){if(this.lineTickEnable[i]){offset[j]+=minor[j]*Math.max(this.lineTickLength[j],0)}}if(this.tickEnable[i]){for(var j=0;j<3;++j){offset[j]+=minor[j]*this.tickPad[j]}this._text.drawTicks(i,this.tickSize[i],this.tickAngle[i],offset,this.tickColor[i])}if(this.labelEnable[i]){for(var j=0;j<3;++j){offset[j]+=minor[j]*this.labelPad[j]}offset[i]+=.5*(bounds[0][i]+bounds[1][i]);this._text.drawLabel(i,this.labelSize[i],this.labelAngle[i],offset,this.labelColor[i])}}this._state.pop()};proto.dispose=function(){this._text.dispose();this._lines.dispose();this._background.dispose()};function createAxes(gl,options){var axes=new Axes(gl);axes.update(options);return axes}},{"./lib/background.js":30,"./lib/cube.js":31,"./lib/lines.js":32,"./lib/text.js":33,"./lib/ticks.js":34,"gl-state":38}],30:[function(require,module,exports){"use strict";module.exports=createBackgroundCube;var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var glslify=require("glslify");var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\nvarying vec3 colorChannel;\nvoid main() {\n  if(dot(normal, enable) > 0.0) {\n    vec3 nPosition = mix(bounds[0], bounds[1], 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0, 0, 0, 0);\n  }\n  colorChannel = abs(normal);\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec4 colors[3];\nvarying vec3 colorChannel;\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] + colorChannel.y * colors[1] + colorChannel.z * colors[2];\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"enable",type:"vec3"},{name:"bounds[0]",type:"vec3"},{name:"bounds[1]",type:"vec3"},{name:"colors[0]",type:"vec4"},{name:"colors[1]",type:"vec4"},{name:"colors[2]",type:"vec4"}],[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}]);function BackgroundCube(gl,buffer,vao,shader){this.gl=gl;this.buffer=buffer;this.vao=vao;this.shader=shader}var proto=BackgroundCube.prototype;proto.draw=function(model,view,projection,bounds,enable,colors){this.shader.bind();this.shader.uniforms={model:model,view:view,projection:projection,bounds:bounds,enable:enable,colors:colors};this.vao.bind();this.vao.draw(this.gl.TRIANGLES,36)};proto.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function createBackgroundCube(gl){var vertices=[];var indices=[];var ptr=0;for(var d=0;d<3;++d){var u=(d+1)%3;var v=(d+2)%3;var x=[0,0,0];var c=[0,0,0];for(var s=-1;s<=1;s+=2){indices.push(ptr,ptr+2,ptr+1,ptr+1,ptr+2,ptr+3);x[d]=s;c[d]=s;for(var i=-1;i<=1;i+=2){x[u]=i;for(var j=-1;j<=1;j+=2){x[v]=j;vertices.push(x[0],x[1],x[2],c[0],c[1],c[2]);ptr+=1}}var tt=u;u=v;v=tt}}var buffer=createBuffer(gl,new Float32Array(vertices));var elements=createBuffer(gl,new Uint16Array(indices),gl.ELEMENT_ARRAY_BUFFER);var vao=createVAO(gl,[{buffer:buffer,type:gl.FLOAT,size:3,offset:0,stride:24},{buffer:buffer,type:gl.FLOAT,size:3,offset:12,stride:24}],elements);var shader=createShader(gl);shader.attributes.position.location=0;shader.attributes.normal.location=1;return new BackgroundCube(gl,buffer,vao,shader)}},{"gl-buffer":121,"gl-vao":44,glslify:46,"glslify/adapter.js":45}],31:[function(require,module,exports){"use strict";module.exports=getCubeEdges;var bits=require("bit-twiddle");var glm=require("gl-matrix");var mat4=glm.mat4;var vec4=glm.vec4;var scratch=new Float32Array(16);function getCubeEdges(model,view,projection,bounds){var mvp=scratch;mat4.multiply(mvp,view,model);mat4.multiply(mvp,projection,mvp);var cubeVerts=[];var x=[0,0,0,1];var y=[0,0,0,0];for(var i=0;i<2;++i){x[2]=bounds[i][2];for(var j=0;j<2;++j){x[1]=bounds[j][1];for(var k=0;k<2;++k){x[0]=bounds[k][0];vec4.transformMat4(y,x,mvp);var cv=[y[0]/y[3],y[1]/y[3],y[2]];cubeVerts.push(cv)}}}var closest=0;for(var i=0;i<8;++i){if(cubeVerts[i][2]<cubeVerts[closest][2]){closest=i}}var farthest=7^closest;var bottom=-1;for(var i=0;i<8;++i){if(i===closest||i===farthest){continue}if(bottom<0){bottom=i}else if(cubeVerts[bottom][1]>cubeVerts[i][1]){bottom=i}}var left=-1;for(var i=0;i<3;++i){var idx=bottom^1<<i;if(idx===closest||idx===farthest){continue}if(left<0){left=idx}var v=cubeVerts[idx];if(v[0]<cubeVerts[left][0]){left=idx}}var right=-1;for(var i=0;i<3;++i){var idx=bottom^1<<i;if(idx===closest||idx===farthest||idx===left){continue}if(right<0){right=idx}var v=cubeVerts[idx];if(v[0]>cubeVerts[right][0]){right=idx}}var cubeEdges=[0,0,0];cubeEdges[bits.log2(left^bottom)]=bottom&left;cubeEdges[bits.log2(bottom^right)]=bottom&right;var top=right^7;if(top===closest||top===farthest){top=left^7;cubeEdges[bits.log2(right^top)]=top&right}else{cubeEdges[bits.log2(left^top)]=top&left}var axis=[1,1,1];var cutCorner=closest;for(var d=0;d<3;++d){if(cutCorner&1<<d){axis[d]=-1}else{axis[d]=1}}return{edges:cubeEdges,axis:axis}}},{"bit-twiddle":35,"gl-matrix":173}],32:[function(require,module,exports){"use strict";module.exports=createLines;var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var glslify=require("glslify");var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nattribute vec2 position;\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis;\nvoid main() {\n  vec3 vPosition = position.x * majorAxis + position.y * minorAxis + offset;\n  gl_Position = projection * view * model * vec4(vPosition, 1.0);\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"offset",type:"vec3"},{name:"majorAxis",type:"vec3"},{name:"minorAxis",type:"vec3"},{name:"color",type:"vec4"}],[{name:"position",type:"vec2"}]);function Lines(gl,vertBuffer,vao,shader,tickCount,tickOffset,gridCount,gridOffset){this.gl=gl;this.vertBuffer=vertBuffer;this.vao=vao;this.shader=shader;this.tickCount=tickCount;this.tickOffset=tickOffset;this.gridCount=gridCount;this.gridOffset=gridOffset}var proto=Lines.prototype;proto.bind=function(model,view,projection){this.shader.bind();this.shader.uniforms.model=model;this.shader.uniforms.view=view;this.shader.uniforms.projection=projection;this.vao.bind()};proto.drawAxisLine=function(j,bounds,offset,color){this.shader.uniforms.majorAxis=[0,0,0];var minorAxis=[0,0,0];minorAxis[j]=bounds[1][j]-bounds[0][j];this.shader.uniforms.minorAxis=minorAxis;var noffset=offset.slice();noffset[j]+=bounds[0][j];this.shader.uniforms.offset=noffset;this.shader.uniforms.color=color;this.vao.draw(this.gl.LINES,2)};proto.drawAxisTicks=function(j,offset,minorAxis,color){var majorAxis=[0,0,0];majorAxis[j]=1;this.shader.uniforms.majorAxis=majorAxis;this.shader.uniforms.offset=offset;this.shader.uniforms.minorAxis=minorAxis;this.shader.uniforms.color=color;this.vao.draw(this.gl.LINES,this.tickCount[j],this.tickOffset[j])};proto.drawGrid=function(i,j,bounds,offset,color){var minorAxis=[0,0,0];minorAxis[j]=bounds[1][j]-bounds[0][j];this.shader.uniforms.minorAxis=minorAxis;var noffset=offset.slice();noffset[j]+=bounds[0][j];this.shader.uniforms.offset=noffset;var majorAxis=[0,0,0];majorAxis[i]=1;this.shader.uniforms.majorAxis=majorAxis;this.shader.uniforms.color=color;this.vao.draw(this.gl.LINES,this.gridCount[i],this.gridOffset[i])};proto.drawZero=function(j,bounds,offset,color){this.shader.uniforms.majorAxis=[0,0,0];var minorAxis=[0,0,0];minorAxis[j]=bounds[1][j]-bounds[0][j];this.shader.uniforms.minorAxis=minorAxis;var noffset=offset.slice();noffset[j]+=bounds[0][j];this.shader.uniforms.offset=noffset;this.shader.uniforms.color=color;this.vao.draw(this.gl.LINES,2)};proto.dispose=function(){this.vao.dispose();this.vertBuffer.dispose();this.shader.dispose()};function createLines(gl,bounds,ticks){var vertices=[];var tickOffset=[0,0,0];var tickCount=[0,0,0];var gridOffset=[0,0,0];var gridCount=[0,0,0];vertices.push(0,0,0,1);for(var i=0;i<3;++i){var start=vertices.length/2|0;for(var j=0;j<ticks[i].length;++j){vertices.push(+ticks[i][j].x,0,+ticks[i][j].x,1)}var end=vertices.length/2|0;tickOffset[i]=start;tickCount[i]=end-start;var start=vertices.length/2|0;for(var k=0;k<ticks[i].length;++k){var tx=+ticks[i][k].x;vertices.push(tx,0,tx,1)}var end=vertices.length/2|0;gridOffset[i]=start;gridCount[i]=end-start}var vertBuf=createBuffer(gl,new Float32Array(vertices));var vao=createVAO(gl,[{buffer:vertBuf,type:gl.FLOAT,size:2,stride:0,offset:0}]);var shader=createShader(gl);shader.attributes.position.location=0;return new Lines(gl,vertBuf,vao,shader,tickCount,tickOffset,gridCount,gridOffset)}},{"gl-buffer":121,"gl-vao":44,glslify:46,"glslify/adapter.js":45}],33:[function(require,module,exports){(function(process){"use strict";module.exports=createTextSprites;var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var vectorizeText=require("vectorize-text");var glslify=require("glslify");var globals=window||process.global||{};var __TEXT_CACHE=globals.__TEXT_CACHE||{};globals.__TEXT_CACHE={};var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nattribute vec3 position;\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis;\nuniform float scale, angle;\nuniform vec2 resolution;\nvoid main() {\n  vec2 planeCoord = position.xy;\n  mat2 planeXform = scale * mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n  vec4 worldPosition = model * vec4(dataPosition, 1);\n  vec4 viewPosition = view * worldPosition;\n  vec4 clipPosition = projection * viewPosition;\n  clipPosition /= clipPosition.w;\n  clipPosition += vec4(viewOffset, 0, 0);\n  gl_Position = clipPosition;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"offset",type:"vec3"},{name:"axis",type:"vec3"},{name:"scale",type:"float"},{name:"angle",type:"float"},{name:"resolution",type:"vec2"},{name:"color",type:"vec4"}],[{name:"position",type:"vec3"}]);var VERTEX_SIZE=3;var VERTEX_STRIDE=VERTEX_SIZE*4;function TextSprites(gl,shader,buffer,vao,tickOffset,tickCount,labelOffset,labelCount){this.gl=gl;this.shader=shader;this.buffer=buffer;this.vao=vao;this.tickOffset=tickOffset;this.tickCount=tickCount;this.labelOffset=labelOffset;this.labelCount=labelCount}var proto=TextSprites.prototype;proto.bind=function(model,view,projection){this.vao.bind();this.shader.bind();this.shader.uniforms.model=model;this.shader.uniforms.view=view;this.shader.uniforms.projection=projection;this.shader.uniforms.resolution=[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]};proto.drawTicks=function(d,scale,angle,offset,color){var v=[0,0,0];v[d]=1;this.shader.uniforms.axis=v;this.shader.uniforms.color=color;this.shader.uniforms.angle=angle;this.shader.uniforms.scale=scale;this.shader.uniforms.offset=offset;this.vao.draw(this.gl.TRIANGLES,this.tickCount[d],this.tickOffset[d])};proto.drawLabel=function(d,scale,angle,offset,color){this.shader.uniforms.axis=[0,0,0];this.shader.uniforms.color=color;this.shader.uniforms.angle=angle;this.shader.uniforms.scale=scale;this.shader.uniforms.offset=offset;this.vao.draw(this.gl.TRIANGLES,this.labelCount[d],this.labelOffset[d])};proto.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};function createTextSprites(gl,bounds,labels,labelFont,ticks,tickFont){var data=[];function addItem(t,text,font){var fontcache=__TEXT_CACHE[font];if(!fontcache){fontcache=__TEXT_CACHE[font]={}}var mesh=fontcache[text];if(!mesh){mesh=fontcache[text]=vectorizeText(text,{triangles:true,font:font,textAlign:"center",textBaseline:"middle"})}var positions=mesh.positions;var cells=mesh.cells;var lo=[Infinity,Infinity];var hi=[-Infinity,-Infinity];for(var i=0,nc=cells.length;i<nc;++i){var c=cells[i];for(var j=2;j>=0;--j){var p=positions[c[j]];data.push(p[0],-p[1],t)}}}var tickOffset=[0,0,0];var tickCount=[0,0,0];var labelOffset=[0,0,0];var labelCount=[0,0,0];for(var d=0;d<3;++d){labelOffset[d]=data.length/VERTEX_SIZE|0;addItem(.5*(bounds[0][d]+bounds[1][d]),labels[d],labelFont);labelCount[d]=(data.length/VERTEX_SIZE|0)-labelOffset[d];tickOffset[d]=data.length/VERTEX_SIZE|0;for(var i=0;i<ticks[d].length;++i){if(!ticks[d][i].text){continue}addItem(ticks[d][i].x,ticks[d][i].text,tickFont)}tickCount[d]=(data.length/VERTEX_SIZE|0)-tickOffset[d]}var buffer=createBuffer(gl,data);var vao=createVAO(gl,[{buffer:buffer,offset:0,size:3}]);var shader=createShader(gl);shader.attributes.position.location=0;return new TextSprites(gl,shader,buffer,vao,tickOffset,tickCount,labelOffset,labelCount)}}).call(this,require("_process"))},{_process:14,"gl-buffer":121,"gl-vao":44,glslify:46,"glslify/adapter.js":45,"vectorize-text":56}],34:[function(require,module,exports){"use strict";exports.create=defaultTicks;exports.equal=ticksEqual;function prettyPrint(spacing,i){var stepStr=spacing+"";var u=stepStr.indexOf(".");var sigFigs=0;if(u>=0){sigFigs=stepStr.length-u-1}var shift=Math.pow(10,sigFigs);var x=Math.round(spacing*i*shift);var xstr=x+"";if(xstr.indexOf("e")>=0){return xstr}var xi=x/shift,xf=x%shift;if(x<0){xi=-Math.ceil(xi)|0;xf=-xf|0}else{xi=Math.floor(xi)|0;xf=xf|0}var xis=""+xi;if(x<0){xis="-"+xis}if(sigFigs){var xs=""+xf;while(xs.length<sigFigs){xs="0"+xs}return xis+"."+xs}else{return xis}}function defaultTicks(bounds,tickSpacing){var array=[];for(var d=0;d<3;++d){var ticks=[];var m=.5*(bounds[0][d]+bounds[1][d]);for(var t=0;t*tickSpacing[d]<=bounds[1][d];++t){ticks.push({x:t*tickSpacing[d],text:prettyPrint(tickSpacing[d],t)})}for(var t=-1;t*tickSpacing[d]>=bounds[0][d];--t){ticks.push({x:t*tickSpacing[d],text:prettyPrint(tickSpacing[d],t)})}array.push(ticks)}return array}function ticksEqual(ticksA,ticksB){for(var i=0;i<3;++i){if(ticksA[i].length!==ticksB[i].length){return false}for(var j=0;j<ticksA[i].length;++j){var a=ticksA[i][j];var b=ticksB[i][j];if(a.x!==b.x||a.text!==b.text){return false}}}return true}},{}],35:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],36:[function(require,module,exports){"use strict";module.exports=extractPlanes;function extractPlanes(M,zNear,zFar){var z=zNear||0;var zf=zFar||1;return[[M[12]+M[0],M[13]+M[1],M[14]+M[2],M[15]+M[3]],[M[12]-M[0],M[13]-M[1],M[14]-M[2],M[15]-M[3]],[M[12]+M[4],M[13]+M[5],M[14]+M[6],M[15]+M[7]],[M[12]-M[4],M[13]-M[5],M[14]-M[6],M[15]-M[7]],[z*M[12]+M[8],z*M[13]+M[9],z*M[14]+M[10],z*M[15]+M[11]],[zf*M[12]-M[8],zf*M[13]-M[9],zf*M[14]-M[10],zf*M[15]-M[11]]]}},{}],37:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],38:[function(require,module,exports){"use strict";module.exports=createGLStateStack;var uniq=require("uniq");function createGLStateStack(gl,variables){if(!variables){variables=[gl.ACTIVE_TEXTURE,gl.ARRAY_BUFFER_BINDING,gl.BLEND,gl.BLEND_COLOR,gl.BLEND_SRC_ALPHA,gl.BLEND_SRC_RGB,gl.BLEND_DST_ALPHA,gl.BLEND_DST_RGB,gl.BLEND_EQUATION_ALPHA,gl.BLEND_EQUATION_RGB,gl.COLOR_WRITEMASK,gl.COLOR_CLEAR_VALUE,gl.CULL_FACE,gl.CULL_FACE_MODE,gl.CURRENT_PROGRAM,gl.DEPTH_CLEAR_VALUE,gl.DEPTH_FUNC,gl.DEPTH_RANGE,gl.DEPTH_WRITEMASK,gl.DITHER,gl.ELEMENT_ARRAY_BUFFER_BINDING,gl.FRAMEBUFFER_BINDING,gl.FRONT_FACE,gl.GENERATE_MIPMAP_HINT,gl.LINE_WIDTH,gl.PACK_ALIGNMENT,gl.POLYGON_OFFSET_FACTOR,gl.POLYGON_OFFSET_FILL,gl.POLYGON_OFFSET_UNITS,gl.RENDERBUFFER_BINDING,gl.SAMPLE_COVERAGE,gl.SAMPLE_COVERAGE_INVERT,gl.SAMPLE_COVERAGE_VALUE,gl.SCISSOR_BOX,gl.SCISSOR_TEST,gl.STENCIL_BACK_FAIL,gl.STENCIL_BACK_FUNC,gl.STENCIL_BACK_PASS_DEPTH_FAIL,gl.STENCIL_BACK_PASS_DEPTH_PASS,gl.STENCIL_BACK_REF,gl.STENCIL_BACK_VALUE_MASK,gl.STENCIL_BACK_WRITEMASK,gl.STENCIL_CLEAR_VALUE,gl.STENCIL_FAIL,gl.STENCIL_FUNC,gl.STENCIL_PASS_DEPTH_FAIL,gl.STENCIL_PASS_DEPTH_PASS,gl.STENCIL_REF,gl.STENCIL_TEST,gl.STENCIL_VALUE_MASK,gl.STENCIL_WRITEMASK,gl.TEXTURE,gl.UNPACK_ALIGNMENT,gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,gl.UNPACK_FLIP_Y_WEBGL,gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,gl.VIEWPORT]}var ctorBody=["'use strict'\nfunction StateStack(gl){this.gl=gl;"];var pushBody=["proto.push=function(){var gl=this.gl;"];var popBody=["proto.pop=function(){var gl=this.gl;"];var nvariables=variables.slice();nvariables.sort(function(a,b){return a-b});uniq(nvariables,undefined,true);var textureTypes=[gl.TEXTURE,gl.TEXTURE_2D,gl.TEXTURE_CUBE_MAP,gl.TEXTURE_BINDING_2D,gl.TEXTURE_BINDING_CUBE_MAP];if(textureTypes.some(function(v){return nvariables.indexOf(v)>=0})){var numTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);ctorBody.push("this.textures=[];");pushBody.push("var curTex=gl.getParameter(",gl.ACTIVE_TEXTURE,"),texState=new Array(",numTextures,");");for(var i=0;i<numTextures;++i){pushBody.push("gl.activeTexture(",gl.TEXTURE0+i,");texState[",i,"]=[gl.getParameter(",gl.TEXTURE_BINDING_2D,"),gl.getParameter(",gl.TEXTURE_BINDING_CUBE_MAP,")];")}pushBody.push("this.textures.push(texState);gl.activeTexture(curTex);");popBody.push("var texState=this.textures.pop();");var restoreActive=nvariables.indexOf(gl.ACTIVE_TEXTURE)<0;if(restoreActive){popBody.push("var curTex=gl.getParameter(",gl.ACTIVE_TEXTURE,");")}for(var i=0;i<numTextures;++i){popBody.push("gl.activeTexture(",gl.TEXTURE0+i,");","gl.bindTexture(",gl.TEXTURE_2D,",texState[",i,"][0]);","gl.bindTexture(",gl.TEXTURE_CUBE_MAP,",texState[",i,"][1]);")}if(restoreActive){popBody.push("gl.activeTexture(curTex);")}}var specialVars={blendEquationSeparate:[gl.BLEND_EQUATION_ALPHA,gl.BLEND_EQUATION_RGB],blendFuncSeparate:[gl.BLEND_SRC_RGB,gl.BLEND_DST_RGB,gl.BLEND_SRC_ALPHA,gl.BLEND_DST_ALPHA],sampleCoverage:[gl.SAMPLE_COVERAGE_INVERT,gl.SAMPLE_COVERAGE_VALUE],polygonOffset:[gl.POLYGON_OFFSET_FACTOR,gl.POLYGON_OFFSET_UNITS],stencilFuncSeparate_FRONT:[gl.STENCIL_FUNC,gl.STENCIL_REF,gl.STENCIL_VALUE_MASK],stencilFuncSeparate_BACK:[gl.STENCIL_BACK_FUNC,gl.STENCIL_BACK_REF,gl.STENCIL_BACK_VALUE_MASK],stencilOpSeparate_FRONT:[gl.STENCIL_FAIL,gl.STENCIL_PASS_DEPTH_FAIL,gl.STENCIL_PASS_DEPTH_PASS],stencilOpSeparate_BACK:[gl.STENCIL_BACK_FAIL,gl.STENCIL_BACK_PASS_DEPTH_FAIL,gl.STENCIL_BACK_PASS_DEPTH_PASS]};for(var id in specialVars){var params=specialVars[id];var variables=[];var snippets=[];for(var i=0;i<params.length;++i){var name="v"+params[i];var snip=[name,"=gl.getParameter(",params[i],");"].join("");variables.push(name);snippets.push(snip)}specialVars[id]={present:false,variables:variables,snippets:snippets,parameters:params}}main_loop:for(var i=0;i<nvariables.length;++i){var type=nvariables[i];if(textureTypes.indexOf(type)>=0){continue}var stateStack="this["+type+"]";ctorBody.push(stateStack,"=[];");switch(type){case gl.SAMPLE_COVERAGE:pushBody.push(stateStack,".push(gl.isEnabled(",gl.SAMPLE_COVERAGE,"));");break;default:pushBody.push(stateStack,".push(gl.getParameter(",type,"));");break}var sv=stateStack+".pop()";switch(type){case gl.ACTIVE_TEXTURE:popBody.push("gl.activeTexture(",sv,");");break;case gl.ARRAY_BUFFER_BINDING:popBody.push("gl.bindBuffer(",gl.ARRAY_BUFFER,",",sv,");");break;case gl.BLEND_COLOR:popBody.push("var c=",sv,";gl.blendColor(c[0], c[1], c[2], c[3]);");break;case gl.COLOR_CLEAR_VALUE:popBody.push("var c=",sv,";gl.clearColor(c[0], c[1], c[2], c[3]);");break;case gl.COLOR_WRITEMASK:popBody.push("var c=",sv,";gl.colorMask(c[0], c[1], c[2], c[3]);");break;case gl.CULL_FACE_MODE:popBody.push("gl.cullFace(",sv,");");break;case gl.CURRENT_PROGRAM:popBody.push("gl.useProgram(",sv,");");break;case gl.DEPTH_CLEAR_VALUE:popBody.push("gl.clearDepth(",sv,");");break;case gl.DEPTH_FUNC:popBody.push("gl.depthFunc(",sv,");");break;case gl.DEPTH_RANGE:popBody.push("var z=",sv,";gl.depthRange(z[0], z[1]);");break;case gl.DEPTH_WRITEMASK:popBody.push("gl.depthMask(",sv,");");break;case gl.ELEMENT_ARRAY_BUFFER_BINDING:popBody.push("gl.bindBuffer(",gl.ELEMENT_ARRAY_BUFFER,",",sv,");");break;case gl.FRAMEBUFFER_BINDING:popBody.push("gl.bindFramebuffer(",gl.FRAMEBUFFER,",",sv,");");break;case gl.FRONT_FACE:popBody.push("gl.frontFace(",sv,");");break;case gl.LINE_WIDTH:popBody.push("gl.lineWidth(",sv,");");break;case gl.RENDERBUFFER_BINDING:popBody.push("gl.bindRenderbuffer(",gl.RENDERBUFFER,",",sv,");");break;case gl.SCISSOR_BOX:popBody.push("var c=",sv,";gl.scissor(c[0],c[1],c[2],c[3]);");break;case gl.STENCIL_WRITEMASK:popBody.push("gl.stencilMaskSeparate(",gl.FRONT,",",sv,");");break;case gl.STENCIL_BACK_WRITEMASK:popBody.push("gl.stencilMaskSeparate(",gl.BACK,",",sv,");");break;case gl.STENCIL_CLEAR_VALUE:popBody.push("gl.clearStencil(",sv,");");break;case gl.VIEWPORT:popBody.push("var c=",sv,";gl.viewport(c[0],c[1],c[2],c[3]);");break;case gl.PACK_ALIGNMENT:case gl.UNPACK_ALIGNMENT:case gl.UNPACK_COLORSPACE_CONVERSION_WEBGL:case gl.UNPACK_FLIP_Y_WEBGL:case gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL:popBody.push("gl.pixelStorei(",type,",",sv,");");break;case gl.BLEND:case gl.CULL_FACE:case gl.DEPTH_TEST:case gl.DITHER:case gl.POLYGON_OFFSET_FILL:case gl.SAMPLE_COVERAGE:case gl.SCISSOR_TEST:case gl.STENCIL_TEST:popBody.push("if(",sv,"){gl.enable(",type,")}else{gl.disable(",type,")}");break;case gl.GENERATE_MIPMAP_HINT:popBody.push("gl.hint(",type,",",sv,");");break;default:for(var id in specialVars){var special=specialVars[id];var index=special.parameters.indexOf(type);if(index<0){continue}special.present=true;special.snippets[index]="var "+special.variables[index]+"="+sv+";";continue main_loop}throw new Error("gl-state: Error, unknown state parameter "+type)}}for(var id in specialVars){var data=specialVars[id];if(data.present){popBody.push.apply(popBody,data.snippets);var parts=id.split("_");if(parts.length===1){popBody.push("gl.",parts[0],"(",data.variables.join(","),");")}else{popBody.push("gl.",parts[0],"(gl.",parts[1],",",data.variables.join(","),");")}}}var code=[ctorBody.join(""),"};var proto=StateStack.prototype;",pushBody.join(""),"};",popBody.join(""),"};","return new StateStack(gl);"].join("");var proc=new Function("gl",code);return proc(gl)}},{uniq:37}],39:[function(require,module,exports){"use strict";function doBind(gl,elements,attributes){if(elements){elements.bind()}else{gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null)}var nattribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS)|0;if(attributes){if(attributes.length>nattribs){throw new Error("gl-vao: Too many vertex attributes")}for(var i=0;i<attributes.length;++i){var attrib=attributes[i];if(attrib.buffer){var buffer=attrib.buffer;var size=attrib.size||4;var type=attrib.type||gl.FLOAT;var normalized=!!attrib.normalized;var stride=attrib.stride||0;var offset=attrib.offset||0;buffer.bind();gl.enableVertexAttribArray(i);gl.vertexAttribPointer(i,size,type,normalized,stride,offset)}else{if(typeof attrib==="number"){gl.vertexAttrib1f(i,attrib)}else if(attrib.length===1){gl.vertexAttrib1f(i,attrib[0])}else if(attrib.length===2){gl.vertexAttrib2f(i,attrib[0],attrib[1])}else if(attrib.length===3){gl.vertexAttrib3f(i,attrib[0],attrib[1],attrib[2])}else if(attrib.length===4){gl.vertexAttrib4f(i,attrib[0],attrib[1],attrib[2],attrib[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}gl.disableVertexAttribArray(i)}}for(;i<nattribs;++i){gl.disableVertexAttribArray(i)}}else{gl.bindBuffer(gl.ARRAY_BUFFER,null);for(var i=0;i<nattribs;++i){gl.disableVertexAttribArray(i)}}}module.exports=doBind},{}],40:[function(require,module,exports){"use strict";var bindAttribs=require("./do-bind.js");function VAOEmulated(gl){this.gl=gl;this._elements=null;this._attributes=null;this._elementsType=gl.UNSIGNED_SHORT}VAOEmulated.prototype.bind=function(){bindAttribs(this.gl,this._elements,this._attributes)};VAOEmulated.prototype.update=function(attributes,elements,elementsType){this._elements=elements;this._attributes=attributes;this._elementsType=elementsType||this.gl.UNSIGNED_SHORT};VAOEmulated.prototype.dispose=function(){};VAOEmulated.prototype.unbind=function(){};VAOEmulated.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;if(this._elements){gl.drawElements(mode,count,this._elementsType,offset)}else{gl.drawArrays(mode,offset,count)}};function createVAOEmulated(gl){return new VAOEmulated(gl)}module.exports=createVAOEmulated},{"./do-bind.js":39}],41:[function(require,module,exports){"use strict";var bindAttribs=require("./do-bind.js");function VertexAttribute(location,dimension,a,b,c,d){this.location=location;this.dimension=dimension;this.a=a;this.b=b;this.c=c;this.d=d}VertexAttribute.prototype.bind=function(gl){switch(this.dimension){case 1:gl.vertexAttrib1f(this.location,this.a);break;case 2:gl.vertexAttrib2f(this.location,this.a,this.b);break;case 3:gl.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:gl.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function VAONative(gl,ext,handle){this.gl=gl;this._ext=ext;this.handle=handle;this._attribs=[];this._useElements=false;this._elementsType=gl.UNSIGNED_SHORT}VAONative.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var i=0;i<this._attribs.length;++i){this._attribs[i].bind(this.gl)}};VAONative.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};VAONative.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};VAONative.prototype.update=function(attributes,elements,elementsType){this.bind();bindAttribs(this.gl,elements,attributes);this.unbind();this._attribs.length=0;if(attributes)for(var i=0;i<attributes.length;++i){var a=attributes[i];if(typeof a==="number"){this._attribs.push(new VertexAttribute(i,1,a))}else if(Array.isArray(a)){this._attribs.push(new VertexAttribute(i,a.length,a[0],a[1],a[2],a[3]))}}this._useElements=!!elements;this._elementsType=elementsType||this.gl.UNSIGNED_SHORT};VAONative.prototype.draw=function(mode,count,offset){offset=offset||0;var gl=this.gl;if(this._useElements){gl.drawElements(mode,count,this._elementsType,offset)}else{gl.drawArrays(mode,offset,count)}};function createVAONative(gl,ext){return new VAONative(gl,ext,ext.createVertexArrayOES())}module.exports=createVAONative},{"./do-bind.js":39}],42:[function(require,module,exports){void function(global,undefined_,undefined){var getProps=Object.getOwnPropertyNames,defProp=Object.defineProperty,toSource=Function.prototype.toString,create=Object.create,hasOwn=Object.prototype.hasOwnProperty,funcName=/^\n?function\s?(\w*)?_?\(/;function define(object,key,value){if(typeof key==="function"){value=key;key=nameOf(value).replace(/_$/,"")}return defProp(object,key,{configurable:true,writable:true,value:value})}function nameOf(func){return typeof func!=="function"?"":"name"in func?func.name:toSource.call(func).match(funcName)[1]}var Data=function(){var dataDesc={value:{writable:true,value:undefined}},datalock="return function(k){if(k===s)return l}",uids=create(null),createUID=function(){var key=Math.random().toString(36).slice(2);return key in uids?createUID():uids[key]=key},globalID=createUID(),storage=function(obj){if(hasOwn.call(obj,globalID))return obj[globalID];if(!Object.isExtensible(obj))throw new TypeError("Object must be extensible");var store=create(null);defProp(obj,globalID,{value:store});return store};define(Object,function getOwnPropertyNames(obj){var props=getProps(obj);if(hasOwn.call(obj,globalID))props.splice(props.indexOf(globalID),1);return props});function Data(){var puid=createUID(),secret={};this.unlock=function(obj){var store=storage(obj);if(hasOwn.call(store,puid))return store[puid](secret);var data=create(null,dataDesc);defProp(store,puid,{value:new Function("s","l",datalock)(secret,data)});return data}}define(Data.prototype,function get(o){return this.unlock(o).value});define(Data.prototype,function set(o,v){this.unlock(o).value=v});return Data}();var WM=function(data){var validate=function(key){if(key==null||typeof key!=="object"&&typeof key!=="function")throw new TypeError("Invalid WeakMap key")};var wrap=function(collection,value){var store=data.unlock(collection);if(store.value)throw new TypeError("Object is already a WeakMap");store.value=value};var unwrap=function(collection){var storage=data.unlock(collection).value;if(!storage)throw new TypeError("WeakMap is not generic");return storage};var initialize=function(weakmap,iterable){if(iterable!==null&&typeof iterable==="object"&&typeof iterable.forEach==="function"){iterable.forEach(function(item,i){if(item instanceof Array&&item.length===2)set.call(weakmap,iterable[i][0],iterable[i][1])})}};function WeakMap(iterable){if(this===global||this==null||this===WeakMap.prototype)return new WeakMap(iterable);wrap(this,new Data);initialize(this,iterable)}function get(key){validate(key);var value=unwrap(this).get(key);return value===undefined_?undefined:value}function set(key,value){validate(key);unwrap(this).set(key,value===undefined?undefined_:value)}function has(key){validate(key);return unwrap(this).get(key)!==undefined}function delete_(key){validate(key);var data=unwrap(this),had=data.get(key)!==undefined;data.set(key,undefined);return had}function toString(){unwrap(this);return"[object WeakMap]"}try{var src=("return "+delete_).replace("e_","\\u0065"),del=new Function("unwrap","validate",src)(unwrap,validate)}catch(e){var del=delete_}var src=(""+Object).split("Object");var stringifier=function toString(){return src[0]+nameOf(this)+src[1]};define(stringifier,stringifier);var prep={__proto__:[]}instanceof Array?function(f){f.__proto__=stringifier}:function(f){define(f,stringifier)};prep(WeakMap);[toString,get,set,has,del].forEach(function(method){define(WeakMap.prototype,method);prep(method)});return WeakMap}(new Data);var defaultCreator=Object.create?function(){return Object.create(null)}:function(){return{}};function createStorage(creator){var weakmap=new WM;creator||(creator=defaultCreator);function storage(object,value){if(value||arguments.length===2){weakmap.set(object,value)}else{value=weakmap.get(object);if(value===undefined){value=creator(object);weakmap.set(object,value)}}return value}return storage}if(typeof module!=="undefined"){module.exports=WM}else if(typeof exports!=="undefined"){exports.WeakMap=WM}else if(!("WeakMap"in global)){global.WeakMap=WM}WM.createStorage=createStorage;if(global.WeakMap)global.WeakMap.createStorage=createStorage}((0,eval)("this"))},{}],43:[function(require,module,exports){"use strict";var weakMap=typeof WeakMap==="undefined"?require("weakmap"):WeakMap;var WebGLEWStruct=new weakMap;function baseName(ext_name){return ext_name.replace(/^[A-Z]+_/,"")}function initWebGLEW(gl){var struct=WebGLEWStruct.get(gl);if(struct){return struct}var extensions={};var supported=gl.getSupportedExtensions();for(var i=0;i<supported.length;++i){var extName=supported[i];if(extName.indexOf("MOZ_")===0){continue}var ext=gl.getExtension(supported[i]);if(!ext){continue}while(true){extensions[extName]=ext;var base=baseName(extName);if(base===extName){break}extName=base}}WebGLEWStruct.set(gl,extensions);return extensions}module.exports=initWebGLEW},{weakmap:42}],44:[function(require,module,exports){"use strict";var webglew=require("webglew");var createVAONative=require("./lib/vao-native.js");var createVAOEmulated=require("./lib/vao-emulated.js");function createVAO(gl,attributes,elements,elementsType){var ext=webglew(gl).OES_vertex_array_object;var vao;if(ext){vao=createVAONative(gl,ext)}else{vao=createVAOEmulated(gl)}vao.update(attributes,elements,elementsType);return vao}module.exports=createVAO},{"./lib/vao-emulated.js":40,"./lib/vao-native.js":41,webglew:43}],45:[function(require,module,exports){module.exports=programify;var shader=require("gl-shader-core");function programify(vertex,fragment,uniforms,attributes){return function(gl){return shader(gl,vertex,fragment,uniforms,attributes)}}},{"gl-shader-core":51}],46:[function(require,module,exports){module.exports=noop;function noop(){throw new Error("You should bundle your code "+"using `glslify` as a transform.")}},{}],47:[function(require,module,exports){"use strict";module.exports=createAttributeWrapper;function ShaderAttribute(gl,program,location,dimension,name,constFunc,relink){this._gl=gl;this._program=program;this._location=location;this._dimension=dimension;this._name=name;this._constFunc=constFunc;this._relink=relink}var proto=ShaderAttribute.prototype;proto.pointer=function setAttribPointer(type,normalized,stride,offset){var gl=this._gl;gl.vertexAttribPointer(this._location,this._dimension,type||gl.FLOAT,!!normalized,stride||0,offset||0);this._gl.enableVertexAttribArray(this._location)};Object.defineProperty(proto,"location",{get:function(){return this._location},set:function(v){if(v!==this._location){this._location=v;this._gl.bindAttribLocation(this._program,v,this._name);this._gl.linkProgram(this._program);this._relink()}}});function addVectorAttribute(gl,program,location,dimension,obj,name,doLink){var constFuncArgs=["gl","v"];var varNames=[];for(var i=0;i<dimension;++i){constFuncArgs.push("x"+i);varNames.push("x"+i)}constFuncArgs.push(["if(x0.length===void 0){return gl.vertexAttrib",dimension,"f(v,",varNames.join(),")}else{return gl.vertexAttrib",dimension,"fv(v,x0)}"].join(""));var constFunc=Function.apply(undefined,constFuncArgs);var attr=new ShaderAttribute(gl,program,location,dimension,name,constFunc,doLink);Object.defineProperty(obj,name,{set:function(x){gl.disableVertexAttribArray(attr._location);constFunc(gl,attr._location,x);return x},get:function(){return attr},enumerable:true})}function createAttributeWrapper(gl,program,attributes,doLink){var obj={};for(var i=0,n=attributes.length;i<n;++i){var a=attributes[i];var name=a.name;var type=a.type;var location=gl.getAttribLocation(program,name);switch(type){case"bool":case"int":case"float":addVectorAttribute(gl,program,location,1,obj,name,doLink);break;default:if(type.indexOf("vec")>=0){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid data type for attribute "+name+": "+type)}addVectorAttribute(gl,program,location,d,obj,name,doLink)}else{throw new Error("gl-shader: Unknown data type for attribute "+name+": "+type)}break}}return obj}},{}],48:[function(require,module,exports){"use strict";var dup=require("dup");var coallesceUniforms=require("./reflect");module.exports=createUniformWrapper;function identity(x){var c=new Function("y","return function(){return y}");return c(x)}function createUniformWrapper(gl,program,uniforms,locations){function makeGetter(index){var proc=new Function("gl","prog","locations","return function(){return gl.getUniform(prog,locations["+index+"])}");return proc(gl,program,locations)}function makePropSetter(path,index,type){switch(type){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+index+"],obj"+path+")";case"float":return"gl.uniform1f(locations["+index+"],obj"+path+")";default:var vidx=type.indexOf("vec");if(0<=vidx&&vidx<=1&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid data type")}switch(type.charAt(0)){case"b":case"i":return"gl.uniform"+d+"iv(locations["+index+"],obj"+path+")";case"v":return"gl.uniform"+d+"fv(locations["+index+"],obj"+path+")";default:throw new Error("gl-shader: Unrecognized data type for vector "+name+": "+type)}}else if(type.indexOf("mat")===0&&type.length===4){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+type)}return"gl.uniformMatrix"+d+"fv(locations["+index+"],false,obj"+path+")"}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+type)}break}}function enumerateIndices(prefix,type){if(typeof type!=="object"){return[[prefix,type]]}var indices=[];for(var id in type){var prop=type[id];var tprefix=prefix;if(parseInt(id)+""===id){tprefix+="["+id+"]"}else{tprefix+="."+id}if(typeof prop==="object"){indices.push.apply(indices,enumerateIndices(tprefix,prop))}else{indices.push([tprefix,prop])}}return indices}function makeSetter(type){var code=["return function updateProperty(obj){"];var indices=enumerateIndices("",type);for(var i=0;i<indices.length;++i){var item=indices[i];var path=item[0];var idx=item[1];if(locations[idx]){code.push(makePropSetter(path,idx,uniforms[idx].type))}}code.push("return obj}");var proc=new Function("gl","prog","locations",code.join("\n"));return proc(gl,program,locations)}function defaultValue(type){switch(type){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var vidx=type.indexOf("vec");if(0<=vidx&&vidx<=1&&type.length===4+vidx){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid data type")}if(type.charAt(0)==="b"){return dup(d,false)}return dup(d)}else if(type.indexOf("mat")===0&&type.length===4){var d=type.charCodeAt(type.length-1)-48;if(d<2||d>4){throw new Error("gl-shader: Invalid uniform dimension type for matrix "+name+": "+type)}return dup([d,d])}else{throw new Error("gl-shader: Unknown uniform data type for "+name+": "+type)}break}}function storeProperty(obj,prop,type){if(typeof type==="object"){var child=processObject(type);Object.defineProperty(obj,prop,{get:identity(child),set:makeSetter(type),enumerable:true,configurable:false})}else{if(locations[type]){Object.defineProperty(obj,prop,{get:makeGetter(type),set:makeSetter(type),enumerable:true,configurable:false})}else{obj[prop]=defaultValue(uniforms[type].type)}}}function processObject(obj){var result;if(Array.isArray(obj)){result=new Array(obj.length);for(var i=0;i<obj.length;++i){storeProperty(result,i,obj[i])}}else{result={};for(var id in obj){storeProperty(result,id,obj[id])}}return result}var coallesced=coallesceUniforms(uniforms,true);return{get:identity(processObject(coallesced)),set:makeSetter(coallesced),enumerable:true,configurable:true}}},{"./reflect":49,dup:50}],49:[function(require,module,exports){"use strict";module.exports=makeReflectTypes;function makeReflectTypes(uniforms,useIndex){var obj={};for(var i=0;i<uniforms.length;++i){var n=uniforms[i].name;var parts=n.split(".");var o=obj;for(var j=0;j<parts.length;++j){var x=parts[j].split("[");if(x.length>1){if(!(x[0]in o)){o[x[0]]=[]}o=o[x[0]];for(var k=1;k<x.length;++k){var y=parseInt(x[k]);if(k<x.length-1||j<parts.length-1){if(!(y in o)){if(k<x.length-1){o[y]=[]}else{o[y]={}}}o=o[y]}else{if(useIndex){o[y]=i}else{o[y]=uniforms[i].type}}}}else if(j<parts.length-1){if(!(x[0]in o)){o[x[0]]={}}o=o[x[0]]}else{if(useIndex){o[x[0]]=i}else{o[x[0]]=uniforms[i].type}}}}return obj}},{}],50:[function(require,module,exports){"use strict";function dupe_array(count,value,i){var c=count[i]|0;if(c<=0){return[]}var result=new Array(c),j;if(i===count.length-1){for(j=0;j<c;++j){result[j]=value}}else{for(j=0;j<c;++j){result[j]=dupe_array(count,value,i+1)}}return result}function dupe_number(count,value){var result,i;result=new Array(count);for(i=0;i<count;++i){result[i]=value}return result}function dupe(count,value){if(typeof value==="undefined"){value=0}switch(typeof count){case"number":if(count>0){return dupe_number(count|0,value)}break;case"object":if(typeof count.length==="number"){return dupe_array(count,value,0)}break}return[]}module.exports=dupe},{}],51:[function(require,module,exports){"use strict";var createUniformWrapper=require("./lib/create-uniforms");var createAttributeWrapper=require("./lib/create-attributes");var makeReflect=require("./lib/reflect");function Shader(gl,prog,vertShader,fragShader){this.gl=gl;this.handle=prog;this.attributes=null;this.uniforms=null;this.types=null;this.vertexShader=vertShader;this.fragmentShader=fragShader}Shader.prototype.bind=function(){this.gl.useProgram(this.handle)};Shader.prototype.dispose=function(){var gl=this.gl;gl.deleteShader(this.vertexShader);gl.deleteShader(this.fragmentShader);gl.deleteProgram(this.handle)};Shader.prototype.updateExports=function(uniforms,attributes){var locations=new Array(uniforms.length);var program=this.handle;var gl=this.gl;var doLink=relinkUniforms.bind(void 0,gl,program,locations,uniforms);doLink();this.types={uniforms:makeReflect(uniforms),attributes:makeReflect(attributes)};this.attributes=createAttributeWrapper(gl,program,attributes,doLink);Object.defineProperty(this,"uniforms",createUniformWrapper(gl,program,uniforms,locations))};function relinkUniforms(gl,program,locations,uniforms){for(var i=0;i<uniforms.length;++i){locations[i]=gl.getUniformLocation(program,uniforms[i].name)}}function createShader(gl,vertSource,fragSource,uniforms,attributes){var vertShader=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(vertShader,vertSource);gl.compileShader(vertShader);if(!gl.getShaderParameter(vertShader,gl.COMPILE_STATUS)){var errLog=gl.getShaderInfoLog(vertShader);console.error("gl-shader: Error compling vertex shader:",errLog);throw new Error("gl-shader: Error compiling vertex shader:"+errLog)}var fragShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(fragShader,fragSource);gl.compileShader(fragShader);if(!gl.getShaderParameter(fragShader,gl.COMPILE_STATUS)){var errLog=gl.getShaderInfoLog(fragShader);console.error("gl-shader: Error compiling fragment shader:",errLog);throw new Error("gl-shader: Error compiling fragment shader:"+errLog)}var program=gl.createProgram();gl.attachShader(program,fragShader);gl.attachShader(program,vertShader);attributes.forEach(function(a){if(typeof a.location==="number")gl.bindAttribLocation(program,a.location,a.name)});gl.linkProgram(program);if(!gl.getProgramParameter(program,gl.LINK_STATUS)){var errLog=gl.getProgramInfoLog(program);console.error("gl-shader: Error linking shader program:",errLog);throw new Error("gl-shader: Error linking shader program:"+errLog)}var shader=new Shader(gl,program,vertShader,fragShader);shader.updateExports(uniforms,attributes);return shader}module.exports=createShader},{"./lib/create-attributes":47,"./lib/create-uniforms":48,"./lib/reflect":49}],52:[function(require,module,exports){"use strict";var robustDot=require("robust-dot-product");var robustSum=require("robust-sum");module.exports=splitPolygon;module.exports.positive=positive;module.exports.negative=negative;function planeT(p,plane){var r=robustSum(robustDot(p,plane),[plane[plane.length-1]]);return r[r.length-1]}function lerpW(a,wa,b,wb){var d=wb-wa;var t=-wa/d;if(t<0){t=0}else if(t>1){t=1}var ti=1-t;var n=a.length;var r=new Array(n);for(var i=0;i<n;++i){r[i]=t*a[i]+ti*b[i]}return r}function splitPolygon(points,plane){var pos=[];var neg=[];var a=planeT(points[points.length-1],plane);for(var s=points[points.length-1],t=points[0],i=0;i<points.length;++i,s=t){t=points[i];var b=planeT(t,plane);if(a<0&&b>0||a>0&&b<0){var p=lerpW(s,b,t,a);pos.push(p);neg.push(p.slice())}if(b<0){neg.push(t.slice())}else if(b>0){pos.push(t.slice())}else{pos.push(t.slice());neg.push(t.slice())}a=b}return{positive:pos,negative:neg}}function positive(points,plane){var pos=[];var a=planeT(points[points.length-1],plane);for(var s=points[points.length-1],t=points[0],i=0;i<points.length;++i,s=t){t=points[i];var b=planeT(t,plane);if(a<0&&b>0||a>0&&b<0){pos.push(lerpW(s,b,t,a))}if(b>=0){pos.push(t.slice())}a=b}return pos}function negative(points,plane){var neg=[];var a=planeT(points[points.length-1],plane);for(var s=points[points.length-1],t=points[0],i=0;i<points.length;++i,s=t){t=points[i];var b=planeT(t,plane);if(a<0&&b>0||a>0&&b<0){neg.push(lerpW(s,b,t,a))}if(b<=0){neg.push(t.slice())}a=b}return neg}},{"robust-dot-product":53,"robust-sum":55}],53:[function(require,module,exports){"use strict";var twoProduct=require("two-product");var robustSum=require("robust-sum");module.exports=robustDotProduct;function robustDotProduct(a,b){var r=twoProduct(a[0],b[0]);for(var i=1;i<a.length;++i){r=robustSum(r,twoProduct(a[i],b[i]))}return r}},{"robust-sum":55,"two-product":54}],54:[function(require,module,exports){module.exports=require(22)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/two-product/two-product.js":22}],55:[function(require,module,exports){module.exports=require(21)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-sum/robust-sum.js":21}],56:[function(require,module,exports){"use strict";module.exports=createText;var vectorizeText=require("./lib/vtext");var Canvas=require("canvas-browserify");var canvas=new Canvas(8192,256);var context=canvas.getContext("2d");function createText(str,options){if(typeof options!=="object"||options===null){options={}}return vectorizeText(str,canvas,context,options)}},{"./lib/vtext":57,"canvas-browserify":58}],57:[function(require,module,exports){"use strict";module.exports=vectorizeText;var surfaceNets=require("surface-nets");var ndarray=require("ndarray");var simplify=require("simplify-planar-graph");var toPolygons=require("planar-graph-to-polyline");var triangulate=require("triangulate-polyline");function transformPositions(positions,options,size){var align=options.textAlign||"start";var baseline=options.textBaseline||"alphabetic";var lo=[1<<30,1<<30];var hi=[0,0];var n=positions.length;for(var i=0;i<n;++i){var p=positions[i];for(var j=0;j<2;++j){lo[j]=Math.min(lo[j],p[j])|0;hi[j]=Math.max(hi[j],p[j])|0}}var xShift=0;switch(align){case"center":xShift=-.5*(lo[0]+hi[0]);break;case"right":case"end":xShift=-hi[0];break;case"left":case"start":xShift=-lo[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+align+"'")}var yShift=0;switch(baseline){case"hanging":case"top":yShift=-lo[1];break;case"middle":yShift=-.5*(lo[1]+hi[1]);break;case"alphabetic":case"ideographic":yShift=-3*size;break;case"bottom":yShift=-hi[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+baseline+"'")}var scale=1/size;if("lineHeight"in options){scale*=+options.lineHeight}else if("width"in options){scale=(hi[0]-lo[0])/options.width}else if("height"in options){scale=(hi[1]-lo[1])/options.height}return positions.map(function(p){return[scale*(p[0]+xShift),scale*(p[1]+yShift)]})}function vectorizeText(str,canvas,context,options){var size=options.size||64;var family=options.font||"normal";context.font=size+"px "+family;context.textAlign="start";context.textBaseline="alphabetic";context.direction="ltr";var width=Math.ceil(context.measureText(str).width+10)|0;if(width>8192){throw new Error("vectorize-text: String too long (sorry, this will get fixed later)")}var height=4*size;if(canvas.height<height){canvas.height=height}context.fillStyle="#000";context.fillRect(0,0,width,height);context.fillStyle="#fff";context.fillText(str,5,3*size|0);var pixelData=context.getImageData(0,0,width,height);var pixels=ndarray(pixelData.data,[height,width,4]);var contour=surfaceNets(pixels.pick(-1,-1,0).transpose(1,0),128);contour=simplify(contour.cells,contour.positions,.25);var npositions=transformPositions(contour.positions,options,size);var flip="ccw"===options.orientation;if(options.polygons||options.polygon||options.polyline){var polygons=toPolygons(contour.edges,contour.positions);return polygons.map(function(polygon){if(flip){polygon.reverse()}return polygon.map(function(loop){return loop.map(function(v){return npositions[v]})})})}else if(options.triangles||options.triangulate||options.triangle){var polygons=toPolygons(contour.edges,contour.positions);var triangles=[];for(var i=0;i<polygons.length;++i){triangles.push.apply(triangles,triangulate(polygons[i],contour.positions))}if(flip){for(var i=0;i<triangles.length;++i){var c=triangles[i];var tmp=c[0];c[0]=c[2];c[2]=tmp}}return{cells:triangles,positions:npositions}}else{return{edges:contour.edges,positions:npositions}}}},{ndarray:412,"planar-graph-to-polyline":79,"simplify-planar-graph":89,"surface-nets":108,"triangulate-polyline":119}],58:[function(require,module,exports){var Canvas=module.exports=function Canvas(w,h){var canvas=document.createElement("canvas");canvas.width=w||300;canvas.height=h||150;return canvas};Canvas.Image=function(){var img=document.createElement("img");return img}},{}],59:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],60:[function(require,module,exports){"use strict";module.exports=edgeToAdjacency;var uniq=require("uniq");function edgeToAdjacency(edges,numVertices){var numEdges=edges.length;if(typeof numVertices!=="number"){numVertices=0;for(var i=0;i<numEdges;++i){var e=edges[i];numVertices=Math.max(numVertices,e[0],e[1])}numVertices=(numVertices|0)+1}numVertices=numVertices|0;var adj=new Array(numVertices);for(var i=0;i<numVertices;++i){adj[i]=[]}for(var i=0;i<numEdges;++i){var e=edges[i];adj[e[0]].push(e[1]);adj[e[1]].push(e[0])}for(var j=0;j<numVertices;++j){uniq(adj[j],function(a,b){return a-b})}return adj}},{uniq:78}],61:[function(require,module,exports){"use strict";module.exports=planarDual;var compareAngle=require("compare-angle");function planarDual(cells,positions){var numVertices=positions.length|0;var numEdges=cells.length;var adj=[new Array(numVertices),new Array(numVertices)];for(var i=0;i<numVertices;++i){adj[0][i]=[];adj[1][i]=[]}for(var i=0;i<numEdges;++i){var c=cells[i];adj[0][c[0]].push(c);adj[1][c[1]].push(c)}var cycles=[];for(var i=0;i<numVertices;++i){if(adj[0][i].length+adj[1][i].length===0){cycles.push([i])}}function cut(c,i){var a=adj[i][c[i]];a.splice(a.indexOf(c),1)}function next(a,b,noCut){var nextCell,nextVertex,nextDir;for(var i=0;i<2;++i){if(adj[i][b].length>0){nextCell=adj[i][b][0];nextDir=i;break}}nextVertex=nextCell[nextDir^1];for(var dir=0;dir<2;++dir){var nbhd=adj[dir][b];for(var k=0;k<nbhd.length;++k){var e=nbhd[k];var p=e[dir^1];var cmp=compareAngle(positions[a],positions[b],positions[nextVertex],positions[p]);if(cmp>0){nextCell=e;nextVertex=p;nextDir=dir}}}if(noCut){return nextVertex}if(nextCell){cut(nextCell,nextDir)}return nextVertex}function extractCycle(v,dir){var e0=adj[dir][v][0];var cycle=[v];cut(e0,dir);var u=e0[dir^1];var d0=dir;while(true){while(u!==v){cycle.push(u);u=next(cycle[cycle.length-2],u,false)}if(adj[0][v].length+adj[1][v].length===0){break}var a=cycle[cycle.length-1];var b=v;var c=cycle[1];var d=next(a,b,true);if(compareAngle(positions[a],positions[b],positions[c],positions[d])<0){break}cycle.push(v);u=next(a,b)}return cycle}function shouldGlue(pcycle,ncycle){return ncycle[1]===ncycle[ncycle.length-1]}for(var i=0;i<numVertices;++i){for(var j=0;j<2;++j){var pcycle=[];while(adj[j][i].length>0){var ni=adj[0][i].length;var ncycle=extractCycle(i,j);if(shouldGlue(pcycle,ncycle)){pcycle.push.apply(pcycle,ncycle)}else{if(pcycle.length>0){cycles.push(pcycle)}pcycle=ncycle}}if(pcycle.length>0){cycles.push(pcycle)}}}return cycles}},{"compare-angle":62}],62:[function(require,module,exports){"use strict";module.exports=compareAngle;var orient=require("robust-orientation");var sgn=require("signum");var twoSum=require("two-sum");var robustProduct=require("robust-product");var robustSum=require("robust-sum");function testInterior(a,b,c){var x0=twoSum(a[0],-b[0]);var y0=twoSum(a[1],-b[1]);var x1=twoSum(c[0],-b[0]);var y1=twoSum(c[1],-b[1]);var d=robustSum(robustProduct(x0,x1),robustProduct(y0,y1));return d[d.length-1]>=0}function compareAngle(a,b,c,d){var bcd=orient(b,c,d);if(bcd===0){var sabc=sgn(orient(a,b,c));var sabd=sgn(orient(a,b,d));if(sabc===sabd){if(sabc===0){var ic=testInterior(a,b,c);var id=testInterior(a,b,d);if(ic===id){return 0}else if(ic){return 1}else{return-1}}return 0}else if(sabd===0){if(sabc>0){return-1}else if(testInterior(a,b,d)){return-1}else{return 1}}else if(sabc===0){if(sabd>0){return 1}else if(testInterior(a,b,c)){return 1}else{return-1}}return sgn(sabd-sabc)}var abc=orient(a,b,c);if(abc>0){if(bcd>0&&orient(a,b,d)>0){return 1}return-1}else if(abc<0){if(bcd>0||orient(a,b,d)>0){return 1}return-1}else{var abd=orient(a,b,d);if(abd>0){return 1}else{if(testInterior(a,b,c)){return 1}else{return-1}}}}},{"robust-orientation":75,"robust-product":64,"robust-sum":76,signum:65,"two-sum":66}],63:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":77,"two-sum":66}],64:[function(require,module,exports){"use strict";var robustSum=require("robust-sum");var robustScale=require("robust-scale");module.exports=robustProduct;function robustProduct(a,b){if(a.length===1){return robustScale(b,a[0])}if(b.length===1){return robustScale(a,b[0])}if(a.length===0||b.length===0){return[0]}var r=[0];if(a.length<b.length){for(var i=0;i<a.length;++i){r=robustSum(r,robustScale(b,a[i]))}}else{for(var i=0;i<b.length;++i){r=robustSum(r,robustScale(a,b[i]))}}return r}},{"robust-scale":63,"robust-sum":76}],65:[function(require,module,exports){"use strict";module.exports=function signum(x){if(x<0){return-1}if(x>0){return 1}return 0}},{}],66:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],67:[function(require,module,exports){"use strict";module.exports=orderSegments;var orient=require("robust-orientation");function horizontalOrder(a,b){var bl,br;if(b[0][0]<b[1][0]){bl=b[0];br=b[1]}else if(b[0][0]>b[1][0]){bl=b[1];br=b[0]}else{var alo=Math.min(a[0][1],a[1][1]);var ahi=Math.max(a[0][1],a[1][1]);var blo=Math.min(b[0][1],b[1][1]);var bhi=Math.max(b[0][1],b[1][1]);if(ahi<blo){return ahi-blo}if(alo>bhi){return alo-bhi}return ahi-bhi}var al,ar;if(a[0][1]<a[1][1]){al=a[0];ar=a[1]}else{al=a[1];ar=a[0]}var d=orient(br,bl,al);if(d){return d}d=orient(br,bl,ar);if(d){return d}return ar-br}function orderSegments(b,a){var al,ar;if(a[0][0]<a[1][0]){al=a[0];ar=a[1]}else if(a[0][0]>a[1][0]){al=a[1];ar=a[0]}else{return horizontalOrder(a,b)}var bl,br;if(b[0][0]<b[1][0]){bl=b[0];br=b[1]}else if(b[0][0]>b[1][0]){bl=b[1];br=b[0]}else{return-horizontalOrder(b,a)}var d1=orient(al,ar,br);var d2=orient(al,ar,bl);if(d1<0){if(d2<=0){return d1}}else if(d1>0){if(d2>=0){return d1}}else if(d2){return d2}d1=orient(br,bl,ar);d2=orient(br,bl,al);if(d1<0){if(d2<=0){return d1}}else if(d1>0){if(d2>=0){return d1}}else if(d2){return d2}return ar[0]-br[0]}},{"robust-orientation":75}],68:[function(require,module,exports){"use strict";function compileSearch(funcName,predicate,reversed,extraArgs,useNdarray,earlyOut){var code=["function ",funcName,"(a,l,h,",extraArgs.join(","),"){",earlyOut?"":"var i=",reversed?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",useNdarray?".get(m)":"[m]"];if(earlyOut){if(predicate.indexOf("c")<0){code.push(";if(x===y){return m}else if(x<=y){")}else{code.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{code.push(";if(",predicate,"){i=m;")}if(reversed){code.push("l=m+1}else{h=m-1}")}else{code.push("h=m-1}else{l=m+1}")}code.push("}");if(earlyOut){code.push("return -1};")}else{code.push("return i};")}return code.join("")}function compileBoundsSearch(predicate,reversed,suffix,earlyOut){var result=new Function([compileSearch("A","x"+predicate+"y",reversed,["y"],false,earlyOut),compileSearch("B","x"+predicate+"y",reversed,["y"],true,earlyOut),compileSearch("P","c(x,y)"+predicate+"0",reversed,["y","c"],false,earlyOut),compileSearch("Q","c(x,y)"+predicate+"0",reversed,["y","c"],true,earlyOut),"function dispatchBsearch",suffix,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",suffix].join(""));return result()}module.exports={ge:compileBoundsSearch(">=",false,"GE"),gt:compileBoundsSearch(">",false,"GT"),lt:compileBoundsSearch("<",true,"LT"),le:compileBoundsSearch("<=",true,"LE"),eq:compileBoundsSearch("-",true,"EQ",true)}},{}],69:[function(require,module,exports){"use strict";module.exports=createRBTree;var RED=0;var BLACK=1;function RBNode(color,key,value,left,right,count){this._color=color;this.key=key;this.value=value;this.left=left;this.right=right;this._count=count}function cloneNode(node){return new RBNode(node._color,node.key,node.value,node.left,node.right,node._count)}function repaint(color,node){return new RBNode(color,node.key,node.value,node.left,node.right,node._count)}function recount(node){node._count=1+(node.left?node.left._count:0)+(node.right?node.right._count:0)}function RedBlackTree(compare,root){this._compare=compare;this.root=root}var proto=RedBlackTree.prototype;Object.defineProperty(proto,"keys",{get:function(){var result=[];this.forEach(function(k,v){result.push(k)});return result}});Object.defineProperty(proto,"values",{get:function(){var result=[];this.forEach(function(k,v){result.push(v)});return result}});Object.defineProperty(proto,"length",{get:function(){if(this.root){return this.root._count}return 0}});proto.insert=function(key,value){var cmp=this._compare;var n=this.root;var n_stack=[];var d_stack=[];while(n){var d=cmp(key,n.key);n_stack.push(n);d_stack.push(d);if(d<=0){n=n.left}else{n=n.right}}n_stack.push(new RBNode(RED,key,value,null,null,1));for(var s=n_stack.length-2;s>=0;--s){var n=n_stack[s];if(d_stack[s]<=0){n_stack[s]=new RBNode(n._color,n.key,n.value,n_stack[s+1],n.right,n._count+1)}else{n_stack[s]=new RBNode(n._color,n.key,n.value,n.left,n_stack[s+1],n._count+1)}}for(var s=n_stack.length-1;s>1;--s){var p=n_stack[s-1];var n=n_stack[s];if(p._color===BLACK||n._color===BLACK){break}var pp=n_stack[s-2];if(pp.left===p){if(p.left===n){var y=pp.right;if(y&&y._color===RED){p._color=BLACK;pp.right=repaint(BLACK,y);pp._color=RED;s-=1}else{pp._color=RED;pp.left=p.right;p._color=BLACK;p.right=pp;n_stack[s-2]=p;n_stack[s-1]=n;recount(pp);recount(p);if(s>=3){var ppp=n_stack[s-3];if(ppp.left===pp){ppp.left=p}else{ppp.right=p}}break}}else{var y=pp.right;if(y&&y._color===RED){p._color=BLACK;pp.right=repaint(BLACK,y);pp._color=RED;s-=1}else{p.right=n.left;pp._color=RED;pp.left=n.right;n._color=BLACK;n.left=p;n.right=pp;n_stack[s-2]=n;n_stack[s-1]=p;recount(pp);recount(p);recount(n);if(s>=3){var ppp=n_stack[s-3];if(ppp.left===pp){ppp.left=n}else{ppp.right=n}}break}}}else{if(p.right===n){var y=pp.left;if(y&&y._color===RED){p._color=BLACK;pp.left=repaint(BLACK,y);pp._color=RED;s-=1}else{pp._color=RED;pp.right=p.left;p._color=BLACK;p.left=pp;n_stack[s-2]=p;n_stack[s-1]=n;recount(pp);recount(p);if(s>=3){var ppp=n_stack[s-3];if(ppp.right===pp){ppp.right=p}else{ppp.left=p}}break}}else{var y=pp.left;if(y&&y._color===RED){p._color=BLACK;pp.left=repaint(BLACK,y);pp._color=RED;s-=1}else{p.left=n.right;pp._color=RED;pp.right=n.left;n._color=BLACK;n.right=p;n.left=pp;n_stack[s-2]=n;n_stack[s-1]=p;recount(pp);recount(p);recount(n);if(s>=3){var ppp=n_stack[s-3];if(ppp.right===pp){ppp.right=n}else{ppp.left=n}}break}}}}n_stack[0]._color=BLACK;return new RedBlackTree(cmp,n_stack[0])};function doVisitFull(visit,node){if(node.left){var v=doVisitFull(visit,node.left);if(v){return v}}var v=visit(node.key,node.value);if(v){return v}if(node.right){return doVisitFull(visit,node.right)}}function doVisitHalf(lo,compare,visit,node){var l=compare(lo,node.key);if(l<=0){if(node.left){var v=doVisitHalf(lo,compare,visit,node.left);if(v){return v}}var v=visit(node.key,node.value);if(v){return v}}if(node.right){return doVisitHalf(lo,compare,visit,node.right)}}function doVisit(lo,hi,compare,visit,node){var l=compare(lo,node.key);var h=compare(hi,node.key);var v;if(l<=0){if(node.left){v=doVisit(lo,hi,compare,visit,node.left);if(v){return v}}if(h>0){v=visit(node.key,node.value);if(v){return v}}}if(h>0&&node.right){return doVisit(lo,hi,compare,visit,node.right)}}proto.forEach=function rbTreeForEach(visit,lo,hi){if(!this.root){return}switch(arguments.length){case 1:return doVisitFull(visit,this.root);break;case 2:return doVisitHalf(lo,this._compare,visit,this.root);break;case 3:if(this._compare(lo,hi)>=0){return}return doVisit(lo,hi,this._compare,visit,this.root);break}};Object.defineProperty(proto,"begin",{get:function(){var stack=[];var n=this.root;while(n){stack.push(n);n=n.left}return new RedBlackTreeIterator(this,stack)}});Object.defineProperty(proto,"end",{get:function(){var stack=[];var n=this.root;while(n){stack.push(n);n=n.right}return new RedBlackTreeIterator(this,stack)}});proto.at=function(idx){if(idx<0){return new RedBlackTreeIterator(this,[])}var n=this.root;var stack=[];while(true){stack.push(n);if(n.left){if(idx<n.left._count){n=n.left;continue}idx-=n.left._count}if(!idx){return new RedBlackTreeIterator(this,stack)}idx-=1;if(n.right){if(idx>=n.right._count){break}n=n.right}else{break}}return new RedBlackTreeIterator(this,[])};proto.ge=function(key){var cmp=this._compare;var n=this.root;var stack=[];var last_ptr=0;while(n){var d=cmp(key,n.key);stack.push(n);if(d<=0){last_ptr=stack.length}if(d<=0){n=n.left}else{n=n.right}}stack.length=last_ptr;return new RedBlackTreeIterator(this,stack)};proto.gt=function(key){var cmp=this._compare;var n=this.root;var stack=[];var last_ptr=0;while(n){var d=cmp(key,n.key);stack.push(n);if(d<0){last_ptr=stack.length}if(d<0){n=n.left}else{n=n.right}}stack.length=last_ptr;return new RedBlackTreeIterator(this,stack)};proto.lt=function(key){var cmp=this._compare;var n=this.root;var stack=[];var last_ptr=0;while(n){var d=cmp(key,n.key);stack.push(n);if(d>0){last_ptr=stack.length}if(d<=0){n=n.left}else{n=n.right}}stack.length=last_ptr;return new RedBlackTreeIterator(this,stack)};proto.le=function(key){var cmp=this._compare;var n=this.root;var stack=[];var last_ptr=0;while(n){var d=cmp(key,n.key);stack.push(n);if(d>=0){last_ptr=stack.length}if(d<0){n=n.left}else{n=n.right}}stack.length=last_ptr;return new RedBlackTreeIterator(this,stack)};proto.find=function(key){var cmp=this._compare;var n=this.root;var stack=[];while(n){var d=cmp(key,n.key);stack.push(n);if(d===0){return new RedBlackTreeIterator(this,stack)}if(d<=0){n=n.left}else{n=n.right}}return new RedBlackTreeIterator(this,[])};proto.remove=function(key){var iter=this.find(key);if(iter){return iter.remove()}return this};proto.get=function(key){var cmp=this._compare;var n=this.root;while(n){var d=cmp(key,n.key);if(d===0){return n.value}if(d<=0){n=n.left}else{n=n.right}}return};function RedBlackTreeIterator(tree,stack){this.tree=tree;this._stack=stack}var iproto=RedBlackTreeIterator.prototype;Object.defineProperty(iproto,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(iproto,"node",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1]}return null},enumerable:true});iproto.clone=function(){return new RedBlackTreeIterator(this.tree,this._stack.slice())};function swapNode(n,v){n.key=v.key;n.value=v.value;n.left=v.left;n.right=v.right;n._color=v._color;n._count=v._count}function fixDoubleBlack(stack){var n,p,s,z;for(var i=stack.length-1;i>=0;--i){n=stack[i];if(i===0){n._color=BLACK;return}p=stack[i-1];if(p.left===n){s=p.right;if(s.right&&s.right._color===RED){s=p.right=cloneNode(s);z=s.right=cloneNode(s.right);p.right=s.left;s.left=p;s.right=z;s._color=p._color;n._color=BLACK;p._color=BLACK;z._color=BLACK;recount(p);recount(s);if(i>1){var pp=stack[i-2];if(pp.left===p){pp.left=s}else{pp.right=s}}stack[i-1]=s;return}else if(s.left&&s.left._color===RED){s=p.right=cloneNode(s);z=s.left=cloneNode(s.left);p.right=z.left;s.left=z.right;z.left=p;z.right=s;z._color=p._color;p._color=BLACK;s._color=BLACK;n._color=BLACK;recount(p);recount(s);recount(z);if(i>1){var pp=stack[i-2];if(pp.left===p){pp.left=z}else{pp.right=z}}stack[i-1]=z;return}if(s._color===BLACK){if(p._color===RED){p._color=BLACK;p.right=repaint(RED,s);return}else{p.right=repaint(RED,s);continue}}else{s=cloneNode(s);p.right=s.left;s.left=p;s._color=p._color;p._color=RED;recount(p);recount(s);if(i>1){var pp=stack[i-2];if(pp.left===p){pp.left=s}else{pp.right=s}}stack[i-1]=s;stack[i]=p;if(i+1<stack.length){stack[i+1]=n}else{stack.push(n)}i=i+2}}else{s=p.left;if(s.left&&s.left._color===RED){s=p.left=cloneNode(s);z=s.left=cloneNode(s.left);p.left=s.right;s.right=p;s.left=z;s._color=p._color;n._color=BLACK;p._color=BLACK;z._color=BLACK;recount(p);recount(s);if(i>1){var pp=stack[i-2];if(pp.right===p){pp.right=s}else{pp.left=s}}stack[i-1]=s;return}else if(s.right&&s.right._color===RED){s=p.left=cloneNode(s);z=s.right=cloneNode(s.right);p.left=z.right;s.right=z.left;z.right=p;z.left=s;z._color=p._color;p._color=BLACK;s._color=BLACK;n._color=BLACK;recount(p);recount(s);recount(z);if(i>1){var pp=stack[i-2];if(pp.right===p){pp.right=z}else{pp.left=z}}stack[i-1]=z;return}if(s._color===BLACK){if(p._color===RED){p._color=BLACK;p.left=repaint(RED,s);return}else{p.left=repaint(RED,s);continue}}else{s=cloneNode(s);p.left=s.right;s.right=p;s._color=p._color;p._color=RED;recount(p);recount(s);if(i>1){var pp=stack[i-2];if(pp.right===p){pp.right=s}else{pp.left=s}}stack[i-1]=s;stack[i]=p;if(i+1<stack.length){stack[i+1]=n}else{stack.push(n)}i=i+2}}}}iproto.remove=function(){var stack=this._stack;if(stack.length===0){return this.tree}var cstack=new Array(stack.length);var n=stack[stack.length-1];cstack[cstack.length-1]=new RBNode(n._color,n.key,n.value,n.left,n.right,n._count);for(var i=stack.length-2;i>=0;--i){var n=stack[i];if(n.left===stack[i+1]){cstack[i]=new RBNode(n._color,n.key,n.value,cstack[i+1],n.right,n._count)}else{cstack[i]=new RBNode(n._color,n.key,n.value,n.left,cstack[i+1],n._count)}}n=cstack[cstack.length-1];if(n.left&&n.right){var split=cstack.length;n=n.left;while(n.right){cstack.push(n);n=n.right}var v=cstack[split-1];cstack.push(new RBNode(n._color,v.key,v.value,n.left,n.right,n._count));cstack[split-1].key=n.key;cstack[split-1].value=n.value;for(var i=cstack.length-2;i>=split;--i){n=cstack[i];cstack[i]=new RBNode(n._color,n.key,n.value,n.left,cstack[i+1],n._count)}cstack[split-1].left=cstack[split]}n=cstack[cstack.length-1];if(n._color===RED){var p=cstack[cstack.length-2];if(p.left===n){p.left=null}else if(p.right===n){p.right=null}cstack.pop();for(var i=0;i<cstack.length;++i){cstack[i]._count--}return new RedBlackTree(this.tree._compare,cstack[0])}else{if(n.left||n.right){if(n.left){swapNode(n,n.left)}else if(n.right){swapNode(n,n.right)}n._color=BLACK;for(var i=0;i<cstack.length-1;++i){cstack[i]._count--}return new RedBlackTree(this.tree._compare,cstack[0])}else if(cstack.length===1){return new RedBlackTree(this.tree._compare,null)}else{for(var i=0;i<cstack.length;++i){cstack[i]._count--}var parent=cstack[cstack.length-2];fixDoubleBlack(cstack);if(parent.left===n){parent.left=null}else{parent.right=null}}}return new RedBlackTree(this.tree._compare,cstack[0])};Object.defineProperty(iproto,"key",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].key}return},enumerable:true});Object.defineProperty(iproto,"value",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].value}return},enumerable:true});Object.defineProperty(iproto,"index",{get:function(){var idx=0;var stack=this._stack;if(stack.length===0){var r=this.tree.root;if(r){return r._count}return 0}else if(stack[stack.length-1].left){idx=stack[stack.length-1].left._count}for(var s=stack.length-2;s>=0;--s){if(stack[s+1]===stack[s].right){++idx;if(stack[s].left){idx+=stack[s].left._count}}}return idx},enumerable:true});iproto.next=function(){var stack=this._stack;if(stack.length===0){return}var n=stack[stack.length-1];if(n.right){n=n.right;while(n){stack.push(n);n=n.left}}else{stack.pop();while(stack.length>0&&stack[stack.length-1].right===n){n=stack[stack.length-1];stack.pop()}}};Object.defineProperty(iproto,"hasNext",{get:function(){var stack=this._stack;if(stack.length===0){return false}if(stack[stack.length-1].right){return true}for(var s=stack.length-1;s>0;--s){if(stack[s-1].left===stack[s]){return true}}return false}});iproto.update=function(value){var stack=this._stack;if(stack.length===0){throw new Error("Can't update empty node!")}var cstack=new Array(stack.length);var n=stack[stack.length-1];cstack[cstack.length-1]=new RBNode(n._color,n.key,value,n.left,n.right,n._count);for(var i=stack.length-2;i>=0;--i){n=stack[i];if(n.left===stack[i+1]){cstack[i]=new RBNode(n._color,n.key,n.value,cstack[i+1],n.right,n._count)}else{cstack[i]=new RBNode(n._color,n.key,n.value,n.left,cstack[i+1],n._count)}}return new RedBlackTree(this.tree._compare,cstack[0])};iproto.prev=function(){var stack=this._stack;if(stack.length===0){return}var n=stack[stack.length-1];if(n.left){n=n.left;while(n){stack.push(n);n=n.right}}else{stack.pop();while(stack.length>0&&stack[stack.length-1].left===n){n=stack[stack.length-1];stack.pop()}}};Object.defineProperty(iproto,"hasPrev",{get:function(){var stack=this._stack;if(stack.length===0){return false}if(stack[stack.length-1].left){return true}for(var s=stack.length-1;s>0;--s){if(stack[s-1].right===stack[s]){return true}}return false}});function defaultCompare(a,b){if(a<b){return-1}if(a>b){return 1}return 0}function createRBTree(compare){return new RedBlackTree(compare||defaultCompare,null)}},{}],70:[function(require,module,exports){"use strict";module.exports=createSlabDecomposition;var bounds=require("binary-search-bounds");var createRBTree=require("functional-red-black-tree");var orient=require("robust-orientation");var orderSegments=require("./lib/order-segments");function SlabDecomposition(slabs,coordinates,horizontal){this.slabs=slabs;this.coordinates=coordinates;this.horizontal=horizontal}var proto=SlabDecomposition.prototype;function compareHorizontal(e,y){return e.y-y}function searchBucket(root,p){var lastNode=null;while(root){var seg=root.key;var l,r;if(seg[0][0]<seg[1][0]){l=seg[0];r=seg[1]}else{l=seg[1];r=seg[0]}var o=orient(l,r,p);if(o<0){root=root.left}else if(o>0){if(p[0]!==seg[1][0]){lastNode=root;root=root.right}else{var val=searchBucket(root.right,p);if(val){return val}root=root.left}}else{if(p[0]!==seg[1][0]){return root}else{var val=searchBucket(root.right,p);if(val){return val}root=root.left}}}return lastNode}proto.castUp=function(p){var bucket=bounds.le(this.coordinates,p[0]);if(bucket<0){return-1}var root=this.slabs[bucket];var hitNode=searchBucket(this.slabs[bucket],p);var lastHit=-1;if(hitNode){lastHit=hitNode.value}if(this.coordinates[bucket]===p[0]){var lastSegment=null;if(hitNode){lastSegment=hitNode.key}if(bucket>0){var otherHitNode=searchBucket(this.slabs[bucket-1],p);if(otherHitNode){if(lastSegment){if(orderSegments(otherHitNode.key,lastSegment)>0){lastSegment=otherHitNode.key;lastHit=otherHitNode.value}}else{lastHit=otherHitNode.value;lastSegment=otherHitNode.key}}}var horiz=this.horizontal[bucket];if(horiz.length>0){var hbucket=bounds.ge(horiz,p[1],compareHorizontal);if(hbucket<horiz.length){var e=horiz[hbucket];if(p[1]===e.y){if(e.closed){return e.index}else{while(hbucket<horiz.length-1&&horiz[hbucket+1].y===p[1]){hbucket=hbucket+1;e=horiz[hbucket];if(e.closed){return e.index}}if(e.y===p[1]&&!e.start){hbucket=hbucket+1;if(hbucket>=horiz.length){return lastHit}e=horiz[hbucket]}}}if(e.start){if(lastSegment){var o=orient(lastSegment[0],lastSegment[1],[p[0],e.y]);if(lastSegment[0][0]>lastSegment[1][0]){o=-o}if(o>0){lastHit=e.index}}else{lastHit=e.index}}else if(e.y!==p[1]){lastHit=e.index}}}}return lastHit};function IntervalSegment(y,index,start,closed){this.y=y;this.index=index;this.start=start;this.closed=closed}function Event(x,segment,create,index){this.x=x;this.segment=segment;this.create=create;this.index=index}function createSlabDecomposition(segments){var numSegments=segments.length;var numEvents=2*numSegments;var events=new Array(numEvents);for(var i=0;i<numSegments;++i){var s=segments[i];var f=s[0][0]<s[1][0];events[2*i]=new Event(s[0][0],s,f,i);events[2*i+1]=new Event(s[1][0],s,!f,i)}events.sort(function(a,b){var d=a.x-b.x;if(d){return d}d=a.create-b.create;if(d){return d}return Math.min(a.segment[0][1],a.segment[1][1])-Math.min(b.segment[0][1],b.segment[1][1])});var tree=createRBTree(orderSegments);var slabs=[];var lines=[];var horizontal=[];var lastX=-Infinity;for(var i=0;i<numEvents;){var x=events[i].x;var horiz=[];while(i<numEvents){var e=events[i];if(e.x!==x){break}i+=1;if(e.segment[0][0]===e.x&&e.segment[1][0]===e.x){if(e.create){if(e.segment[0][1]<e.segment[1][1]){horiz.push(new IntervalSegment(e.segment[0][1],e.index,true,true));horiz.push(new IntervalSegment(e.segment[1][1],e.index,false,false))}else{horiz.push(new IntervalSegment(e.segment[1][1],e.index,true,false));horiz.push(new IntervalSegment(e.segment[0][1],e.index,false,true))}}}else{if(e.create){tree=tree.insert(e.segment,e.index)}else{tree=tree.remove(e.segment)}}}slabs.push(tree.root);lines.push(x);horizontal.push(horiz)}return new SlabDecomposition(slabs,lines,horizontal)}},{"./lib/order-segments":67,"binary-search-bounds":68,"functional-red-black-tree":69,"robust-orientation":75}],71:[function(require,module,exports){"use strict";module.exports=preprocessPolygon;var orient=require("robust-orientation");var makeSlabs=require("slab-decomposition");function dummyFunction(p){return-1}function createClassifyPoint(segments,slabs,outside,orientation){function classifyPoint(p){var index=slabs.castUp(p);if(index<0){return outside}var seg=segments[index];if(!orientation){return orient(p,seg[0],seg[1])}else{return orient(p,seg[1],seg[0])}}return classifyPoint}function preprocessPolygon(loops,orientation){orientation=!!orientation;var numLoops=loops.length;var numSegments=0;for(var i=0;i<numLoops;++i){numSegments+=loops[i].length}if(numSegments===0){return dummyFunction}var segments=new Array(numSegments);var ptr=0;for(var i=0;i<numLoops;++i){var loop=loops[i];var numVertices=loop.length;for(var s=numVertices-1,t=0;t<numVertices;s=t++){segments[ptr++]=[loop[s],loop[t]]}}var slabs=makeSlabs(segments);var outside;var root=slabs.slabs[0];if(root){while(root.left){root=root.left}var h=root.key;if(h[0][0]<h[1][0]){outside=-1}else{outside=1}}else{var h=segments[slabs.horizontal[0][0].index];if(h[0][1]<h[1][1]){outside=1}else{outside=-1}}if(orientation){outside=-outside}return createClassifyPoint(segments,slabs,outside,orientation)}},{"robust-orientation":75,"slab-decomposition":70}],72:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],73:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":77,"two-sum":72}],74:[function(require,module,exports){module.exports=require(20)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-subtract/robust-diff.js":20}],75:[function(require,module,exports){module.exports=require(23)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/orientation.js":23,"robust-scale":73,"robust-subtract":74,"robust-sum":76,"two-product":77}],76:[function(require,module,exports){module.exports=require(21)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-sum/robust-sum.js":21}],77:[function(require,module,exports){module.exports=require(22)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/two-product/two-product.js":22}],78:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],79:[function(require,module,exports){"use strict";module.exports=planarGraphToPolyline;var e2a=require("edges-to-adjacency-list");var planarDual=require("planar-dual");var preprocessPolygon=require("point-in-big-polygon");var twoProduct=require("two-product");var robustSum=require("robust-sum");var uniq=require("uniq");var dup=require("dup");function planarGraphToPolyline(edges,positions){var numVertices=positions.length;var numEdges=edges.length;var adj=e2a(edges,positions.length);for(var i=0;i<numVertices;++i){if(adj[i].length%2===1){throw new Error("planar-graph-to-polyline: graph must be manifold")}}var faces=planarDual(edges,positions);function ccw(c){var n=c.length;var area=[0];for(var j=0;j<n;++j){var a=positions[c[j]];var b=positions[c[(j+1)%n]];var t00=twoProduct(-a[0],a[1]);var t01=twoProduct(-a[0],b[1]);var t10=twoProduct(b[0],a[1]);var t11=twoProduct(b[0],b[1]);area=robustSum(area,robustSum(robustSum(t00,t01),robustSum(t10,t11)))}return area[area.length-1]>0}faces=faces.filter(ccw);var numFaces=faces.length;var parent=new Array(numFaces);var containment=new Array(numFaces);for(var i=0;i<numFaces;++i){parent[i]=i;var row=new Array(numFaces);var loopVertices=faces[i].map(function(v){return positions[v]});var pmc=preprocessPolygon([loopVertices]);var count=0;outer:for(var j=0;j<numFaces;++j){row[j]=0;if(i===j){continue}var c=faces[j];var n=c.length;for(var k=0;k<n;++k){var d=pmc(positions[c[k]]);if(d!==0){if(d>0){row[j]=1;count+=1}continue outer}}row[j]=1;count+=1}containment[i]=[count,i,row]}containment.sort(function(a,b){return b[0]-a[0]});for(var i=0;i<numFaces;++i){var row=containment[i];var idx=row[1];var children=row[2];for(var j=0;j<numFaces;++j){if(children[j]){parent[j]=idx}}}var fadj=dup([numFaces,0]);for(var i=0;i<numFaces;++i){fadj[i].push(parent[i]);fadj[parent[i]].push(i)}var edgeAdjacency={};var internalVertices=dup(numVertices,false);for(var i=0;i<numFaces;++i){var c=faces[i];var n=c.length;for(var j=0;j<n;++j){var a=c[j];var b=c[(j+1)%n];var key=Math.min(a,b)+":"+Math.max(a,b);if(key in edgeAdjacency){var neighbor=edgeAdjacency[key];fadj[neighbor].push(i);fadj[i].push(neighbor);internalVertices[a]=internalVertices[b]=true}else{edgeAdjacency[key]=i}}}function sharedBoundary(c){var n=c.length;for(var i=0;i<n;++i){if(!internalVertices[c[i]]){return false}}return true}var toVisit=[];var parity=dup(numFaces,-1);for(var i=0;i<numFaces;++i){if(parent[i]===i&&!sharedBoundary(faces[i])){toVisit.push(i);parity[i]=0}else{parity[i]=-1}}var result=[];while(toVisit.length>0){var top=toVisit.pop();var nbhd=fadj[top];uniq(nbhd,function(a,b){return a-b});var nnbhr=nbhd.length;var p=parity[top];var polyline;if(p===0){var c=faces[top];polyline=[c]}for(var i=0;i<nnbhr;++i){var f=nbhd[i];if(parity[f]>=0){continue}parity[f]=p^1;toVisit.push(f);if(p===0){var c=faces[f];if(!sharedBoundary(c)){c.reverse();polyline.push(c)}}}if(p===0){result.push(polyline)}}return result}},{dup:59,"edges-to-adjacency-list":60,"planar-dual":61,"point-in-big-polygon":71,"robust-sum":76,"two-product":77,uniq:78}],80:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],81:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":84,"two-sum":80}],82:[function(require,module,exports){module.exports=require(20)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-subtract/robust-diff.js":20}],83:[function(require,module,exports){module.exports=require(21)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-sum/robust-sum.js":21}],84:[function(require,module,exports){module.exports=require(22)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/two-product/two-product.js":22}],85:[function(require,module,exports){module.exports=require(23)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/orientation.js":23,"robust-scale":81,"robust-subtract":82,"robust-sum":83,"two-product":84}],86:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],87:[function(require,module,exports){"use strict";"use restrict";module.exports=UnionFind;function UnionFind(count){this.roots=new Array(count);this.ranks=new Array(count);for(var i=0;i<count;++i){this.roots[i]=i;this.ranks[i]=0}}UnionFind.prototype.length=function(){return this.roots.length};UnionFind.prototype.makeSet=function(){var n=this.roots.length;this.roots.push(n);this.ranks.push(0);return n};UnionFind.prototype.find=function(x){var roots=this.roots;while(roots[x]!==x){var y=roots[x];roots[x]=roots[y];x=y}return x};UnionFind.prototype.link=function(x,y){var xr=this.find(x),yr=this.find(y);if(xr===yr){return}var ranks=this.ranks,roots=this.roots,xd=ranks[xr],yd=ranks[yr];if(xd<yd){roots[xr]=yr}else if(yd<xd){roots[yr]=xr}else{roots[yr]=xr;++ranks[xr]}}},{}],88:[function(require,module,exports){arguments[4][26][0].apply(exports,arguments)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/topology.js":26,"bit-twiddle":86,"union-find":87}],89:[function(require,module,exports){"use strict";module.exports=simplifyPolygon;var orient=require("robust-orientation");var sc=require("simplicial-complex");function errorWeight(base,a,b){var area=Math.abs(orient(base,a,b));var perim=Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2));return area/perim}function simplifyPolygon(cells,positions,minArea){var n=positions.length;var nc=cells.length;var inv=new Array(n);var outv=new Array(n);var weights=new Array(n);var dead=new Array(n);for(var i=0;i<n;++i){inv[i]=outv[i]=-1;weights[i]=Infinity;dead[i]=false}for(var i=0;i<nc;++i){var c=cells[i];if(c.length!==2){throw new Error("Input must be a graph")}var s=c[1];var t=c[0];if(outv[t]!==-1){outv[t]=-2}else{outv[t]=s}if(inv[s]!==-1){inv[s]=-2}else{inv[s]=t}}function computeWeight(i){if(dead[i]){return Infinity}var s=inv[i];var t=outv[i];if(s<0||t<0){return Infinity}else{return errorWeight(positions[i],positions[s],positions[t])}}function heapSwap(i,j){var a=heap[i];var b=heap[j];heap[i]=b;heap[j]=a;index[a]=j;index[b]=i}function heapWeight(i){return weights[heap[i]]}function heapParent(i){if(i&1){return i-1>>1}return(i>>1)-1}function heapDown(i){var w=heapWeight(i);while(true){var tw=w;var left=2*i+1;var right=2*(i+1);var next=i;if(left<heapCount){var lw=heapWeight(left);if(lw<tw){next=left;tw=lw}}if(right<heapCount){var rw=heapWeight(right);if(rw<tw){next=right}}if(next===i){return i}heapSwap(i,next);i=next}}function heapUp(i){var w=heapWeight(i);while(i>0){var parent=heapParent(i);if(parent>=0){var pw=heapWeight(parent);if(w<pw){heapSwap(i,parent);i=parent;continue}}return i}}function heapPop(){if(heapCount>0){var head=heap[0];heapSwap(0,heapCount-1);heapCount-=1;heapDown(0);return head}return-1}function heapUpdate(i,w){var a=heap[i];if(weights[a]===w){return i}weights[a]=-Infinity;heapUp(i);heapPop();weights[a]=w;heapCount+=1;return heapUp(heapCount-1)}function kill(i){if(dead[i]){return}dead[i]=true;var s=inv[i];var t=outv[i];if(inv[t]>=0){inv[t]=s}if(outv[s]>=0){outv[s]=t}if(index[s]>=0){heapUpdate(index[s],computeWeight(s))}if(index[t]>=0){heapUpdate(index[t],computeWeight(t))}}var heap=[];var index=new Array(n);for(var i=0;i<n;++i){var w=weights[i]=computeWeight(i);if(w<Infinity){index[i]=heap.length;heap.push(i)}else{index[i]=-1}}var heapCount=heap.length;for(var i=heapCount>>1;i>=0;--i){heapDown(i)}while(true){var hmin=heapPop();if(hmin<0||weights[hmin]>minArea){break}kill(hmin)}var npositions=[];for(var i=0;i<n;++i){if(!dead[i]){index[i]=npositions.length;npositions.push(positions[i].slice())}}var nv=npositions.length;function tortoiseHare(seq,start){if(seq[start]<0){return start}var t=start;var h=start;do{var nh=seq[h];if(!dead[h]||nh<0||nh===h){break}h=nh;nh=seq[h];if(!dead[h]||nh<0||nh===h){break}h=nh;t=seq[t]}while(t!==h);for(var v=start;v!==h;v=seq[v]){seq[v]=h}return h}var ncells=[];cells.forEach(function(c){var tin=tortoiseHare(inv,c[0]);var tout=tortoiseHare(outv,c[1]);if(tin>=0&&tout>=0&&tin!==tout){var cin=index[tin];var cout=index[tout];if(cin!==cout){ncells.push([cin,cout])}}});sc.unique(sc.normalize(ncells));return{positions:npositions,edges:ncells}}},{"robust-orientation":85,"simplicial-complex":88}],90:[function(require,module,exports){"use strict";var pool=require("typedarray-pool");module.exports=createSurfaceExtractor;function array(i){return"a"+i}function data(i){return"d"+i}function cube(i,bitmask){return"c"+i+"_"+bitmask}function shape(i){return"s"+i}function stride(i,j){return"t"+i+"_"+j}function offset(i){return"o"+i}function scalar(i){return"x"+i}function pointer(i){return"p"+i}function delta(i,bitmask){return"d"+i+"_"+bitmask}function index(i){return"i"+i}function step(i,j){return"u"+i+"_"+j}function pcube(bitmask){return"b"+bitmask}function qcube(bitmask){return"y"+bitmask}function pdelta(bitmask){return"e"+bitmask}function vert(i){return"v"+i}var VERTEX_IDS="V";var PHASES="P";var VERTEX_COUNT="N";var POOL_SIZE="Q";var POINTER="X";var TEMPORARY="T";function permBitmask(dimension,mask,order){var r=0;for(var i=0;i<dimension;++i){if(mask&1<<i){r|=1<<order[i]}}return r}function compileSurfaceProcedure(vertexFunc,faceFunc,phaseFunc,scalarArgs,order,typesig){var arrayArgs=typesig.length;var dimension=order.length;if(dimension<2){throw new Error("ndarray-extract-contour: Dimension must be at least 2")}var funcName="extractContour"+order.join("_");var code=[];var vars=[];var args=[];for(var i=0;i<arrayArgs;++i){args.push(array(i))}for(var i=0;i<scalarArgs;++i){args.push(scalar(i))}for(var i=0;i<dimension;++i){vars.push(shape(i)+"="+array(0)+".shape["+i+"]|0")}for(var i=0;i<arrayArgs;++i){vars.push(data(i)+"="+array(i)+".data",offset(i)+"="+array(i)+".offset|0");for(var j=0;j<dimension;++j){vars.push(stride(i,j)+"="+array(i)+".stride["+j+"]|0")}}for(var i=0;i<arrayArgs;++i){vars.push(pointer(i)+"="+offset(i));vars.push(cube(i,0));for(var j=1;j<1<<dimension;++j){var ptrStr=[];for(var k=0;k<dimension;++k){if(j&1<<k){ptrStr.push("-"+stride(i,k))}}vars.push(delta(i,j)+"=("+ptrStr.join("")+")|0");vars.push(cube(i,j)+"=0")}}for(var i=0;i<arrayArgs;++i){for(var j=0;j<dimension;++j){var stepVal=[stride(i,order[j])];if(j>0){stepVal.push(stride(i,order[j-1])+"*"+shape(order[j-1]))}vars.push(step(i,order[j])+"=("+stepVal.join("-")+")|0")}}for(var i=0;i<dimension;++i){vars.push(index(i)+"=0")}vars.push(VERTEX_COUNT+"=0");var sizeVariable=["2"];for(var i=dimension-2;i>=0;--i){sizeVariable.push(shape(order[i]))}vars.push(POOL_SIZE+"=("+sizeVariable.join("*")+")|0",PHASES+"=mallocUint32("+POOL_SIZE+")",VERTEX_IDS+"=mallocUint32("+POOL_SIZE+")",POINTER+"=0");vars.push(pcube(0)+"=0");for(var j=1;j<1<<dimension;++j){var cubeDelta=[];var cubeStep=[];for(var k=0;k<dimension;++k){if(j&1<<k){if(cubeStep.length===0){cubeDelta.push("1")}else{cubeDelta.unshift(cubeStep.join("*"))}}cubeStep.push(shape(order[k]))}var signFlag="";if(cubeDelta[0].indexOf(shape(order[dimension-2]))<0){signFlag="-"}var jperm=permBitmask(dimension,j,order);vars.push(pdelta(jperm)+"=(-"+cubeDelta.join("-")+")|0",qcube(jperm)+"=("+signFlag+cubeDelta.join("-")+")|0",pcube(jperm)+"=0")}vars.push(vert(0)+"=0",TEMPORARY+"=0");function forLoopBegin(i,start){code.push("for(",index(order[i]),"=",start,";",index(order[i]),"<",shape(order[i]),";","++",index(order[i]),"){")}function forLoopEnd(i){for(var j=0;j<arrayArgs;++j){code.push(pointer(j),"+=",step(j,order[i]),";")}code.push("}")}function fillEmptySlice(k){for(var i=k-1;i>=0;--i){forLoopBegin(i,0)}var phaseFuncArgs=[];for(var i=0;i<arrayArgs;++i){if(typesig[i]){phaseFuncArgs.push(data(i)+".get("+pointer(i)+")")}else{phaseFuncArgs.push(data(i)+"["+pointer(i)+"]")}}for(var i=0;i<scalarArgs;++i){phaseFuncArgs.push(scalar(i))}code.push(PHASES,"[",POINTER,"++]=phase(",phaseFuncArgs.join(),");");for(var i=0;i<k;++i){forLoopEnd(i)}for(var j=0;j<arrayArgs;++j){code.push(pointer(j),"+=",step(j,order[k]),";")}}function processGridCell(mask){for(var i=0;i<arrayArgs;++i){if(typesig[i]){code.push(cube(i,0),"=",data(i),".get(",pointer(i),");")}else{code.push(cube(i,0),"=",data(i),"[",pointer(i),"];")}}var phaseFuncArgs=[];for(var i=0;i<arrayArgs;++i){phaseFuncArgs.push(cube(i,0))}for(var i=0;i<scalarArgs;++i){phaseFuncArgs.push(scalar(i))}code.push(pcube(0),"=",PHASES,"[",POINTER,"]=phase(",phaseFuncArgs.join(),");");for(var j=1;j<1<<dimension;++j){code.push(pcube(j),"=",PHASES,"[",POINTER,"+",pdelta(j),"];")}var vertexPredicate=[];for(var j=1;j<1<<dimension;++j){vertexPredicate.push("("+pcube(0)+"!=="+pcube(j)+")")}code.push("if(",vertexPredicate.join("||"),"){");var vertexArgs=[];for(var i=0;i<dimension;++i){vertexArgs.push(index(i))}for(var i=0;i<arrayArgs;++i){vertexArgs.push(cube(i,0));for(var j=1;j<1<<dimension;++j){if(typesig[i]){code.push(cube(i,j),"=",data(i),".get(",pointer(i),"+",delta(i,j),");")}else{code.push(cube(i,j),"=",data(i),"[",pointer(i),"+",delta(i,j),"];")}vertexArgs.push(cube(i,j))}}for(var i=0;i<1<<dimension;++i){vertexArgs.push(pcube(i))}for(var i=0;i<scalarArgs;++i){vertexArgs.push(scalar(i))}code.push("vertex(",vertexArgs.join(),");",vert(0),"=",VERTEX_IDS,"[",POINTER,"]=",VERTEX_COUNT,"++;");var base=(1<<dimension)-1;var corner=pcube(base);for(var j=0;j<dimension;++j){if((mask&~(1<<j))===0){var subset=base^1<<j;var edge=pcube(subset);var faceArgs=[];for(var k=subset;k>0;k=k-1&subset){faceArgs.push(VERTEX_IDS+"["+POINTER+"+"+pdelta(k)+"]")}faceArgs.push(vert(0));for(var k=0;k<arrayArgs;++k){if(j&1){faceArgs.push(cube(k,base),cube(k,subset))}else{faceArgs.push(cube(k,subset),cube(k,base))}}if(j&1){faceArgs.push(corner,edge)}else{faceArgs.push(edge,corner)}for(var k=0;k<scalarArgs;++k){faceArgs.push(scalar(k))}code.push("if(",corner,"!==",edge,"){","face(",faceArgs.join(),")}")}}code.push("}",POINTER,"+=1;")}function flip(){for(var j=1;j<1<<dimension;++j){code.push(TEMPORARY,"=",pdelta(j),";",pdelta(j),"=",qcube(j),";",qcube(j),"=",TEMPORARY,";")}}function createLoop(i,mask){if(i<0){processGridCell(mask);return}fillEmptySlice(i);code.push("if(",shape(order[i]),">0){",index(order[i]),"=1;");createLoop(i-1,mask|1<<order[i]);for(var j=0;j<arrayArgs;++j){code.push(pointer(j),"+=",step(j,order[i]),";")}if(i===dimension-1){code.push(POINTER,"=0;");flip()}forLoopBegin(i,2);createLoop(i-1,mask);if(i===dimension-1){code.push("if(",index(order[dimension-1]),"&1){",POINTER,"=0;}");flip()}forLoopEnd(i);code.push("}")}createLoop(dimension-1,0);code.push("freeUint32(",VERTEX_IDS,");freeUint32(",PHASES,");");var procedureCode=["'use strict';","function ",funcName,"(",args.join(),"){","var ",vars.join(),";",code.join(""),"}","return ",funcName].join("");var proc=new Function("vertex","face","phase","mallocUint32","freeUint32",procedureCode);return proc(vertexFunc,faceFunc,phaseFunc,pool.mallocUint32,pool.freeUint32)}function createSurfaceExtractor(args){function error(msg){throw new Error("ndarray-extract-contour: "+msg)}if(typeof args!=="object"){error("Must specify arguments")}var order=args.order;if(!Array.isArray(order)){error("Must specify order")}var arrays=args.arrayArguments||1;if(arrays<1){error("Must have at least one array argument")}var scalars=args.scalarArguments||0;if(scalars<0){error("Scalar arg count must be > 0")}if(typeof args.vertex!=="function"){error("Must specify vertex creation function")}if(typeof args.cell!=="function"){error("Must specify cell creation function")}if(typeof args.phase!=="function"){error("Must specify phase function")}var getters=args.getters||[];var typesig=new Array(arrays);for(var i=0;i<arrays;++i){if(getters.indexOf(i)>=0){typesig[i]=true}else{typesig[i]=false}}return compileSurfaceProcedure(args.vertex,args.cell,args.phase,scalars,order,typesig)}},{"typedarray-pool":92}],91:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],92:[function(require,module,exports){(function(global,Buffer){"use strict";var bits=require("bit-twiddle");var dup=require("dup");if(!global.__TYPEDARRAY_POOL){global.__TYPEDARRAY_POOL={UINT8:dup([32,0]),UINT16:dup([32,0]),UINT32:dup([32,0]),INT8:dup([32,0]),INT16:dup([32,0]),INT32:dup([32,0]),FLOAT:dup([32,0]),DOUBLE:dup([32,0]),DATA:dup([32,0]),UINT8C:dup([32,0]),BUFFER:dup([32,0])}}var hasUint8C=typeof Uint8ClampedArray!=="undefined";var POOL=global.__TYPEDARRAY_POOL;if(!POOL.UINT8C){POOL.UINT8C=dup([32,0])}if(!POOL.BUFFER){POOL.BUFFER=dup([32,0])}var DATA=POOL.DATA,BUFFER=POOL.BUFFER;exports.free=function free(array){if(Buffer.isBuffer(array)){BUFFER[bits.log2(array.length)].push(array)}else{if(Object.prototype.toString.call(array)!=="[object ArrayBuffer]"){array=array.buffer}if(!array){return}var n=array.length||array.byteLength;var log_n=bits.log2(n)|0;DATA[log_n].push(array)}};function freeArrayBuffer(buffer){if(!buffer){return}var n=buffer.length||buffer.byteLength;var log_n=bits.log2(n);DATA[log_n].push(buffer)}function freeTypedArray(array){freeArrayBuffer(array.buffer)}exports.freeUint8=exports.freeUint16=exports.freeUint32=exports.freeInt8=exports.freeInt16=exports.freeInt32=exports.freeFloat32=exports.freeFloat=exports.freeFloat64=exports.freeDouble=exports.freeUint8Clamped=exports.freeDataView=freeTypedArray;exports.freeArrayBuffer=freeArrayBuffer;exports.freeBuffer=function freeBuffer(array){BUFFER[bits.log2(array.length)].push(array)};exports.malloc=function malloc(n,dtype){if(dtype===undefined||dtype==="arraybuffer"){return mallocArrayBuffer(n)}else{switch(dtype){case"uint8":return mallocUint8(n);case"uint16":return mallocUint16(n);case"uint32":return mallocUint32(n);case"int8":return mallocInt8(n);case"int16":return mallocInt16(n);case"int32":return mallocInt32(n);case"float":case"float32":return mallocFloat(n);case"double":case"float64":return mallocDouble(n);case"uint8_clamped":return mallocUint8Clamped(n);case"buffer":return mallocBuffer(n);case"data":case"dataview":return mallocDataView(n);default:return null}}return null};function mallocArrayBuffer(n){var n=bits.nextPow2(n);var log_n=bits.log2(n);var d=DATA[log_n];if(d.length>0){return d.pop()}return new ArrayBuffer(n)}exports.mallocArrayBuffer=mallocArrayBuffer;function mallocUint8(n){return new Uint8Array(mallocArrayBuffer(n),0,n)}exports.mallocUint8=mallocUint8;function mallocUint16(n){return new Uint16Array(mallocArrayBuffer(2*n),0,n)}exports.mallocUint16=mallocUint16;function mallocUint32(n){return new Uint32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocUint32=mallocUint32;function mallocInt8(n){return new Int8Array(mallocArrayBuffer(n),0,n)}exports.mallocInt8=mallocInt8;function mallocInt16(n){return new Int16Array(mallocArrayBuffer(2*n),0,n)}exports.mallocInt16=mallocInt16;function mallocInt32(n){return new Int32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocInt32=mallocInt32;function mallocFloat(n){return new Float32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocFloat32=exports.mallocFloat=mallocFloat;function mallocDouble(n){return new Float64Array(mallocArrayBuffer(8*n),0,n)}exports.mallocFloat64=exports.mallocDouble=mallocDouble;function mallocUint8Clamped(n){if(hasUint8C){return new Uint8ClampedArray(mallocArrayBuffer(n),0,n)}else{return mallocUint8(n)}}exports.mallocUint8Clamped=mallocUint8Clamped;function mallocDataView(n){return new DataView(mallocArrayBuffer(n),0,n)}exports.mallocDataView=mallocDataView;function mallocBuffer(n){n=bits.nextPow2(n);var log_n=bits.log2(n);var cache=BUFFER[log_n];if(cache.length>0){return cache.pop()}return new Buffer(n)}exports.mallocBuffer=mallocBuffer;exports.clearCache=function clearCache(){for(var i=0;i<32;++i){POOL.UINT8[i].length=0;POOL.UINT16[i].length=0;POOL.UINT32[i].length=0;POOL.INT8[i].length=0;POOL.INT16[i].length=0;POOL.INT32[i].length=0;POOL.FLOAT[i].length=0;POOL.DOUBLE[i].length=0;POOL.UINT8C[i].length=0;DATA[i].length=0;BUFFER[i].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"bit-twiddle":35,buffer:8,dup:91}],93:[function(require,module,exports){var g=7;var p=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];var g_ln=607/128;var p_ln=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function lngamma(z){if(z<0)return Number("0/0");var x=p_ln[0];for(var i=p_ln.length-1;i>0;--i)x+=p_ln[i]/(z+i);var t=z+g_ln+.5;return.5*Math.log(2*Math.PI)+(z+.5)*Math.log(t)-t+Math.log(x)-Math.log(z)}module.exports=function gamma(z){if(z<.5){return Math.PI/(Math.sin(Math.PI*z)*gamma(1-z))}else if(z>100)return Math.exp(lngamma(z));else{z-=1;var x=p[0];for(var i=1;i<g+2;i++){x+=p[i]/(z+i)}var t=z+g+.5;return Math.sqrt(2*Math.PI)*Math.pow(t,z+.5)*Math.exp(-t)*x}};module.exports.log=lngamma},{}],94:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],95:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":35,buffer:8,dup:94}],96:[function(require,module,exports){"use strict";module.exports=permutationSign;var BRUTE_FORCE_CUTOFF=32;var pool=require("typedarray-pool");function permutationSign(p){var n=p.length;if(n<BRUTE_FORCE_CUTOFF){var sgn=1;for(var i=0;i<n;++i){for(var j=0;j<i;++j){if(p[i]<p[j]){sgn=-sgn}else if(p[i]===p[j]){return 0}}}return sgn}else{var visited=pool.mallocUint8(n);for(var i=0;i<n;++i){visited[i]=0}var sgn=1;for(var i=0;i<n;++i){if(!visited[i]){var count=1;visited[i]=1;for(var j=p[i];j!==i;j=p[j]){if(visited[j]){pool.freeUint8(visited);return 0}count+=1;visited[j]=1}if(!(count&1)){sgn=-sgn}}}pool.freeUint8(visited);return sgn}}},{"typedarray-pool":95}],97:[function(require,module,exports){"use strict";var pool=require("typedarray-pool");var inverse=require("invert-permutation");function rank(permutation){var n=permutation.length;switch(n){case 0:case 1:return 0;case 2:return permutation[1];default:break}var p=pool.mallocUint32(n);var pinv=pool.mallocUint32(n);var r=0,s,t,i;inverse(permutation,pinv);for(i=0;i<n;++i){p[i]=permutation[i]}for(i=n-1;i>0;--i){t=pinv[i];s=p[i];p[i]=p[t];p[t]=s;pinv[i]=pinv[s];pinv[s]=t;r=(r+s)*i}pool.freeUint32(pinv);pool.freeUint32(p);return r}function unrank(n,r,p){switch(n){case 0:if(p){return p}return[];case 1:if(p){p[0]=0;return p}else{return[0]}case 2:if(p){if(r){p[0]=0;p[1]=1}else{p[0]=1;p[1]=0}return p}else{return r?[0,1]:[1,0]}default:break}p=p||new Array(n);var s,t,i,nf=1;p[0]=0;for(i=1;i<n;++i){p[i]=i;nf=nf*i|0}for(i=n-1;i>0;--i){s=r/nf|0;r=r-s*nf|0;nf=nf/i|0;t=p[i]|0;p[i]=p[s]|0;p[s]=t|0}return p}exports.rank=rank;exports.unrank=unrank},{"invert-permutation":98,"typedarray-pool":100}],98:[function(require,module,exports){"use strict";function invertPermutation(pi,result){result=result||new Array(pi.length);for(var i=0;i<pi.length;++i){result[pi[i]]=i}return result}module.exports=invertPermutation},{}],99:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],100:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":35,buffer:8,dup:99}],101:[function(require,module,exports){"use strict";module.exports=triangulateCube;var perm=require("permutation-rank");var sgn=require("permutation-parity");var gamma=require("gamma");function triangulateCube(dimension){if(dimension<0){return[]}if(dimension===0){return[[0]]}var dfactorial=Math.round(gamma(dimension+1))|0;var result=[];for(var i=0;i<dfactorial;++i){var p=perm.unrank(dimension,i);var cell=[0];var v=0;for(var j=0;j<p.length;++j){v+=1<<p[j];cell.push(v)}if(sgn(p)<1){cell[0]=v;cell[dimension]=0}result.push(cell)}return result}},{gamma:93,"permutation-parity":96,"permutation-rank":97}],102:[function(require,module,exports){module.exports=require("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg3_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":103}],103:[function(require,module,exports){"use strict";var createThunk=require("./lib/thunk.js");function Procedure(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function compileCwise(user_args){var proc=new Procedure;proc.pre=user_args.pre;proc.body=user_args.body;proc.post=user_args.post;var proc_args=user_args.args.slice(0);proc.argTypes=proc_args;for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if(arg_type==="array"){proc.arrayArgs.push(i);proc.shimArgs.push("array"+i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array args")}if(i<proc.post.args.length&&proc.post.args[i].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(arg_type==="scalar"){proc.scalarArgs.push(i);proc.shimArgs.push("scalar"+i)}else if(arg_type==="index"){proc.indexArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array index")}if(i<proc.body.args.length&&proc.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array index")}if(i<proc.post.args.length&&proc.post.args[i].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(arg_type==="shape"){proc.shapeArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(i<proc.body.args.length&&proc.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(i<proc.post.args.length&&proc.post.args[i].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof arg_type==="object"&&arg_type.offset){proc.argTypes[i]="offset";proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset});proc.offsetArgIndex.push(i)}else{throw new Error("cwise: Unknown argument type "+proc_args[i])}}if(proc.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(proc.pre.args.length>proc_args.length){throw new Error("cwise: Too many arguments in pre() block")}if(proc.body.args.length>proc_args.length){throw new Error("cwise: Too many arguments in body() block")}if(proc.post.args.length>proc_args.length){throw new Error("cwise: Too many arguments in post() block")}proc.debug=!!user_args.printCode||!!user_args.debug;proc.funcName=user_args.funcName||"cwise";proc.blockSize=user_args.blockSize||64;return createThunk(proc)}module.exports=compileCwise},{"./lib/thunk.js":105}],104:[function(require,module,exports){"use strict";var uniq=require("uniq");function innerFill(order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0,i,j;for(i=0;i<dimension;++i){vars.push(["i",i,"=0"].join(""))}for(j=0;j<nargs;++j){for(i=0;i<dimension;++i){pidx=idx;idx=order[i];if(i===0){vars.push(["d",j,"s",i,"=t",j,"p",idx].join(""))}else{vars.push(["d",j,"s",i,"=(t",j,"p",idx,"-s",pidx,"*t",j,"p",pidx,")"].join(""))}}}code.push("var "+vars.join(","));for(i=dimension-1;i>=0;--i){idx=order[i];code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""))}code.push(body);for(i=0;i<dimension;++i){pidx=idx;idx=order[i];for(j=0;j<nargs;++j){code.push(["p",j,"+=d",j,"s",i].join(""))}if(has_index){if(i>0){code.push(["index[",pidx,"]-=s",pidx].join(""))}code.push(["++index[",idx,"]"].join(""))}code.push("}")}return code.join("\n")}function outerFill(matched,order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[];for(var i=0;i<nargs;++i){code.push(["var offset",i,"=p",i].join(""))}for(var i=matched;i<dimension;++i){code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join(""));code.push(["if(j",i,"<",blockSize,"){"].join(""));code.push(["s",order[i],"=j",i].join(""));code.push(["j",i,"=0"].join(""));code.push(["}else{s",order[i],"=",blockSize].join(""));code.push(["j",i,"-=",blockSize,"}"].join(""));if(has_index){code.push(["index[",order[i],"]=j",i].join(""))}}for(var i=0;i<nargs;++i){var indexStr=["offset"+i];for(var j=matched;j<dimension;++j){indexStr.push(["j",j,"*t",i,"p",order[j]].join(""))}code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}code.push(innerFill(order,proc,body));for(var i=matched;i<dimension;++i){code.push("}")}return code.join("\n")}function countMatches(orders){var matched=0,dimension=orders[0].length;while(matched<dimension){for(var j=1;j<orders.length;++j){if(orders[j][matched]!==orders[0][matched]){return matched}}++matched}return matched}function processBlock(block,proc,dtypes){var code=block.body;var pre=[];var post=[];for(var i=0;i<block.args.length;++i){var carg=block.args[i];if(carg.count<=0){continue}var re=new RegExp(carg.name,"g");var ptrStr="";var arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case"offset":var offArgIndex=proc.offsetArgIndex.indexOf(i);var offArg=proc.offsetArgs[offArgIndex];arrNum=offArg.array;ptrStr="+q"+offArgIndex;case"array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i;var arrStr="a"+arrNum;if(carg.count===1){if(dtypes[arrNum]==="generic"){if(carg.lvalue){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}else{code=code.replace(re,[arrStr,".get(",ptrStr,")"].join(""))}}else{code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}}else if(dtypes[arrNum]==="generic"){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);if(carg.lvalue){post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}}else{pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join(""));code=code.replace(re,localStr);if(carg.lvalue){post.push([arrStr,"[",ptrStr,"]=",localStr].join(""))}}break;case"scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case"index":code=code.replace(re,"index");break;case"shape":code=code.replace(re,"shape");break}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}function typeSummary(dtypes){var summary=new Array(dtypes.length);var allEqual=true;for(var i=0;i<dtypes.length;++i){var t=dtypes[i];var digits=t.match(/\d+/);if(!digits){digits=""}else{digits=digits[0]}if(t.charAt(0)===0){summary[i]="u"+t.charAt(1)+digits}else{summary[i]=t.charAt(0)+digits}if(i>0){allEqual=allEqual&&summary[i]===summary[i-1]}}if(allEqual){return summary[0]}return summary.join("")}function generateCWiseOp(proc,typesig){var dimension=typesig[1].length|0;var orders=new Array(proc.arrayArgs.length);var dtypes=new Array(proc.arrayArgs.length);var arglist=["SS"];var code=["'use strict'"];var vars=[];for(var j=0;j<dimension;++j){vars.push(["s",j,"=SS[",j,"]"].join(""))}for(var i=0;i<proc.arrayArgs.length;++i){arglist.push("a"+i);arglist.push("t"+i);arglist.push("p"+i);dtypes[i]=typesig[2*i];orders[i]=typesig[2*i+1];for(var j=0;j<dimension;++j){vars.push(["t",i,"p",j,"=t",i,"[",j,"]"].join(""))}}for(var i=0;i<proc.scalarArgs.length;++i){arglist.push("Y"+i)}if(proc.shapeArgs.length>0){vars.push("shape=SS.slice(0)")}if(proc.indexArgs.length>0){var zeros=new Array(dimension);for(var i=0;i<dimension;++i){zeros[i]="0"}vars.push(["index=[",zeros.join(","),"]"].join(""))}for(var i=0;i<proc.offsetArgs.length;++i){var off_arg=proc.offsetArgs[i];var init_string=[];for(var j=0;j<off_arg.offset.length;++j){if(off_arg.offset[j]===0){continue}else if(off_arg.offset[j]===1){init_string.push(["t",off_arg.array,"p",j].join(""))}else{init_string.push([off_arg.offset[j],"*t",off_arg.array,"p",j].join(""))}}if(init_string.length===0){vars.push("q"+i+"=0")}else{vars.push(["q",i,"=",init_string.join("+")].join(""))}}var thisVars=uniq([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));vars=vars.concat(thisVars);code.push("var "+vars.join(","));for(var i=0;i<proc.arrayArgs.length;++i){code.push("p"+i+"|=0")}if(proc.pre.body.length>3){code.push(processBlock(proc.pre,proc,dtypes))}var body=processBlock(proc.body,proc,dtypes);var matched=countMatches(orders);if(matched<dimension){code.push(outerFill(matched,orders[0],proc,body))}else{code.push(innerFill(orders[0],proc,body))}if(proc.post.body.length>3){code.push(processBlock(proc.post,proc,dtypes))}if(proc.debug){console.log("Generated cwise routine for ",typesig,":\n\n",code.join("\n"))}var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,typeSummary(dtypes)].join("");var f=new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""));return f()}module.exports=generateCWiseOp},{uniq:106}],105:[function(require,module,exports){"use strict";var compile=require("./compile.js");function createThunk(proc){var code=["'use strict'","var CACHED={}"];var vars=[];var thunkName=proc.funcName+"_cwise_thunk";code.push(["return function ",thunkName,"(",proc.shimArgs.join(","),"){"].join(""));var typesig=[];var string_typesig=[];var proc_args=[["array",proc.arrayArgs[0],".shape"].join("")];for(var i=0;i<proc.arrayArgs.length;++i){var j=proc.arrayArgs[i];vars.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join(""));typesig.push("t"+j);typesig.push("r"+j);string_typesig.push("t"+j);string_typesig.push("r"+j+".join()");proc_args.push("array"+j+".data");proc_args.push("array"+j+".stride");proc_args.push("array"+j+".offset|0")}for(var i=0;i<proc.scalarArgs.length;++i){proc_args.push("scalar"+proc.scalarArgs[i])}vars.push(["type=[",string_typesig.join(","),"].join()"].join(""));vars.push("proc=CACHED[type]");code.push("var "+vars.join(","));code.push(["if(!proc){","CACHED[type]=proc=compile([",typesig.join(","),"])}","return proc(",proc_args.join(","),")}"].join(""));if(proc.debug){console.log("Generated thunk:",code.join("\n"))}var thunk=new Function("compile",code.join("\n"));return thunk(compile.bind(undefined,proc))}module.exports=createThunk},{"./compile.js":104}],106:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],107:[function(require,module,exports){"use strict";module.exports=findZeroCrossings;var core=require("./lib/zc-core");function findZeroCrossings(array,level){var cross=[];level=+level||0;core(array.hi(array.shape[0]-1),cross,level);return cross}},{"./lib/zc-core":102}],108:[function(require,module,exports){"use strict";module.exports=surfaceNets;var generateContourExtractor=require("ndarray-extract-contour");var triangulateCube=require("triangulate-hypercube");var zeroCrossings=require("zero-crossings");function buildSurfaceNets(order,dtype){var dimension=order.length;var code=["'use strict';"];var funcName="surfaceNets"+order.join("_")+"d"+dtype;code.push("var contour=genContour({","order:[",order.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");if(dtype==="generic"){code.push("getters:[0],")}var cubeArgs=[];var extraArgs=[];for(var i=0;i<dimension;++i){cubeArgs.push("d"+i);extraArgs.push("d"+i)}for(var i=0;i<1<<dimension;++i){cubeArgs.push("v"+i);extraArgs.push("v"+i)}for(var i=0;i<1<<dimension;++i){cubeArgs.push("p"+i);extraArgs.push("p"+i)}cubeArgs.push("a","b","c");extraArgs.push("a","c");code.push("vertex:function vertexFunc(",cubeArgs.join(),"){");var maskStr=[];for(var i=0;i<1<<dimension;++i){maskStr.push("(p"+i+"<<"+i+")")}code.push("var m=(",maskStr.join("+"),")|0;if(m===0||m===",(1<<(1<<dimension))-1,"){return}");var extraFuncs=[];var currentFunc=[];if(1<<(1<<dimension)<=128){code.push("switch(m){");currentFunc=code}else{code.push("switch(m>>>7){")}for(var i=0;i<1<<(1<<dimension);++i){if(1<<(1<<dimension)>128){if(i%128===0){if(extraFuncs.length>0){currentFunc.push("}}")}var efName="vExtra"+extraFuncs.length;code.push("case ",i>>>7,":",efName,"(m&0x7f,",extraArgs.join(),");break;");currentFunc=["function ",efName,"(m,",extraArgs.join(),"){switch(m){"];extraFuncs.push(currentFunc)}}currentFunc.push("case ",i&127,":");var crossings=new Array(dimension);var denoms=new Array(dimension);var crossingCount=new Array(dimension);var bias=new Array(dimension);var totalCrossings=0;for(var j=0;j<dimension;++j){crossings[j]=[];denoms[j]=[];crossingCount[j]=0;bias[j]=0}for(var j=0;j<1<<dimension;++j){for(var k=0;k<dimension;++k){var u=j^1<<k;if(u>j){continue}if(!(i&1<<u)!==!(i&1<<j)){var sign=1;if(i&1<<u){denoms[k].push("v"+u+"-v"+j)}else{denoms[k].push("v"+j+"-v"+u);sign=-sign}if(sign<0){crossings[k].push("-v"+j+"-v"+u);crossingCount[k]+=2}else{crossings[k].push("v"+j+"+v"+u);crossingCount[k]-=2}totalCrossings+=1;for(var l=0;l<dimension;++l){if(l===k){continue}if(u&1<<l){bias[l]+=1}else{bias[l]-=1}}}}}var vertexStr=[];for(var k=0;k<dimension;++k){if(crossings[k].length===0){vertexStr.push("d"+k+"-0.5")}else{var cStr="";if(crossingCount[k]<0){cStr=crossingCount[k]+"*c"}else if(crossingCount[k]>0){cStr="+"+crossingCount[k]+"*c"}var weight=.5*(crossings[k].length/totalCrossings);var shift=.5+.5*(bias[k]/totalCrossings);vertexStr.push("d"+k+"-"+shift+"-"+weight+"*("+crossings[k].join("+")+cStr+")/("+denoms[k].join("+")+")")}}currentFunc.push("a.push([",vertexStr.join(),"]);","break;")}code.push("}},");if(extraFuncs.length>0){currentFunc.push("}}")}var faceArgs=[];for(var i=0;i<1<<dimension-1;++i){faceArgs.push("v"+i)}faceArgs.push("c0","c1","p0","p1","a","b","c");code.push("cell:function cellFunc(",faceArgs.join(),"){");var facets=triangulateCube(dimension-1);code.push("if(p0){b.push(",facets.map(function(f){return"["+f.map(function(v){return"v"+v})+"]"}).join(),")}else{b.push(",facets.map(function(f){var e=f.slice();e.reverse();return"["+e.map(function(v){return"v"+v})+"]"}).join(),")}}});function ",funcName,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",funcName,";");for(var i=0;i<extraFuncs.length;++i){code.push(extraFuncs[i].join(""))}var proc=new Function("genContour",code.join(""));return proc(generateContourExtractor)}function mesh1D(array,level){var zc=zeroCrossings(array,level);var n=zc.length;var npos=new Array(n);var ncel=new Array(n);for(var i=0;i<n;++i){npos[i]=[zc[i]];ncel[i]=[i]}return{positions:npos,cells:ncel}}var CACHE={};function surfaceNets(array,level){if(array.dimension<=0){return{positions:[],cells:[]}}else if(array.dimension===1){return mesh1D(array,level)}var typesig=array.order.join()+"-"+array.dtype;var proc=CACHE[typesig];var level=+level||0;if(!proc){proc=CACHE[typesig]=buildSurfaceNets(array.order,array.dtype)}return proc(array,level)}},{"ndarray-extract-contour":90,"triangulate-hypercube":101,"zero-crossings":107}],109:[function(require,module,exports){module.exports={version:"1.3.3"}},{}],110:[function(require,module,exports){"use strict";var Node=function(p,t){this.point=p;this.triangle=t||null;this.next=null;this.prev=null;this.value=p.x};var AdvancingFront=function(head,tail){this.head_=head;this.tail_=tail;this.search_node_=head};AdvancingFront.prototype.head=function(){return this.head_};AdvancingFront.prototype.setHead=function(node){this.head_=node};AdvancingFront.prototype.tail=function(){return this.tail_};AdvancingFront.prototype.setTail=function(node){this.tail_=node};AdvancingFront.prototype.search=function(){return this.search_node_};AdvancingFront.prototype.setSearch=function(node){this.search_node_=node};AdvancingFront.prototype.findSearchNode=function(){return this.search_node_};AdvancingFront.prototype.locateNode=function(x){var node=this.search_node_;if(x<node.value){while(node=node.prev){if(x>=node.value){this.search_node_=node;return node}}}else{while(node=node.next){if(x<node.value){this.search_node_=node.prev;return node.prev}}}return null};AdvancingFront.prototype.locatePoint=function(point){var px=point.x;var node=this.findSearchNode(px);var nx=node.point.x;if(px===nx){if(point!==node.point){if(point===node.prev.point){node=node.prev}else if(point===node.next.point){node=node.next}else{throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call")}}}else if(px<nx){while(node=node.prev){if(point===node.point){break}}}else{while(node=node.next){if(point===node.point){break}}}if(node){this.search_node_=node}return node};module.exports=AdvancingFront;module.exports.Node=Node},{}],111:[function(require,module,exports){"use strict";var xy=require("./xy");var Point=function(x,y){this.x=+x||0;this.y=+y||0;this._p2t_edge_list=null};Point.prototype.toString=function(){return xy.toStringBase(this)};Point.prototype.clone=function(){return new Point(this.x,this.y)};Point.prototype.set_zero=function(){this.x=0;this.y=0;return this};Point.prototype.set=function(x,y){this.x=+x||0;this.y=+y||0;return this};Point.prototype.negate=function(){this.x=-this.x;this.y=-this.y;return this};Point.prototype.add=function(n){this.x+=n.x;this.y+=n.y;return this};Point.prototype.sub=function(n){this.x-=n.x;this.y-=n.y;return this};Point.prototype.mul=function(s){this.x*=s;this.y*=s;return this};Point.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};Point.prototype.normalize=function(){var len=this.length();this.x/=len;this.y/=len;return len};Point.prototype.equals=function(p){return this.x===p.x&&this.y===p.y};Point.negate=function(p){return new Point(-p.x,-p.y)};Point.add=function(a,b){return new Point(a.x+b.x,a.y+b.y)};Point.sub=function(a,b){return new Point(a.x-b.x,a.y-b.y)};Point.mul=function(s,p){return new Point(s*p.x,s*p.y)};Point.cross=function(a,b){if(typeof a==="number"){if(typeof b==="number"){return a*b}else{return new Point(-a*b.y,a*b.x)}}else{if(typeof b==="number"){return new Point(b*a.y,-b*a.x)}else{return a.x*b.y-a.y*b.x}}};Point.toString=xy.toString;Point.compare=xy.compare;Point.cmp=xy.compare;Point.equals=xy.equals;Point.dot=function(a,b){return a.x*b.x+a.y*b.y};module.exports=Point},{"./xy":118}],112:[function(require,module,exports){"use strict";var xy=require("./xy");var PointError=function(message,points){this.name="PointError";this.points=points=points||[];this.message=message||"Invalid Points!";for(var i=0;i<points.length;i++){this.message+=" "+xy.toString(points[i])}};PointError.prototype=new Error;PointError.prototype.constructor=PointError;module.exports=PointError},{"./xy":118}],113:[function(require,module,exports){(function(global){"use strict";var previousPoly2tri=global.poly2tri;exports.noConflict=function(){global.poly2tri=previousPoly2tri;return exports};exports.VERSION=require("../dist/version.json").version;exports.PointError=require("./pointerror");exports.Point=require("./point");exports.Triangle=require("./triangle");exports.SweepContext=require("./sweepcontext");var sweep=require("./sweep");exports.triangulate=sweep.triangulate;exports.sweep={Triangulate:sweep.triangulate}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../dist/version.json":109,"./point":111,"./pointerror":112,"./sweep":114,"./sweepcontext":115,"./triangle":116}],114:[function(require,module,exports){"use strict";var PointError=require("./pointerror");var Triangle=require("./triangle");var Node=require("./advancingfront").Node;var utils=require("./utils");var PI_3div4=3*Math.PI/4;var PI_div2=Math.PI/2;var EPSILON=utils.EPSILON;var Orientation=utils.Orientation;var orient2d=utils.orient2d;var inScanArea=utils.inScanArea;function triangulate(tcx){tcx.initTriangulation();tcx.createAdvancingFront();sweepPoints(tcx);finalizationPolygon(tcx)}function sweepPoints(tcx){var i,len=tcx.pointCount();for(i=1;i<len;++i){var point=tcx.getPoint(i);var node=pointEvent(tcx,point);var edges=point._p2t_edge_list;for(var j=0;edges&&j<edges.length;++j){edgeEventByEdge(tcx,edges[j],node)}}}function finalizationPolygon(tcx){var t=tcx.front().head().next.triangle;var p=tcx.front().head().next.point;while(!t.getConstrainedEdgeCW(p)){t=t.neighborCCW(p)}tcx.meshClean(t)}function pointEvent(tcx,point){var node=tcx.locateNode(point);var new_node=newFrontTriangle(tcx,point,node);if(point.x<=node.point.x+EPSILON){fill(tcx,node)}fillAdvancingFront(tcx,new_node);return new_node}function edgeEventByEdge(tcx,edge,node){tcx.edge_event.constrained_edge=edge;tcx.edge_event.right=edge.p.x>edge.q.x;if(isEdgeSideOfTriangle(node.triangle,edge.p,edge.q)){return}fillEdgeEvent(tcx,edge,node);edgeEventByPoints(tcx,edge.p,edge.q,node.triangle,edge.q)}function edgeEventByPoints(tcx,ep,eq,triangle,point){if(isEdgeSideOfTriangle(triangle,ep,eq)){return}var p1=triangle.pointCCW(point);var o1=orient2d(eq,p1,ep);if(o1===Orientation.COLLINEAR){throw new PointError("poly2tri EdgeEvent: Collinear not supported!",[eq,p1,ep])}var p2=triangle.pointCW(point);var o2=orient2d(eq,p2,ep);if(o2===Orientation.COLLINEAR){throw new PointError("poly2tri EdgeEvent: Collinear not supported!",[eq,p2,ep])}if(o1===o2){if(o1===Orientation.CW){triangle=triangle.neighborCCW(point)}else{triangle=triangle.neighborCW(point)}edgeEventByPoints(tcx,ep,eq,triangle,point)}else{flipEdgeEvent(tcx,ep,eq,triangle,point)}}function isEdgeSideOfTriangle(triangle,ep,eq){var index=triangle.edgeIndex(ep,eq);if(index!==-1){triangle.markConstrainedEdgeByIndex(index);var t=triangle.getNeighbor(index);if(t){t.markConstrainedEdgeByPoints(ep,eq)}return true}return false}function newFrontTriangle(tcx,point,node){var triangle=new Triangle(point,node.point,node.next.point);triangle.markNeighbor(node.triangle);tcx.addToMap(triangle);var new_node=new Node(point);new_node.next=node.next;new_node.prev=node;node.next.prev=new_node;node.next=new_node;if(!legalize(tcx,triangle)){tcx.mapTriangleToNodes(triangle)}return new_node}function fill(tcx,node){var triangle=new Triangle(node.prev.point,node.point,node.next.point);triangle.markNeighbor(node.prev.triangle);triangle.markNeighbor(node.triangle);tcx.addToMap(triangle);node.prev.next=node.next;node.next.prev=node.prev;if(!legalize(tcx,triangle)){tcx.mapTriangleToNodes(triangle)}}function fillAdvancingFront(tcx,n){var node=n.next;var angle;while(node.next){angle=holeAngle(node);if(angle>PI_div2||angle<-PI_div2){break}fill(tcx,node);node=node.next}node=n.prev;while(node.prev){angle=holeAngle(node);if(angle>PI_div2||angle<-PI_div2){break}fill(tcx,node);node=node.prev}if(n.next&&n.next.next){angle=basinAngle(n);if(angle<PI_3div4){fillBasin(tcx,n)}}}function basinAngle(node){var ax=node.point.x-node.next.next.point.x;var ay=node.point.y-node.next.next.point.y;return Math.atan2(ay,ax)}function holeAngle(node){var ax=node.next.point.x-node.point.x;var ay=node.next.point.y-node.point.y;var bx=node.prev.point.x-node.point.x;var by=node.prev.point.y-node.point.y;return Math.atan2(ax*by-ay*bx,ax*bx+ay*by)}function legalize(tcx,t){for(var i=0;i<3;++i){if(t.delaunay_edge[i]){continue}var ot=t.getNeighbor(i);if(ot){var p=t.getPoint(i);var op=ot.oppositePoint(t,p);var oi=ot.index(op);if(ot.constrained_edge[oi]||ot.delaunay_edge[oi]){t.constrained_edge[i]=ot.constrained_edge[oi];continue}var inside=inCircle(p,t.pointCCW(p),t.pointCW(p),op);if(inside){t.delaunay_edge[i]=true;ot.delaunay_edge[oi]=true;rotateTrianglePair(t,p,ot,op);var not_legalized=!legalize(tcx,t);if(not_legalized){tcx.mapTriangleToNodes(t)}not_legalized=!legalize(tcx,ot);if(not_legalized){tcx.mapTriangleToNodes(ot)}t.delaunay_edge[i]=false;ot.delaunay_edge[oi]=false;return true}}}return false}function inCircle(pa,pb,pc,pd){var adx=pa.x-pd.x;var ady=pa.y-pd.y;var bdx=pb.x-pd.x;var bdy=pb.y-pd.y;var adxbdy=adx*bdy;var bdxady=bdx*ady;var oabd=adxbdy-bdxady;if(oabd<=0){return false}var cdx=pc.x-pd.x;var cdy=pc.y-pd.y;var cdxady=cdx*ady;var adxcdy=adx*cdy;var ocad=cdxady-adxcdy;if(ocad<=0){return false}var bdxcdy=bdx*cdy;var cdxbdy=cdx*bdy;var alift=adx*adx+ady*ady;var blift=bdx*bdx+bdy*bdy;var clift=cdx*cdx+cdy*cdy;var det=alift*(bdxcdy-cdxbdy)+blift*ocad+clift*oabd;return det>0}function rotateTrianglePair(t,p,ot,op){var n1,n2,n3,n4;n1=t.neighborCCW(p);n2=t.neighborCW(p);n3=ot.neighborCCW(op);n4=ot.neighborCW(op);var ce1,ce2,ce3,ce4;ce1=t.getConstrainedEdgeCCW(p);ce2=t.getConstrainedEdgeCW(p);ce3=ot.getConstrainedEdgeCCW(op);ce4=ot.getConstrainedEdgeCW(op);var de1,de2,de3,de4;de1=t.getDelaunayEdgeCCW(p);de2=t.getDelaunayEdgeCW(p);de3=ot.getDelaunayEdgeCCW(op);de4=ot.getDelaunayEdgeCW(op);t.legalize(p,op);ot.legalize(op,p);ot.setDelaunayEdgeCCW(p,de1);t.setDelaunayEdgeCW(p,de2);t.setDelaunayEdgeCCW(op,de3);ot.setDelaunayEdgeCW(op,de4);ot.setConstrainedEdgeCCW(p,ce1);t.setConstrainedEdgeCW(p,ce2);t.setConstrainedEdgeCCW(op,ce3);ot.setConstrainedEdgeCW(op,ce4);t.clearNeigbors();ot.clearNeigbors();if(n1){ot.markNeighbor(n1)}if(n2){t.markNeighbor(n2)}if(n3){t.markNeighbor(n3)}if(n4){ot.markNeighbor(n4)}t.markNeighbor(ot)}function fillBasin(tcx,node){if(orient2d(node.point,node.next.point,node.next.next.point)===Orientation.CCW){tcx.basin.left_node=node.next.next}else{tcx.basin.left_node=node.next}tcx.basin.bottom_node=tcx.basin.left_node;while(tcx.basin.bottom_node.next&&tcx.basin.bottom_node.point.y>=tcx.basin.bottom_node.next.point.y){tcx.basin.bottom_node=tcx.basin.bottom_node.next}if(tcx.basin.bottom_node===tcx.basin.left_node){return}tcx.basin.right_node=tcx.basin.bottom_node;while(tcx.basin.right_node.next&&tcx.basin.right_node.point.y<tcx.basin.right_node.next.point.y){tcx.basin.right_node=tcx.basin.right_node.next}if(tcx.basin.right_node===tcx.basin.bottom_node){return}tcx.basin.width=tcx.basin.right_node.point.x-tcx.basin.left_node.point.x;tcx.basin.left_highest=tcx.basin.left_node.point.y>tcx.basin.right_node.point.y;fillBasinReq(tcx,tcx.basin.bottom_node)}function fillBasinReq(tcx,node){if(isShallow(tcx,node)){return}fill(tcx,node);var o;if(node.prev===tcx.basin.left_node&&node.next===tcx.basin.right_node){return}else if(node.prev===tcx.basin.left_node){o=orient2d(node.point,node.next.point,node.next.next.point);if(o===Orientation.CW){return}node=node.next}else if(node.next===tcx.basin.right_node){o=orient2d(node.point,node.prev.point,node.prev.prev.point);if(o===Orientation.CCW){return}node=node.prev}else{if(node.prev.point.y<node.next.point.y){node=node.prev}else{node=node.next}}fillBasinReq(tcx,node)}function isShallow(tcx,node){var height;if(tcx.basin.left_highest){height=tcx.basin.left_node.point.y-node.point.y}else{height=tcx.basin.right_node.point.y-node.point.y}if(tcx.basin.width>height){return true}return false}function fillEdgeEvent(tcx,edge,node){if(tcx.edge_event.right){fillRightAboveEdgeEvent(tcx,edge,node)}else{fillLeftAboveEdgeEvent(tcx,edge,node)}}function fillRightAboveEdgeEvent(tcx,edge,node){while(node.next.point.x<edge.p.x){if(orient2d(edge.q,node.next.point,edge.p)===Orientation.CCW){fillRightBelowEdgeEvent(tcx,edge,node)}else{node=node.next}}}function fillRightBelowEdgeEvent(tcx,edge,node){if(node.point.x<edge.p.x){if(orient2d(node.point,node.next.point,node.next.next.point)===Orientation.CCW){fillRightConcaveEdgeEvent(tcx,edge,node)}else{fillRightConvexEdgeEvent(tcx,edge,node);fillRightBelowEdgeEvent(tcx,edge,node)}}}function fillRightConcaveEdgeEvent(tcx,edge,node){fill(tcx,node.next);if(node.next.point!==edge.p){if(orient2d(edge.q,node.next.point,edge.p)===Orientation.CCW){if(orient2d(node.point,node.next.point,node.next.next.point)===Orientation.CCW){fillRightConcaveEdgeEvent(tcx,edge,node)}else{}}}}function fillRightConvexEdgeEvent(tcx,edge,node){if(orient2d(node.next.point,node.next.next.point,node.next.next.next.point)===Orientation.CCW){fillRightConcaveEdgeEvent(tcx,edge,node.next)}else{if(orient2d(edge.q,node.next.next.point,edge.p)===Orientation.CCW){fillRightConvexEdgeEvent(tcx,edge,node.next)}else{}}}function fillLeftAboveEdgeEvent(tcx,edge,node){while(node.prev.point.x>edge.p.x){if(orient2d(edge.q,node.prev.point,edge.p)===Orientation.CW){fillLeftBelowEdgeEvent(tcx,edge,node)}else{node=node.prev}}}function fillLeftBelowEdgeEvent(tcx,edge,node){if(node.point.x>edge.p.x){if(orient2d(node.point,node.prev.point,node.prev.prev.point)===Orientation.CW){fillLeftConcaveEdgeEvent(tcx,edge,node)}else{fillLeftConvexEdgeEvent(tcx,edge,node);fillLeftBelowEdgeEvent(tcx,edge,node)}}}function fillLeftConvexEdgeEvent(tcx,edge,node){if(orient2d(node.prev.point,node.prev.prev.point,node.prev.prev.prev.point)===Orientation.CW){fillLeftConcaveEdgeEvent(tcx,edge,node.prev)}else{if(orient2d(edge.q,node.prev.prev.point,edge.p)===Orientation.CW){fillLeftConvexEdgeEvent(tcx,edge,node.prev)}else{}}}function fillLeftConcaveEdgeEvent(tcx,edge,node){fill(tcx,node.prev);if(node.prev.point!==edge.p){if(orient2d(edge.q,node.prev.point,edge.p)===Orientation.CW){if(orient2d(node.point,node.prev.point,node.prev.prev.point)===Orientation.CW){fillLeftConcaveEdgeEvent(tcx,edge,node)}else{}}}}function flipEdgeEvent(tcx,ep,eq,t,p){var ot=t.neighborAcross(p);if(!ot){throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle!")}var op=ot.oppositePoint(t,p);if(t.getConstrainedEdgeAcross(p)){var index=t.index(p);throw new PointError("poly2tri Intersecting Constraints",[p,op,t.getPoint((index+1)%3),t.getPoint((index+2)%3)])}if(inScanArea(p,t.pointCCW(p),t.pointCW(p),op)){rotateTrianglePair(t,p,ot,op);tcx.mapTriangleToNodes(t);tcx.mapTriangleToNodes(ot);if(p===eq&&op===ep){if(eq===tcx.edge_event.constrained_edge.q&&ep===tcx.edge_event.constrained_edge.p){t.markConstrainedEdgeByPoints(ep,eq);ot.markConstrainedEdgeByPoints(ep,eq);legalize(tcx,t);legalize(tcx,ot)}else{}}else{var o=orient2d(eq,op,ep);t=nextFlipTriangle(tcx,o,t,ot,p,op);flipEdgeEvent(tcx,ep,eq,t,p)}}else{var newP=nextFlipPoint(ep,eq,ot,op);flipScanEdgeEvent(tcx,ep,eq,t,ot,newP);edgeEventByPoints(tcx,ep,eq,t,p)}}function nextFlipTriangle(tcx,o,t,ot,p,op){var edge_index;if(o===Orientation.CCW){edge_index=ot.edgeIndex(p,op);ot.delaunay_edge[edge_index]=true;legalize(tcx,ot);ot.clearDelunayEdges();return t}edge_index=t.edgeIndex(p,op);t.delaunay_edge[edge_index]=true;legalize(tcx,t);t.clearDelunayEdges();return ot}function nextFlipPoint(ep,eq,ot,op){var o2d=orient2d(eq,op,ep);if(o2d===Orientation.CW){return ot.pointCCW(op)}else if(o2d===Orientation.CCW){return ot.pointCW(op)}else{throw new PointError("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[eq,op,ep])}}function flipScanEdgeEvent(tcx,ep,eq,flip_triangle,t,p){var ot=t.neighborAcross(p);if(!ot){throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle")}var op=ot.oppositePoint(t,p);if(inScanArea(eq,flip_triangle.pointCCW(eq),flip_triangle.pointCW(eq),op)){flipEdgeEvent(tcx,eq,op,ot,op)}else{var newP=nextFlipPoint(ep,eq,ot,op);flipScanEdgeEvent(tcx,ep,eq,flip_triangle,ot,newP)}}exports.triangulate=triangulate},{"./advancingfront":110,"./pointerror":112,"./triangle":116,"./utils":117}],115:[function(require,module,exports){"use strict";var PointError=require("./pointerror");var Point=require("./point");var Triangle=require("./triangle");var sweep=require("./sweep");var AdvancingFront=require("./advancingfront");var Node=AdvancingFront.Node;var kAlpha=.3;var Edge=function(p1,p2){this.p=p1;this.q=p2;if(p1.y>p2.y){this.q=p1;this.p=p2}else if(p1.y===p2.y){if(p1.x>p2.x){this.q=p1;this.p=p2}else if(p1.x===p2.x){throw new PointError("poly2tri Invalid Edge constructor: repeated points!",[p1])}}if(!this.q._p2t_edge_list){this.q._p2t_edge_list=[]}this.q._p2t_edge_list.push(this)};var Basin=function(){this.left_node=null;this.bottom_node=null;this.right_node=null;this.width=0;this.left_highest=false};Basin.prototype.clear=function(){this.left_node=null;this.bottom_node=null;this.right_node=null;this.width=0;this.left_highest=false};var EdgeEvent=function(){this.constrained_edge=null;this.right=false};var SweepContext=function(contour,options){options=options||{};this.triangles_=[];this.map_=[];this.points_=options.cloneArrays?contour.slice(0):contour;this.edge_list=[];this.pmin_=this.pmax_=null;this.front_=null;this.head_=null;this.tail_=null;this.af_head_=null;this.af_middle_=null;this.af_tail_=null;this.basin=new Basin;this.edge_event=new EdgeEvent;this.initEdges(this.points_)};SweepContext.prototype.addHole=function(polyline){this.initEdges(polyline);var i,len=polyline.length;for(i=0;i<len;i++){this.points_.push(polyline[i])}return this};SweepContext.prototype.AddHole=SweepContext.prototype.addHole;SweepContext.prototype.addPoint=function(point){this.points_.push(point);return this};SweepContext.prototype.AddPoint=SweepContext.prototype.addPoint;SweepContext.prototype.addPoints=function(points){this.points_=this.points_.concat(points);return this};SweepContext.prototype.triangulate=function(){sweep.triangulate(this);return this};SweepContext.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}};SweepContext.prototype.getTriangles=function(){return this.triangles_};SweepContext.prototype.GetTriangles=SweepContext.prototype.getTriangles;SweepContext.prototype.front=function(){return this.front_};SweepContext.prototype.pointCount=function(){return this.points_.length};SweepContext.prototype.head=function(){return this.head_};SweepContext.prototype.setHead=function(p1){this.head_=p1};SweepContext.prototype.tail=function(){return this.tail_};SweepContext.prototype.setTail=function(p1){this.tail_=p1};SweepContext.prototype.getMap=function(){return this.map_};SweepContext.prototype.initTriangulation=function(){var xmax=this.points_[0].x;var xmin=this.points_[0].x;var ymax=this.points_[0].y;var ymin=this.points_[0].y;var i,len=this.points_.length;for(i=1;i<len;i++){var p=this.points_[i];p.x>xmax&&(xmax=p.x);p.x<xmin&&(xmin=p.x);p.y>ymax&&(ymax=p.y);p.y<ymin&&(ymin=p.y)}this.pmin_=new Point(xmin,ymin);this.pmax_=new Point(xmax,ymax);var dx=kAlpha*(xmax-xmin);var dy=kAlpha*(ymax-ymin);this.head_=new Point(xmax+dx,ymin-dy);this.tail_=new Point(xmin-dx,ymin-dy);this.points_.sort(Point.compare)};SweepContext.prototype.initEdges=function(polyline){var i,len=polyline.length;for(i=0;i<len;++i){this.edge_list.push(new Edge(polyline[i],polyline[(i+1)%len]))}};SweepContext.prototype.getPoint=function(index){return this.points_[index]};SweepContext.prototype.addToMap=function(triangle){this.map_.push(triangle)};SweepContext.prototype.locateNode=function(point){return this.front_.locateNode(point.x)};SweepContext.prototype.createAdvancingFront=function(){var head;var middle;var tail;var triangle=new Triangle(this.points_[0],this.tail_,this.head_);this.map_.push(triangle);head=new Node(triangle.getPoint(1),triangle);middle=new Node(triangle.getPoint(0),triangle);tail=new Node(triangle.getPoint(2));this.front_=new AdvancingFront(head,tail);head.next=middle;middle.next=tail;middle.prev=head;tail.prev=middle};SweepContext.prototype.removeNode=function(node){};SweepContext.prototype.mapTriangleToNodes=function(t){for(var i=0;i<3;++i){if(!t.getNeighbor(i)){var n=this.front_.locatePoint(t.pointCW(t.getPoint(i)));if(n){n.triangle=t}}}};SweepContext.prototype.removeFromMap=function(triangle){var i,map=this.map_,len=map.length;for(i=0;i<len;i++){if(map[i]===triangle){map.splice(i,1);break}}};SweepContext.prototype.meshClean=function(triangle){var triangles=[triangle],t,i;while(t=triangles.pop()){if(!t.isInterior()){t.setInterior(true);this.triangles_.push(t);for(i=0;i<3;i++){if(!t.constrained_edge[i]){triangles.push(t.getNeighbor(i))}}}}};module.exports=SweepContext},{"./advancingfront":110,"./point":111,"./pointerror":112,"./sweep":114,"./triangle":116}],116:[function(require,module,exports){"use strict";var xy=require("./xy");var Triangle=function(a,b,c){this.points_=[a,b,c];this.neighbors_=[null,null,null];this.interior_=false;this.constrained_edge=[false,false,false];this.delaunay_edge=[false,false,false]};var p2s=xy.toString;Triangle.prototype.toString=function(){return"["+p2s(this.points_[0])+p2s(this.points_[1])+p2s(this.points_[2])+"]"};Triangle.prototype.getPoint=function(index){return this.points_[index]};Triangle.prototype.GetPoint=Triangle.prototype.getPoint;Triangle.prototype.getPoints=function(){return this.points_};Triangle.prototype.getNeighbor=function(index){return this.neighbors_[index]};Triangle.prototype.containsPoint=function(point){var points=this.points_;return point===points[0]||point===points[1]||point===points[2]};Triangle.prototype.containsEdge=function(edge){return this.containsPoint(edge.p)&&this.containsPoint(edge.q)};Triangle.prototype.containsPoints=function(p1,p2){return this.containsPoint(p1)&&this.containsPoint(p2)};Triangle.prototype.isInterior=function(){return this.interior_};Triangle.prototype.setInterior=function(interior){this.interior_=interior;return this};Triangle.prototype.markNeighborPointers=function(p1,p2,t){var points=this.points_;if(p1===points[2]&&p2===points[1]||p1===points[1]&&p2===points[2]){this.neighbors_[0]=t}else if(p1===points[0]&&p2===points[2]||p1===points[2]&&p2===points[0]){this.neighbors_[1]=t}else if(p1===points[0]&&p2===points[1]||p1===points[1]&&p2===points[0]){this.neighbors_[2]=t}else{throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call")}};Triangle.prototype.markNeighbor=function(t){var points=this.points_;if(t.containsPoints(points[1],points[2])){this.neighbors_[0]=t;t.markNeighborPointers(points[1],points[2],this)}else if(t.containsPoints(points[0],points[2])){this.neighbors_[1]=t;t.markNeighborPointers(points[0],points[2],this)}else if(t.containsPoints(points[0],points[1])){this.neighbors_[2]=t;t.markNeighborPointers(points[0],points[1],this)}};Triangle.prototype.clearNeigbors=function(){this.neighbors_[0]=null;this.neighbors_[1]=null;this.neighbors_[2]=null};Triangle.prototype.clearDelunayEdges=function(){this.delaunay_edge[0]=false;this.delaunay_edge[1]=false;this.delaunay_edge[2]=false};Triangle.prototype.pointCW=function(p){var points=this.points_;if(p===points[0]){return points[2]}else if(p===points[1]){return points[0]}else if(p===points[2]){return points[1]}else{return null}};Triangle.prototype.pointCCW=function(p){var points=this.points_;if(p===points[0]){return points[1]}else if(p===points[1]){return points[2]}else if(p===points[2]){return points[0]}else{return null}};Triangle.prototype.neighborCW=function(p){if(p===this.points_[0]){return this.neighbors_[1]}else if(p===this.points_[1]){return this.neighbors_[2]}else{return this.neighbors_[0]}};Triangle.prototype.neighborCCW=function(p){if(p===this.points_[0]){return this.neighbors_[2]}else if(p===this.points_[1]){return this.neighbors_[0]}else{return this.neighbors_[1]}};Triangle.prototype.getConstrainedEdgeCW=function(p){if(p===this.points_[0]){return this.constrained_edge[1]}else if(p===this.points_[1]){return this.constrained_edge[2]}else{return this.constrained_edge[0]}};Triangle.prototype.getConstrainedEdgeCCW=function(p){if(p===this.points_[0]){return this.constrained_edge[2]}else if(p===this.points_[1]){return this.constrained_edge[0]}else{return this.constrained_edge[1]}};Triangle.prototype.getConstrainedEdgeAcross=function(p){if(p===this.points_[0]){return this.constrained_edge[0]}else if(p===this.points_[1]){return this.constrained_edge[1]}else{return this.constrained_edge[2]}};Triangle.prototype.setConstrainedEdgeCW=function(p,ce){if(p===this.points_[0]){this.constrained_edge[1]=ce}else if(p===this.points_[1]){this.constrained_edge[2]=ce}else{this.constrained_edge[0]=ce}};Triangle.prototype.setConstrainedEdgeCCW=function(p,ce){if(p===this.points_[0]){this.constrained_edge[2]=ce}else if(p===this.points_[1]){this.constrained_edge[0]=ce}else{this.constrained_edge[1]=ce}};Triangle.prototype.getDelaunayEdgeCW=function(p){if(p===this.points_[0]){return this.delaunay_edge[1]}else if(p===this.points_[1]){return this.delaunay_edge[2]}else{return this.delaunay_edge[0]}};Triangle.prototype.getDelaunayEdgeCCW=function(p){if(p===this.points_[0]){return this.delaunay_edge[2]}else if(p===this.points_[1]){return this.delaunay_edge[0]}else{return this.delaunay_edge[1]}};Triangle.prototype.setDelaunayEdgeCW=function(p,e){if(p===this.points_[0]){this.delaunay_edge[1]=e}else if(p===this.points_[1]){this.delaunay_edge[2]=e}else{this.delaunay_edge[0]=e}};Triangle.prototype.setDelaunayEdgeCCW=function(p,e){if(p===this.points_[0]){this.delaunay_edge[2]=e}else if(p===this.points_[1]){this.delaunay_edge[0]=e}else{this.delaunay_edge[1]=e}};Triangle.prototype.neighborAcross=function(p){if(p===this.points_[0]){return this.neighbors_[0]}else if(p===this.points_[1]){return this.neighbors_[1]}else{return this.neighbors_[2]}};Triangle.prototype.oppositePoint=function(t,p){var cw=t.pointCW(p);return this.pointCW(cw)};Triangle.prototype.legalize=function(opoint,npoint){var points=this.points_;if(opoint===points[0]){points[1]=points[0];points[0]=points[2];points[2]=npoint}else if(opoint===points[1]){points[2]=points[1];points[1]=points[0];points[0]=npoint}else if(opoint===points[2]){points[0]=points[2];points[2]=points[1];points[1]=npoint}else{throw new Error("poly2tri Invalid Triangle.legalize() call")}};Triangle.prototype.index=function(p){var points=this.points_;if(p===points[0]){return 0}else if(p===points[1]){return 1}else if(p===points[2]){return 2}else{throw new Error("poly2tri Invalid Triangle.index() call")}};Triangle.prototype.edgeIndex=function(p1,p2){var points=this.points_;if(p1===points[0]){if(p2===points[1]){return 2}else if(p2===points[2]){return 1}}else if(p1===points[1]){if(p2===points[2]){return 0}else if(p2===points[0]){return 2}}else if(p1===points[2]){if(p2===points[0]){return 1}else if(p2===points[1]){return 0}}return-1};Triangle.prototype.markConstrainedEdgeByIndex=function(index){this.constrained_edge[index]=true};Triangle.prototype.markConstrainedEdgeByEdge=function(edge){this.markConstrainedEdgeByPoints(edge.p,edge.q)};Triangle.prototype.markConstrainedEdgeByPoints=function(p,q){var points=this.points_;if(q===points[0]&&p===points[1]||q===points[1]&&p===points[0]){this.constrained_edge[2]=true}else if(q===points[0]&&p===points[2]||q===points[2]&&p===points[0]){this.constrained_edge[1]=true}else if(q===points[1]&&p===points[2]||q===points[2]&&p===points[1]){this.constrained_edge[0]=true}};module.exports=Triangle},{"./xy":118}],117:[function(require,module,exports){"use strict";var EPSILON=1e-12;var Orientation={CW:1,CCW:-1,COLLINEAR:0};function orient2d(pa,pb,pc){var detleft=(pa.x-pc.x)*(pb.y-pc.y);var detright=(pa.y-pc.y)*(pb.x-pc.x);var val=detleft-detright;if(val>-EPSILON&&val<EPSILON){return Orientation.COLLINEAR}else if(val>0){return Orientation.CCW}else{return Orientation.CW}}function inScanArea(pa,pb,pc,pd){var oadb=(pa.x-pb.x)*(pd.y-pb.y)-(pd.x-pb.x)*(pa.y-pb.y);if(oadb>=-EPSILON){return false}var oadc=(pa.x-pc.x)*(pd.y-pc.y)-(pd.x-pc.x)*(pa.y-pc.y);if(oadc<=EPSILON){return false}return true}module.exports={EPSILON:EPSILON,Orientation:Orientation,orient2d:orient2d,inScanArea:inScanArea}},{}],118:[function(require,module,exports){"use strict";function toStringBase(p){return"("+p.x+";"+p.y+")"}function toString(p){var s=p.toString();return s==="[object Object]"?toStringBase(p):s}function compare(a,b){if(a.y===b.y){return a.x-b.x}else{return a.y-b.y}}function equals(a,b){return a.x===b.x&&a.y===b.y}module.exports={toString:toString,toStringBase:toStringBase,compare:compare,equals:equals}},{}],119:[function(require,module,exports){"use strict";module.exports=triangulateLoop;var poly2tri=require("poly2tri");function PointWrapper(x,y,idx){this.x=x;this.y=y;this.idx=idx}function triangulatePolyline(loops,positions,perturb){function convertLoop(loop){return loop.map(function(v){var p=positions[v];return new PointWrapper(p[0]+(.5-Math.random())*perturb*(1+Math.abs(p[0])),p[1]+(.5-Math.random())*perturb*(1+Math.abs(p[1])),v)})}var numLoops=loops.length;var outerLoop=0;var outerPoint=positions[loops[0][0]];for(var i=0;i<numLoops;++i){var loop=loops[i];var n=loop.length;for(var j=0;j<n;++j){var p=positions[loop[j]];var d=p[1]-outerPoint[1];if(d===0){d=p[0]-outerPoint[0]}if(d<0){outerPoint=p;outerLoop=i}}}var ctx=new poly2tri.SweepContext(convertLoop(loops[outerLoop]));for(var i=0;i<numLoops;++i){if(i===outerLoop){continue}ctx.addHole(convertLoop(loops[i]))}ctx.triangulate();var triangles=ctx.getTriangles();return triangles.map(function(tri){return[tri.getPoint(0).idx,tri.getPoint(1).idx,tri.getPoint(2).idx]})}function triangulateLoop(loops,positions){var p=0;for(var i=0;i<10;++i){try{return triangulatePolyline(loops,positions,p)}catch(e){}p=(p+1e-8)*2}return[]}},{poly2tri:113}],120:[function(require,module,exports){"use strict";module.exports=axesProperties;var glm=require("gl-matrix");var getPlanes=require("extract-frustum-planes");var splitPoly=require("split-polygon");var cubeParams=require("./lib/cube.js");var mat4=glm.mat4;var vec4=glm.vec4;var identity=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var mvp=new Float32Array(16);function AxesRange3D(lo,hi,pixelsPerDataUnit){this.lo=lo;this.hi=hi;this.pixelsPerDataUnit=pixelsPerDataUnit}function gradient(M,v,width,height){var result=[0,0,0];for(var i=0;i<3;++i){var q=[v[0],v[1],v[2],1];q[i]+=1;vec4.transformMat4(q,q,M);if(q[3]<0){result[i]=Infinity}var p=[v[0],v[1],v[2],1];p[i]-=1;vec4.transformMat4(p,p,M);if(p[3]<0){result[i]=Infinity}var dx=(p[0]/p[3]-q[0]/q[3])*width;var dy=(p[1]/p[3]-q[1]/q[3])*height;result[i]=.25*Math.sqrt(dx*dx+dy*dy)}return result}function axesProperties(axes,camera,width,height){var model=camera.model||identity;var view=camera.view||identity;var projection=camera.projection||identity;var bounds=axes.bounds;var params=cubeParams(model,view,projection,bounds);var axis=params.axis;var edges=params.edges;mat4.mul(mvp,view,model);mat4.mul(mvp,projection,mvp);var ranges=new Array(3);for(var i=0;i<3;++i){ranges[i]=new AxesRange3D(Infinity,-Infinity,Infinity)}var frustum=getPlanes(mat4.transpose(mvp,mvp));mat4.transpose(mvp,mvp);for(var d=0;d<3;++d){var u=(d+1)%3;var v=(d+2)%3;var x=[0,0,0];i_loop:for(var i=0;i<2;++i){var poly=[];if(axis[d]<0===!!i){continue}x[d]=bounds[i][d];for(var j=0;j<2;++j){x[u]=bounds[j^i][u];for(var k=0;k<2;++k){x[v]=bounds[k^j^i][v];poly.push(x.slice())}}for(var j=0;j<frustum.length;++j){if(poly.length===0){continue i_loop}poly=splitPoly.positive(poly,frustum[j])}for(var j=0;j<poly.length;++j){var v=poly[j];var grad=gradient(mvp,v,width,height);for(var k=0;k<3;++k){ranges[k].lo=Math.min(ranges[k].lo,v[k]);ranges[k].hi=Math.max(ranges[k].hi,v[k]);if(k!==d){ranges[k].pixelsPerDataUnit=Math.min(ranges[k].pixelsPerDataUnit,Math.abs(grad[k]))}}}}}return ranges}},{"./lib/cube.js":31,"extract-frustum-planes":36,"gl-matrix":173,"split-polygon":52}],121:[function(require,module,exports){"use strict";var pool=require("typedarray-pool");var ops=require("ndarray-ops");var ndarray=require("ndarray");var webglew=require("webglew");var SUPPORTED_TYPES=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function GLBuffer(gl,type,handle,length,usage){this.gl=gl;this.type=type;this.handle=handle;this.length=length;this.usage=usage}var proto=GLBuffer.prototype;proto.bind=function(){this.gl.bindBuffer(this.type,this.handle)};proto.unbind=function(){this.gl.bindBuffer(this.type,null)};proto.dispose=function(){this.gl.deleteBuffer(this.handle)};function updateTypeArray(gl,type,len,usage,data,offset){var dataLen=data.length*data.BYTES_PER_ELEMENT;if(offset<0){gl.bufferData(type,data,usage);return dataLen}if(dataLen+offset>len){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}gl.bufferSubData(type,offset,data);return len}function makeScratchTypeArray(array,dtype){var res=pool.malloc(array.length,dtype);var n=array.length;for(var i=0;i<n;++i){res[i]=array[i]}return res}function isPacked(shape,stride){var n=1;for(var i=stride.length-1;i>=0;--i){if(stride[i]!==n){return false}n*=shape[i]}return true}proto.update=function(array,offset){if(typeof offset!=="number"){offset=-1}this.bind();if(typeof array==="object"&&typeof array.shape!=="undefined"){var dtype=array.dtype;if(SUPPORTED_TYPES.indexOf(dtype)<0){dtype="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var wgl=webglew(this.gl);var ext=wgl.OES_element_index_uint;if(ext&&dtype!=="uint16"){dtype="uint32"}else{dtype="uint16"}}if(dtype===array.dtype&&isPacked(array.shape,array.stride)){if(array.offset===0&&array.data.length===array.shape[0]){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data,offset)}else{this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array.data.subarray(array.offset,array.shape[0]),offset)}}else{var tmp=pool.malloc(array.size,dtype);var ndt=ndarray(tmp,array.shape);ops.assign(ndt,array);if(offset<0){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,tmp,offset)}else{this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,tmp.subarray(0,array.size),offset)}pool.free(tmp)}}else if(Array.isArray(array)){var t;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){t=makeScratchTypeArray(array,"uint16")}else{t=makeScratchTypeArray(array,"float32")}if(offset<0){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,t,offset)}else{this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,t.subarray(0,array.length),offset)}pool.free(t)}else if(typeof array==="object"&&typeof array.length==="number"){this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,array,offset)}else if(typeof array==="number"||array===undefined){if(offset>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}array=array|0;if(array<=0){array=1}this.gl.bufferData(this.type,array|0,this.usage);this.length=array}else{throw new Error("gl-buffer: Invalid data type")}};function createBuffer(gl,data,type,usage){webglew(gl);type=type||gl.ARRAY_BUFFER;usage=usage||gl.DYNAMIC_DRAW;if(type!==gl.ARRAY_BUFFER&&type!==gl.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(usage!==gl.DYNAMIC_DRAW&&usage!==gl.STATIC_DRAW&&usage!==gl.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var handle=gl.createBuffer();var result=new GLBuffer(gl,type,handle,0,usage);result.update(data);return result}module.exports=createBuffer},{ndarray:412,"ndarray-ops":122,"typedarray-pool":129,webglew:131}],122:[function(require,module,exports){"use strict";var compile=require("cwise-compiler");var EmptyProc={body:"",args:[],thisVars:[],localVars:[]};function fixup(x){if(!x){return EmptyProc}for(var i=0;i<x.args.length;++i){var a=x.args[i];if(i===0){x.args[i]={name:a,lvalue:true,rvalue:!!x.rvalue,count:x.count||1}}else{x.args[i]={name:a,lvalue:false,rvalue:true,count:1}}}if(!x.thisVars){x.thisVars=[]}if(!x.localVars){x.localVars=[]}return x}function pcompile(user_args){return compile({args:user_args.args,pre:fixup(user_args.pre),body:fixup(user_args.body),post:fixup(user_args.proc),funcName:user_args.funcName})}function makeOp(user_args){var args=[];for(var i=0;i<user_args.args.length;++i){args.push("a"+i)}var wrapper=new Function("P",["return function ",user_args.funcName,"_ndarrayops(",args.join(","),") {P(",args.join(","),");return a0}"].join(""));return wrapper(pcompile(user_args))}var assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var id in assign_ops){var op=assign_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id});exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+op+"=b"},rvalue:true,funcName:id+"eq"});exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"});exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+op+"=s"},rvalue:true,funcName:id+"seq"})}})();var unary_ops={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var id in unary_ops){var op=unary_ops[id];exports[id]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+op+"b"},funcName:id});exports[id+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+op+"a"},rvalue:true,count:2,funcName:id+"eq"})}})();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var id in binary_ops){var op=binary_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id});exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"});exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+op+"b"},rvalue:true,count:2,funcName:id+"eq"});exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+op+"s"},rvalue:true,count:2,funcName:id+"seq"})}})();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var i=0;i<math_unary.length;++i){var f=math_unary[i];exports[f]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f});exports[f+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"eq"})}})();var math_comm=["max","min","atan2","pow"];(function(){for(var i=0;i<math_comm.length;++i){var f=math_comm[i];exports[f]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f});exports[f+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"});exports[f+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"eq"});exports[f+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"seq"})}})();var math_noncomm=["atan2","pow"];(function(){for(var i=0;i<math_noncomm.length;++i){var f=math_noncomm[i];exports[f+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"});exports[f+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"});exports[f+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"opeq"});exports[f+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"opseq"})}})();exports.any=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});exports.all=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});exports.sum=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});exports.prod=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});exports.norm2squared=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});exports.norm2=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});exports.norminf=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});exports.norm1=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});exports.sup=compile({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});exports.inf=compile({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});exports.argmin=compile({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});exports.argmax=compile({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});exports.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});exports.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});exports.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});exports.equals=compile({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":123}],123:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":125,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],124:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:126}],125:[function(require,module,exports){module.exports=require(105)},{"./compile.js":124,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],126:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],127:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],128:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],129:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":127,buffer:8,dup:128}],130:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],131:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:130}],132:[function(require,module,exports){"use strict";module.exports=createErrorBars;var glslify=require("glslify");var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\nvoid main() {\n  vec4 worldPosition = model * vec4(position, 1.0);\n  worldPosition = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position = projection * view * worldPosition;\n  fragColor = color;\n  fragPosition = position;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 clipBounds[2];\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\nvoid main() {\n  if(any(lessThan(fragPosition, clipBounds[0])) || any(greaterThan(fragPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = fragColor;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"capSize",type:"float"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"offset",type:"vec3"},{name:"color",type:"vec4"}]);var IDENTITY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function ErrorBars(gl,buffer,vao,shader){this.gl=gl;this.shader=shader;this.buffer=buffer;this.vao=vao;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lineWidth=[1,1,1];this.capSize=[.1,.1,.1];this.lineCount=[0,0,0];this.lineOffset=[0,0,0]}var proto=ErrorBars.prototype;proto.draw=function(cameraParams){var gl=this.gl;var uniforms=this.shader.uniforms;this.shader.bind();uniforms.model=cameraParams.model||IDENTITY;uniforms.view=cameraParams.view||IDENTITY;uniforms.projection=cameraParams.projection||IDENTITY;uniforms.clipBounds=this.clipBounds;this.vao.bind();for(var i=0;i<3;++i){gl.lineWidth(this.lineWidth[i]);uniforms.capSize=this.capSize[i];gl.drawArrays(gl.LINES,this.lineOffset[i],this.lineCount[i])}this.vao.unbind()};function updateBounds(bounds,point){for(var i=0;i<3;++i){bounds[0][i]=Math.min(bounds[0][i],point[i]);bounds[1][i]=Math.max(bounds[1][i],point[i])}}var FACE_TABLE=function(){var table=new Array(3);for(var d=0;d<3;++d){var row=[];for(var j=1;j<=2;++j){for(var s=-1;s<=1;s+=2){var u=(j+d)%3;var y=[0,0,0];y[u]=s;row.push(y)}}table[d]=row}return table}();function emitFace(verts,x,c,d){var offsets=FACE_TABLE[d];for(var i=0;i<offsets.length;++i){var o=offsets[i];verts.push(x[0],x[1],x[2],c[0],c[1],c[2],c[3],o[0],o[1],o[2])}return offsets.length}proto.update=function(options){options=options||{};if("clipBounds"in options){this.clipBounds=options.clipBounds}if("lineWidth"in options){this.lineWidth=options.lineWidth;if(!Array.isArray(this.lineWidth)){this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth]}}if("capSize"in options){this.capSize=options.capSize;if(!Array.isArray(this.capSize)){this.capSize=[this.capSize,this.capSize,this.capSize]}}var color=options.color||[[0,0,0],[0,0,0],[0,0,0]];var position=options.position;var error=options.error;if(!Array.isArray(color[0])){color=[color,color,color]}if(position&&error){var verts=[];var n=position.length;var vertexCount=0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.lineCount=[0,0,0];for(var j=0;j<3;++j){this.lineOffset[j]=vertexCount;i_loop:for(var i=0;i<n;++i){var p=position[i];for(var k=0;k<3;++k){if(isNaN(p[k])||!isFinite(p[k])){continue i_loop}}var e=error[i];var c=color[j];if(Array.isArray(c[0])){c=color[i]}if(c.length===3){c=[c[0],c[1],c[2],1]}if(isNaN(e[0][j])||isNaN(e[1][j])){continue}if(e[0][j]<0){var x=p.slice();x[j]+=e[0][j];verts.push(p[0],p[1],p[2],c[0],c[1],c[2],c[3],0,0,0,x[0],x[1],x[2],c[0],c[1],c[2],c[3],0,0,0);updateBounds(this.bounds,x);vertexCount+=2+emitFace(verts,x,c,j)}if(e[1][j]>0){var x=p.slice();x[j]+=e[1][j];verts.push(p[0],p[1],p[2],c[0],c[1],c[2],c[3],0,0,0,x[0],x[1],x[2],c[0],c[1],c[2],c[3],0,0,0);updateBounds(this.bounds,x);vertexCount+=2+emitFace(verts,x,c,j)}}this.lineCount[j]=vertexCount-this.lineOffset[j]}this.buffer.update(verts)}};proto.dispose=function(){this.shader.dispose();this.buffer.dispose();this.vao.dispose()};function createErrorBars(gl,options){var buffer=createBuffer(gl);var vao=createVAO(gl,[{buffer:buffer,type:gl.FLOAT,size:3,offset:0,stride:40},{buffer:buffer,type:gl.FLOAT,size:4,offset:12,stride:40},{buffer:buffer,type:gl.FLOAT,size:3,offset:28,stride:40}]);var shader=createShader(gl);shader.attributes.position.location=0;shader.attributes.color.location=1;shader.attributes.offset.location=2;var result=new ErrorBars(gl,buffer,vao,shader);result.update(options);return result}},{"gl-buffer":121,"gl-vao":138,glslify:140,"glslify/adapter.js":139}],133:[function(require,module,exports){module.exports=require(39)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/do-bind.js":39}],134:[function(require,module,exports){module.exports=require(40)},{"./do-bind.js":133,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-emulated.js":40}],135:[function(require,module,exports){module.exports=require(41)},{"./do-bind.js":133,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-native.js":41}],136:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],137:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:136}],138:[function(require,module,exports){module.exports=require(44)},{"./lib/vao-emulated.js":134,"./lib/vao-native.js":135,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/vao.js":44,webglew:137}],139:[function(require,module,exports){module.exports=require(45)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/adapter.js":45,"gl-shader-core":145}],140:[function(require,module,exports){module.exports=require(46)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/browser.js":46}],141:[function(require,module,exports){module.exports=require(47)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-attributes.js":47}],142:[function(require,module,exports){module.exports=require(48)},{"./reflect":143,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-uniforms.js":48,dup:144}],143:[function(require,module,exports){module.exports=require(49)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/reflect.js":49}],144:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],145:[function(require,module,exports){module.exports=require(51)},{"./lib/create-attributes":141,"./lib/create-uniforms":142,"./lib/reflect":143,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/shader-core.js":51}],146:[function(require,module,exports){"use strict";module.exports=createLinePlot;var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var createTexture=require("gl-texture2d");var glslify=require("glslify");var unpackFloat=require("glsl-read-float");var bsearch=require("binary-search-bounds");var ndarray=require("ndarray");var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute float arcLength;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvoid main() {\n  vec4 worldCoordinate = model * vec4(position, 1);\n  gl_Position = projection * view * worldCoordinate;\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float dashScale;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"dashTexture",type:"sampler2D"},{name:"dashScale",type:"float"}],[{name:"position",type:"vec3"},{name:"arcLength",type:"float"},{name:"color",type:"vec4"}]);var createPickShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute float arcLength;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvoid main() {\n  vec4 worldCoordinate = model * vec4(position, 1);\n  gl_Position = projection * view * worldCoordinate;\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\n#define FLOAT_MAX  1.70141184e38\n\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 a_x_encode_float(highp float v) {\n  highp float av = abs(v);\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n  \n  highp vec4 c = vec4(0, 0, 0, 0);\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n  c[0] += 128.0 * step(0.0, -v);\n  return c / 255.0;\n}\nuniform float pickId;\nuniform vec3 clipBounds[2];\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId / 255.0, a_x_encode_float(pixelArcLength).xyz);\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"pickId",type:"float"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"arcLength",type:"float"},{name:"color",type:"vec4"}]);var identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function distance(a,b){var s=0;for(var i=0;i<3;++i){var d=a[i]-b[i];s+=d*d}return Math.sqrt(s)}function filterClipBounds(bounds){var result=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var i=0;i<3;++i){result[0][i]=Math.max(bounds[0][i],result[0][i]);result[1][i]=Math.min(bounds[1][i],result[1][i])}return result}function PickResult(tau,position,index){this.arcLength=tau;this.position=position;this.index=index}function LinePlot(gl,shader,pickShader,buffer,vao,texture){this.gl=gl;this.shader=shader;this.pickShader=pickShader;this.buffer=buffer;this.vao=vao;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.points=[];this.arcLength=[];this.vertexCount=0;this.bounds=[[0,0,0],[0,0,0]];this.pickId=0;this.lineWidth=1;this.texture=texture;this.dashScale=1}var proto=LinePlot.prototype;proto.draw=function(camera){var gl=this.gl;var shader=this.shader;var vao=this.vao;gl.lineWidth(this.lineWidth);shader.bind();shader.uniforms={model:camera.model||identity,view:camera.view||identity,projection:camera.projection||identity,clipBounds:filterClipBounds(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1]};vao.bind();vao.draw(gl.LINES,this.vertexCount)};proto.drawPick=function(camera){var gl=this.gl;var shader=this.pickShader;var vao=this.vao;gl.lineWidth(this.lineWidth);shader.bind();shader.uniforms={model:camera.model||identity,view:camera.view||identity,projection:camera.projection||identity,pickId:this.pickId,clipBounds:filterClipBounds(this.clipBounds)};vao.bind();vao.draw(gl.LINES,this.vertexCount)};proto.update=function(options){if("pickId"in options){this.pickId=options.pickId}if("lineWidth"in options){this.lineWidth=options.lineWidth}if("dashScale"in options){this.dashScale=options.dashScale}var positions=options.position||options.positions;if(!positions){return}var colors=options.color||options.colors||[0,0,0,1];var buffer=[];var arcLengthArray=[];var pointArray=[];var arcLength=0;var vertexCount=0;var bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];fill_loop:for(var i=1;i<positions.length;++i){var a=positions[i-1];var b=positions[i];arcLengthArray.push(arcLength);pointArray.push(a.slice());for(var j=0;j<3;++j){if(isNaN(a[j])||isNaN(b[j])||!isFinite(a[j])||!isFinite(b[j])){continue fill_loop}bounds[0][j]=Math.min(bounds[0][j],a[j],b[j]);bounds[1][j]=Math.max(bounds[1][j],a[j],b[j])}var acolor,bcolor;if(Array.isArray(colors[0])){acolor=colors[i-1];bcolor=colors[i]}else{acolor=bcolor=colors}if(acolor.length===3){acolor=[acolor[0],acolor[1],acolor[2],1]}if(bcolor.length===3){bcolor=[bcolor[0],bcolor[1],bcolor[2],1]}var t0=arcLength;arcLength+=distance(a,b);buffer.push(a[0],a[1],a[2],t0,acolor[0],acolor[1],acolor[2],acolor[3],b[0],b[1],b[2],arcLength,bcolor[0],bcolor[1],bcolor[2],bcolor[3]);vertexCount+=2}this.buffer.update(buffer);arcLengthArray.push(arcLength);pointArray.push(positions[positions.length-1].slice());this.bounds=bounds;this.vertexCount=vertexCount;this.points=pointArray;this.arcLength=arcLengthArray;if("dashes"in options){var dashArray=options.dashes;var prefixSum=dashArray.slice();prefixSum.unshift(0);for(var i=1;i<prefixSum.length;++i){prefixSum[i]=prefixSum[i-1]+prefixSum[i]}var dashTexture=ndarray(new Array(256*4),[256,1,4]);for(var i=0;i<256;++i){for(var j=0;j<4;++j){dashTexture.set(i,0,j,0)}if(bsearch.le(prefixSum,prefixSum[prefixSum.length-1]*i/255)&1){dashTexture.set(i,0,0,0)}else{dashTexture.set(i,0,0,255)}}this.texture.setPixels(dashTexture)}};proto.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};proto.pick=function(selection){if(!selection){return null}if(selection.id!==this.pickId){return null}var tau=unpackFloat(selection.value[0],selection.value[1],selection.value[2],0);var index=bsearch.le(this.arcLength,tau);if(index<0){return null}if(index===this.arcLength.length-1){return new PickResult(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),index)}var a=this.points[index];var b=this.points[index+1];var t=(tau-this.arcLength[index])/(this.arcLength[index+1]-this.arcLength[index]);var ti=1-t;var x=[0,0,0];for(var i=0;i<3;++i){x[i]=ti*a[i]+t*b[i]}return new PickResult(tau,x,t<.5?index:index+1)};function createLinePlot(gl,options){var shader=createShader(gl);shader.attributes.position.location=0;shader.attributes.arcLength.location=1;shader.attributes.color.location=2;var pickShader=createPickShader(gl);pickShader.attributes.position.location=0;pickShader.attributes.arcLength.location=1;pickShader.attributes.color.location=2;var buffer=createBuffer(gl);var vao=createVAO(gl,[{buffer:buffer,size:3,offset:0,stride:32},{buffer:buffer,size:1,offset:12,stride:32},{buffer:buffer,size:4,offset:16,stride:32}]);var defaultTexture=ndarray(new Array(256*4),[256,1,4]);for(var i=0;i<256*4;++i){defaultTexture.data[i]=255}var texture=createTexture(gl,defaultTexture);texture.wrap=gl.REPEAT;var linePlot=new LinePlot(gl,shader,pickShader,buffer,vao,texture);linePlot.update(options);return linePlot}},{"binary-search-bounds":147,"gl-buffer":121,"gl-texture2d":158,"gl-vao":164,"glsl-read-float":165,glslify:167,"glslify/adapter.js":166,ndarray:412}],147:[function(require,module,exports){module.exports=require(68)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/node_modules/slab-decomposition/node_modules/binary-search-bounds/search-bounds.js":68}],148:[function(require,module,exports){module.exports=require(122)},{"/var/www/streambed/gl3d/node_modules/gl-buffer/node_modules/ndarray-ops/ndarray-ops.js":122,"cwise-compiler":149}],149:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":151,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],150:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:152}],151:[function(require,module,exports){module.exports=require(105)},{"./compile.js":150,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],152:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],153:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],154:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],155:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":153,buffer:8,dup:154}],156:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],157:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:156}],158:[function(require,module,exports){"use strict";var ndarray=require("ndarray");var ops=require("ndarray-ops");var pool=require("typedarray-pool");var webglew=require("webglew");module.exports=createTexture2D;var linearTypes=null;var filterTypes=null;var wrapTypes=null;function lazyInitLinearTypes(gl){linearTypes=[gl.LINEAR,gl.NEAREST_MIPMAP_LINEAR,gl.LINEAR_MIPMAP_NEAREST,gl.LINEAR_MIPMAP_NEAREST];filterTypes=[gl.NEAREST,gl.LINEAR,gl.NEAREST_MIPMAP_NEAREST,gl.NEAREST_MIPMAP_LINEAR,gl.LINEAR_MIPMAP_NEAREST,gl.LINEAR_MIPMAP_LINEAR];wrapTypes=[gl.REPEAT,gl.CLAMP_TO_EDGE,gl.MIRRORED_REPEAT]}var convertFloatToUint8=function(out,inp){ops.muls(out,inp,255)};function reshapeTexture(tex,w,h){var gl=tex.gl;var maxSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(w<0||w>maxSize||h<0||h>maxSize){throw new Error("gl-texture2d: Invalid texture size")}tex._shape=[w,h];tex.bind();gl.texImage2D(gl.TEXTURE_2D,0,tex.format,w,h,0,tex.format,tex.type,null);tex._mipLevels=[0];return tex}function Texture2D(gl,handle,width,height,format,type){this.gl=gl;this.handle=handle;this.format=format;this.type=type;this._shape=[width,height];this._mipLevels=[0];this._magFilter=gl.NEAREST;this._minFilter=gl.NEAREST;this._wrapS=gl.CLAMP_TO_EDGE;this._wrapT=gl.CLAMP_TO_EDGE;this._anisoSamples=1;var parent=this;var wrapVector=[this._wrapS,this._wrapT];Object.defineProperties(wrapVector,[{get:function(){return parent._wrapS},set:function(v){return parent.wrapS=v}},{get:function(){return parent._wrapT},set:function(v){return parent.wrapT=v}}]);this._wrapVector=wrapVector;var shapeVector=[this._shape[0],this._shape[1]];Object.defineProperties(shapeVector,[{get:function(){return parent._shape[0]},set:function(v){return parent.width=v}},{get:function(){return parent._shape[1]},set:function(v){return parent.height=v}}]);this._shapeVector=shapeVector}var proto=Texture2D.prototype;Object.defineProperties(proto,{minFilter:{get:function(){return this._minFilter},set:function(v){this.bind();var gl=this.gl;if(this.type===gl.FLOAT&&linearTypes.indexOf(v)>=0){if(!webglew(gl).texture_float_linear){v=gl.NEAREST}}if(filterTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown filter mode "+v)}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,v);return this._minFilter=v}},magFilter:{get:function(){return this._magFilter},set:function(v){this.bind();var gl=this.gl;if(this.type===gl.FLOAT&&linearTypes.indexOf(v)>=0){if(!webglew(gl).texture_float_linear){v=gl.NEAREST}}if(filterTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown filter mode "+v)}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,v);return this._magFilter=v}},mipSamples:{get:function(){return this._anisoSamples},set:function(i){var psamples=this._anisoSamples;this._anisoSamples=Math.max(i,1)|0;if(psamples!==this._anisoSamples){var ext=webglew(this.gl).EXT_texture_filter_anisotropic;if(ext){this.gl.texParameterf(this.gl.TEXTURE_2D,ext.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(v){this.bind();if(wrapTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown wrap mode "+v)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,v);return this._wrapS=v}},wrapT:{get:function(){return this._wrapT},set:function(v){this.bind();if(wrapTypes.indexOf(v)<0){throw new Error("gl-texture2d: Unknown wrap mode "+v)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,v);return this._wrapT=v}},wrap:{get:function(){return this._wrapVector},set:function(v){if(!Array.isArray(v)){v=[v,v]}if(v.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var i=0;i<2;++i){if(wrapTypes.indexOf(v[i])<0){throw new Error("gl-texture2d: Unknown wrap mode "+v)}}this._wrapS=v[0];this._wrapT=v[1];var gl=this.gl;this.bind();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,this._wrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,this._wrapT);return v}},shape:{get:function(){return this._shapeVector},set:function(x){if(!Array.isArray(x)){x=[x|0,x|0]}else{if(x.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}reshapeTexture(this,x[0]|0,x[1]|0);return[x[0]|0,x[1]|0]}},width:{get:function(){return this._shape[0]},set:function(w){w=w|0;reshapeTexture(this,w,this._shape[1]);return w}},height:{get:function(){return this._shape[1]},set:function(h){h=h|0;reshapeTexture(this,this._shape[0],h);return h}}});proto.bind=function(unit){var gl=this.gl;if(unit!==undefined){gl.activeTexture(gl.TEXTURE0+(unit|0))}gl.bindTexture(gl.TEXTURE_2D,this.handle);if(unit!==undefined){return unit|0}return gl.getParameter(gl.ACTIVE_TEXTURE)-gl.TEXTURE0};proto.dispose=function(){this.gl.deleteTexture(this.handle)};proto.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var l=Math.min(this._shape[0],this._shape[1]);for(var i=0;l>0;++i,l>>>=1){if(this._mipLevels.indexOf(i)<0){this._mipLevels.push(i)}}};proto.setPixels=function(data,x_off,y_off,mip_level){var gl=this.gl;this.bind();if(Array.isArray(x_off)){mip_level=y_off;y_off=x_off[1]|0;x_off=x_off[0]|0}else{x_off=x_off||0;y_off=y_off||0}mip_level=mip_level||0;if(data instanceof HTMLCanvasElement||data instanceof ImageData||data instanceof HTMLImageElement||data instanceof HTMLVideoElement){var needsMip=this._mipLevels.indexOf(mip_level)<0;if(needsMip){gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,this.type,data);this._mipLevels.push(mip_level)}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,this.format,this.type,data)}}else if(data.shape&&data.stride&&data.data){if(data.shape.length<2||x_off+data.shape[1]>this._shape[1]>>>mip_level||y_off+data.shape[0]>this._shape[0]>>>mip_level||x_off<0||y_off<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}texSubImageArray(gl,x_off,y_off,mip_level,this.format,this.type,this._mipLevels,data)}else{throw new Error("gl-texture2d: Unsupported data type")}};function isPacked(shape,stride){if(shape.length===3){return stride[2]===1&&stride[1]===shape[0]*shape[2]&&stride[0]===shape[2]}return stride[0]===1&&stride[1]===shape[0]}function texSubImageArray(gl,x_off,y_off,mip_level,cformat,ctype,mipLevels,array){var dtype=array.dtype;var shape=array.shape.slice();if(shape.length<2||shape.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var type=0,format=0;var packed=isPacked(shape,array.stride.slice());if(dtype==="float32"){type=gl.FLOAT}else if(dtype==="float64"){type=gl.FLOAT;packed=false;dtype="float32"}else if(dtype==="uint8"){type=gl.UNSIGNED_BYTE}else{type=gl.UNSIGNED_BYTE;packed=false;dtype="uint8"}var channels=1;if(shape.length===2){format=gl.LUMINANCE;shape=[shape[0],shape[1],1];array=ndarray(array.data,shape,[array.stride[0],array.stride[1],1],array.offset)}else if(shape.length===3){if(shape[2]===1){format=gl.ALPHA}else if(shape[2]===2){format=gl.LUMINANCE_ALPHA}else if(shape[2]===3){format=gl.RGB}else if(shape[2]===4){format=gl.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}channels=shape[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((format===gl.LUMINANCE||format===gl.ALPHA)&&(cformat===gl.LUMINANCE||cformat===gl.ALPHA)){format=cformat}if(format!==cformat){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var size=array.size;var needsMip=mipLevels.indexOf(mip_level)<0;if(needsMip){mipLevels.push(mip_level)}if(type===ctype&&packed){if(array.offset===0&&array.data.length===size){if(needsMip){gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,array.data)}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,array.data)}}else{if(needsMip){gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,array.data.subarray(array.offset,array.offset+size))}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,array.data.subarray(array.offset,array.offset+size))}}}else{var pack_buffer;if(ctype===gl.FLOAT){pack_buffer=pool.mallocFloat32(size)}else{pack_buffer=pool.mallocUint8(size)}var pack_view=ndarray(pack_buffer,shape,[shape[2],shape[2]*shape[0],1]);if(type===gl.FLOAT&&ctype===gl.UNSIGNED_BYTE){convertFloatToUint8(pack_view,array)}else{ops.assign(pack_view,array)}if(needsMip){gl.texImage2D(gl.TEXTURE_2D,mip_level,cformat,shape[0],shape[1],0,cformat,ctype,pack_buffer.subarray(0,size))}else{gl.texSubImage2D(gl.TEXTURE_2D,mip_level,x_off,y_off,shape[0],shape[1],cformat,ctype,pack_buffer.subarray(0,size))}if(ctype===gl.FLOAT){pool.freeFloat32(pack_buffer)}else{pool.freeUint8(pack_buffer)}}}function initTexture(gl){var tex=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,tex);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);return tex}function createTextureShape(gl,width,height,format,type){var maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(width<0||width>maxTextureSize||height<0||height>maxTextureSize){throw new Error("gl-texture2d: Invalid texture shape")}if(type===gl.FLOAT&&!webglew(gl).texture_float){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,width,height,0,format,type,null);return new Texture2D(gl,tex,width,height,format,type)}function createTextureDOM(gl,element,format,type){var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,format,type,element);return new Texture2D(gl,tex,element.width|0,element.height|0,format,type)}function createTextureArray(gl,array){var dtype=array.dtype;var shape=array.shape.slice();var maxSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);if(shape[0]<0||shape[0]>maxSize||shape[1]<0||shape[1]>maxSize){throw new Error("gl-texture2d: Invalid texture size")}var packed=isPacked(shape,array.stride.slice());var type=0;if(dtype==="float32"){type=gl.FLOAT}else if(dtype==="float64"){type=gl.FLOAT;packed=false;dtype="float32"}else if(dtype==="uint8"){type=gl.UNSIGNED_BYTE}else{type=gl.UNSIGNED_BYTE;packed=false;dtype="uint8"}var format=0;if(shape.length===2){format=gl.LUMINANCE;shape=[shape[0],shape[1],1];array=ndarray(array.data,shape,[array.stride[0],array.stride[1],1],array.offset)}else if(shape.length===3){if(shape[2]===1){format=gl.ALPHA}else if(shape[2]===2){format=gl.LUMINANCE_ALPHA}else if(shape[2]===3){format=gl.RGB}else if(shape[2]===4){format=gl.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(type===gl.FLOAT&&!webglew(gl).texture_float){type=gl.UNSIGNED_BYTE;packed=false}var buffer,buf_store;var size=array.size;if(!packed){var stride=[shape[2],shape[2]*shape[0],1];buf_store=pool.malloc(size,dtype);var buf_array=ndarray(buf_store,shape,stride,0);if((dtype==="float32"||dtype==="float64")&&type===gl.UNSIGNED_BYTE){convertFloatToUint8(buf_array,array)}else{ops.assign(buf_array,array)}buffer=buf_store.subarray(0,size)}else if(array.offset===0&&array.data.length===size){buffer=array.data}else{buffer=array.data.subarray(array.offset,array.offset+size)}var tex=initTexture(gl);gl.texImage2D(gl.TEXTURE_2D,0,format,shape[0],shape[1],0,format,type,buffer);if(!packed){pool.free(buf_store)}return new Texture2D(gl,tex,shape[0],shape[1],format,type)}function createTexture2D(gl){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!linearTypes){lazyInitLinearTypes(gl)}if(typeof arguments[1]==="number"){return createTextureShape(gl,arguments[1],arguments[2],arguments[3]||gl.RGBA,arguments[4]||gl.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return createTextureShape(gl,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||gl.RGBA,arguments[3]||gl.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var obj=arguments[1];if(obj instanceof HTMLCanvasElement||obj instanceof HTMLImageElement||obj instanceof HTMLVideoElement||obj instanceof ImageData){return createTextureDOM(gl,obj,arguments[2]||gl.RGBA,arguments[3]||gl.UNSIGNED_BYTE)}else if(obj.shape&&obj.data&&obj.stride){return createTextureArray(gl,obj)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:412,"ndarray-ops":148,"typedarray-pool":155,webglew:157}],159:[function(require,module,exports){module.exports=require(39)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/do-bind.js":39}],160:[function(require,module,exports){module.exports=require(40)},{"./do-bind.js":159,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-emulated.js":40}],161:[function(require,module,exports){module.exports=require(41)},{"./do-bind.js":159,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-native.js":41}],162:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],163:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:162}],164:[function(require,module,exports){module.exports=require(44)},{"./lib/vao-emulated.js":160,"./lib/vao-native.js":161,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/vao.js":44,webglew:163}],165:[function(require,module,exports){module.exports=decodeFloat;var UINT8_VIEW=new Uint8Array(4);var FLOAT_VIEW=new Float32Array(UINT8_VIEW.buffer);function decodeFloat(x,y,z,w){UINT8_VIEW[0]=w;UINT8_VIEW[1]=z;UINT8_VIEW[2]=y;UINT8_VIEW[3]=x;return FLOAT_VIEW[0]}},{}],166:[function(require,module,exports){module.exports=require(45)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/adapter.js":45,"gl-shader-core":172}],167:[function(require,module,exports){module.exports=require(46)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/browser.js":46}],168:[function(require,module,exports){module.exports=require(47)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-attributes.js":47}],169:[function(require,module,exports){module.exports=require(48)},{"./reflect":170,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-uniforms.js":48,dup:171}],170:[function(require,module,exports){module.exports=require(49)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/reflect.js":49}],171:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],172:[function(require,module,exports){module.exports=require(51)},{"./lib/create-attributes":168,"./lib/create-uniforms":169,"./lib/reflect":170,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/shader-core.js":51}],173:[function(require,module,exports){(function(_global){"use strict";var shim={};if(typeof exports==="undefined"){if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){shim.exports={};define(function(){return shim.exports})}else{shim.exports=typeof window!=="undefined"?window:_global}}else{shim.exports=exports}(function(exports){if(!GLMAT_EPSILON){var GLMAT_EPSILON=1e-6}if(!GLMAT_ARRAY_TYPE){var GLMAT_ARRAY_TYPE=typeof Float32Array!=="undefined"?Float32Array:Array}if(!GLMAT_RANDOM){var GLMAT_RANDOM=Math.random}var glMatrix={};glMatrix.setMatrixArrayType=function(type){GLMAT_ARRAY_TYPE=type};if(typeof exports!=="undefined"){exports.glMatrix=glMatrix}var degree=Math.PI/180;glMatrix.toRadian=function(a){return a*degree};var vec2={};vec2.create=function(){var out=new GLMAT_ARRAY_TYPE(2);out[0]=0;out[1]=0;return out};vec2.clone=function(a){var out=new GLMAT_ARRAY_TYPE(2);out[0]=a[0];out[1]=a[1];return out};vec2.fromValues=function(x,y){var out=new GLMAT_ARRAY_TYPE(2);out[0]=x;out[1]=y;return out};vec2.copy=function(out,a){out[0]=a[0];out[1]=a[1];return out};vec2.set=function(out,x,y){out[0]=x;out[1]=y;return out};vec2.add=function(out,a,b){out[0]=a[0]+b[0];out[1]=a[1]+b[1];return out};vec2.subtract=function(out,a,b){out[0]=a[0]-b[0];out[1]=a[1]-b[1];return out};vec2.sub=vec2.subtract;vec2.multiply=function(out,a,b){out[0]=a[0]*b[0];out[1]=a[1]*b[1];return out};vec2.mul=vec2.multiply;vec2.divide=function(out,a,b){out[0]=a[0]/b[0];out[1]=a[1]/b[1];return out};vec2.div=vec2.divide;vec2.min=function(out,a,b){out[0]=Math.min(a[0],b[0]);out[1]=Math.min(a[1],b[1]);return out};vec2.max=function(out,a,b){out[0]=Math.max(a[0],b[0]);out[1]=Math.max(a[1],b[1]);return out};vec2.scale=function(out,a,b){out[0]=a[0]*b;out[1]=a[1]*b;return out};vec2.scaleAndAdd=function(out,a,b,scale){out[0]=a[0]+b[0]*scale;out[1]=a[1]+b[1]*scale;return out};vec2.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1];return Math.sqrt(x*x+y*y)};vec2.dist=vec2.distance;vec2.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1];return x*x+y*y};vec2.sqrDist=vec2.squaredDistance;vec2.length=function(a){var x=a[0],y=a[1];return Math.sqrt(x*x+y*y)};vec2.len=vec2.length;vec2.squaredLength=function(a){var x=a[0],y=a[1];return x*x+y*y};vec2.sqrLen=vec2.squaredLength;vec2.negate=function(out,a){out[0]=-a[0];out[1]=-a[1];return out};vec2.normalize=function(out,a){var x=a[0],y=a[1];var len=x*x+y*y;if(len>0){len=1/Math.sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len}return out};vec2.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};vec2.cross=function(out,a,b){var z=a[0]*b[1]-a[1]*b[0];out[0]=out[1]=0;out[2]=z;return out};vec2.lerp=function(out,a,b,t){var ax=a[0],ay=a[1];out[0]=ax+t*(b[0]-ax);out[1]=ay+t*(b[1]-ay);return out};vec2.random=function(out,scale){scale=scale||1;var r=GLMAT_RANDOM()*2*Math.PI;out[0]=Math.cos(r)*scale;out[1]=Math.sin(r)*scale;return out};vec2.transformMat2=function(out,a,m){var x=a[0],y=a[1];out[0]=m[0]*x+m[2]*y;out[1]=m[1]*x+m[3]*y;return out};vec2.transformMat2d=function(out,a,m){var x=a[0],y=a[1];out[0]=m[0]*x+m[2]*y+m[4];out[1]=m[1]*x+m[3]*y+m[5];return out};vec2.transformMat3=function(out,a,m){var x=a[0],y=a[1];out[0]=m[0]*x+m[3]*y+m[6];out[1]=m[1]*x+m[4]*y+m[7];return out};vec2.transformMat4=function(out,a,m){var x=a[0],y=a[1];out[0]=m[0]*x+m[4]*y+m[12];out[1]=m[1]*x+m[5]*y+m[13];return out};vec2.forEach=function(){var vec=vec2.create();return function(a,stride,offset,count,fn,arg){var i,l;if(!stride){stride=2}if(!offset){offset=0}if(count){l=Math.min(count*stride+offset,a.length)}else{l=a.length}for(i=offset;i<l;i+=stride){vec[0]=a[i];vec[1]=a[i+1];fn(vec,vec,arg);a[i]=vec[0];a[i+1]=vec[1]}return a}}();vec2.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};if(typeof exports!=="undefined"){exports.vec2=vec2}var vec3={};vec3.create=function(){var out=new GLMAT_ARRAY_TYPE(3);out[0]=0;out[1]=0;out[2]=0;return out};vec3.clone=function(a){var out=new GLMAT_ARRAY_TYPE(3);out[0]=a[0];out[1]=a[1];out[2]=a[2];return out};vec3.fromValues=function(x,y,z){var out=new GLMAT_ARRAY_TYPE(3);out[0]=x;out[1]=y;out[2]=z;return out};vec3.copy=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];return out};vec3.set=function(out,x,y,z){out[0]=x;out[1]=y;out[2]=z;return out};vec3.add=function(out,a,b){out[0]=a[0]+b[0];out[1]=a[1]+b[1];out[2]=a[2]+b[2];return out};vec3.subtract=function(out,a,b){out[0]=a[0]-b[0];out[1]=a[1]-b[1];out[2]=a[2]-b[2];return out};vec3.sub=vec3.subtract;vec3.multiply=function(out,a,b){out[0]=a[0]*b[0];out[1]=a[1]*b[1];out[2]=a[2]*b[2];return out};vec3.mul=vec3.multiply;vec3.divide=function(out,a,b){out[0]=a[0]/b[0];out[1]=a[1]/b[1];out[2]=a[2]/b[2];return out};vec3.div=vec3.divide;vec3.min=function(out,a,b){out[0]=Math.min(a[0],b[0]);out[1]=Math.min(a[1],b[1]);out[2]=Math.min(a[2],b[2]);return out};vec3.max=function(out,a,b){out[0]=Math.max(a[0],b[0]);out[1]=Math.max(a[1],b[1]);out[2]=Math.max(a[2],b[2]);return out};vec3.scale=function(out,a,b){out[0]=a[0]*b;out[1]=a[1]*b;out[2]=a[2]*b;return out};vec3.scaleAndAdd=function(out,a,b,scale){out[0]=a[0]+b[0]*scale;out[1]=a[1]+b[1]*scale;out[2]=a[2]+b[2]*scale;return out};vec3.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2];return Math.sqrt(x*x+y*y+z*z)};vec3.dist=vec3.distance;vec3.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2];return x*x+y*y+z*z};vec3.sqrDist=vec3.squaredDistance;vec3.length=function(a){var x=a[0],y=a[1],z=a[2];return Math.sqrt(x*x+y*y+z*z)};vec3.len=vec3.length;vec3.squaredLength=function(a){var x=a[0],y=a[1],z=a[2];return x*x+y*y+z*z};vec3.sqrLen=vec3.squaredLength;vec3.negate=function(out,a){out[0]=-a[0];out[1]=-a[1];out[2]=-a[2];return out};vec3.normalize=function(out,a){var x=a[0],y=a[1],z=a[2];var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len;out[2]=a[2]*len}return out};vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};vec3.cross=function(out,a,b){var ax=a[0],ay=a[1],az=a[2],bx=b[0],by=b[1],bz=b[2];out[0]=ay*bz-az*by;out[1]=az*bx-ax*bz;out[2]=ax*by-ay*bx;return out};vec3.lerp=function(out,a,b,t){var ax=a[0],ay=a[1],az=a[2];out[0]=ax+t*(b[0]-ax);out[1]=ay+t*(b[1]-ay);out[2]=az+t*(b[2]-az);return out};vec3.random=function(out,scale){scale=scale||1;var r=GLMAT_RANDOM()*2*Math.PI;var z=GLMAT_RANDOM()*2-1;var zScale=Math.sqrt(1-z*z)*scale;out[0]=Math.cos(r)*zScale;out[1]=Math.sin(r)*zScale;out[2]=z*scale;return out};vec3.transformMat4=function(out,a,m){var x=a[0],y=a[1],z=a[2];out[0]=m[0]*x+m[4]*y+m[8]*z+m[12];out[1]=m[1]*x+m[5]*y+m[9]*z+m[13];out[2]=m[2]*x+m[6]*y+m[10]*z+m[14];return out};vec3.transformMat3=function(out,a,m){var x=a[0],y=a[1],z=a[2];out[0]=x*m[0]+y*m[3]+z*m[6];out[1]=x*m[1]+y*m[4]+z*m[7];out[2]=x*m[2]+y*m[5]+z*m[8];return out};vec3.transformQuat=function(out,a,q){var x=a[0],y=a[1],z=a[2],qx=q[0],qy=q[1],qz=q[2],qw=q[3],ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;out[0]=ix*qw+iw*-qx+iy*-qz-iz*-qy;out[1]=iy*qw+iw*-qy+iz*-qx-ix*-qz;out[2]=iz*qw+iw*-qz+ix*-qy-iy*-qx;return out};vec3.rotateX=function(out,a,b,c){var p=[],r=[];p[0]=a[0]-b[0];p[1]=a[1]-b[1];p[2]=a[2]-b[2];r[0]=p[0];r[1]=p[1]*Math.cos(c)-p[2]*Math.sin(c);r[2]=p[1]*Math.sin(c)+p[2]*Math.cos(c);out[0]=r[0]+b[0];out[1]=r[1]+b[1];out[2]=r[2]+b[2];return out};vec3.rotateY=function(out,a,b,c){var p=[],r=[];p[0]=a[0]-b[0];p[1]=a[1]-b[1];p[2]=a[2]-b[2];r[0]=p[2]*Math.sin(c)+p[0]*Math.cos(c);r[1]=p[1];r[2]=p[2]*Math.cos(c)-p[0]*Math.sin(c);out[0]=r[0]+b[0];out[1]=r[1]+b[1];out[2]=r[2]+b[2];return out};vec3.rotateZ=function(out,a,b,c){var p=[],r=[];p[0]=a[0]-b[0];p[1]=a[1]-b[1];p[2]=a[2]-b[2];r[0]=p[0]*Math.cos(c)-p[1]*Math.sin(c);r[1]=p[0]*Math.sin(c)+p[1]*Math.cos(c);r[2]=p[2];out[0]=r[0]+b[0];out[1]=r[1]+b[1];out[2]=r[2]+b[2];return out};vec3.forEach=function(){var vec=vec3.create();return function(a,stride,offset,count,fn,arg){var i,l;if(!stride){stride=3}if(!offset){offset=0}if(count){l=Math.min(count*stride+offset,a.length)}else{l=a.length}for(i=offset;i<l;i+=stride){vec[0]=a[i];vec[1]=a[i+1];vec[2]=a[i+2];fn(vec,vec,arg);a[i]=vec[0];a[i+1]=vec[1];a[i+2]=vec[2]}return a}}();vec3.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};if(typeof exports!=="undefined"){exports.vec3=vec3}var vec4={};vec4.create=function(){var out=new GLMAT_ARRAY_TYPE(4);out[0]=0;out[1]=0;out[2]=0;out[3]=0;return out};vec4.clone=function(a){var out=new GLMAT_ARRAY_TYPE(4);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];return out};vec4.fromValues=function(x,y,z,w){var out=new GLMAT_ARRAY_TYPE(4);out[0]=x;out[1]=y;out[2]=z;out[3]=w;return out};vec4.copy=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];return out};vec4.set=function(out,x,y,z,w){out[0]=x;out[1]=y;out[2]=z;out[3]=w;return out};vec4.add=function(out,a,b){out[0]=a[0]+b[0];out[1]=a[1]+b[1];out[2]=a[2]+b[2];out[3]=a[3]+b[3];return out};vec4.subtract=function(out,a,b){out[0]=a[0]-b[0];out[1]=a[1]-b[1];out[2]=a[2]-b[2];out[3]=a[3]-b[3];return out};vec4.sub=vec4.subtract;vec4.multiply=function(out,a,b){out[0]=a[0]*b[0];out[1]=a[1]*b[1];out[2]=a[2]*b[2];out[3]=a[3]*b[3];return out};vec4.mul=vec4.multiply;vec4.divide=function(out,a,b){out[0]=a[0]/b[0];out[1]=a[1]/b[1];out[2]=a[2]/b[2];out[3]=a[3]/b[3];return out};vec4.div=vec4.divide;vec4.min=function(out,a,b){out[0]=Math.min(a[0],b[0]);out[1]=Math.min(a[1],b[1]);out[2]=Math.min(a[2],b[2]);out[3]=Math.min(a[3],b[3]);return out};vec4.max=function(out,a,b){out[0]=Math.max(a[0],b[0]);out[1]=Math.max(a[1],b[1]);out[2]=Math.max(a[2],b[2]);out[3]=Math.max(a[3],b[3]);return out};vec4.scale=function(out,a,b){out[0]=a[0]*b;out[1]=a[1]*b;out[2]=a[2]*b;out[3]=a[3]*b;return out};vec4.scaleAndAdd=function(out,a,b,scale){out[0]=a[0]+b[0]*scale;out[1]=a[1]+b[1]*scale;out[2]=a[2]+b[2]*scale;out[3]=a[3]+b[3]*scale;return out};vec4.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2],w=b[3]-a[3];return Math.sqrt(x*x+y*y+z*z+w*w)};vec4.dist=vec4.distance;vec4.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2],w=b[3]-a[3];return x*x+y*y+z*z+w*w};vec4.sqrDist=vec4.squaredDistance;vec4.length=function(a){var x=a[0],y=a[1],z=a[2],w=a[3];return Math.sqrt(x*x+y*y+z*z+w*w)};vec4.len=vec4.length;vec4.squaredLength=function(a){var x=a[0],y=a[1],z=a[2],w=a[3];return x*x+y*y+z*z+w*w};vec4.sqrLen=vec4.squaredLength;vec4.negate=function(out,a){out[0]=-a[0];out[1]=-a[1];out[2]=-a[2];out[3]=-a[3];return out};vec4.normalize=function(out,a){var x=a[0],y=a[1],z=a[2],w=a[3];var len=x*x+y*y+z*z+w*w;if(len>0){len=1/Math.sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len;out[2]=a[2]*len;out[3]=a[3]*len}return out};vec4.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};vec4.lerp=function(out,a,b,t){var ax=a[0],ay=a[1],az=a[2],aw=a[3];out[0]=ax+t*(b[0]-ax);out[1]=ay+t*(b[1]-ay);out[2]=az+t*(b[2]-az);out[3]=aw+t*(b[3]-aw);return out};vec4.random=function(out,scale){scale=scale||1;out[0]=GLMAT_RANDOM();out[1]=GLMAT_RANDOM();out[2]=GLMAT_RANDOM();out[3]=GLMAT_RANDOM();vec4.normalize(out,out);vec4.scale(out,out,scale);return out};vec4.transformMat4=function(out,a,m){var x=a[0],y=a[1],z=a[2],w=a[3];out[0]=m[0]*x+m[4]*y+m[8]*z+m[12]*w;out[1]=m[1]*x+m[5]*y+m[9]*z+m[13]*w;out[2]=m[2]*x+m[6]*y+m[10]*z+m[14]*w;out[3]=m[3]*x+m[7]*y+m[11]*z+m[15]*w;return out};vec4.transformQuat=function(out,a,q){var x=a[0],y=a[1],z=a[2],qx=q[0],qy=q[1],qz=q[2],qw=q[3],ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;out[0]=ix*qw+iw*-qx+iy*-qz-iz*-qy;out[1]=iy*qw+iw*-qy+iz*-qx-ix*-qz;out[2]=iz*qw+iw*-qz+ix*-qy-iy*-qx;return out};vec4.forEach=function(){var vec=vec4.create();return function(a,stride,offset,count,fn,arg){var i,l;if(!stride){stride=4}if(!offset){offset=0}if(count){l=Math.min(count*stride+offset,a.length)}else{l=a.length}for(i=offset;i<l;i+=stride){vec[0]=a[i];vec[1]=a[i+1];vec[2]=a[i+2];vec[3]=a[i+3];fn(vec,vec,arg);a[i]=vec[0];a[i+1]=vec[1];a[i+2]=vec[2];a[i+3]=vec[3]}return a}}();vec4.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};if(typeof exports!=="undefined"){exports.vec4=vec4}var mat2={};mat2.create=function(){var out=new GLMAT_ARRAY_TYPE(4);out[0]=1;out[1]=0;out[2]=0;out[3]=1;return out};mat2.clone=function(a){var out=new GLMAT_ARRAY_TYPE(4);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];return out};mat2.copy=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];return out};mat2.identity=function(out){out[0]=1;out[1]=0;out[2]=0;out[3]=1;return out};mat2.transpose=function(out,a){if(out===a){var a1=a[1];out[1]=a[2];out[2]=a1}else{out[0]=a[0];out[1]=a[2];out[2]=a[1];out[3]=a[3]}return out};mat2.invert=function(out,a){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],det=a0*a3-a2*a1;if(!det){return null}det=1/det;out[0]=a3*det;out[1]=-a1*det;out[2]=-a2*det;out[3]=a0*det;return out};mat2.adjoint=function(out,a){var a0=a[0];out[0]=a[3];out[1]=-a[1];out[2]=-a[2];out[3]=a0;return out};mat2.determinant=function(a){return a[0]*a[3]-a[2]*a[1]};mat2.multiply=function(out,a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3];var b0=b[0],b1=b[1],b2=b[2],b3=b[3];out[0]=a0*b0+a2*b1;out[1]=a1*b0+a3*b1;out[2]=a0*b2+a2*b3;out[3]=a1*b2+a3*b3;return out};mat2.mul=mat2.multiply;mat2.rotate=function(out,a,rad){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],s=Math.sin(rad),c=Math.cos(rad);out[0]=a0*c+a2*s;out[1]=a1*c+a3*s;out[2]=a0*-s+a2*c;out[3]=a1*-s+a3*c;return out};mat2.scale=function(out,a,v){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],v0=v[0],v1=v[1];out[0]=a0*v0;out[1]=a1*v0;out[2]=a2*v1;out[3]=a3*v1;return out};mat2.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};mat2.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};mat2.LDU=function(L,D,U,a){L[2]=a[2]/a[0];U[0]=a[0];U[1]=a[1];U[3]=a[3]-L[2]*U[1];return[L,D,U]};if(typeof exports!=="undefined"){exports.mat2=mat2}var mat2d={};mat2d.create=function(){var out=new GLMAT_ARRAY_TYPE(6);out[0]=1;out[1]=0;out[2]=0;out[3]=1;out[4]=0;out[5]=0;return out};mat2d.clone=function(a){var out=new GLMAT_ARRAY_TYPE(6);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];return out};mat2d.copy=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];return out};mat2d.identity=function(out){out[0]=1;out[1]=0;out[2]=0;out[3]=1;out[4]=0;out[5]=0;return out};mat2d.invert=function(out,a){var aa=a[0],ab=a[1],ac=a[2],ad=a[3],atx=a[4],aty=a[5];var det=aa*ad-ab*ac;if(!det){return null}det=1/det;out[0]=ad*det;out[1]=-ab*det;out[2]=-ac*det;out[3]=aa*det;out[4]=(ac*aty-ad*atx)*det;out[5]=(ab*atx-aa*aty)*det;return out};mat2d.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};mat2d.multiply=function(out,a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5];out[0]=a0*b0+a2*b1;out[1]=a1*b0+a3*b1;out[2]=a0*b2+a2*b3;out[3]=a1*b2+a3*b3;out[4]=a0*b4+a2*b5+a4;out[5]=a1*b4+a3*b5+a5;return out};mat2d.mul=mat2d.multiply;mat2d.rotate=function(out,a,rad){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],s=Math.sin(rad),c=Math.cos(rad);out[0]=a0*c+a2*s;out[1]=a1*c+a3*s;out[2]=a0*-s+a2*c;out[3]=a1*-s+a3*c;out[4]=a4;out[5]=a5;return out};mat2d.scale=function(out,a,v){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],v0=v[0],v1=v[1];out[0]=a0*v0;out[1]=a1*v0;out[2]=a2*v1;out[3]=a3*v1;out[4]=a4;out[5]=a5;return out};mat2d.translate=function(out,a,v){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],v0=v[0],v1=v[1];out[0]=a0;out[1]=a1;out[2]=a2;out[3]=a3;out[4]=a0*v0+a2*v1+a4;out[5]=a1*v0+a3*v1+a5;return out};mat2d.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};mat2d.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};if(typeof exports!=="undefined"){exports.mat2d=mat2d}var mat3={};mat3.create=function(){var out=new GLMAT_ARRAY_TYPE(9);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=1;out[5]=0;out[6]=0;out[7]=0;out[8]=1;return out};mat3.fromMat4=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[4];out[4]=a[5];out[5]=a[6];out[6]=a[8];out[7]=a[9];out[8]=a[10];return out};mat3.clone=function(a){var out=new GLMAT_ARRAY_TYPE(9);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];return out};mat3.copy=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];return out};mat3.identity=function(out){out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=1;out[5]=0;out[6]=0;out[7]=0;out[8]=1;return out};mat3.transpose=function(out,a){if(out===a){var a01=a[1],a02=a[2],a12=a[5];out[1]=a[3];out[2]=a[6];out[3]=a01;out[5]=a[7];out[6]=a02;out[7]=a12}else{out[0]=a[0];out[1]=a[3];out[2]=a[6];out[3]=a[1];out[4]=a[4];out[5]=a[7];out[6]=a[2];out[7]=a[5];out[8]=a[8]}return out};mat3.invert=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;if(!det){return null}det=1/det;out[0]=b01*det;out[1]=(-a22*a01+a02*a21)*det;out[2]=(a12*a01-a02*a11)*det;out[3]=b11*det;out[4]=(a22*a00-a02*a20)*det;out[5]=(-a12*a00+a02*a10)*det;out[6]=b21*det;out[7]=(-a21*a00+a01*a20)*det;out[8]=(a11*a00-a01*a10)*det;return out};mat3.adjoint=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];out[0]=a11*a22-a12*a21;out[1]=a02*a21-a01*a22;out[2]=a01*a12-a02*a11;out[3]=a12*a20-a10*a22;out[4]=a00*a22-a02*a20;out[5]=a02*a10-a00*a12;out[6]=a10*a21-a11*a20;out[7]=a01*a20-a00*a21;out[8]=a00*a11-a01*a10;return out};mat3.determinant=function(a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20)};mat3.multiply=function(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b00=b[0],b01=b[1],b02=b[2],b10=b[3],b11=b[4],b12=b[5],b20=b[6],b21=b[7],b22=b[8];out[0]=b00*a00+b01*a10+b02*a20;out[1]=b00*a01+b01*a11+b02*a21;out[2]=b00*a02+b01*a12+b02*a22;out[3]=b10*a00+b11*a10+b12*a20;out[4]=b10*a01+b11*a11+b12*a21;out[5]=b10*a02+b11*a12+b12*a22;out[6]=b20*a00+b21*a10+b22*a20;out[7]=b20*a01+b21*a11+b22*a21;out[8]=b20*a02+b21*a12+b22*a22;return out};mat3.mul=mat3.multiply;mat3.translate=function(out,a,v){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],x=v[0],y=v[1];out[0]=a00;out[1]=a01;out[2]=a02;out[3]=a10;out[4]=a11;out[5]=a12;out[6]=x*a00+y*a10+a20;out[7]=x*a01+y*a11+a21;out[8]=x*a02+y*a12+a22;return out};mat3.rotate=function(out,a,rad){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],s=Math.sin(rad),c=Math.cos(rad);out[0]=c*a00+s*a10;out[1]=c*a01+s*a11;out[2]=c*a02+s*a12;out[3]=c*a10-s*a00;out[4]=c*a11-s*a01;out[5]=c*a12-s*a02;out[6]=a20;out[7]=a21;out[8]=a22;return out};mat3.scale=function(out,a,v){var x=v[0],y=v[1];out[0]=x*a[0];out[1]=x*a[1];out[2]=x*a[2];out[3]=y*a[3];out[4]=y*a[4];out[5]=y*a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];return out};mat3.fromMat2d=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=0;out[3]=a[2];out[4]=a[3];out[5]=0;out[6]=a[4];out[7]=a[5];out[8]=1;return out};mat3.fromQuat=function(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-yy-zz;out[3]=yx-wz;out[6]=zx+wy;out[1]=yx+wz;out[4]=1-xx-zz;out[7]=zy-wx;out[2]=zx-wy;out[5]=zy+wx;out[8]=1-xx-yy;return out};mat3.normalFromMat4=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a12*b08-a10*b11-a13*b07)*det;out[2]=(a10*b10-a11*b08+a13*b06)*det;out[3]=(a02*b10-a01*b11-a03*b09)*det;out[4]=(a00*b11-a02*b08+a03*b07)*det;out[5]=(a01*b08-a00*b10-a03*b06)*det;out[6]=(a31*b05-a32*b04+a33*b03)*det;out[7]=(a32*b02-a30*b05-a33*b01)*det;out[8]=(a30*b04-a31*b02+a33*b00)*det;return out};mat3.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};mat3.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};if(typeof exports!=="undefined"){exports.mat3=mat3}var mat4={};mat4.create=function(){var out=new GLMAT_ARRAY_TYPE(16);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};mat4.clone=function(a){var out=new GLMAT_ARRAY_TYPE(16);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out};mat4.copy=function(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out};mat4.identity=function(out){out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};mat4.transpose=function(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a01;out[6]=a[9];out[7]=a[13];out[8]=a02;out[9]=a12;out[11]=a[14];out[12]=a03;out[13]=a13;out[14]=a23}else{out[0]=a[0];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a[1];out[5]=a[5];out[6]=a[9];out[7]=a[13];out[8]=a[2];out[9]=a[6];out[10]=a[10];out[11]=a[14];out[12]=a[3];out[13]=a[7];out[14]=a[11];out[15]=a[15]}return out};mat4.invert=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a02*b10-a01*b11-a03*b09)*det;out[2]=(a31*b05-a32*b04+a33*b03)*det;out[3]=(a22*b04-a21*b05-a23*b03)*det;out[4]=(a12*b08-a10*b11-a13*b07)*det;out[5]=(a00*b11-a02*b08+a03*b07)*det;out[6]=(a32*b02-a30*b05-a33*b01)*det;out[7]=(a20*b05-a22*b02+a23*b01)*det;out[8]=(a10*b10-a11*b08+a13*b06)*det;out[9]=(a01*b08-a00*b10-a03*b06)*det;out[10]=(a30*b04-a31*b02+a33*b00)*det;out[11]=(a21*b02-a20*b04-a23*b00)*det;out[12]=(a11*b07-a10*b09-a12*b06)*det;out[13]=(a00*b09-a01*b07+a02*b06)*det;out[14]=(a31*b01-a30*b03-a32*b00)*det;out[15]=(a20*b03-a21*b01+a22*b00)*det;return out};mat4.adjoint=function(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];out[0]=a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22);out[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22));out[2]=a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12);out[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12));out[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22));out[5]=a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22);out[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12));out[7]=a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12);out[8]=a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21);out[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21));out[10]=a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11);out[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11));out[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21));out[13]=a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21);out[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11));out[15]=a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11);return out};mat4.determinant=function(a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32;return b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06};mat4.multiply=function(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];var b0=b[0],b1=b[1],b2=b[2],b3=b[3];out[0]=b0*a00+b1*a10+b2*a20+b3*a30;out[1]=b0*a01+b1*a11+b2*a21+b3*a31;out[2]=b0*a02+b1*a12+b2*a22+b3*a32;out[3]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[4];b1=b[5];b2=b[6];b3=b[7];out[4]=b0*a00+b1*a10+b2*a20+b3*a30;out[5]=b0*a01+b1*a11+b2*a21+b3*a31;out[6]=b0*a02+b1*a12+b2*a22+b3*a32;out[7]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[8];b1=b[9];b2=b[10];b3=b[11];out[8]=b0*a00+b1*a10+b2*a20+b3*a30;out[9]=b0*a01+b1*a11+b2*a21+b3*a31;out[10]=b0*a02+b1*a12+b2*a22+b3*a32;out[11]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[12];b1=b[13];b2=b[14];b3=b[15];out[12]=b0*a00+b1*a10+b2*a20+b3*a30;out[13]=b0*a01+b1*a11+b2*a21+b3*a31;out[14]=b0*a02+b1*a12+b2*a22+b3*a32;out[15]=b0*a03+b1*a13+b2*a23+b3*a33;return out};mat4.mul=mat4.multiply;mat4.translate=function(out,a,v){var x=v[0],y=v[1],z=v[2],a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23;if(a===out){out[12]=a[0]*x+a[4]*y+a[8]*z+a[12];out[13]=a[1]*x+a[5]*y+a[9]*z+a[13];out[14]=a[2]*x+a[6]*y+a[10]*z+a[14];out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]}else{a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];out[0]=a00;out[1]=a01;out[2]=a02;out[3]=a03;out[4]=a10;out[5]=a11;out[6]=a12;out[7]=a13;out[8]=a20;out[9]=a21;out[10]=a22;out[11]=a23;out[12]=a00*x+a10*y+a20*z+a[12];out[13]=a01*x+a11*y+a21*z+a[13];out[14]=a02*x+a12*y+a22*z+a[14];out[15]=a03*x+a13*y+a23*z+a[15]}return out};mat4.scale=function(out,a,v){var x=v[0],y=v[1],z=v[2];out[0]=a[0]*x;out[1]=a[1]*x;out[2]=a[2]*x;out[3]=a[3]*x;out[4]=a[4]*y;out[5]=a[5]*y;out[6]=a[6]*y;out[7]=a[7]*y;out[8]=a[8]*z;out[9]=a[9]*z;out[10]=a[10]*z;out[11]=a[11]*z;out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out};mat4.rotate=function(out,a,rad,axis){var x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z),s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22;if(Math.abs(len)<GLMAT_EPSILON){return null}len=1/len;x*=len;y*=len;z*=len;s=Math.sin(rad);c=Math.cos(rad);t=1-c;a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];b00=x*x*t+c;b01=y*x*t+z*s;b02=z*x*t-y*s;b10=x*y*t-z*s;b11=y*y*t+c;b12=z*y*t+x*s;b20=x*z*t+y*s;b21=y*z*t-x*s;b22=z*z*t+c;out[0]=a00*b00+a10*b01+a20*b02;out[1]=a01*b00+a11*b01+a21*b02;out[2]=a02*b00+a12*b01+a22*b02;out[3]=a03*b00+a13*b01+a23*b02;out[4]=a00*b10+a10*b11+a20*b12;out[5]=a01*b10+a11*b11+a21*b12;out[6]=a02*b10+a12*b11+a22*b12;out[7]=a03*b10+a13*b11+a23*b12;out[8]=a00*b20+a10*b21+a20*b22;out[9]=a01*b20+a11*b21+a21*b22;out[10]=a02*b20+a12*b21+a22*b22;out[11]=a03*b20+a13*b21+a23*b22;if(a!==out){out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}return out};mat4.rotateX=function(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[4]=a10*c+a20*s;out[5]=a11*c+a21*s;out[6]=a12*c+a22*s;out[7]=a13*c+a23*s;out[8]=a20*c-a10*s;out[9]=a21*c-a11*s;out[10]=a22*c-a12*s;out[11]=a23*c-a13*s;return out};mat4.rotateY=function(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c-a20*s;out[1]=a01*c-a21*s;out[2]=a02*c-a22*s;out[3]=a03*c-a23*s;out[8]=a00*s+a20*c;out[9]=a01*s+a21*c;out[10]=a02*s+a22*c;out[11]=a03*s+a23*c;return out};mat4.rotateZ=function(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];if(a!==out){out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c+a10*s;out[1]=a01*c+a11*s;out[2]=a02*c+a12*s;out[3]=a03*c+a13*s;out[4]=a10*c-a00*s;out[5]=a11*c-a01*s;out[6]=a12*c-a02*s;out[7]=a13*c-a03*s;return out};mat4.fromRotationTranslation=function(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-(yy+zz);out[1]=xy+wz;out[2]=xz-wy;out[3]=0;out[4]=xy-wz;out[5]=1-(xx+zz);out[6]=yz+wx;out[7]=0;out[8]=xz+wy;out[9]=yz-wx;out[10]=1-(xx+yy);out[11]=0;out[12]=v[0];out[13]=v[1];out[14]=v[2];out[15]=1;return out};mat4.fromQuat=function(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-yy-zz;out[1]=yx+wz;out[2]=zx-wy;out[3]=0;out[4]=yx-wz;out[5]=1-xx-zz;out[6]=zy+wx;out[7]=0;out[8]=zx+wy;out[9]=zy-wx;out[10]=1-xx-yy;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};mat4.frustum=function(out,left,right,bottom,top,near,far){var rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);out[0]=near*2*rl;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=near*2*tb;out[6]=0;out[7]=0;out[8]=(right+left)*rl;out[9]=(top+bottom)*tb;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=far*near*2*nf;out[15]=0;return out};mat4.perspective=function(out,fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);out[0]=f/aspect;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=f;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=2*far*near*nf;out[15]=0;return out};mat4.ortho=function(out,left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);out[0]=-2*lr;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=-2*bt;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=2*nf;out[11]=0;out[12]=(left+right)*lr;out[13]=(top+bottom)*bt;out[14]=(far+near)*nf;out[15]=1;return out};mat4.lookAt=function(out,eye,center,up){var x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];if(Math.abs(eyex-centerx)<GLMAT_EPSILON&&Math.abs(eyey-centery)<GLMAT_EPSILON&&Math.abs(eyez-centerz)<GLMAT_EPSILON){return mat4.identity(out)}z0=eyex-centerx;z1=eyey-centery;z2=eyez-centerz;len=1/Math.sqrt(z0*z0+z1*z1+z2*z2);z0*=len;z1*=len;z2*=len;x0=upy*z2-upz*z1;x1=upz*z0-upx*z2;x2=upx*z1-upy*z0;len=Math.sqrt(x0*x0+x1*x1+x2*x2);if(!len){x0=0;x1=0;x2=0}else{len=1/len;x0*=len;x1*=len;x2*=len}y0=z1*x2-z2*x1;y1=z2*x0-z0*x2;y2=z0*x1-z1*x0;len=Math.sqrt(y0*y0+y1*y1+y2*y2);if(!len){y0=0;y1=0;y2=0}else{len=1/len;y0*=len;y1*=len;y2*=len}out[0]=x0;out[1]=y0;out[2]=z0;out[3]=0;out[4]=x1;out[5]=y1;out[6]=z1;out[7]=0;out[8]=x2;out[9]=y2;out[10]=z2;out[11]=0;out[12]=-(x0*eyex+x1*eyey+x2*eyez);out[13]=-(y0*eyex+y1*eyey+y2*eyez);out[14]=-(z0*eyex+z1*eyey+z2*eyez);out[15]=1;return out};mat4.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};mat4.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};if(typeof exports!=="undefined"){exports.mat4=mat4}var quat={};quat.create=function(){var out=new GLMAT_ARRAY_TYPE(4);out[0]=0;out[1]=0;out[2]=0;out[3]=1;return out};quat.rotationTo=function(){var tmpvec3=vec3.create();var xUnitVec3=vec3.fromValues(1,0,0);var yUnitVec3=vec3.fromValues(0,1,0);return function(out,a,b){var dot=vec3.dot(a,b);if(dot<-.999999){vec3.cross(tmpvec3,xUnitVec3,a);if(vec3.length(tmpvec3)<1e-6)vec3.cross(tmpvec3,yUnitVec3,a);vec3.normalize(tmpvec3,tmpvec3);quat.setAxisAngle(out,tmpvec3,Math.PI);return out}else if(dot>.999999){out[0]=0;out[1]=0;out[2]=0;out[3]=1;return out}else{vec3.cross(tmpvec3,a,b);out[0]=tmpvec3[0];out[1]=tmpvec3[1];out[2]=tmpvec3[2];out[3]=1+dot;return quat.normalize(out,out)}}}();quat.setAxes=function(){var matr=mat3.create();return function(out,view,right,up){matr[0]=right[0];matr[3]=right[1];matr[6]=right[2];matr[1]=up[0];matr[4]=up[1];matr[7]=up[2];matr[2]=-view[0];matr[5]=-view[1];matr[8]=-view[2];return quat.normalize(out,quat.fromMat3(out,matr))}}();quat.clone=vec4.clone;quat.fromValues=vec4.fromValues;quat.copy=vec4.copy;quat.set=vec4.set;quat.identity=function(out){out[0]=0;out[1]=0;out[2]=0;out[3]=1;return out};quat.setAxisAngle=function(out,axis,rad){rad=rad*.5;var s=Math.sin(rad);out[0]=s*axis[0];out[1]=s*axis[1];out[2]=s*axis[2];out[3]=Math.cos(rad);return out};quat.add=vec4.add;quat.multiply=function(out,a,b){var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];out[0]=ax*bw+aw*bx+ay*bz-az*by;out[1]=ay*bw+aw*by+az*bx-ax*bz;out[2]=az*bw+aw*bz+ax*by-ay*bx;out[3]=aw*bw-ax*bx-ay*by-az*bz;return out};quat.mul=quat.multiply;quat.scale=vec4.scale;quat.rotateX=function(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=Math.sin(rad),bw=Math.cos(rad);out[0]=ax*bw+aw*bx;out[1]=ay*bw+az*bx;out[2]=az*bw-ay*bx;out[3]=aw*bw-ax*bx;return out};quat.rotateY=function(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],by=Math.sin(rad),bw=Math.cos(rad);out[0]=ax*bw-az*by;out[1]=ay*bw+aw*by;out[2]=az*bw+ax*by;out[3]=aw*bw-ay*by;return out};quat.rotateZ=function(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bz=Math.sin(rad),bw=Math.cos(rad);out[0]=ax*bw+ay*bz;out[1]=ay*bw-ax*bz;out[2]=az*bw+aw*bz;out[3]=aw*bw-az*bz;return out};quat.calculateW=function(out,a){var x=a[0],y=a[1],z=a[2];out[0]=x;out[1]=y;out[2]=z;out[3]=-Math.sqrt(Math.abs(1-x*x-y*y-z*z));return out};quat.dot=vec4.dot;quat.lerp=vec4.lerp;quat.slerp=function(out,a,b,t){var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];var omega,cosom,sinom,scale0,scale1;cosom=ax*bx+ay*by+az*bz+aw*bw;if(cosom<0){cosom=-cosom;bx=-bx;by=-by;bz=-bz;bw=-bw}if(1-cosom>1e-6){omega=Math.acos(cosom);sinom=Math.sin(omega);scale0=Math.sin((1-t)*omega)/sinom;scale1=Math.sin(t*omega)/sinom}else{scale0=1-t;scale1=t}out[0]=scale0*ax+scale1*bx;out[1]=scale0*ay+scale1*by;out[2]=scale0*az+scale1*bz;out[3]=scale0*aw+scale1*bw;return out};quat.invert=function(out,a){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],dot=a0*a0+a1*a1+a2*a2+a3*a3,invDot=dot?1/dot:0;out[0]=-a0*invDot;out[1]=-a1*invDot;out[2]=-a2*invDot;out[3]=a3*invDot;return out};quat.conjugate=function(out,a){out[0]=-a[0];out[1]=-a[1];out[2]=-a[2];out[3]=a[3];return out};quat.length=vec4.length;quat.len=quat.length;quat.squaredLength=vec4.squaredLength;quat.sqrLen=quat.squaredLength;quat.normalize=vec4.normalize;quat.fromMat3=function(out,m){var fTrace=m[0]+m[4]+m[8];var fRoot;if(fTrace>0){fRoot=Math.sqrt(fTrace+1);out[3]=.5*fRoot;fRoot=.5/fRoot;out[0]=(m[7]-m[5])*fRoot;out[1]=(m[2]-m[6])*fRoot;out[2]=(m[3]-m[1])*fRoot}else{var i=0;if(m[4]>m[0])i=1;if(m[8]>m[i*3+i])i=2;var j=(i+1)%3;var k=(i+2)%3;fRoot=Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k]+1);out[i]=.5*fRoot;fRoot=.5/fRoot;out[3]=(m[k*3+j]-m[j*3+k])*fRoot;out[j]=(m[j*3+i]+m[i*3+j])*fRoot;out[k]=(m[k*3+i]+m[i*3+k])*fRoot}return out};quat.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};if(typeof exports!=="undefined"){exports.quat=quat}})(shim.exports)})(this)},{}],174:[function(require,module,exports){"use strict";var vectorizeText=require("vectorize-text");module.exports=getGlyph;var GLYPH_CACHE={};function getGlyph(symbol,font){var fontCache=GLYPH_CACHE[font];if(!fontCache){fontCache=GLYPH_CACHE[font]={}}if(symbol in fontCache){return fontCache[symbol]}var lineSymbol=vectorizeText(symbol,{textAlign:"center",textBaseline:"middle",lineHeight:1,font:font});var triSymbol=vectorizeText(symbol,{triangles:true,textAlign:"center",textBaseline:"middle",lineHeight:1,font:font});var bounds=[[Infinity,Infinity],[-Infinity,-Infinity]];for(var i=0;i<lineSymbol.positions.length;++i){var p=lineSymbol.positions[i];for(var j=0;j<2;++j){bounds[0][j]=Math.min(bounds[0][j],p[j]);bounds[1][j]=Math.max(bounds[1][j],p[j])}}return fontCache[symbol]=[triSymbol,lineSymbol,bounds]}},{"vectorize-text":214}],175:[function(require,module,exports){module.exports=adjoint;function adjoint(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];out[0]=a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22);out[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22));out[2]=a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12);out[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12));out[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22));out[5]=a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22);out[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12));out[7]=a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12);out[8]=a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21);out[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21));out[10]=a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11);out[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11));out[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21));out[13]=a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21);out[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11));out[15]=a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11);return out}},{}],176:[function(require,module,exports){module.exports=clone;function clone(a){var out=new Float32Array(16);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out}},{}],177:[function(require,module,exports){module.exports=copy;function copy(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out}},{}],178:[function(require,module,exports){module.exports=create;function create(){var out=new Float32Array(16);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out}},{}],179:[function(require,module,exports){module.exports=determinant;function determinant(a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32;return b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06}},{}],180:[function(require,module,exports){module.exports=fromQuat;function fromQuat(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-yy-zz;out[1]=yx+wz;out[2]=zx-wy;out[3]=0;out[4]=yx-wz;out[5]=1-xx-zz;out[6]=zy+wx;out[7]=0;out[8]=zx+wy;out[9]=zy-wx;out[10]=1-xx-yy;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out}},{}],181:[function(require,module,exports){module.exports=fromRotationTranslation;function fromRotationTranslation(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-(yy+zz);out[1]=xy+wz;out[2]=xz-wy;out[3]=0;out[4]=xy-wz;out[5]=1-(xx+zz);out[6]=yz+wx;out[7]=0;out[8]=xz+wy;out[9]=yz-wx;out[10]=1-(xx+yy);out[11]=0;out[12]=v[0];out[13]=v[1];out[14]=v[2];out[15]=1;return out}},{}],182:[function(require,module,exports){module.exports=frustum;function frustum(out,left,right,bottom,top,near,far){var rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);out[0]=near*2*rl;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=near*2*tb;out[6]=0;out[7]=0;out[8]=(right+left)*rl;out[9]=(top+bottom)*tb;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=far*near*2*nf;out[15]=0;return out}},{}],183:[function(require,module,exports){module.exports=identity;function identity(out){out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out}},{}],184:[function(require,module,exports){module.exports={create:require("./create"),clone:require("./clone"),copy:require("./copy"),identity:require("./identity"),transpose:require("./transpose"),invert:require("./invert"),adjoint:require("./adjoint"),determinant:require("./determinant"),multiply:require("./multiply"),translate:require("./translate"),scale:require("./scale"),rotate:require("./rotate"),rotateX:require("./rotateX"),rotateY:require("./rotateY"),rotateZ:require("./rotateZ"),fromRotationTranslation:require("./fromRotationTranslation"),fromQuat:require("./fromQuat"),frustum:require("./frustum"),perspective:require("./perspective"),ortho:require("./ortho"),lookAt:require("./lookAt"),str:require("./str")}},{"./adjoint":175,"./clone":176,"./copy":177,"./create":178,"./determinant":179,"./fromQuat":180,"./fromRotationTranslation":181,"./frustum":182,"./identity":183,"./invert":185,"./lookAt":186,"./multiply":187,"./ortho":188,"./perspective":189,"./rotate":190,"./rotateX":191,"./rotateY":192,"./rotateZ":193,"./scale":194,"./str":195,"./translate":196,"./transpose":197}],185:[function(require,module,exports){module.exports=invert;function invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a02*b10-a01*b11-a03*b09)*det;out[2]=(a31*b05-a32*b04+a33*b03)*det;out[3]=(a22*b04-a21*b05-a23*b03)*det;out[4]=(a12*b08-a10*b11-a13*b07)*det;out[5]=(a00*b11-a02*b08+a03*b07)*det;out[6]=(a32*b02-a30*b05-a33*b01)*det;out[7]=(a20*b05-a22*b02+a23*b01)*det;out[8]=(a10*b10-a11*b08+a13*b06)*det;out[9]=(a01*b08-a00*b10-a03*b06)*det;out[10]=(a30*b04-a31*b02+a33*b00)*det;out[11]=(a21*b02-a20*b04-a23*b00)*det;out[12]=(a11*b07-a10*b09-a12*b06)*det;out[13]=(a00*b09-a01*b07+a02*b06)*det;out[14]=(a31*b01-a30*b03-a32*b00)*det;out[15]=(a20*b03-a21*b01+a22*b00)*det;return out}},{}],186:[function(require,module,exports){module.exports=lookAt;function lookAt(out,eye,center,up){var x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];if(Math.abs(eyex-centerx)<1e-6&&Math.abs(eyey-centery)<1e-6&&Math.abs(eyez-centerz)<1e-6){return mat4.identity(out)}z0=eyex-centerx;z1=eyey-centery;z2=eyez-centerz;len=1/Math.sqrt(z0*z0+z1*z1+z2*z2);z0*=len;z1*=len;z2*=len;x0=upy*z2-upz*z1;x1=upz*z0-upx*z2;x2=upx*z1-upy*z0;len=Math.sqrt(x0*x0+x1*x1+x2*x2);if(!len){x0=0;x1=0;x2=0}else{len=1/len;x0*=len;x1*=len;x2*=len}y0=z1*x2-z2*x1;y1=z2*x0-z0*x2;y2=z0*x1-z1*x0;len=Math.sqrt(y0*y0+y1*y1+y2*y2);if(!len){y0=0;y1=0;y2=0}else{len=1/len;y0*=len;y1*=len;y2*=len}out[0]=x0;out[1]=y0;out[2]=z0;out[3]=0;out[4]=x1;out[5]=y1;out[6]=z1;out[7]=0;out[8]=x2;out[9]=y2;out[10]=z2;out[11]=0;out[12]=-(x0*eyex+x1*eyey+x2*eyez);out[13]=-(y0*eyex+y1*eyey+y2*eyez);out[14]=-(z0*eyex+z1*eyey+z2*eyez);out[15]=1;return out}},{}],187:[function(require,module,exports){module.exports=multiply;function multiply(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];var b0=b[0],b1=b[1],b2=b[2],b3=b[3];out[0]=b0*a00+b1*a10+b2*a20+b3*a30;out[1]=b0*a01+b1*a11+b2*a21+b3*a31;out[2]=b0*a02+b1*a12+b2*a22+b3*a32;out[3]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[4];b1=b[5];b2=b[6];b3=b[7];out[4]=b0*a00+b1*a10+b2*a20+b3*a30;out[5]=b0*a01+b1*a11+b2*a21+b3*a31;out[6]=b0*a02+b1*a12+b2*a22+b3*a32;out[7]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[8];b1=b[9];b2=b[10];b3=b[11];out[8]=b0*a00+b1*a10+b2*a20+b3*a30;out[9]=b0*a01+b1*a11+b2*a21+b3*a31;out[10]=b0*a02+b1*a12+b2*a22+b3*a32;out[11]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[12];b1=b[13];b2=b[14];b3=b[15];out[12]=b0*a00+b1*a10+b2*a20+b3*a30;out[13]=b0*a01+b1*a11+b2*a21+b3*a31;out[14]=b0*a02+b1*a12+b2*a22+b3*a32;out[15]=b0*a03+b1*a13+b2*a23+b3*a33;return out}},{}],188:[function(require,module,exports){module.exports=ortho;function ortho(out,left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);out[0]=-2*lr;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=-2*bt;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=2*nf;out[11]=0;out[12]=(left+right)*lr;out[13]=(top+bottom)*bt;out[14]=(far+near)*nf;out[15]=1;return out}},{}],189:[function(require,module,exports){module.exports=perspective;function perspective(out,fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);out[0]=f/aspect;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=f;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=2*far*near*nf;out[15]=0;return out}},{}],190:[function(require,module,exports){module.exports=rotate;function rotate(out,a,rad,axis){var x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z),s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22;if(Math.abs(len)<1e-6){return null}len=1/len;x*=len;y*=len;z*=len;s=Math.sin(rad);c=Math.cos(rad);t=1-c;a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];b00=x*x*t+c;b01=y*x*t+z*s;b02=z*x*t-y*s;b10=x*y*t-z*s;b11=y*y*t+c;b12=z*y*t+x*s;b20=x*z*t+y*s;b21=y*z*t-x*s;b22=z*z*t+c;out[0]=a00*b00+a10*b01+a20*b02;out[1]=a01*b00+a11*b01+a21*b02;out[2]=a02*b00+a12*b01+a22*b02;out[3]=a03*b00+a13*b01+a23*b02;out[4]=a00*b10+a10*b11+a20*b12;out[5]=a01*b10+a11*b11+a21*b12;out[6]=a02*b10+a12*b11+a22*b12;out[7]=a03*b10+a13*b11+a23*b12;out[8]=a00*b20+a10*b21+a20*b22;out[9]=a01*b20+a11*b21+a21*b22;out[10]=a02*b20+a12*b21+a22*b22;out[11]=a03*b20+a13*b21+a23*b22;if(a!==out){out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}return out}},{}],191:[function(require,module,exports){module.exports=rotateX;function rotateX(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[4]=a10*c+a20*s;out[5]=a11*c+a21*s;out[6]=a12*c+a22*s;out[7]=a13*c+a23*s;out[8]=a20*c-a10*s;out[9]=a21*c-a11*s;out[10]=a22*c-a12*s;out[11]=a23*c-a13*s;return out}},{}],192:[function(require,module,exports){module.exports=rotateY;function rotateY(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c-a20*s;out[1]=a01*c-a21*s;out[2]=a02*c-a22*s;out[3]=a03*c-a23*s;out[8]=a00*s+a20*c;out[9]=a01*s+a21*c;out[10]=a02*s+a22*c;out[11]=a03*s+a23*c;return out}},{}],193:[function(require,module,exports){module.exports=rotateZ;function rotateZ(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];if(a!==out){out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c+a10*s;out[1]=a01*c+a11*s;out[2]=a02*c+a12*s;out[3]=a03*c+a13*s;out[4]=a10*c-a00*s;out[5]=a11*c-a01*s;out[6]=a12*c-a02*s;out[7]=a13*c-a03*s;return out}},{}],194:[function(require,module,exports){module.exports=scale;function scale(out,a,v){var x=v[0],y=v[1],z=v[2];out[0]=a[0]*x;out[1]=a[1]*x;out[2]=a[2]*x;out[3]=a[3]*x;out[4]=a[4]*y;out[5]=a[5]*y;out[6]=a[6]*y;out[7]=a[7]*y;out[8]=a[8]*z;out[9]=a[9]*z;out[10]=a[10]*z;out[11]=a[11]*z;out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out}},{}],195:[function(require,module,exports){module.exports=str;function str(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],196:[function(require,module,exports){module.exports=translate;function translate(out,a,v){var x=v[0],y=v[1],z=v[2],a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23;if(a===out){out[12]=a[0]*x+a[4]*y+a[8]*z+a[12];out[13]=a[1]*x+a[5]*y+a[9]*z+a[13];out[14]=a[2]*x+a[6]*y+a[10]*z+a[14];out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]}else{a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];out[0]=a00;out[1]=a01;out[2]=a02;out[3]=a03;out[4]=a10;out[5]=a11;out[6]=a12;out[7]=a13;out[8]=a20;out[9]=a21;out[10]=a22;out[11]=a23;out[12]=a00*x+a10*y+a20*z+a[12];out[13]=a01*x+a11*y+a21*z+a[13];out[14]=a02*x+a12*y+a22*z+a[14];out[15]=a03*x+a13*y+a23*z+a[15]}return out}},{}],197:[function(require,module,exports){module.exports=transpose;function transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a01;out[6]=a[9];out[7]=a[13];out[8]=a02;out[9]=a12;out[11]=a[14];out[12]=a03;out[13]=a13;out[14]=a23}else{out[0]=a[0];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a[1];out[5]=a[5];out[6]=a[9];out[7]=a[13];out[8]=a[2];out[9]=a[6];out[10]=a[10];out[11]=a[14];out[12]=a[3];out[13]=a[7];out[14]=a[11];out[15]=a[15]}return out}},{}],198:[function(require,module,exports){module.exports=require(39)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/do-bind.js":39}],199:[function(require,module,exports){module.exports=require(40)},{"./do-bind.js":198,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-emulated.js":40}],200:[function(require,module,exports){module.exports=require(41)},{"./do-bind.js":198,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-native.js":41}],201:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],202:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:201}],203:[function(require,module,exports){module.exports=require(44)},{"./lib/vao-emulated.js":199,"./lib/vao-native.js":200,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/vao.js":44,webglew:202}],204:[function(require,module,exports){module.exports=require(45)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/adapter.js":45,"gl-shader-core":210}],205:[function(require,module,exports){module.exports=require(46)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/browser.js":46}],206:[function(require,module,exports){module.exports=require(47)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-attributes.js":47}],207:[function(require,module,exports){module.exports=require(48)},{"./reflect":208,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-uniforms.js":48,dup:209}],208:[function(require,module,exports){module.exports=require(49)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/reflect.js":49}],209:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],210:[function(require,module,exports){module.exports=require(51)},{"./lib/create-attributes":206,"./lib/create-uniforms":207,"./lib/reflect":208,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/shader-core.js":51}],211:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],212:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],213:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":211,buffer:8,dup:212}],214:[function(require,module,exports){module.exports=require(56)},{"./lib/vtext":215,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/index.js":56,"canvas-browserify":216}],215:[function(require,module,exports){module.exports=require(57)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/lib/vtext.js":57,ndarray:412,"planar-graph-to-polyline":237,"simplify-planar-graph":247,"surface-nets":260,"triangulate-polyline":271}],216:[function(require,module,exports){module.exports=require(58)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/canvas-browserify/browser.js":58}],217:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],218:[function(require,module,exports){module.exports=require(60)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/edges-to-adjacency-list/e2a.js":60,uniq:236}],219:[function(require,module,exports){module.exports=require(61)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/planar-dual/loops.js":61,"compare-angle":220}],220:[function(require,module,exports){module.exports=require(62)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/planar-dual/node_modules/compare-angle/cmpangle.js":62,"robust-orientation":233,"robust-product":222,"robust-sum":234,signum:223,"two-sum":224}],221:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":235,"two-sum":224}],222:[function(require,module,exports){module.exports=require(64)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/planar-dual/node_modules/compare-angle/node_modules/robust-product/product.js":64,"robust-scale":221,"robust-sum":234}],223:[function(require,module,exports){module.exports=require(65)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/planar-dual/node_modules/compare-angle/node_modules/signum/sgn.js":65}],224:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],225:[function(require,module,exports){module.exports=require(67)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/node_modules/slab-decomposition/lib/order-segments.js":67,"robust-orientation":233}],226:[function(require,module,exports){module.exports=require(68)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/node_modules/slab-decomposition/node_modules/binary-search-bounds/search-bounds.js":68}],227:[function(require,module,exports){module.exports=require(69)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/node_modules/slab-decomposition/node_modules/functional-red-black-tree/rbtree.js":69}],228:[function(require,module,exports){module.exports=require(70)},{"./lib/order-segments":225,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/node_modules/slab-decomposition/slabs.js":70,"binary-search-bounds":226,"functional-red-black-tree":227,"robust-orientation":233}],229:[function(require,module,exports){module.exports=require(71)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/pnp-big.js":71,"robust-orientation":233,"slab-decomposition":228}],230:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],231:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":235,"two-sum":230}],232:[function(require,module,exports){module.exports=require(20)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-subtract/robust-diff.js":20}],233:[function(require,module,exports){module.exports=require(23)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/orientation.js":23,"robust-scale":231,"robust-subtract":232,"robust-sum":234,"two-product":235}],234:[function(require,module,exports){module.exports=require(21)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-sum/robust-sum.js":21}],235:[function(require,module,exports){module.exports=require(22)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/two-product/two-product.js":22}],236:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],237:[function(require,module,exports){module.exports=require(79)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/pg2pl.js":79,dup:217,"edges-to-adjacency-list":218,"planar-dual":219,"point-in-big-polygon":229,"robust-sum":234,"two-product":235,uniq:236}],238:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],239:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":242,"two-sum":238}],240:[function(require,module,exports){module.exports=require(20)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-subtract/robust-diff.js":20}],241:[function(require,module,exports){module.exports=require(21)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-sum/robust-sum.js":21}],242:[function(require,module,exports){module.exports=require(22)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/two-product/two-product.js":22}],243:[function(require,module,exports){module.exports=require(23)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/orientation.js":23,"robust-scale":239,"robust-subtract":240,"robust-sum":241,"two-product":242}],244:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],245:[function(require,module,exports){module.exports=require(87)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/simplify-planar-graph/node_modules/simplicial-complex/node_modules/union-find/index.js":87}],246:[function(require,module,exports){arguments[4][26][0].apply(exports,arguments)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/topology.js":26,"bit-twiddle":244,"union-find":245}],247:[function(require,module,exports){module.exports=require(89)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/simplify-planar-graph/simplify.js":89,"robust-orientation":243,"simplicial-complex":246}],248:[function(require,module,exports){module.exports=require(90)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/contour.js":90,"typedarray-pool":213}],249:[function(require,module,exports){module.exports=require(93)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/gamma/index.js":93}],250:[function(require,module,exports){module.exports=require(96)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/permutation-parity/permutation-sign.js":96,"typedarray-pool":213}],251:[function(require,module,exports){module.exports=require(97)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/permutation-rank/index.js":97,"invert-permutation":252,"typedarray-pool":213}],252:[function(require,module,exports){module.exports=require(98)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/permutation-rank/node_modules/invert-permutation/index.js":98}],253:[function(require,module,exports){module.exports=require(101)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/triangulate-cube.js":101,gamma:249,"permutation-parity":250,"permutation-rank":251}],254:[function(require,module,exports){module.exports=require(102)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/lib/zc-core.js":102,"cwise-compiler":255}],255:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":257,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],256:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:258}],257:[function(require,module,exports){module.exports=require(105)},{"./compile.js":256,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],258:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],259:[function(require,module,exports){module.exports=require(107)},{"./lib/zc-core":254,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/zc.js":107}],260:[function(require,module,exports){module.exports=require(108)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/surfacenets.js":108,"ndarray-extract-contour":248,"triangulate-hypercube":253,"zero-crossings":259}],261:[function(require,module,exports){module.exports=require(109)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/dist/version.json":109}],262:[function(require,module,exports){module.exports=require(110)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/advancingfront.js":110}],263:[function(require,module,exports){module.exports=require(111)},{"./xy":270,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/point.js":111}],264:[function(require,module,exports){module.exports=require(112)},{"./xy":270,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/pointerror.js":112}],265:[function(require,module,exports){module.exports=require(113)},{"../dist/version.json":261,"./point":263,"./pointerror":264,"./sweep":266,"./sweepcontext":267,"./triangle":268,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/poly2tri.js":113}],266:[function(require,module,exports){module.exports=require(114)},{"./advancingfront":262,"./pointerror":264,"./triangle":268,"./utils":269,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/sweep.js":114}],267:[function(require,module,exports){module.exports=require(115)},{"./advancingfront":262,"./point":263,"./pointerror":264,"./sweep":266,"./triangle":268,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/sweepcontext.js":115}],268:[function(require,module,exports){module.exports=require(116)},{"./xy":270,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/triangle.js":116}],269:[function(require,module,exports){module.exports=require(117)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/utils.js":117}],270:[function(require,module,exports){module.exports=require(118)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/node_modules/poly2tri/src/xy.js":118}],271:[function(require,module,exports){module.exports=require(119)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/triangulate-polyline/tripolyline.js":119,poly2tri:265}],272:[function(require,module,exports){"use strict";var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var glslify=require("glslify");var pool=require("typedarray-pool");var getCubeParams=require("gl-axes/lib/cube");var mat4=require("gl-mat4");var vec4=require("gl-matrix").vec4;var vec3=require("gl-matrix").vec3;var getGlyph=require("./lib/glyphs");var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + vec4(glyph.x, -glyph.y, 0, 0));\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec4 highlightId;\nuniform vec4 highlightColor;\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0])) || any(greaterThan(dataCoordinate, fragClipBounds[1]))) {\n    discard;\n  } else if(distance(pickId, highlightId) < 0.001) {\n    gl_FragColor = highlightColor * opacity;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n  \n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"highlightId",type:"vec4"},{name:"highlightColor",type:"vec4"},{name:"fragClipBounds[0]",type:"vec3"},{name:"fragClipBounds[1]",type:"vec3"},{name:"opacity",type:"float"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}]),createOrthoShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n    gl_Position = clipPosition + vec4(screenSize * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec4 highlightId;\nuniform vec4 highlightColor;\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0])) || any(greaterThan(dataCoordinate, fragClipBounds[1]))) {\n    discard;\n  } else if(distance(pickId, highlightId) < 0.001) {\n    gl_FragColor = highlightColor * opacity;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n  \n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"screenSize",type:"vec2"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"highlightId",type:"vec4"},{name:"highlightColor",type:"vec4"},{name:"fragClipBounds[0]",type:"vec3"},{name:"fragClipBounds[1]",type:"vec3"},{name:"opacity",type:"float"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}]),createProjectShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale;\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    vec4 clipCenter = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5 * scale * (axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec4 highlightId;\nuniform vec4 highlightColor;\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0])) || any(greaterThan(dataCoordinate, fragClipBounds[1]))) {\n    discard;\n  } else if(distance(pickId, highlightId) < 0.001) {\n    gl_FragColor = highlightColor * opacity;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n  \n}",[{name:"axes[0]",type:"vec3"},{name:"axes[1]",type:"vec3"},{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"screenSize",type:"vec2"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"scale",type:"float"},{name:"highlightId",type:"vec4"},{name:"highlightColor",type:"vec4"},{name:"fragClipBounds[0]",type:"vec3"},{name:"fragClipBounds[1]",type:"vec3"},{name:"opacity",type:"float"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}]),createPickPerspectiveShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + vec4(glyph.x, -glyph.y, 0, 0));\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 fragClipBounds[2];\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0])) || any(greaterThan(dataCoordinate, fragClipBounds[1]))) {\n    discard;\n  } else {\n    gl_FragColor = pickId.abgr;\n  }\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"fragClipBounds[0]",type:"vec3"},{name:"fragClipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}]),createPickOrthoShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n    gl_Position = clipPosition + vec4(screenSize * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 fragClipBounds[2];\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0])) || any(greaterThan(dataCoordinate, fragClipBounds[1]))) {\n    discard;\n  } else {\n    gl_FragColor = pickId.abgr;\n  }\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"screenSize",type:"vec2"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"fragClipBounds[0]",type:"vec3"},{name:"fragClipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}]),createPickProjectShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale;\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    vec4 clipCenter = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5 * scale * (axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 fragClipBounds[2];\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0])) || any(greaterThan(dataCoordinate, fragClipBounds[1]))) {\n    discard;\n  } else {\n    gl_FragColor = pickId.abgr;\n  }\n}",[{name:"axes[0]",type:"vec3"},{name:"axes[1]",type:"vec3"},{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"screenSize",type:"vec2"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"scale",type:"float"},{name:"fragClipBounds[0]",type:"vec3"},{name:"fragClipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}]);var IDENTITY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];module.exports=createPointCloud;function project(p,v,m,x){vec4.transformMat4(x,x,m);vec4.transformMat4(x,x,v);return vec4.transformMat4(x,x,p)}function clampVec(v){var result=new Array(3);for(var i=0;i<3;++i){result[i]=Math.min(Math.max(v[i],-1e8),1e8)}return result}function ScatterPlotPickResult(index,position){this.index=index;this.position=position}function PointCloud(gl,shader,orthoShader,projectShader,pointBuffer,colorBuffer,glyphBuffer,idBuffer,vao,pickPerspectiveShader,pickOrthoShader,pickProjectShader){this.gl=gl;this.shader=shader;this.orthoShader=orthoShader;this.projectShader=projectShader;this.pointBuffer=pointBuffer;this.colorBuffer=colorBuffer;this.glyphBuffer=glyphBuffer;this.idBuffer=idBuffer;this.vao=vao;this.vertexCount=0;this.lineVertexCount=0;this.lineWidth=0;this.projectScale=2/3;this.projectOpacity=1;this.pickId=0;this.pickPerspectiveShader=pickPerspectiveShader;this.pickOrthoShader=pickOrthoShader;this.pickProjectShader=pickProjectShader;this.points=[];this.useOrtho=false;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.axesProject=[false,false,false];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.highlightColor=[0,0,0,1];this.highlightId=[1,1,1,1];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]]}var proto=PointCloud.prototype;function drawProject(shader,points,camera){var axesProject=points.axesProject;if(!(axesProject[0]||axesProject[1]||axesProject[2])){return}var gl=points.gl;var uniforms=shader.uniforms;var model=camera.model||IDENTITY;var view=camera.view||IDENTITY;var projection=camera.projection||IDENTITY;var bounds=points.axesBounds;var clipBounds=points.clipBounds.map(clampVec);var cubeParams=getCubeParams(model,view,projection,bounds);var cubeAxis=cubeParams.axis;shader.bind();uniforms.view=view;uniforms.projection=projection;uniforms.screenSize=[2/gl.drawingBufferWidth,2/gl.drawingBufferHeight];uniforms.highlightId=points.highlightId;uniforms.highlightColor=points.highlightColor;uniforms.clipBounds=clipBounds;uniforms.scale=points.projectScale;uniforms.opacity=points.projectOpacity;for(var i=0;i<3;++i){if(!axesProject[i]){continue}var pmodel=IDENTITY.slice();pmodel[5*i]=0;if(cubeAxis[i]<0){pmodel[12+i]=bounds[0][i]}else{pmodel[12+i]=bounds[1][i]}mat4.multiply(pmodel,model,pmodel);uniforms.model=pmodel;var u=(i+1)%3;var v=(i+2)%3;var du=[0,0,0];var dv=[0,0,0];du[u]=1;dv[v]=1;var mdu=project(projection,view,model,[du[0],du[1],du[2],0]);var mdv=project(projection,view,model,[dv[0],dv[1],dv[2],0]);if(Math.abs(mdu[1])>Math.abs(mdv[1])){var tmp=mdu;mdu=mdv;mdv=tmp;tmp=du;du=dv;dv=tmp;var t=u;u=v;v=t}if(mdu[0]<0){du[u]=-1}if(mdv[1]>0){dv[v]=-1}var su=0;var sv=0;for(var j=0;j<4;++j){su+=Math.pow(model[4*u+j],2);sv+=Math.pow(model[4*v+j],2)}du[u]/=Math.sqrt(su);dv[v]/=Math.sqrt(sv);uniforms.axes=[du,dv];var fragClip=[clipBounds[0].slice(),clipBounds[1].slice()];fragClip[0][i]=-1e8;fragClip[1][i]=1e8;uniforms.fragClipBounds=fragClip;points.vao.draw(gl.TRIANGLES,points.vertexCount);if(points.lineWidth>0){gl.lineWidth(points.lineWidth);points.vao.draw(gl.LINES,points.lineVertexCount,points.vertexCount)}}}function drawFull(shader,pshader,points,camera){var gl=points.gl;gl.depthFunc(gl.LEQUAL);shader.bind();shader.uniforms={model:camera.model||IDENTITY,view:camera.view||IDENTITY,projection:camera.projection||IDENTITY,screenSize:[2/gl.drawingBufferWidth,2/gl.drawingBufferHeight],highlightId:points.highlightId,highlightColor:points.highlightColor,clipBounds:points.clipBounds.map(clampVec),fragClipBounds:[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]],opacity:1};points.vao.bind();points.vao.draw(gl.TRIANGLES,points.vertexCount);if(points.lineWidth>0){gl.lineWidth(points.lineWidth);points.vao.draw(gl.LINES,points.lineVertexCount,points.vertexCount)}drawProject(pshader,points,camera);points.vao.unbind()}proto.draw=function(camera){var shader=this.useOrtho?this.orthoShader:this.shader;drawFull(shader,this.projectShader,this,camera)};proto.drawPick=function(camera){var shader=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;drawFull(shader,this.pickProjectShader,this,camera)};proto.pick=function(selected){if(!selected){return null}if(selected.id!==this.pickId){return null}var x=selected.value[2]+(selected.value[1]<<8)+(selected.value[0]<<16);if(x>=this.pointCount||x<0){return null}return new ScatterPlotPickResult(x,this.points[x].slice())};proto.highlight=function(pointId,color){if(typeof pointId!=="number"){this.highlightId=[1,1,1,1];this.highlightColor=[0,0,0,1]}else{var a0=pointId&255;var a1=pointId>>8&255;var a2=pointId>>16&255;this.highlightId=[a0/255,a1/255,a2/255,this.pickId/255];if(color){if(color.length===3){this.highlightColor=[color[0],color[1],color[2],1]}else{this.highlightColor=color}}else{this.highlightColor=[0,0,0,1]}}};proto.update=function(options){var points=options.position;if(!points){throw new Error("gl-scatter-plot: Must specify points")}if("orthographic"in options){this.useOrtho=!!options.orthographic}if("pickId"in options){this.pickId=options.pickId>>>0}if("clipBounds"in options){this.clipBounds=options.clipBounds}if("lineWidth"in options){this.lineWidth=options.lineWidth}if("project"in options){if(Array.isArray(options.project)){this.axesProject=options.project}else{var v=!!options.project;this.axesProject=[v,v,v]}}if("axisBounds"in options){this.axesBounds=options.axisBounds}if("projectScale"in options){this.projectScale=options.projectScale}if("projectOpacity"in options){this.projectOpacity=options.projectOpacity}var font=options.font||"normal";var alignment=options.alignment||[0,0];var lowerBound=[Infinity,Infinity,Infinity];var upperBound=[-Infinity,-Infinity,-Infinity];var glyphs=options.glyph;var colors=options.color;var sizes=options.size;var angles=options.angle;var lineColors=options.lineColor;var pickCounter=this.pickId<<24;var triVertexCount=0;var lineVertexCount=0;var numPoints=points.length;count_loop:for(var i=0;i<numPoints;++i){var x=points[i];for(var j=0;j<3;++j){if(isNaN(x[j])||!isFinite(x[j])){continue count_loop}}var glyphData;if(Array.isArray(glyphs)){glyphData=getGlyph(glyphs[i],font)}else if(glyphs){glyphData=getGlyph(glyphs,font)}else{glyphData=getGlyph("●",font)}var glyphMesh=glyphData[0];var glyphLines=glyphData[1];var glyphBounds=glyphData[2];triVertexCount+=glyphMesh.cells.length*3;lineVertexCount+=glyphLines.edges.length*2}var vertexCount=triVertexCount+lineVertexCount;var positionArray=pool.mallocFloat(3*vertexCount);var colorArray=pool.mallocFloat(4*vertexCount);var glyphArray=pool.mallocFloat(2*vertexCount);var idArray=pool.mallocUint32(vertexCount);var textOffset=[0,alignment[1]];var triOffset=0;var lineOffset=triVertexCount;var color=[0,0,0,1];var lineColor=[0,0,0,1];var isColorArray=Array.isArray(colors)&&Array.isArray(colors[0]);var isLineColorArray=Array.isArray(lineColors)&&Array.isArray(lineColors[0]);fill_loop:for(var i=0;i<numPoints;++i){var x=points[i];for(var j=0;j<3;++j){if(isNaN(x[j])||!isFinite(x[j])){pickCounter+=1;continue fill_loop}upperBound[j]=Math.max(upperBound[j],x[j]);lowerBound[j]=Math.min(lowerBound[j],x[j])}var glyphData;if(Array.isArray(glyphs)){glyphData=getGlyph(glyphs[i],font)}else if(glyphs){glyphData=getGlyph(glyphs,font)}else{glyphData=getGlyph("●",font)}var glyphMesh=glyphData[0];var glyphLines=glyphData[1];var glyphBounds=glyphData[2];if(Array.isArray(colors)){var c;if(isColorArray){c=colors[i]}else{c=colors}if(c.length===3){for(var j=0;j<3;++j){color[j]=c[j]}color[3]=1}else if(c.length===4){for(var j=0;j<4;++j){color[j]=c[j]}}}else{color[0]=color[1]=color[2]=0;color[3]=1}if(Array.isArray(lineColors)){var c;if(isLineColorArray){c=lineColors[i]}else{c=lineColors}if(c.length===3){for(var j=0;j<3;++j){lineColor[j]=c[j]}lineColor[j]=1}else if(c.length===4){for(var j=0;j<4;++j){lineColor[j]=c[j]}}}else{lineColor[0]=lineColor[1]=lineColor[2]=0;lineColor[3]=1}var size=.5;if(Array.isArray(sizes)){size=+sizes[i]}else if(sizes){size=+sizes}else if(this.useOrtho){size=12}var angle=0;if(Array.isArray(angles)){angle=+angles[i]}else if(angles){angle=+angles}var cos=Math.cos(angle);var sin=Math.sin(angle);var x=points[i];for(var j=0;j<3;++j){upperBound[j]=Math.max(upperBound[j],x[j]);lowerBound[j]=Math.min(lowerBound[j],x[j])}if(alignment[0]<0){textOffset[0]=alignment[0]*(1+glyphBounds[1][0])}else if(alignment[0]>0){textOffset[0]=-alignment[0]*(1+glyphBounds[0][0])}var cells=glyphMesh.cells;var verts=glyphMesh.positions;for(var j=0;j<cells.length;++j){var cell=cells[j];for(var k=0;k<3;++k){for(var l=0;l<3;++l){positionArray[3*triOffset+l]=x[l]}for(var l=0;l<4;++l){colorArray[4*triOffset+l]=color[l]}idArray[triOffset]=pickCounter;var p=verts[cell[k]];glyphArray[2*triOffset]=size*(cos*p[0]-sin*p[1]+textOffset[0]);glyphArray[2*triOffset+1]=size*(sin*p[0]+cos*p[1]+textOffset[1]);triOffset+=1}}var cells=glyphLines.edges;var verts=glyphLines.positions;for(var j=0;j<cells.length;++j){var cell=cells[j];for(var k=0;k<2;++k){for(var l=0;l<3;++l){positionArray[3*lineOffset+l]=x[l]}for(var l=0;l<4;++l){colorArray[4*lineOffset+l]=lineColor[l]}idArray[lineOffset]=pickCounter;var p=verts[cell[k]];glyphArray[2*lineOffset]=size*(cos*p[0]-sin*p[1]+textOffset[0]);glyphArray[2*lineOffset+1]=size*(sin*p[0]+cos*p[1]+textOffset[1]);lineOffset+=1}}pickCounter+=1}this.vertexCount=triVertexCount;this.lineVertexCount=lineVertexCount;this.pointBuffer.update(positionArray);this.colorBuffer.update(colorArray);this.glyphBuffer.update(glyphArray);this.idBuffer.update(new Uint32Array(idArray));pool.free(positionArray);pool.free(colorArray);pool.free(glyphArray);pool.free(idArray);this.bounds=[lowerBound,upperBound];this.points=points;this.pointCount=points.length};proto.dispose=function(){this.shader.dispose();this.orthoShader.dispose();this.pickPerspectiveShader.dispose();this.pickOrthoShader.dispose();this.vao.dispose();this.pointBuffer.dispose();this.colorBuffer.dispose();this.glyphBuffer.dispose();this.idBuffer.dispose()};function createPointCloud(gl,options){options=options||{};var shader=createShader(gl);var orthoShader=createOrthoShader(gl);var projectShader=createProjectShader(gl);var pickPerspectiveShader=createPickPerspectiveShader(gl);var pickOrthoShader=createPickOrthoShader(gl);var pickProjectShader=createPickProjectShader(gl);var shaders=[shader,orthoShader,projectShader,pickPerspectiveShader,pickOrthoShader,pickProjectShader];for(var i=0;i<shaders.length;++i){var attr=shaders[i].attributes;attr.position.location=0;attr.color.location=1;attr.glyph.location=2;attr.id.location=3}var pointBuffer=createBuffer(gl);var colorBuffer=createBuffer(gl);var glyphBuffer=createBuffer(gl);var idBuffer=createBuffer(gl);var vao=createVAO(gl,[{buffer:pointBuffer,size:3,type:gl.FLOAT},{buffer:colorBuffer,size:4,type:gl.FLOAT},{buffer:glyphBuffer,size:2,type:gl.FLOAT},{buffer:idBuffer,size:4,type:gl.UNSIGNED_BYTE,normalized:true}]);var pointCloud=new PointCloud(gl,shader,orthoShader,projectShader,pointBuffer,colorBuffer,glyphBuffer,idBuffer,vao,pickPerspectiveShader,pickOrthoShader,pickProjectShader);pointCloud.update(options);return pointCloud}},{"./lib/glyphs":174,"gl-axes/lib/cube":31,"gl-buffer":121,"gl-mat4":184,"gl-matrix":173,"gl-vao":203,glslify:205,"glslify/adapter.js":204,"typedarray-pool":213}],273:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],274:[function(require,module,exports){module.exports=require("cwise-compiler")},{"cwise-compiler":275}],275:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":277,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],276:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:278}],277:[function(require,module,exports){module.exports=require(105)},{"./compile.js":276,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],278:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],279:[function(require,module,exports){"use strict";var webglew=require("webglew");var createTexture=require("gl-texture2d");module.exports=createFBO;var colorAttachmentArrays=null;var FRAMEBUFFER_UNSUPPORTED;var FRAMEBUFFER_INCOMPLETE_ATTACHMENT;var FRAMEBUFFER_INCOMPLETE_DIMENSIONS;var FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT;function saveFBOState(gl){var fbo=gl.getParameter(gl.FRAMEBUFFER_BINDING);var rbo=gl.getParameter(gl.RENDERBUFFER_BINDING);var tex=gl.getParameter(gl.TEXTURE_BINDING_2D);return[fbo,rbo,tex]}function restoreFBOState(gl,data){gl.bindFramebuffer(gl.FRAMEBUFFER,data[0]);gl.bindRenderbuffer(gl.RENDERBUFFER,data[1]);gl.bindTexture(gl.TEXTURE_2D,data[2])}function lazyInitColorAttachments(gl,ext){var maxColorAttachments=gl.getParameter(ext.MAX_COLOR_ATTACHMENTS_WEBGL);colorAttachmentArrays=new Array(maxColorAttachments+1);for(var i=0;i<=maxColorAttachments;++i){var x=new Array(maxColorAttachments);for(var j=0;j<i;++j){x[j]=gl.COLOR_ATTACHMENT0+j}for(var j=i;j<maxColorAttachments;++j){x[j]=gl.NONE}colorAttachmentArrays[i]=x}}function throwFBOError(status){switch(status){case FRAMEBUFFER_UNSUPPORTED:throw new Error("gl-fbo: Framebuffer unsupported");case FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw new Error("gl-fbo: Framebuffer incomplete attachment");case FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function initTexture(gl,width,height,type,format,attachment){if(!type){return null}var result=createTexture(gl,width,height,format,type);result.magFilter=gl.NEAREST;result.minFilter=gl.NEAREST;result.mipSamples=1;result.bind();gl.framebufferTexture2D(gl.FRAMEBUFFER,attachment,gl.TEXTURE_2D,result.handle,0);return result}function initRenderBuffer(gl,width,height,component,attachment){var result=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,result);gl.renderbufferStorage(gl.RENDERBUFFER,component,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,attachment,gl.RENDERBUFFER,result);return result}function rebuildFBO(fbo){var state=saveFBOState(fbo.gl);var gl=fbo.gl;var handle=fbo.handle=gl.createFramebuffer();var width=fbo._shape[0];var height=fbo._shape[1];var numColors=fbo.color.length;var ext=fbo._ext;var useStencil=fbo._useStencil;var useDepth=fbo._useDepth;var colorType=fbo._colorType;var extensions=webglew(gl);gl.bindFramebuffer(gl.FRAMEBUFFER,handle);for(var i=0;i<numColors;++i){fbo.color[i]=initTexture(gl,width,height,colorType,gl.RGBA,gl.COLOR_ATTACHMENT0+i)}if(numColors===0){fbo._color_rb=initRenderBuffer(gl,width,height,gl.RGBA4,gl.COLOR_ATTACHMENT0);if(ext){ext.drawBuffersWEBGL(colorAttachmentArrays[0])}}else if(numColors>1){ext.drawBuffersWEBGL(colorAttachmentArrays[numColor])}if(extensions.WEBGL_depth_texture){if(useStencil){fbo.depth=initTexture(gl,width,height,extensions.WEBGL_depth_texture.UNSIGNED_INT_24_8_WEBGL,gl.DEPTH_STENCIL,gl.DEPTH_STENCIL_ATTACHMENT)}else if(useDepth){fbo.depth=initTexture(gl,width,height,gl.UNSIGNED_SHORT,gl.DEPTH_COMPONENT,gl.DEPTH_ATTACHMENT)}}else{if(useDepth&&useStencil){fbo._depth_rb=initRenderBuffer(gl,width,height,gl.DEPTH_STENCIL,gl.DEPTH_STENCIL_ATTACHMENT)}else if(useDepth){fbo._depth_rb=initRenderBuffer(gl,width,height,gl.DEPTH_COMPONENT16,gl.DEPTH_ATTACHMENT)}else if(useStencil){fbo._depth_rb=initRenderBuffer(gl,width,height,gl.STENCIL_INDEX,gl.STENCIL_ATTACHMENT)}}var status=gl.checkFramebufferStatus(gl.FRAMEBUFFER);if(status!==gl.FRAMEBUFFER_COMPLETE){fbo._destroyed=true;gl.bindFramebuffer(gl.FRAMEBUFFER,null);gl.deleteFramebuffer(fbo.handle);fbo.handle=null;if(fbo.depth){fbo.depth.dispose();fbo.depth=null}if(fbo._depth_rb){gl.deleteRenderbuffer(fbo._depth_rb);fbo._depth_rb=null}for(var i=0;i<fbo.color.length;++i){fbo.color[i].dispose();fbo.color[i]=null}if(fbo._color_rb){gl.deleteRenderbuffer(fbo._color_rb);fbo._color_rb=null}restoreFBOState(gl,state);throwFBOError(status)}restoreFBOState(gl,state)}function Framebuffer(gl,width,height,colorType,numColors,useDepth,useStencil,ext){var extensions=webglew(gl);this.gl=gl;this._shape=[width|0,height|0];this._destroyed=false;this._ext=ext;this.color=new Array(numColors);for(var i=0;i<numColors;++i){this.color[i]=null}this._color_rb=null;this.depth=null;this._depth_rb=null;this._colorType=colorType;this._useDepth=useDepth;this._useStencil=useStencil;var parent=this;var shapeVector=[width|0,height|0];Object.defineProperties(shapeVector,{0:{get:function(){return parent._shape[0]},set:function(w){return parent.width=w}},1:{get:function(){return parent._shape[1]},set:function(h){return parent.height=h}}});this._shapeVector=shapeVector;rebuildFBO(this)}var proto=Framebuffer.prototype;function reshapeFBO(fbo,w,h){if(fbo._destroyed){throw new Error("gl-fbo: Can't resize destroyed FBO")}if(fbo._shape[0]===w&&fbo._shape[1]===h){return}var gl=fbo.gl;var maxFBOSize=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE);if(w<0||w>maxFBOSize||h<0||h>maxFBOSize){throw new Error("gl-fbo: Can't resize FBO, invalid dimensions")}fbo._shape[0]=w;fbo._shape[1]=h;var state=saveFBOState(gl);for(var i=0;i<fbo.color.length;++i){fbo.color[i].shape=fbo._shape}if(fbo._color_rb){gl.bindRenderbuffer(gl.RENDERBUFFER,fbo._color_rb);gl.renderbufferStorage(gl.RENDERBUFFER,gl.RGBA4,fbo._shape[0],fbo._shape[1])}if(fbo.depth){fbo.depth.shape=fbo._shape}if(fbo._depth_rb){gl.bindRenderbuffer(gl.RENDERBUFFER,fbo._depth_rb);if(fbo._useDepth&&fbo._useStencil){gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,fbo._shape[0],fbo._shape[1])}else if(fbo._useDepth){gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,fbo._shape[0],fbo._shape[1])}else if(fbo._useStencil){gl.renderbufferStorage(gl.RENDERBUFFER,gl.STENCIL_INDEX,fbo._shape[0],fbo._shape[1])}}gl.bindFramebuffer(gl.FRAMEBUFFER,fbo.handle);var status=gl.checkFramebufferStatus(gl.FRAMEBUFFER);if(status!==gl.FRAMEBUFFER_COMPLETE){fbo.dispose();restoreFBOState(gl,state);throwFBOError(status)}restoreFBOState(gl,state)}Object.defineProperties(proto,{shape:{get:function(){if(this._destroyed){return[0,0]}return this._shapeVector},set:function(x){if(!Array.isArray(x)){x=[x|0,x|0]}if(x.length!==2){throw new Error("gl-fbo: Shape vector must be length 2")}var w=x[0]|0;var h=x[1]|0;reshapeFBO(this,w,h);return[w,h]},enumerable:false},width:{get:function(){if(this._destroyed){return 0}return this._shape[0]},set:function(w){w=w|0;reshapeFBO(this,w,this._shape[1]);return w},enumerable:false},height:{get:function(){if(this._destroyed){return 0}return this._shape[1]},set:function(h){h=h|0;reshapeFBO(this,this._shape[0],h);return h},enumerable:false}});proto.bind=function(){if(this._destroyed){return}var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,this.handle);gl.viewport(0,0,this._shape[0],this._shape[1])};proto.dispose=function(){if(this._destroyed){return}this._destroyed=true;var gl=this.gl;gl.deleteFramebuffer(this.handle);this.handle=null;if(this.depth){this.depth.dispose();this.depth=null}if(this._depth_rb){gl.deleteRenderbuffer(this._depth_rb);this._depth_rb=null}for(var i=0;i<this.color.length;++i){this.color[i].dispose();this.color[i]=null}if(this._color_rb){gl.deleteRenderbuffer(this._color_rb);this._color_rb=null}};function createFBO(gl,width,height,options){if(!FRAMEBUFFER_UNSUPPORTED){FRAMEBUFFER_UNSUPPORTED=gl.FRAMEBUFFER_UNSUPPORTED;FRAMEBUFFER_INCOMPLETE_ATTACHMENT=gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;FRAMEBUFFER_INCOMPLETE_DIMENSIONS=gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS;FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT}var extensions=webglew(gl);if(!colorAttachmentArrays&&extensions.WEBGL_draw_buffers){lazyInitColorAttachments(gl,extensions.WEBGL_draw_buffers)}if(Array.isArray(width)){options=height;height=width[1]|0;width=width[0]|0}if(typeof width!=="number"){throw new Error("gl-fbo: Missing shape parameter")}var maxFBOSize=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE);if(width<0||width>maxFBOSize||height<0||height>maxFBOSize){throw new Error("gl-fbo: Parameters are too large for FBO")}options=options||{};var numColors=1;if("color"in options){numColors=Math.max(options.color|0,0);if(numColors<0){throw new Error("gl-fbo: Must specify a nonnegative number of colors")}if(numColors>1){var mrtext=extensions.WEBGL_draw_buffers;if(!mrtext){throw new Error("gl-fbo: Multiple draw buffer extension not supported")}else if(numColors>gl.getParameter(mrtext.MAX_COLOR_ATTACHMENTS_WEBGL)){throw new Error("gl-fbo: Context does not support "+numColors+" draw buffers")}}}var colorType=gl.UNSIGNED_BYTE;if(options.float&&numColors>0){if(!extensions.OES_texture_float){throw new Error("gl-fbo: Context does not support floating point textures")}colorType=gl.FLOAT}else if(options.preferFloat&&numColors>0){if(extensions.OES_texture_float){colorType=gl.FLOAT}}var useDepth=true;if("depth"in options){useDepth=!!options.depth}var useStencil=false;if("stencil"in options){useStencil=!!options.stencil}return new Framebuffer(gl,width,height,colorType,numColors,useDepth,useStencil,extensions.WEBGL_draw_buffers)}},{"gl-texture2d":285,webglew:287}],280:[function(require,module,exports){module.exports=require(122)},{"/var/www/streambed/gl3d/node_modules/gl-buffer/node_modules/ndarray-ops/ndarray-ops.js":122,"cwise-compiler":281}],281:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":283,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],282:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:284}],283:[function(require,module,exports){module.exports=require(105)},{"./compile.js":282,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],284:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],285:[function(require,module,exports){module.exports=require(158)},{"/var/www/streambed/gl3d/node_modules/gl-line-plot/node_modules/gl-texture2d/texture.js":158,ndarray:412,"ndarray-ops":280,"typedarray-pool":289,webglew:287}],286:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],287:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:286}],288:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],289:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":273,buffer:8,dup:288}],290:[function(require,module,exports){"use strict";module.exports=createSelectBuffer;var createFBO=require("gl-fbo");var pool=require("typedarray-pool");var ndarray=require("ndarray");var nextPow2=require("bit-twiddle").nextPow2;var selectRange=require("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(255>_inline_1_arg0_||255>_inline_1_arg1_||255>_inline_1_arg2_||255>_inline_1_arg3_){var _inline_1_l=_inline_1_arg4_-_inline_1_arg6_[0],_inline_1_a=_inline_1_arg5_-_inline_1_arg6_[1],_inline_1_f=_inline_1_l*_inline_1_l+_inline_1_a*_inline_1_a;_inline_1_f<this_closestD2&&(this_closestD2=_inline_1_f,this_closestX=_inline_1_arg6_[0],this_closestY=_inline_1_arg6_[1])}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg4_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg5_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg6_",lvalue:false,rvalue:true,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_1_a","_inline_1_f","_inline_1_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:false,funcName:"cwise",blockSize:64});function SelectResult(x,y,id,value,distance){this.coord=[x,y];this.id=id;this.value=value;this.distance=distance}function SelectBuffer(gl,fbo,buffer){this.gl=gl;this.fbo=fbo;this.buffer=buffer;this._readTimeout=null;var self=this;this._readCallback=function(){fbo.bind();gl.readPixels(0,0,fbo.shape[0],fbo.shape[1],gl.RGBA,gl.UNSIGNED_BYTE,self.buffer);self._readTimeout=null}}var proto=SelectBuffer.prototype;Object.defineProperty(proto,"shape",{get:function(){return this.fbo.shape.slice()},set:function(v){this.fbo.shape=v;var c=this.fbo.shape[0];var r=this.fbo.shape[1];if(r*c*4>this.buffer.length){pool.free(this.buffer);var buffer=this.buffer=pool.mallocUint8(nextPow2(r*c*4));for(var i=0;i<r*c*4;++i){buffer[i]=255}}return v}});proto.begin=function(){var gl=this.gl;var shape=this.shape;this.fbo.bind();gl.clearColor(1,1,1,1);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT)};proto.end=function(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,null);if(!this._readTimeout){clearTimeout(this._readTimeout)}this._readTimeout=setTimeout(this._readCallback,1)};proto.query=function(x,y,radius){var shape=this.fbo.shape.slice();x=x|0;y=y|0;if(typeof radius!=="number"){radius=1}var x0=Math.min(Math.max(x-radius,0),shape[0])|0;var x1=Math.min(Math.max(x+radius,0),shape[0])|0;var y0=Math.min(Math.max(y-radius,0),shape[1])|0;var y1=Math.min(Math.max(y+radius,0),shape[1])|0;if(x1<=x0||y1<=y0){return null}var dims=[x1-x0,y1-y0];var region=ndarray(this.buffer,[dims[0],dims[1],4],[4,shape[0]*4,1],4*(x0+shape[0]*y0));var closest=selectRange(region.hi(dims[0],dims[1],1),x,y);var dx=closest[0];var dy=closest[1];if(dx<0||Math.pow(this.radius,2)<closest[2]){return null}var c0=region.get(dx,dy,0);var c1=region.get(dx,dy,1);var c2=region.get(dx,dy,2);var c3=region.get(dx,dy,3);return new SelectResult(dx+x0|0,dy+y0|0,c0,[c1,c2,c3],Math.sqrt(closest[2]))};proto.dispose=function(){this.fbo.dispose();pool.free(this.buffer)};function createSelectBuffer(gl,shape){var fbo=createFBO(gl,shape);var buffer=pool.mallocUint8(shape[0]*shape[1]*4);return new SelectBuffer(gl,fbo,buffer)}},{"bit-twiddle":273,"cwise/lib/wrapper":274,"gl-fbo":279,ndarray:412,"typedarray-pool":289}],291:[function(require,module,exports){"use strict";var barycentric=require("barycentric");var closestPointToTriangle=require("polytope-closest-point/lib/closest_point_2d.js");module.exports=closestPointToPickLocation;function xformMatrix(m,v){var out=[0,0,0,0];for(var i=0;i<4;++i){for(var j=0;j<4;++j){out[j]+=m[4*i+j]*v[i]}}return out}function projectVertex(v,model,view,projection,resolution){var p=xformMatrix(projection,xformMatrix(view,xformMatrix(model,[v[0],v[1],v[2],1])));for(var i=0;i<3;++i){p[i]/=p[3]}return[.5*resolution[0]*(1+p[0]),.5*resolution[1]*(1-p[1])]}function barycentricCoord(simplex,point){if(simplex.length===2){var d0=0;var d1=0;for(var i=0;i<2;++i){d0+=Math.pow(point[i]-simplex[0][i],2);d1+=Math.pow(point[i]-simplex[1][i],2)}d0=Math.sqrt(d0);d1=Math.sqrt(d1);if(d0+d1<1e-6){return[1,0]}return[d1/(d0+d1),d0/(d1+d0)]}else if(simplex.length===3){var closestPoint=[0,0];closestPointToTriangle(simplex[0],simplex[1],simplex[2],point,closestPoint);return barycentric(simplex,closestPoint)}return[]}function interpolate(simplex,weights){var result=[0,0,0];for(var i=0;i<simplex.length;++i){var p=simplex[i];var w=weights[i];for(var j=0;j<3;++j){result[j]+=w*p[j]}}return result}function closestPointToPickLocation(simplex,pixelCoord,model,view,projection,resolution){if(simplex.length===1){return[0,simplex[0].slice()]}var simplex2D=new Array(simplex.length);for(var i=0;i<simplex.length;++i){simplex2D[i]=projectVertex(simplex[i],model,view,projection,resolution)}var closestIndex=0;var closestDist=Infinity;for(var i=0;i<simplex2D.length;++i){var d2=0;for(var j=0;j<2;++j){d2+=Math.pow(simplex2D[i][j]-pixelCoord[j],2)}if(d2<closestDist){closestDist=d2;closestIndex=i}}var weights=barycentricCoord(simplex2D,pixelCoord);var s=0;for(var i=0;i<3;++i){if(weights[i]<-.001||weights[i]>1.0001){return null}s+=weights[i]}if(Math.abs(s-1)>.001){return null}return[closestIndex,interpolate(simplex,weights)]}},{barycentric:293,"polytope-closest-point/lib/closest_point_2d.js":338}],292:[function(require,module,exports){"use strict";var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var glslify=require("glslify");var normals=require("normals");var mat4=require("gl-mat4");var closestPoint=require("./lib/closest-point");var createMeshShaderGLSLify=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nattribute vec3 normal;\nuniform mat4 model, modelInverseTranspose, view, projection;\nuniform vec3 eyePosition;\nvarying vec4 f_color;\nvarying vec3 f_position, f_normal, viewDirection, f_data;\nvoid main() {\n  vec4 m_position = model * vec4(position, 1.0);\n  vec4 t_position = view * m_position;\n  gl_Position = projection * t_position;\n  f_color = color;\n  f_normal = normalize((modelInverseTranspose * vec4(normal, 0.0)).xyz);\n  f_position = m_position.xyz / m_position.w;\n  f_data = position;\n  viewDirection = eyePosition - f_position;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 lightPosition, ambient, diffuse, specular;\nuniform vec3 clipBounds[2];\nuniform float specularExponent;\nvarying vec4 f_color;\nvarying vec3 f_position, f_normal, viewDirection, f_data;\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n  vec3 lightDirection = normalize(lightPosition - f_position);\n  vec3 normal = normalize(f_normal);\n  float diffuseIntensity = clamp(dot(normal, lightDirection), 0.0, 1.0);\n  vec3 halfView = normalize(lightDirection + normalize(viewDirection));\n  float specularIntensity = pow(clamp(dot(normal, halfView), 0.0, 1.0), specularExponent);\n  gl_FragColor = vec4(f_color.xyz * (ambient + diffuse * diffuseIntensity) + specular * specularIntensity, f_color.a);\n}",[{name:"model",type:"mat4"},{name:"modelInverseTranspose",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"eyePosition",type:"vec3"},{name:"lightPosition",type:"vec3"},{name:"ambient",type:"vec3"},{name:"diffuse",type:"vec3"},{name:"specular",type:"vec3"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"specularExponent",type:"float"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"normal",type:"vec3"}]);var createWireShaderGLSLify=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nvarying vec4 f_color;\nvarying vec3 f_data;\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data = position;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 clipBounds[2];\nvarying vec4 f_color;\nvarying vec3 f_data;\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = f_color;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"color",type:"vec4"}]);var createPointShaderGLSLify=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute float pointSize;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\nvarying vec4 f_color;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n    f_color = color;\n  }\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nvarying vec4 f_color;\nvoid main() {\n  gl_FragColor = f_color;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"}],[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"color",type:"vec4"}]);var createPickShaderGLSLify=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute vec4 id;\nuniform mat4 model, view, projection;\nvarying vec3 f_position;\nvarying vec4 f_id;\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id = id;\n  f_position = position;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 clipBounds[2];\nuniform float pickId;\nvarying vec3 f_position;\nvarying vec4 f_id;\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"pickId",type:"float"}],[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]);var createPointPickShaderGLSLify=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position;\nattribute float pointSize;\nattribute vec4 id;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\nvarying vec3 f_position;\nvarying vec4 f_id;\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0, 0, 0, 0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id = id;\n  f_position = position;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec3 clipBounds[2];\nuniform float pickId;\nvarying vec3 f_position;\nvarying vec4 f_id;\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"pickId",type:"float"}],[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]);var identityMatrix=mat4.identity(mat4.create());function SimplicialMesh(gl,triShader,lineShader,pointShader,pickShader,pointPickShader,trianglePositions,triangleColors,triangleNormals,triangleIds,triangleVAO,edgePositions,edgeColors,edgeIds,edgeVAO,pointPositions,pointColors,pointSizes,pointIds,pointVAO){this.gl=gl;this.cells=[];this.positions=[];this.triShader=triShader;this.lineShader=lineShader;this.pointShader=pointShader;this.pickShader=pickShader;this.pointPickShader=pointPickShader;this.trianglePositions=trianglePositions;this.triangleColors=triangleColors;this.triangleNormals=triangleNormals;this.triangleIds=triangleIds;this.triangleVAO=triangleVAO;this.triangleCount=0;this.lineWidth=1;this.edgePositions=edgePositions;this.edgeColors=edgeColors;this.edgeIds=edgeIds;this.edgeVAO=edgeVAO;this.edgeCount=0;this.pointPositions=pointPositions;this.pointColors=pointColors;this.pointSizes=pointSizes;this.pointIds=pointIds;this.pointVAO=pointVAO;this.pointCount=0;this.pickId=0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this._model=identityMatrix;this._view=identityMatrix;this._projection=identityMatrix;this._resolution=[1,1]}var proto=SimplicialMesh.prototype;proto.update=function(params){params=params||{};var gl=this.gl;var cells=params.cells;var positions=params.positions;var tPos=[];var tCol=[];var tNor=[];var tIds=[];var ePos=[];var eCol=[];var eIds=[];var pPos=[];var pCol=[];var pSiz=[];var pIds=[];if("clipBounds"in params){this.clipBounds=params.clipBounds}if("pickId"in params){this.pickId=params.pickId}if("lineWidth"in params){this.lineWidth=params.lineWidth}this.cells=cells;this.positions=positions;var vertexNormals=params.vertexNormals;var cellNormals=params.cellNormals;if(params.useCellNormals&&!cellNormals){cellNormals=normals.facetNormals(cells,positions)}if(!cellNormals&&!vertexNormals){vertexNormals=normals.vertexNormals(cells,positions)}var vertexColors=params.vertexColors;var cellColors=params.cellColors;var meshColor=params.meshColor||[.7,.5,.2];var pointSizes=params.pointSizes;var meshPointSize=params.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var i=0;i<positions.length;++i){var p=positions[i];for(var j=0;j<3;++j){if(isNaN(p)||!isFinite(p)){continue}this.bounds[0][j]=Math.min(this.bounds[0][j],p[j]);this.bounds[1][j]=Math.max(this.bounds[1][j],p[j])}}var triangleCount=0;var edgeCount=0;var pointCount=0;fill_loop:for(var i=0;i<cells.length;++i){var cell=cells[i];switch(cell.length){case 1:var v=cell[0];var p=positions[v];for(var j=0;j<3;++j){if(isNaN(p[j])||!isFinite(p[j])){continue fill_loop}}pPos.push(p[0],p[1],p[2]);var c;if(vertexColors){c=vertexColors[v]}else if(cellColors){c=cellColors[i]}else{c=meshColor}if(c.length===3){pCol.push(c[0],c[1],c[2],1)}else{pCol.push(c[0],c[1],c[2],c[3])}if(pointSizes){pSiz.push(pointSizes[v])}else{pSiz.push(meshPointSize)}pIds.push(i);pointCount+=1;break;case 2:for(var j=0;j<2;++j){var v=cell[j];var p=positions[v];for(var k=0;k<3;++k){if(isNaN(p[k])||!isFinite(p[k])){continue fill_loop}}}for(var j=0;j<2;++j){var v=cell[j];var p=positions[v];ePos.push(p[0],p[1],p[2]);var c;if(vertexColors){c=vertexColors[v]}else if(cellColors){c=cellColors[i]}else{c=meshColor}if(c.length===3){eCol.push(c[0],c[1],c[2],1)}else{eCol.push(c[0],c[1],c[2],c[3])}eIds.push(i)}edgeCount+=1;break;case 3:for(var j=0;j<3;++j){var v=cell[j];var p=positions[v];for(var k=0;k<3;++k){if(isNaN(p[k])||!isFinite(p[k])){continue fill_loop}}}for(var j=0;j<3;++j){var v=cell[j];var p=positions[v];tPos.push(p[0],p[1],p[2]);var c;if(vertexColors){c=vertexColors[v]}else if(cellColors){c=cellColors[i]}else{c=meshColor}if(c.length===3){tCol.push(c[0],c[1],c[2],1)}else{tCol.push(c[0],c[1],c[2],c[3])}var q;if(vertexNormals){q=vertexNormals[v]}else{q=cellNormals[i]}tNor.push(q[0],q[1],q[2]);tIds.push(i)}triangleCount+=1;break;default:break}}this.pointCount=pointCount;this.edgeCount=edgeCount;this.triangleCount=triangleCount;this.pointPositions.update(pPos);this.pointColors.update(pCol);this.pointSizes.update(pSiz);this.pointIds.update(new Uint32Array(pIds));this.edgePositions.update(ePos);this.edgeColors.update(eCol);this.edgeIds.update(new Uint32Array(eIds));this.trianglePositions.update(tPos);this.triangleColors.update(tCol);this.triangleNormals.update(tNor);this.triangleIds.update(new Uint32Array(tIds))};proto.draw=function(params){params=params||{};var gl=this.gl;var model=params.model||identityMatrix;var view=params.view||identityMatrix;var projection=params.projection||identityMatrix;var clipBounds=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var i=0;i<3;++i){clipBounds[0][i]=Math.max(clipBounds[0][i],this.clipBounds[0][i]);clipBounds[1][i]=Math.min(clipBounds[1][i],this.clipBounds[1][i])}if(this.triangleCount>0){var shader=this.triShader;shader.bind();shader.uniforms.model=model;shader.uniforms.view=view;shader.uniforms.projection=projection;var eyePosition=mat4.invert(mat4.create(),view);shader.uniforms.lightPosition=params.lightPosition||[0,100,0];shader.uniforms.ambient=params.ambient||[.3,.3,.3];shader.uniforms.diffuse=params.diffuse||[.5,.5,.5];shader.uniforms.specular=params.specular||[1,1,1];shader.uniforms.specularExponent=params.specularExponent||10;shader.uniforms.eyePosition=[eyePosition[12],eyePosition[13],eyePosition[14]];shader.uniforms.clipBounds=clipBounds;var m=mat4.create();shader.uniforms.modelInverseTranspose=mat4.transpose(m,mat4.invert(m,model));this.triangleVAO.bind();gl.drawArrays(gl.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){var shader=this.lineShader;shader.bind();shader.uniforms.model=model;shader.uniforms.view=view;shader.uniforms.projection=projection;shader.uniforms.clipBounds=clipBounds;this.edgeVAO.bind();gl.lineWidth(this.lineWidth);gl.drawArrays(gl.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var shader=this.pointShader;shader.bind();shader.uniforms.model=model;shader.uniforms.view=view;shader.uniforms.projection=projection;shader.uniforms.clipBounds=clipBounds;this.pointVAO.bind();gl.drawArrays(gl.POINTS,0,this.pointCount);this.pointVAO.unbind()}};proto.drawPick=function(params){params=params||{};var gl=this.gl;var model=params.model||identityMatrix;var view=params.view||identityMatrix;var projection=params.projection||identityMatrix;var clipBounds=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var i=0;i<3;++i){clipBounds[0][i]=Math.max(clipBounds[0][i],this.clipBounds[0][i]);clipBounds[1][i]=Math.min(clipBounds[1][i],this.clipBounds[1][i])}this._model=[].slice.call(model);this._view=[].slice.call(view);this._projection=[].slice.call(projection);this._resolution=[gl.drawingBufferWidth,gl.drawingBufferHeight];var shader=this.pickShader;shader.bind();var uniforms=shader.uniforms;uniforms.model=model;uniforms.view=view;uniforms.projection=projection;uniforms.pickId=this.pickId/255;uniforms.clipBounds=clipBounds;if(this.triangleCount>0){this.triangleVAO.bind();gl.drawArrays(gl.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();gl.lineWidth(this.lineWidth);gl.drawArrays(gl.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var shader=this.pointPickShader;shader.bind();var uniforms=shader.uniforms;uniforms.model=model;uniforms.view=view;uniforms.projection=projection;uniforms.pickId=this.pickId/255;uniforms.clipBounds=clipBounds;this.pointVAO.bind();gl.drawArrays(gl.POINTS,0,this.pointCount);this.pointVAO.unbind()}};proto.pick=function(pickData){if(!pickData){return null}if(pickData.id!==this.pickId){return null}var cellId=pickData.value[0]+256*pickData.value[1]+65536*pickData.value[2];var cell=this.cells[cellId];var positions=this.positions;var simplex=new Array(cell.length);for(var i=0;i<cell.length;++i){simplex[i]=positions[cell[i]]}var data=closestPoint(simplex,pickData.coord,this._model,this._view,this._projection,this._resolution);if(!data){return null}return{position:data[1],index:cell[data[0]],cell:cell,cellId:cellId}};proto.dispose=function(){this.triShader.dispose();this.lineShader.dispose();this.pointShader.dispose();this.pickShader.dispose();this.pointPickShader.dispose();this.triangleVAO.dispose();this.edgeVAO.dispose();this.pointVAO.dispose();this.trianglePositions.dispose();this.triangleColors.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeIds.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointSizes.dispose();this.pointIds.dispose()};function createMeshShader(gl){var shader=createMeshShaderGLSLify(gl);shader.attributes.position.location=0;shader.attributes.color.location=1;shader.attributes.normal.location=3;return shader}function createWireShader(gl){var shader=createWireShaderGLSLify(gl);shader.attributes.position.location=0;shader.attributes.color.location=1;return shader}function createPointShader(gl){var shader=createPointShaderGLSLify(gl);shader.attributes.position.location=0;shader.attributes.color.location=1;shader.attributes.pointSize.location=3;return shader}function createPickShader(gl){var shader=createPickShaderGLSLify(gl);shader.attributes.position.location=0;shader.attributes.id.location=2;return shader}function createPointPickShader(gl){var shader=createPointPickShaderGLSLify(gl);shader.attributes.position.location=0;shader.attributes.id.location=2;shader.attributes.pointSize.location=3;return shader}function createSimplicialMesh(gl,params){var triShader=createMeshShader(gl);var lineShader=createWireShader(gl);var pointShader=createPointShader(gl);var pickShader=createPickShader(gl);var pointPickShader=createPointPickShader(gl);var trianglePositions=createBuffer(gl);var triangleColors=createBuffer(gl);var triangleNormals=createBuffer(gl);var triangleIds=createBuffer(gl);var triangleVAO=createVAO(gl,[{buffer:trianglePositions,type:gl.FLOAT,size:3},{buffer:triangleColors,type:gl.FLOAT,size:4},{buffer:triangleIds,type:gl.UNSIGNED_BYTE,size:4,normalized:true},{buffer:triangleNormals,type:gl.FLOAT,size:3}]);var edgePositions=createBuffer(gl);var edgeColors=createBuffer(gl);var edgeIds=createBuffer(gl);var edgeVAO=createVAO(gl,[{buffer:edgePositions,type:gl.FLOAT,size:3},{buffer:edgeColors,type:gl.FLOAT,size:4},{buffer:edgeIds,type:gl.UNSIGNED_BYTE,size:4,normalized:true}]);var pointPositions=createBuffer(gl);var pointColors=createBuffer(gl);var pointSizes=createBuffer(gl);var pointIds=createBuffer(gl);var pointVAO=createVAO(gl,[{buffer:pointPositions,type:gl.FLOAT,size:3},{buffer:pointColors,type:gl.FLOAT,size:4},{buffer:pointIds,type:gl.UNSIGNED_BYTE,size:4,normalized:true},{buffer:pointSizes,type:gl.FLOAT,size:1}]);var mesh=new SimplicialMesh(gl,triShader,lineShader,pointShader,pickShader,pointPickShader,trianglePositions,triangleColors,triangleNormals,triangleIds,triangleVAO,edgePositions,edgeColors,edgeIds,edgeVAO,pointPositions,pointColors,pointSizes,pointIds,pointVAO);mesh.update(params);return mesh}module.exports=createSimplicialMesh},{"./lib/closest-point":291,"gl-buffer":121,"gl-mat4":310,"gl-vao":329,glslify:331,"glslify/adapter.js":330,normals:337}],293:[function(require,module,exports){"use strict";module.exports=barycentric;var solve=require("robust-linear-solve");function reduce(x){var r=0;for(var i=0;i<x.length;++i){r+=x[i]}return r}function barycentric(simplex,point){var d=point.length;var A=new Array(d+1);for(var i=0;i<d;++i){var row=new Array(d+1);for(var j=0;j<=d;++j){row[j]=simplex[j][i]}A[i]=row}A[d]=new Array(d+1);for(var i=0;i<=d;++i){A[d][i]=1}var b=new Array(d+1);for(var i=0;i<d;++i){b[i]=point[i]}b[d]=1;var x=solve(A,b);var w=reduce(x[d+1]);if(w===0){w=1}var y=new Array(d+1);for(var i=0;i<=d;++i){y[i]=reduce(x[i])/w}return y}},{"robust-linear-solve":294}],294:[function(require,module,exports){"use strict";var determinant=require("robust-determinant");var NUM_EXPAND=6;function generateSolver(n){var funcName="robustLinearSolve"+n+"d";var code=["function ",funcName,"(A,b){return ["];for(var i=0;i<n;++i){code.push("det([");for(var j=0;j<n;++j){if(j>0){code.push(",")}code.push("[");for(var k=0;k<n;++k){if(k>0){code.push(",")}if(k===i){code.push("+b[",j,"]")}else{code.push("+A[",j,"][",k,"]")}}code.push("]")}code.push("]),")}code.push("det(A)]}return ",funcName);var proc=new Function("det",code.join(""));if(n<6){return proc(determinant[n])}return proc(determinant)}function robustLinearSolve0d(){return[0]}function robustLinearSolve1d(A,b){return[[b[0]],[A[0][0]]]}var CACHE=[robustLinearSolve0d,robustLinearSolve1d];function generateDispatch(){while(CACHE.length<NUM_EXPAND){CACHE.push(generateSolver(CACHE.length))}var procArgs=[];var code=["function dispatchLinearSolve(A,b){switch(A.length){"];for(var i=0;i<NUM_EXPAND;++i){procArgs.push("s"+i);code.push("case ",i,":return s",i,"(A,b);")}code.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve");procArgs.push("CACHE","g",code.join(""));var proc=Function.apply(undefined,procArgs);module.exports=proc.apply(undefined,CACHE.concat([CACHE,generateSolver]));for(var i=0;i<NUM_EXPAND;++i){module.exports[i]=CACHE[i]}}generateDispatch()},{"robust-determinant":300}],295:[function(require,module,exports){"use strict";module.exports=compressExpansion;function compressExpansion(e){var m=e.length;var Q=e[e.length-1];var bottom=m;for(var i=m-2;i>=0;--i){var a=Q;var b=e[i];Q=a+b;var bv=Q-a;var q=b-bv;if(q){e[--bottom]=Q;Q=q}}var top=0;for(var i=bottom;i<m;++i){var a=e[i];var b=Q;Q=a+b;var bv=Q-a;var q=b-bv;if(q){e[top++]=q}}e[top++]=Q;e.length=top;return e}},{}],296:[function(require,module,exports){module.exports=require(18)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/node_modules/two-sum/two-sum.js":18}],297:[function(require,module,exports){module.exports=require(19)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-scale/robust-scale.js":19,"two-product":299,"two-sum":296}],298:[function(require,module,exports){module.exports=require(21)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/robust-sum/robust-sum.js":21}],299:[function(require,module,exports){module.exports=require(22)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/robust-orientation/node_modules/two-product/two-product.js":22}],300:[function(require,module,exports){"use strict";var twoProduct=require("two-product");var robustSum=require("robust-sum");var robustScale=require("robust-scale");var compress=require("robust-compress");var NUM_EXPANDED=6;function cofactor(m,c){var result=new Array(m.length-1);for(var i=1;i<m.length;++i){var r=result[i-1]=new Array(m.length-1);for(var j=0,k=0;j<m.length;++j){if(j===c){continue}r[k++]=m[i][j]}}return result}function matrix(n){var result=new Array(n);for(var i=0;i<n;++i){result[i]=new Array(n);for(var j=0;j<n;++j){result[i][j]=["m[",i,"][",j,"]"].join("")}}return result}function sign(n){if(n&1){return"-"}return""}function generateSum(expr){if(expr.length===1){return expr[0]}else if(expr.length===2){return["sum(",expr[0],",",expr[1],")"].join("")}else{var m=expr.length>>1;return["sum(",generateSum(expr.slice(0,m)),",",generateSum(expr.slice(m)),")"].join("")}}function determinant(m){if(m.length===2){return["sum(prod(",m[0][0],",",m[1][1],"),prod(-",m[0][1],",",m[1][0],"))"].join("")}else{var expr=[];for(var i=0;i<m.length;++i){expr.push(["scale(",determinant(cofactor(m,i)),",",sign(i),m[0][i],")"].join(""))}return generateSum(expr)}}function compileDeterminant(n){var proc=new Function("sum","scale","prod","compress",["function robustDeterminant",n,"(m){return compress(",determinant(matrix(n)),")};return robustDeterminant",n].join(""));return proc(robustSum,robustScale,twoProduct,compress)}var CACHE=[function robustDeterminant0(){return[0]},function robustDeterminant1(m){return[m[0][0]]}];function generateDispatch(){while(CACHE.length<NUM_EXPANDED){CACHE.push(compileDeterminant(CACHE.length))}var procArgs=[];var code=["function robustDeterminant(m){switch(m.length){"];for(var i=0;i<NUM_EXPANDED;++i){procArgs.push("det"+i);code.push("case ",i,":return det",i,"(m);")}code.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant");procArgs.push("CACHE","gen",code.join(""));var proc=Function.apply(undefined,procArgs);module.exports=proc.apply(undefined,CACHE.concat([CACHE,compileDeterminant]));for(var i=0;i<CACHE.length;++i){module.exports[i]=CACHE[i]}}generateDispatch()},{"robust-compress":295,"robust-scale":297,"robust-sum":298,"two-product":299}],301:[function(require,module,exports){module.exports=require(175)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/adjoint.js":175}],302:[function(require,module,exports){module.exports=require(176)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/clone.js":176}],303:[function(require,module,exports){module.exports=require(177)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/copy.js":177}],304:[function(require,module,exports){module.exports=require(178)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/create.js":178}],305:[function(require,module,exports){module.exports=require(179)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/determinant.js":179}],306:[function(require,module,exports){module.exports=require(180)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/fromQuat.js":180}],307:[function(require,module,exports){module.exports=require(181)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/fromRotationTranslation.js":181}],308:[function(require,module,exports){module.exports=require(182)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/frustum.js":182}],309:[function(require,module,exports){module.exports=require(183)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/identity.js":183}],310:[function(require,module,exports){module.exports=require(184)},{"./adjoint":301,"./clone":302,"./copy":303,"./create":304,"./determinant":305,"./fromQuat":306,"./fromRotationTranslation":307,"./frustum":308,"./identity":309,"./invert":311,"./lookAt":312,"./multiply":313,"./ortho":314,"./perspective":315,"./rotate":316,"./rotateX":317,"./rotateY":318,"./rotateZ":319,"./scale":320,"./str":321,"./translate":322,"./transpose":323,"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/index.js":184}],311:[function(require,module,exports){module.exports=require(185)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/invert.js":185}],312:[function(require,module,exports){module.exports=require(186)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/lookAt.js":186}],313:[function(require,module,exports){module.exports=require(187)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/multiply.js":187}],314:[function(require,module,exports){module.exports=require(188)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/ortho.js":188}],315:[function(require,module,exports){module.exports=require(189)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/perspective.js":189}],316:[function(require,module,exports){module.exports=require(190)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/rotate.js":190}],317:[function(require,module,exports){module.exports=require(191)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/rotateX.js":191}],318:[function(require,module,exports){module.exports=require(192)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/rotateY.js":192}],319:[function(require,module,exports){module.exports=require(193)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/rotateZ.js":193}],320:[function(require,module,exports){module.exports=require(194)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/scale.js":194}],321:[function(require,module,exports){module.exports=require(195)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/str.js":195}],322:[function(require,module,exports){module.exports=require(196)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/translate.js":196}],323:[function(require,module,exports){module.exports=require(197)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/transpose.js":197}],324:[function(require,module,exports){module.exports=require(39)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/do-bind.js":39}],325:[function(require,module,exports){module.exports=require(40)},{"./do-bind.js":324,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-emulated.js":40}],326:[function(require,module,exports){module.exports=require(41)},{"./do-bind.js":324,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-native.js":41}],327:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],328:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:327}],329:[function(require,module,exports){module.exports=require(44)},{"./lib/vao-emulated.js":325,"./lib/vao-native.js":326,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/vao.js":44,webglew:328}],330:[function(require,module,exports){module.exports=require(45)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/adapter.js":45,"gl-shader-core":336}],331:[function(require,module,exports){module.exports=require(46)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/browser.js":46}],332:[function(require,module,exports){module.exports=require(47)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-attributes.js":47}],333:[function(require,module,exports){module.exports=require(48)},{"./reflect":334,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-uniforms.js":48,dup:335}],334:[function(require,module,exports){module.exports=require(49)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/reflect.js":49}],335:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],336:[function(require,module,exports){module.exports=require(51)},{"./lib/create-attributes":332,"./lib/create-uniforms":333,"./lib/reflect":334,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/shader-core.js":51}],337:[function(require,module,exports){var EPSILON=1e-6;exports.vertexNormals=function(faces,positions){var N=positions.length;var normals=new Array(N);for(var i=0;i<N;++i){normals[i]=[0,0,0]}for(var i=0;i<faces.length;++i){var f=faces[i];var p=0;var c=f[f.length-1];var n=f[0];for(var j=0;j<f.length;++j){p=c;c=n;n=f[(j+1)%f.length];var v0=positions[p];var v1=positions[c];var v2=positions[n];var d01=new Array(3);var m01=0;var d21=new Array(3);var m21=0;for(var k=0;k<3;++k){d01[k]=v0[k]-v1[k];m01+=d01[k]*d01[k];d21[k]=v2[k]-v1[k];m21+=d21[k]*d21[k]}if(m01*m21>EPSILON){var norm=normals[c];var w=1/Math.sqrt(m01*m21);for(var k=0;k<3;++k){var u=(k+1)%3;var v=(k+2)%3;norm[k]+=w*(d21[u]*d01[v]-d21[v]*d01[u])}}}}for(var i=0;i<N;++i){var norm=normals[i];var m=0;for(var k=0;k<3;++k){m+=norm[k]*norm[k]}if(m>EPSILON){var w=1/Math.sqrt(m);for(var k=0;k<3;++k){norm[k]*=w}}else{for(var k=0;k<3;++k){norm[k]=0}}}return normals};exports.faceNormals=function(faces,positions){var N=faces.length;var normals=new Array(N);for(var i=0;i<N;++i){var f=faces[i];var pos=new Array(3);for(var j=0;j<3;++j){pos[j]=positions[f[j]]}var d01=new Array(3);var d21=new Array(3);for(var j=0;j<3;++j){d01[j]=pos[1][j]-pos[0][j];d21[j]=pos[2][j]-pos[0][j]}var n=new Array(3);var l=0;for(var j=0;j<3;++j){var u=(j+1)%3;var v=(j+2)%3;n[j]=d01[u]*d21[v]-d01[v]*d21[u];l+=n[j]*n[j]}if(l>EPSILON){l=1/Math.sqrt(l)}else{l=0}for(var j=0;j<3;++j){n[j]*=l}normals[i]=n}return normals}},{}],338:[function(require,module,exports){"use strict";var diff=new Float64Array(4);var edge0=new Float64Array(4);var edge1=new Float64Array(4);function closestPoint2d(V0,V1,V2,point,result){if(diff.length<point.length){diff=new Float64Array(point.length);edge0=new Float64Array(point.length);edge1=new Float64Array(point.length)}for(var i=0;i<point.length;++i){diff[i]=V0[i]-point[i];edge0[i]=V1[i]-V0[i];edge1[i]=V2[i]-V0[i]}var a00=0,a01=0,a11=0,b0=0,b1=0,c=0;for(var i=0;i<point.length;++i){var e0=edge0[i],e1=edge1[i],d=diff[i];a00+=e0*e0;a01+=e0*e1;a11+=e1*e1;b0+=d*e0;b1+=d*e1;c+=d*d}var det=Math.abs(a00*a11-a01*a01);var s=a01*b1-a11*b0;var t=a01*b0-a00*b1;var sqrDistance;if(s+t<=det){if(s<0){if(t<0){if(b0<0){t=0;if(-b0>=a00){s=1;sqrDistance=a00+2*b0+c}else{s=-b0/a00;sqrDistance=b0*s+c}}else{s=0;if(b1>=0){t=0;sqrDistance=c}else if(-b1>=a11){t=1;sqrDistance=a11+2*b1+c}else{t=-b1/a11;sqrDistance=b1*t+c}}}else{s=0;if(b1>=0){t=0;sqrDistance=c}else if(-b1>=a11){t=1;sqrDistance=a11+2*b1+c}else{t=-b1/a11;sqrDistance=b1*t+c}}}else if(t<0){t=0;if(b0>=0){s=0;sqrDistance=c}else if(-b0>=a00){s=1;sqrDistance=a00+2*b0+c}else{s=-b0/a00;sqrDistance=b0*s+c}}else{var invDet=1/det;s*=invDet;t*=invDet;sqrDistance=s*(a00*s+a01*t+2*b0)+t*(a01*s+a11*t+2*b1)+c}}else{var tmp0,tmp1,numer,denom;if(s<0){tmp0=a01+b0;tmp1=a11+b1;if(tmp1>tmp0){numer=tmp1-tmp0;denom=a00-2*a01+a11;if(numer>=denom){s=1;t=0;sqrDistance=a00+2*b0+c}else{s=numer/denom;t=1-s;sqrDistance=s*(a00*s+a01*t+2*b0)+t*(a01*s+a11*t+2*b1)+c}}else{s=0;if(tmp1<=0){t=1;sqrDistance=a11+2*b1+c}else if(b1>=0){t=0;sqrDistance=c}else{t=-b1/a11;sqrDistance=b1*t+c}}}else if(t<0){tmp0=a01+b1;tmp1=a00+b0;if(tmp1>tmp0){numer=tmp1-tmp0;denom=a00-2*a01+a11;if(numer>=denom){t=1;s=0;sqrDistance=a11+2*b1+c}else{t=numer/denom;s=1-t;sqrDistance=s*(a00*s+a01*t+2*b0)+t*(a01*s+a11*t+2*b1)+c}}else{t=0;if(tmp1<=0){s=1;sqrDistance=a00+2*b0+c}else if(b0>=0){s=0;sqrDistance=c}else{s=-b0/a00;sqrDistance=b0*s+c}}}else{numer=a11+b1-a01-b0;if(numer<=0){s=0;t=1;sqrDistance=a11+2*b1+c}else{denom=a00-2*a01+a11;if(numer>=denom){s=1;t=0;sqrDistance=a00+2*b0+c}else{s=numer/denom;t=1-s;sqrDistance=s*(a00*s+a01*t+2*b0)+t*(a01*s+a11*t+2*b1)+c}}}}var u=1-s-t;for(var i=0;i<point.length;++i){result[i]=u*V0[i]+s*V1[i]+t*V2[i]}if(sqrDistance<0){return 0}return sqrDistance}module.exports=closestPoint2d},{}],339:[function(require,module,exports){module.exports=require(39)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/do-bind.js":39}],340:[function(require,module,exports){module.exports=require(40)},{"./do-bind.js":339,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-emulated.js":40}],341:[function(require,module,exports){module.exports=require(41)},{"./do-bind.js":339,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-native.js":41}],342:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],343:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:342}],344:[function(require,module,exports){module.exports=require(44)},{"./lib/vao-emulated.js":340,"./lib/vao-native.js":341,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/vao.js":44,webglew:343}],345:[function(require,module,exports){module.exports=require(45)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/adapter.js":45,"gl-shader-core":351}],346:[function(require,module,exports){module.exports=require(46)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/browser.js":46}],347:[function(require,module,exports){module.exports=require(47)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-attributes.js":47}],348:[function(require,module,exports){module.exports=require(48)},{"./reflect":349,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-uniforms.js":48,dup:350}],349:[function(require,module,exports){module.exports=require(49)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/reflect.js":49}],350:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],351:[function(require,module,exports){module.exports=require(51)},{"./lib/create-attributes":347,"./lib/create-uniforms":348,"./lib/reflect":349,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/shader-core.js":51}],352:[function(require,module,exports){"use strict";var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var glslify=require("glslify");var axesParams=require("gl-axes/lib/cube");module.exports=createSpikes;var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec3 position, color;\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nvarying vec4 fragColor;\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0], mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n  vec4 worldCoordinate = model * vec4(vertexPosition, 1.0);\n  vec4 viewCoordinate = view * worldCoordinate;\n  vec4 clipCoordinate = projection * viewCoordinate;\n  gl_Position = clipCoordinate;\n  fragColor = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = fragColor;\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"coordinates[0]",type:"vec3"},{name:"coordinates[1]",type:"vec3"},{name:"coordinates[2]",type:"vec3"},{name:"colors[0]",type:"vec4"},{name:"colors[1]",type:"vec4"},{name:"colors[2]",type:"vec4"}],[{name:"position",type:"vec3"},{name:"color",type:"vec3"}]);var identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function AxisSpikes(gl,buffer,vao,shader){this.gl=gl;this.buffer=buffer;this.vao=vao;this.shader=shader;this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]];this.position=[0,0,0];this.lineWidth=[2,2,2];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.enabled=[true,true,true];this.drawSides=[true,true,true]}var proto=AxisSpikes.prototype;proto.draw=function(camera){var gl=this.gl;var vao=this.vao;var shader=this.shader;vao.bind();shader.bind();var model=camera.model||identity;var view=camera.view||identity;var projection=camera.projection||identity;var axis=axesParams(model,view,projection,this.bounds).axis;var outerFace=[0,0,0];var innerFace=[0,0,0];for(var i=0;i<3;++i){if(axis[i]<0){outerFace[i]=this.bounds[0][i];innerFace[i]=this.bounds[1][i]}else{outerFace[i]=this.bounds[1][i];innerFace[i]=this.bounds[0][i]}}shader.uniforms.model=model;shader.uniforms.view=view;shader.uniforms.projection=projection;shader.uniforms.coordinates=[this.position,outerFace,innerFace];shader.uniforms.colors=this.colors;for(var i=0;i<3;++i){gl.lineWidth(this.lineWidth[i]);if(this.enabled[i]){vao.draw(gl.LINES,2,2*i);if(this.drawSides[i]){vao.draw(gl.LINES,4,6+4*i)}}}vao.unbind()};proto.update=function(options){if(!options){return}if("bounds"in options){this.bounds=options.bounds}if("position"in options){this.position=options.position}if("lineWidth"in options){this.lineWidth=options.lineWidth}if("colors"in options){this.colors=options.colors}if("enabled"in options){this.enabled=options.enabled}if("drawSides"in options){this.drawSides=options.drawSides}};proto.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function createSpikes(gl,options){var data=[0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,1,0,0,1,1,-1,0,1,0,0,1,1,0,1,0,0,1,0,-1,1,0,0,1,0,1,1,0,0,-1,1,0,0,1,0,1,1,0,0,1,0,0,1,-1,0,1,0,0,1,1,0,1,0,-1,0,1,0,0,1,1,0,1,0,0,1,0,-1,1,0,0,1,0,1,1,0,0,1];var buffer=createBuffer(gl,data);var vao=createVAO(gl,[{type:gl.FLOAT,buffer:buffer,size:3,offset:0,stride:24},{type:gl.FLOAT,buffer:buffer,size:3,offset:12,stride:24}]);var shader=createShader(gl);shader.attributes.position.location=0;shader.attributes.color.location=1;var spikes=new AxisSpikes(gl,buffer,vao,shader);spikes.update(options);return spikes}},{"gl-axes/lib/cube":31,"gl-buffer":121,"gl-vao":344,glslify:346,"glslify/adapter.js":345}],353:[function(require,module,exports){module.exports=require(68)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/planar-graph-to-polyline/node_modules/point-in-big-polygon/node_modules/slab-decomposition/node_modules/binary-search-bounds/search-bounds.js":68}],354:[function(require,module,exports){module.exports=require(24)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/incremental-convex-hull/node_modules/simplicial-complex/node_modules/bit-twiddle/twiddle.js":24}],355:[function(require,module,exports){module.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:0,rgb:[255,255,255,1]}]}},{}],356:[function(require,module,exports){"use strict";var at=require("arraytools");var colorScale=require("./colorScales.json");module.exports=function(spec){var indicies,rgba,fromrgba,torgba,nsteps,cmap,colormap,format,nshades,colors,alpha,index,i,r=[],g=[],b=[],a=[];if(!at.isPlainObject(spec))spec={};if(!spec.colormap)colormap="jet";if(!Array.isArray(spec.alpha)){if(typeof spec.alpha==="number")spec.alpha=[spec.alpha,spec.alpha];else spec.alpha=[1,1]}else if(spec.alpha.length!==2)spec.alpha=[1,1];if(typeof spec.colormap==="string"){colormap=spec.colormap.toLowerCase();if(!(colormap in colorScale)){throw Error(colormap+" not a supported colorscale")}cmap=colorScale[colormap]}else if(Array.isArray(spec.colormap)){cmap=spec.colormap}nshades=spec.nshades||72;format=spec.format||"hex";alpha=spec.alpha;if(cmap.length>nshades){throw new Error(colormap+" map requires nshades to be at least size "+cmap.length)}indicies=cmap.map(function(c){return Math.round(c.index*nshades)});if(alpha[0]<0)alpha[0]=0;if(alpha[1]<0)alpha[0]=0;if(alpha[0]>1)alpha[0]=1;if(alpha[1]>1)alpha[0]=1;for(i=0;i<indicies.length;++i){index=cmap[i].index;rgba=cmap[i].rgb;if(rgba.length===4&&rgba[3]>=0&&rgba[3]<=1)continue;rgba[3]=alpha[0]+(alpha[1]-alpha[0])*index}for(i=0;i<indicies.length-1;++i){nsteps=indicies[i+1]-indicies[i];fromrgba=cmap[i].rgb;torgba=cmap[i+1].rgb;r=r.concat(at.linspace(fromrgba[0],torgba[0],nsteps));g=g.concat(at.linspace(fromrgba[1],torgba[1],nsteps));b=b.concat(at.linspace(fromrgba[2],torgba[2],nsteps));a=a.concat(at.linspace(fromrgba[3],torgba[3],nsteps))}r=r.map(Math.round);g=g.map(Math.round);b=b.map(Math.round);colors=at.zip(r,g,b,a);if(format==="hex")colors=colors.map(rgb2hex);if(format==="rgbaString")colors=colors.map(rgbaStr);return colors};function rgb2hex(rgba){var dig,hex="#";for(var i=0;i<3;++i){dig=rgba[i];dig=dig.toString(16);hex+=("00"+dig).substr(dig.length)}return hex}function rgbaStr(rgba){return"rgba("+rgba.join(",")+")"}},{"./colorScales.json":355,arraytools:7}],357:[function(require,module,exports){module.exports=require(50)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/node_modules/dup/dup.js":50}],358:[function(require,module,exports){module.exports=require(185)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/invert.js":185}],359:[function(require,module,exports){module.exports=require(187)},{"/var/www/streambed/gl3d/node_modules/gl-scatter-plot/node_modules/gl-mat4/multiply.js":187}],360:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],361:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:360}],362:[function(require,module,exports){module.exports=require(158)},{"/var/www/streambed/gl3d/node_modules/gl-line-plot/node_modules/gl-texture2d/texture.js":158,ndarray:412,"ndarray-ops":380,"typedarray-pool":398,webglew:361}],363:[function(require,module,exports){module.exports=require(39)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/do-bind.js":39}],364:[function(require,module,exports){module.exports=require(40)},{"./do-bind.js":363,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-emulated.js":40}],365:[function(require,module,exports){module.exports=require(41)},{"./do-bind.js":363,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/lib/vao-native.js":41}],366:[function(require,module,exports){module.exports=require(42)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/node_modules/weakmap/weakmap.js":42}],367:[function(require,module,exports){module.exports=require(43)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/node_modules/webglew/webglew.js":43,weakmap:366}],368:[function(require,module,exports){module.exports=require(44)},{"./lib/vao-emulated.js":364,"./lib/vao-native.js":365,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/gl-vao/vao.js":44,webglew:367}],369:[function(require,module,exports){module.exports=require(45)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/adapter.js":45,"gl-shader-core":374}],370:[function(require,module,exports){module.exports=require(46)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/browser.js":46}],371:[function(require,module,exports){module.exports=require(47)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-attributes.js":47}],372:[function(require,module,exports){module.exports=require(48)},{"./reflect":373,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/create-uniforms.js":48,dup:357}],373:[function(require,module,exports){module.exports=require(49)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/lib/reflect.js":49}],374:[function(require,module,exports){module.exports=require(51)},{"./lib/create-attributes":371,"./lib/create-uniforms":372,"./lib/reflect":373,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/glslify/node_modules/gl-shader-core/shader-core.js":51}],375:[function(require,module,exports){"use strict";module.exports=gradient;var dup=require("dup");var cwiseCompiler=require("cwise-compiler");var TEMPLATE_CACHE={};var GRADIENT_CACHE={};var EmptyProc={body:"",args:[],thisVars:[],localVars:[]};var centralDiff=cwiseCompiler({args:["array","array","array"],pre:EmptyProc,post:EmptyProc,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1},{name:"left",lvalue:false,rvalue:true,count:1},{name:"right",lvalue:false,rvalue:true,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"});var zeroOut=cwiseCompiler({args:["array"],pre:EmptyProc,post:EmptyProc,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function generateTemplate(d){if(d in TEMPLATE_CACHE){return TEMPLATE_CACHE[d]}var code=[];for(var i=0;i<d;++i){code.push("out",i,"s=0.5*(inp",i,"l-inp",i,"r);")}var args=["array"];var names=["junk"];for(var i=0;i<d;++i){args.push("array");names.push("out"+i+"s");var o=dup(d);o[i]=-1;args.push({array:0,offset:o.slice()});o[i]=1;args.push({array:0,offset:o.slice()});names.push("inp"+i+"l","inp"+i+"r")}return TEMPLATE_CACHE[d]=cwiseCompiler({args:args,pre:EmptyProc,post:EmptyProc,body:{body:code.join(""),args:names.map(function(n){return{name:n,lvalue:n.indexOf("out")===0,rvalue:n.indexOf("inp")===0,count:n!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+d})}function generateGradient(boundaryConditions){var token=boundaryConditions.join();var proc=GRADIENT_CACHE[token];if(proc){return proc}var d=boundaryConditions.length;var code=["function gradient(dst,src){var s=src.shape.slice();"];function handleBoundary(facet){var cod=d-facet.length;var loStr=[];var hiStr=[];var pickStr=[];for(var i=0;i<d;++i){if(facet.indexOf(i+1)>=0){pickStr.push("0")}else if(facet.indexOf(-(i+1))>=0){pickStr.push("s["+i+"]-1")}else{pickStr.push("-1");loStr.push("1");hiStr.push("s["+i+"]-2")}}var boundStr=".lo("+loStr.join()+").hi("+hiStr.join()+")";if(loStr.length===0){boundStr=""}if(cod>0){code.push("if(1");for(var i=0;i<d;++i){if(facet.indexOf(i+1)>=0||facet.indexOf(-(i+1))>=0){continue}code.push("&&s[",i,"]>2")}code.push("){grad",cod,"(src.pick(",pickStr.join(),")",boundStr);for(var i=0;i<d;++i){if(facet.indexOf(i+1)>=0||facet.indexOf(-(i+1))>=0){continue}code.push(",dst.pick(",pickStr.join(),",",i,")",boundStr)}code.push(");")}for(var i=0;i<facet.length;++i){var bnd=Math.abs(facet[i])-1;var outStr="dst.pick("+pickStr.join()+","+bnd+")"+boundStr;switch(boundaryConditions[bnd]){case"clamp":var cPickStr=pickStr.slice();var dPickStr=pickStr.slice();if(facet[i]<0){cPickStr[bnd]="s["+bnd+"]-2"}else{dPickStr[bnd]="1"}if(cod===0){code.push("if(s[",bnd,"]>1){dst.set(",pickStr.join(),",",bnd,",0.5*(src.get(",cPickStr.join(),")-src.get(",dPickStr.join(),")))}else{dst.set(",pickStr.join(),",",bnd,",0)};")}else{code.push("if(s[",bnd,"]>1){diff(",outStr,",src.pick(",cPickStr.join(),")",boundStr,",src.pick(",dPickStr.join(),")",boundStr,");}else{zero(",outStr,");};")}break;case"mirror":if(cod===0){code.push("dst.set(",pickStr.join(),",",bnd,",0);")}else{code.push("zero(",outStr,");")}break;case"wrap":var aPickStr=pickStr.slice();var bPickStr=pickStr.slice();if(facet[i]<0){aPickStr[bnd]="s["+bnd+"]-2";bPickStr[bnd]="0"}else{aPickStr[bnd]="s["+bnd+"]-1";bPickStr[bnd]="1"}if(cod===0){code.push("if(s[",bnd,"]>2){dst.set(",pickStr.join(),",",bnd,",0.5*(src.get(",aPickStr.join(),")-src.get(",bPickStr.join(),")))}else{dst.set(",pickStr.join(),",",bnd,",0)};")}else{code.push("if(s[",bnd,"]>2){diff(",outStr,",src.pick(",aPickStr.join(),")",boundStr,",src.pick(",bPickStr.join(),")",boundStr,");}else{zero(",outStr,");};")}break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}if(cod>0){code.push("};")}}for(var i=0;i<1<<d;++i){var faces=[];for(var j=0;j<d;++j){if(i&1<<j){faces.push(j+1)}}for(var k=0;k<1<<faces.length;++k){var sfaces=faces.slice();for(var j=0;j<faces.length;++j){if(k&1<<j){sfaces[j]=-sfaces[j]}}handleBoundary(sfaces)}}code.push("return dst;};return gradient");var linkNames=["diff","zero"];var linkArgs=[centralDiff,zeroOut];for(var i=1;i<=d;++i){linkNames.push("grad"+i);linkArgs.push(generateTemplate(i))}linkNames.push(code.join(""));var link=Function.apply(void 0,linkNames);var proc=link.apply(void 0,linkArgs);TEMPLATE_CACHE[token]=proc;return proc}function gradient(out,inp,bc){if(Array.isArray(bc)){if(bc.length!==inp.dimension){throw new Error("ndarray-gradient: invalid boundary conditions")}}else if(typeof bc==="string"){bc=dup(inp.dimension,bc)}else{bc=dup(inp.dimension,"clamp")}if(out.dimension!==inp.dimension+1){throw new Error("ndarray-gradient: output dimension must be +1 input dimension")}if(out.shape[inp.dimension]!==inp.dimension){throw new Error("ndarray-gradient: output shape must match input shape")}for(var i=0;i<inp.dimension;++i){if(out.shape[i]!==inp.shape[i]){throw new Error("ndarray-gradient: shape mismatch")}}if(inp.size===0){return out}if(inp.dimension<=0){out.set(0);return out}var cached=generateGradient(bc);return cached(out,inp)}},{"cwise-compiler":376,dup:357}],376:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":378,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],377:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:379}],378:[function(require,module,exports){module.exports=require(105)},{"./compile.js":377,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],379:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],380:[function(require,module,exports){module.exports=require(122)},{"/var/www/streambed/gl3d/node_modules/gl-buffer/node_modules/ndarray-ops/ndarray-ops.js":122,"cwise-compiler":381}],381:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":383,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],382:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:384}],383:[function(require,module,exports){module.exports=require(105)},{"./compile.js":382,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],384:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],385:[function(require,module,exports){module.exports=require(90)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/contour.js":90,"typedarray-pool":398}],386:[function(require,module,exports){module.exports=require(93)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/gamma/index.js":93}],387:[function(require,module,exports){module.exports=require(96)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/permutation-parity/permutation-sign.js":96,"typedarray-pool":398}],388:[function(require,module,exports){module.exports=require(97)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/permutation-rank/index.js":97,"invert-permutation":389,"typedarray-pool":398}],389:[function(require,module,exports){module.exports=require(98)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/node_modules/permutation-rank/node_modules/invert-permutation/index.js":98}],390:[function(require,module,exports){module.exports=require(101)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/triangulate-hypercube/triangulate-cube.js":101,gamma:386,"permutation-parity":387,"permutation-rank":388}],391:[function(require,module,exports){module.exports=require(102)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/lib/zc-core.js":102,"cwise-compiler":392}],392:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":394,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],393:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:395}],394:[function(require,module,exports){module.exports=require(105)},{"./compile.js":393,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],395:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],396:[function(require,module,exports){module.exports=require(107)},{"./lib/zc-core":391,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/zc.js":107}],397:[function(require,module,exports){module.exports=require(108)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/surfacenets.js":108,"ndarray-extract-contour":385,"triangulate-hypercube":390,"zero-crossings":396}],398:[function(require,module,exports){module.exports=require(92)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/ndarray-extract-contour/node_modules/typedarray-pool/pool.js":92,"bit-twiddle":354,buffer:8,dup:357}],399:[function(require,module,exports){"use strict";module.exports=createSurfacePlot;var dup=require("dup");var bits=require("bit-twiddle");var glslify=require("glslify");var createBuffer=require("gl-buffer");var createVAO=require("gl-vao");var createTexture=require("gl-texture2d");var pool=require("typedarray-pool");var colormap=require("colormap");var ops=require("ndarray-ops");var pack=require("ndarray-pack");var ndarray=require("ndarray");var surfaceNets=require("surface-nets");var getCubeProps=require("gl-axes/lib/cube");var multiply=require("gl-mat4/multiply");var invert=require("gl-mat4/invert");var bsearch=require("binary-search-bounds");var gradient=require("ndarray-gradient");var SURFACE_VERTEX_SIZE=4*(4+2+3);var createShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec4 uv;\nattribute vec2 f;\nattribute vec3 normal;\nuniform mat4 model, view, projection;\nuniform vec3 lightPosition, eyePosition;\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvoid main() {\n  vec4 worldPosition = model * vec4(uv.zw, f.x, 1.0);\n  gl_Position = projection * view * worldPosition;\n  value = f.x;\n  kill = f.y;\n  worldCoordinate = vec3(uv.zw, f.x);\n  planeCoordinate = uv.xy;\n  lightDirection = lightPosition - worldCoordinate;\n  eyeDirection = eyePosition - worldCoordinate;\n  surfaceNormal = normal;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nfloat b_x_beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\nfloat a_x_cookTorranceSpecular(vec3 lightDirection, vec3 viewDirection, vec3 surfaceNormal, float roughness, float fresnel) {\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n  vec3 H = normalize(lightDirection + viewDirection);\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  float D = b_x_beckmannDistribution(NdotH, roughness);\n  float F = pow(1.0 - VdotN, fresnel);\n  return G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular;\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvoid main() {\n  if(kill > 0.0 || any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n  float specular = a_x_cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n  float interpValue = (value - lowerBound.z) / (upperBound.z - lowerBound.z);\n  vec4 surfaceColor = texture2D(colormap, vec2(interpValue, interpValue));\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1, 1, 1) * specular, 1.0);\n  gl_FragColor = mix(litColor, contourColor, contourTint);\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"lightPosition",type:"vec3"},{name:"eyePosition",type:"vec3"},{name:"lowerBound",type:"vec3"},{name:"upperBound",type:"vec3"},{name:"contourTint",type:"float"},{name:"contourColor",type:"vec4"},{name:"colormap",type:"sampler2D"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"roughness",type:"float"},{name:"fresnel",type:"float"},{name:"kambient",type:"float"},{name:"kdiffuse",type:"float"},{name:"kspecular",type:"float"}],[{name:"uv",type:"vec4"},{name:"f",type:"vec2"},{name:"normal",type:"vec3"}]),createContourShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec4 uv;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nvarying float value;\nvarying float kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  vec4 worldPosition = model * vec4(dataCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z = clipPosition.z + zOffset;\n  gl_Position = clipPosition;\n  value = height;\n  kill = -1.0;\n  worldCoordinate = dataCoordinate;\n  planeCoordinate = uv.zw;\n  surfaceNormal = vec3(1, 0, 0);\n  eyeDirection = vec3(0, 1, 0);\n  lightDirection = vec3(0, 0, 1);\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nfloat b_x_beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\nfloat a_x_cookTorranceSpecular(vec3 lightDirection, vec3 viewDirection, vec3 surfaceNormal, float roughness, float fresnel) {\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n  vec3 H = normalize(lightDirection + viewDirection);\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  float D = b_x_beckmannDistribution(NdotH, roughness);\n  float F = pow(1.0 - VdotN, fresnel);\n  return G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular;\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvoid main() {\n  if(kill > 0.0 || any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n  float specular = a_x_cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n  float interpValue = (value - lowerBound.z) / (upperBound.z - lowerBound.z);\n  vec4 surfaceColor = texture2D(colormap, vec2(interpValue, interpValue));\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1, 1, 1) * specular, 1.0);\n  gl_FragColor = mix(litColor, contourColor, contourTint);\n}",[{name:"permutation",type:"mat3"},{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"height",type:"float"},{name:"zOffset",type:"float"},{name:"lowerBound",type:"vec3"},{name:"upperBound",type:"vec3"},{name:"contourTint",type:"float"},{name:"contourColor",type:"vec4"},{name:"colormap",type:"sampler2D"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"roughness",type:"float"},{name:"fresnel",type:"float"},{name:"kambient",type:"float"},{name:"kdiffuse",type:"float"},{name:"kspecular",type:"float"}],[{name:"uv",type:"vec4"}]),createPickShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec4 uv;\nattribute vec2 f;\nattribute vec3 normal;\nuniform mat4 model, view, projection;\nuniform vec3 lightPosition, eyePosition;\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvoid main() {\n  vec4 worldPosition = model * vec4(uv.zw, f.x, 1.0);\n  gl_Position = projection * view * worldPosition;\n  value = f.x;\n  kill = f.y;\n  worldCoordinate = vec3(uv.zw, f.x);\n  planeCoordinate = uv.xy;\n  lightDirection = lightPosition - worldCoordinate;\n  eyeDirection = eyePosition - worldCoordinate;\n  surfaceNormal = normal;\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\nvoid main() {\n  if(kill > 0.0 || any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y / 16.0));\n}",[{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"lightPosition",type:"vec3"},{name:"eyePosition",type:"vec3"},{name:"shape",type:"vec2"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"pickId",type:"float"}],[{name:"uv",type:"vec4"},{name:"f",type:"vec2"},{name:"normal",type:"vec3"}]),createPickContourShader=require("glslify/adapter.js")("\n#define GLSLIFY 1\n\nprecision mediump float;\nattribute vec4 uv;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nvarying float value;\nvarying float kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  vec4 worldPosition = model * vec4(dataCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z = clipPosition.z + zOffset;\n  gl_Position = clipPosition;\n  value = height;\n  kill = -1.0;\n  worldCoordinate = dataCoordinate;\n  planeCoordinate = uv.zw;\n  surfaceNormal = vec3(1, 0, 0);\n  eyeDirection = vec3(0, 1, 0);\n  lightDirection = vec3(0, 0, 1);\n}","\n#define GLSLIFY 1\n\nprecision mediump float;\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\nvoid main() {\n  if(kill > 0.0 || any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y / 16.0));\n}",[{name:"permutation",type:"mat3"},{name:"model",type:"mat4"},{name:"view",type:"mat4"},{name:"projection",type:"mat4"},{name:"height",type:"float"},{name:"zOffset",type:"float"},{name:"shape",type:"vec2"},{name:"clipBounds[0]",type:"vec3"},{name:"clipBounds[1]",type:"vec3"},{name:"pickId",type:"float"}],[{name:"uv",type:"vec4"}]);var IDENTITY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var QUAD=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]];var PERMUTATIONS=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var i=0;i<3;++i){var p=PERMUTATIONS[i];var u=(i+1)%3;var v=(i+2)%3;p[u+0]=1;p[v+3]=1;p[i+6]=1}})();function SurfacePickResult(position,index,uv,level){this.position=position;this.index=index;this.uv=uv;this.level=level}function genColormap(name){var x=pack([colormap({colormap:name,nshades:256,format:"rgba"}).map(function(c){return[c[0],c[1],c[2],255*c[3]]})]);ops.divseq(x,255);return x}function clampVec(v){var result=new Array(3);for(var i=0;i<3;++i){result[i]=Math.min(Math.max(v[i],-1e8),1e8)}return result}function SurfacePlot(gl,shape,bounds,shader,pickShader,coordinates,vao,colorMap,contourShader,contourPickShader,contourBuffer,contourVAO,dynamicBuffer,dynamicVAO){this.gl=gl;this.shape=shape;this.bounds=bounds;this._shader=shader;this._pickShader=pickShader;this._coordinateBuffer=coordinates;this._vao=vao;this._colorMap=colorMap;this._contourShader=contourShader;this._contourPickShader=contourPickShader;this._contourBuffer=contourBuffer;this._contourVAO=contourVAO;this._contourOffsets=[[],[],[]];this._contourCounts=[[],[],[]];this._vertexCount=0;this._dynamicBuffer=dynamicBuffer;this._dynamicVAO=dynamicVAO;this._dynamicOffsets=[0,0,0];this._dynamicCounts=[0,0,0];this.contourWidth=[1,1,1];this.contourLevels=[[],[],[]];this.contourTint=[0,0,0];this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]];this.showContour=true;this.showSurface=true;this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.highlightTint=[1,1,1];this.highlightLevel=[-1,-1,-1];this.dynamicLevel=[NaN,NaN,NaN];this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.dynamicTint=[1,1,1];this.dynamicWidth=[1,1,1];this.axesBounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.surfaceProject=[false,false,false];this.contourProject=[false,false,false];this._field=[ndarray(pool.mallocFloat(1024),[0,0]),ndarray(pool.mallocFloat(1024),[0,0]),ndarray(pool.mallocFloat(1024),[0,0])];this.pickId=1;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[10,1e4,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5}var proto=SurfacePlot.prototype;function computeProjectionData(camera,obj){var cubeProps=getCubeProps(camera.model,camera.view,camera.projection,obj.axesBounds);var cubeAxis=cubeProps.axis;var showSurface=obj.showSurface;var showContour=obj.showContour;var projections=[null,null,null];var clipRects=[null,null,null];for(var i=0;i<3;++i){showSurface=showSurface||obj.surfaceProject[i];showContour=showContour||obj.contourProject[i];if(obj.surfaceProject[i]||obj.contourProject[i]){var axisSquish=IDENTITY.slice();axisSquish[5*i]=0;axisSquish[12+i]=obj.axesBounds[+(cubeAxis[i]>0)][i];multiply(axisSquish,camera.model,axisSquish);projections[i]=axisSquish;var nclipBounds=[camera.clipBounds[0].slice(),camera.clipBounds[1].slice()];nclipBounds[0][i]=-1e8;nclipBounds[1][i]=1e8;clipRects[i]=nclipBounds}}return{showSurface:showSurface,showContour:showContour,projections:projections,clipBounds:clipRects}}proto.draw=function(params){params=params||{};var gl=this.gl;var uniforms={model:params.model||IDENTITY,view:params.view||IDENTITY,projection:params.projection||IDENTITY,lowerBound:this.bounds[0],upperBound:this.bounds[1],colormap:this._colorMap.bind(0),clipBounds:this.clipBounds.map(clampVec),height:0,contourTint:0,contourColor:this.contourColor[0],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-.001,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:this.roughness,fresnel:this.fresnel};var invCameraMatrix=IDENTITY.slice();multiply(invCameraMatrix,uniforms.view,uniforms.model);multiply(invCameraMatrix,uniforms.projection,uniforms.view);invert(invCameraMatrix,invCameraMatrix);for(var i=0;i<3;++i){uniforms.eyePosition[i]=invCameraMatrix[12+i]/invCameraMatrix[15]}var w=invCameraMatrix[15];for(var i=0;i<3;++i){w+=this.lightPosition[i]*invCameraMatrix[4*i+3]}for(var i=0;i<3;++i){var s=invCameraMatrix[12+i];for(var j=0;j<3;++j){s+=invCameraMatrix[4*j+i]*this.lightPosition[j]}uniforms.lightPosition[i]=s/w}var projectData=computeProjectionData(uniforms,this);if(projectData.showSurface){this._shader.bind();this._shader.uniforms=uniforms;this._vao.bind();if(this.showSurface){this._vao.draw(gl.TRIANGLES,this._vertexCount)}for(var i=0;i<3;++i){if(!this.surfaceProject[i]){continue}this._shader.uniforms.model=projectData.projections[i];this._shader.uniforms.clipBounds=projectData.clipBounds[i];this._vao.draw(gl.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(projectData.showContour){var shader=this._contourShader;uniforms.kambient=1;uniforms.kdiffuse=0;uniforms.kspecular=0;shader.bind();shader.uniforms=uniforms;var vao=this._contourVAO;vao.bind();for(var i=0;i<3;++i){shader.uniforms.permutation=PERMUTATIONS[i];gl.lineWidth(this.contourWidth[i]);for(var j=0;j<this.contourLevels[i].length;++j){if(j===this.highlightLevel[i]){shader.uniforms.contourColor=this.highlightColor[i];shader.uniforms.contourTint=this.highlightTint[i]}else if(j===0||j-1===this.highlightLevel[i]){shader.uniforms.contourColor=this.contourColor[i];shader.uniforms.contourTint=this.contourTint[i]}shader.uniforms.height=this.contourLevels[i][j];vao.draw(gl.LINES,this._contourCounts[i][j],this._contourOffsets[i][j])}}for(var i=0;i<3;++i){if(!this.contourProject[i]){continue}shader.uniforms.model=projectData.projections[i];shader.uniforms.clipBounds=projectData.clipBounds[i];for(var j=0;j<3;++j){shader.uniforms.permutation=PERMUTATIONS[j];gl.lineWidth(this.contourWidth[j]);for(var k=0;k<this.contourLevels[j].length;++k){if(k===this.highlightLevel[j]){shader.uniforms.contourColor=this.highlightColor[j];shader.uniforms.contourTint=this.highlightTint[j]}else if(k===0||k-1===this.highlightLevel[j]){shader.uniforms.contourColor=this.contourColor[j];shader.uniforms.contourTint=this.contourTint[j]}shader.uniforms.height=this.contourLevels[j][k];vao.draw(gl.LINES,this._contourCounts[j][k],this._contourOffsets[j][k])}}}vao=this._dynamicVAO;vao.bind();for(var i=0;i<3;++i){if(this._dynamicCounts[i]===0){continue}shader.uniforms.model=uniforms.model;shader.uniforms.clipBounds=uniforms.clipBounds;shader.uniforms.permutation=PERMUTATIONS[i];gl.lineWidth(this.dynamicWidth[i]);shader.uniforms.contourColor=this.dynamicColor[i];shader.uniforms.contourTint=this.dynamicTint[i];shader.uniforms.height=this.dynamicLevel[i];vao.draw(gl.LINES,this._dynamicCounts[i],this._dynamicOffsets[i]);for(var j=0;j<3;++j){if(!this.contourProject[j]){continue}shader.uniforms.model=projectData.projections[j];shader.uniforms.clipBounds=projectData.clipBounds[j];vao.draw(gl.LINES,this._dynamicCounts[i],this._dynamicOffsets[i])}}vao.unbind()}};proto.drawPick=function(params){params=params||{};var gl=this.gl;var uniforms={model:params.model||IDENTITY,view:params.view||IDENTITY,projection:params.projection||IDENTITY,clipBounds:this.clipBounds.map(clampVec),height:0,shape:this._field[2].shape.slice(),pickId:this.pickId/255,lowerBound:this.bounds[0],upperBound:this.bounds[1],zOffset:0,permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};var projectData=computeProjectionData(uniforms,this);if(projectData.showSurface){this._pickShader.bind();this._pickShader.uniforms=uniforms;this._vao.bind();this._vao.draw(gl.TRIANGLES,this._vertexCount);for(var i=0;i<3;++i){if(!this.surfaceProject[i]){continue}this._pickShader.uniforms.model=projectData.projections[i];this._pickShader.uniforms.clipBounds=projectData.clipBounds[i];this._vao.draw(gl.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(projectData.showContour){var shader=this._contourPickShader;shader.bind();shader.uniforms=uniforms;var vao=this._contourVAO;vao.bind();for(var j=0;j<3;++j){gl.lineWidth(this.contourWidth[j]);shader.uniforms.permutation=PERMUTATIONS[j];for(var i=0;i<this.contourLevels[j].length;++i){shader.uniforms.height=this.contourLevels[j][i];vao.draw(gl.LINES,this._contourCounts[j][i],this._contourOffsets[j][i])}}for(var i=0;i<3;++i){if(!this.contourProject[i]){continue}shader.uniforms.model=projectData.projections[i];shader.uniforms.clipBounds=projectData.clipBounds[i];for(var j=0;j<3;++j){shader.uniforms.permutation=PERMUTATIONS[j];gl.lineWidth(this.contourWidth[j]);for(var k=0;k<this.contourLevels[j].length;++k){shader.uniforms.height=this.contourLevels[j][k];vao.draw(gl.LINES,this._contourCounts[j][k],this._contourOffsets[j][k])}}}vao.unbind()}};proto.pick=function(selection){if(!selection){return null}if(selection.id!==this.pickId){return null}var shape=this._field[2].shape.slice();var x=shape[0]*(selection.value[0]+(selection.value[2]>>4)/16)/255;var ix=Math.floor(x);var fx=x-ix;var y=shape[1]*(selection.value[1]+(selection.value[2]&15)/16)/255;var iy=Math.floor(y);var fy=y-iy;ix+=1;iy+=1;var pos=[0,0,0];for(var dx=0;dx<2;++dx){var s=dx?fx:1-fx;for(var dy=0;dy<2;++dy){var t=dy?fy:1-fy;var r=ix+dx;var c=iy+dy;var w=s*t;for(var i=0;i<3;++i){pos[i]+=this._field[i].get(r,c)*w}}}var levelIndex=[-1,-1,-1];for(var j=0;j<3;++j){levelIndex[j]=bsearch.le(this.contourLevels[j],pos[j]);if(levelIndex[j]<0){if(this.contourLevels[j].length>0){levelIndex[j]=0}}else if(levelIndex[j]<this.contourLevels[j].length-1){var a=this.contourLevels[j][levelIndex[j]];var b=this.contourLevels[j][levelIndex[j]+1];if(Math.abs(a-pos[j])>Math.abs(b-pos[j])){levelIndex[j]+=1}}}return new SurfacePickResult(pos,[fx<.5?ix:ix+1,fy<.5?iy:iy+1],[x/shape[0],y/shape[1]],levelIndex)};function padField(nfield,field){var shape=field.shape.slice();var nshape=nfield.shape.slice();ops.assign(nfield.lo(1,1).hi(shape[0],shape[1]),field);ops.assign(nfield.lo(1).hi(shape[0],1),field.hi(shape[0],1));ops.assign(nfield.lo(1,nshape[1]-1).hi(shape[0],1),field.lo(0,shape[1]-1).hi(shape[0],1));ops.assign(nfield.lo(0,1).hi(1,shape[1]),field.hi(1));ops.assign(nfield.lo(nshape[0]-1,1).hi(1,shape[1]),field.lo(shape[0]-1));nfield.set(0,0,field.get(0,0));nfield.set(0,nshape[1]-1,field.get(0,shape[1]-1));nfield.set(nshape[0]-1,0,field.get(shape[0]-1,0));nfield.set(nshape[0]-1,nshape[1]-1,field.get(shape[0]-1,shape[1]-1))}function handleArray(param,ctor){if(Array.isArray(param)){return[ctor(param[0]),ctor(param[1]),ctor(param[2])]}return[ctor(param),ctor(param),ctor(param)]}function toColor(x){if(Array.isArray(x)){if(x.length===3){return[x[0],x[1],x[2],1]}return[x[0],x[1],x[2],x[3]]}return[0,0,0,1]}function handleColor(param){if(Array.isArray(param)){if(Array.isArray(param)){return[toColor(param[0]),toColor(param[1]),toColor(param[2])]}else{var c=toColor(param);return[c.slice(),c.slice(),c.slice()]}}}proto.update=function(params){params=params||{};if("pickId"in params){this.pickId=params.pickId|0}if("levels"in params){var levels=params.levels;if(!Array.isArray(levels[0])){this.contourLevels=[[],[],levels]}else{this.contourLevels=levels.slice()}for(var i=0;i<3;++i){this.contourLevels[i]=this.contourLevels[i].slice();this.contourLevels.sort(function(a,b){return a-b})}}if("contourWidth"in params){this.contourWidth=handleArray(params.contourWidth,Number)}if("showContour"in params){this.showContour=handleArray(params.showContour,Boolean)}if("showSurface"in params){this.showSurface=!!params.showSurface}if("contourTint"in params){this.contourTint=handleArray(params.contourTint,Boolean)}if("contourColor"in params){this.contourColor=handleColor(params.contourColor)}if("contourProject"in params){this.contourProject=handleArray(params.contourProject,Boolean)}if("surfaceProject"in params){this.surfaceProject=params.surfaceProject}if("axesBounds"in params){this.axesBounds=params.axesBounds}if(!params.field){throw new Error("must specify field parameter")}if("dynamicColor"in params){this.dynamicColor=handleColor(params.dynamicColor)}if("dynamicTint"in params){this.dynamicTint=handleArray(params.dynamicTint,Number)}if("dynamicWidth"in params){this.dynamicWidth=handleArray(params.dynamicWidth,Number)}var field=params.field;var fsize=(field.shape[0]+2)*(field.shape[1]+2);if(fsize>this._field[2].data.length){pool.freeFloat(this._field[2].data);this._field[2].data=pool.mallocFloat(bits.nextPow2(fsize))}this._field[2]=ndarray(this._field[2].data,[field.shape[0]+2,field.shape[1]+2]);padField(this._field[2],field);this.shape=field.shape.slice();var shape=this.shape;for(var i=0;i<2;++i){if(this._field[2].size>this._field[i].data.length){pool.freeFloat(this._field[i].data);this._field[i].data=pool.mallocFloat(this._field[2].size)}this._field[i]=ndarray(this._field[i].data,[shape[0]+2,shape[1]+2])}if(params.coords){var coords=params.coords;if(!Array.isArray(coords)||coords.length!==2){throw new Error("gl-surface: invalid coordinates for x/y")}for(var i=0;i<2;++i){var coord=coords[i];for(var j=0;j<2;++j){if(coord.shape[j]!==shape[j]){throw new Error("gl-surface: coords have incorrect shape")}}padField(this._field[i],coord)}}else if(params.ticks){var ticks=params.ticks;if(!Array.isArray(ticks)||ticks.length!==2){throw new Error("gl-surface: invalid ticks")}for(var i=0;i<2;++i){var tick=ticks[i];if(Array.isArray(tick)||tick.length){tick=ndarray(tick)}if(tick.shape[0]!==shape[i]){throw new Error("gl-surface: invalid tick length")}var tick2=ndarray(tick.data,shape);tick2.stride[i]=tick.stride[0];tick2.stride[i^1]=0;padField(this._field[i],tick2)}}else{for(var i=0;i<2;++i){var offset=[0,0];offset[i]=1;this._field[i]=ndarray(this._field[i].data,[shape[0]+2,shape[1]+2],offset,0)}this._field[0].set(0,0,0);for(var j=0;j<shape[0];++j){this._field[0].set(j+1,0,j)}this._field[0].set(shape[0]+1,0,shape[0]-1);this._field[1].set(0,0,0);for(var j=0;j<shape[1];++j){this._field[1].set(0,j+1,j)}this._field[1].set(0,shape[1]+1,shape[1]-1)}var fields=this._field;var fieldSize=fields[2].size;var dfields=ndarray(pool.mallocFloat(fields[2].size*3*2),[3,shape[0]+2,shape[1]+2,2]);for(var i=0;i<3;++i){gradient(dfields.pick(i),fields[i],"mirror")}var normals=ndarray(pool.mallocFloat(fields[2].size*3),[shape[0]+2,shape[1]+2,3]);for(var i=0;i<shape[0]+2;++i){for(var j=0;j<shape[1]+2;++j){var dxdu=dfields.get(0,i,j,0);var dxdv=dfields.get(0,i,j,1);var dydu=dfields.get(1,i,j,0);var dydv=dfields.get(1,i,j,1);var dzdu=dfields.get(2,i,j,0);var dzdv=dfields.get(2,i,j,1);var nx=dydu*dzdv-dydv*dzdu;var ny=dzdu*dxdv-dzdv*dxdu;var nz=dxdu*dydv-dxdv*dydu;var nl=nx*nx+ny*ny+nz*nz;if(nl<1e-6){nl=0}else{nl=1/Math.sqrt(nl)}normals.set(i,j,0,nx*nl);normals.set(i,j,1,ny*nl);normals.set(i,j,2,nz*nl)}}pool.free(dfields.data);var lo=[Infinity,Infinity,Infinity];var hi=[-Infinity,-Infinity,-Infinity];var count=(shape[0]-1)*(shape[1]-1)*6;var tverts=pool.mallocFloat(bits.nextPow2(9*count));var tptr=0;var fptr=0;var vertexCount=0;for(var i=0;i<shape[0]-1;++i){j_loop:for(var j=0;j<shape[1]-1;++j){for(var dx=0;dx<2;++dx){for(var dy=0;dy<2;++dy){for(var k=0;k<3;++k){var f=this._field[k].get(1+i+dx,1+j+dy);if(isNaN(f)||!isFinite(f)){continue j_loop}}}}for(var k=0;k<6;++k){var r=i+QUAD[k][0];var c=j+QUAD[k][1];var tx=this._field[0].get(r+1,c+1);var ty=this._field[1].get(r+1,c+1);var f=this._field[2].get(r+1,c+1);var nx=normals.get(r+1,c+1,0);var ny=normals.get(r+1,c+1,1);var nz=normals.get(r+1,c+1,2);tverts[tptr++]=r;tverts[tptr++]=c;tverts[tptr++]=tx;tverts[tptr++]=ty;tverts[tptr++]=f;tverts[tptr++]=0;tverts[tptr++]=nx;tverts[tptr++]=ny;tverts[tptr++]=nz;lo[0]=Math.min(lo[0],tx);lo[1]=Math.min(lo[1],ty);lo[2]=Math.min(lo[2],f);hi[0]=Math.max(hi[0],tx);hi[1]=Math.max(hi[1],ty);hi[2]=Math.max(hi[2],f);vertexCount+=1}}}this._vertexCount=vertexCount;this._coordinateBuffer.update(tverts.subarray(0,tptr));pool.freeFloat(tverts);pool.free(normals.data);this.bounds=[lo,hi];var contourVerts=[];for(var dim=0;dim<3;++dim){var levels=this.contourLevels[dim];var levelOffsets=[];var levelCounts=[];var parts=[0,0];var graphParts=[0,0];for(var i=0;i<levels.length;++i){var graph=surfaceNets(this._field[dim],levels[i]);levelOffsets.push(contourVerts.length/4|0);var vertexCount=0;edge_loop:for(var j=0;j<graph.cells.length;++j){var e=graph.cells[j];for(var k=0;k<2;++k){var p=graph.positions[e[k]];var x=p[0];var ix=Math.floor(x)|0;var fx=x-ix;var y=p[1];var iy=Math.floor(y)|0;var fy=y-iy;var hole=false;dd_loop:for(var dd=0;dd<2;++dd){parts[dd]=0;var iu=(dim+dd+1)%3;for(var dx=0;dx<2;++dx){var s=dx?fx:1-fx;var r=Math.min(Math.max(ix+dx,0),shape[0])|0;for(var dy=0;dy<2;++dy){var t=dy?fy:1-fy;var c=Math.min(Math.max(iy+dy,0),shape[1])|0;var f=this._field[iu].get(r,c);if(!isFinite(f)||isNaN(f)){hole=true;break dd_loop}var w=s*t;parts[dd]+=w*f}}}if(!hole){contourVerts.push(parts[0],parts[1],p[0],p[1]);vertexCount+=1}else{if(k>0){for(var l=0;l<4;++l){contourVerts.pop()}vertexCount-=1}continue edge_loop}}}levelCounts.push(vertexCount)}this._contourOffsets[dim]=levelOffsets;this._contourCounts[dim]=levelCounts}var floatBuffer=pool.mallocFloat(contourVerts.length);for(var i=0;i<contourVerts.length;++i){floatBuffer[i]=contourVerts[i]}this._contourBuffer.update(floatBuffer);pool.freeFloat(floatBuffer);if(params.colormap){this._colorMap.setPixels(genColormap(params.colormap))}};proto.dispose=function(){this._shader.dispose();this._vao.dispose();this._coordinateBuffer.dispose();this._colorMap.dispose();this._contourBuffer.dispose();this._contourVAO.dispose();this._contourShader.dispose();this._contourPickShader.dispose();this._dynamicBuffer.dispose();this._dynamicVAO.dispose();for(var i=0;i<3;++i){pool.freeFloat(this._field[i].data)}};proto.dynamic=function(levels){if(!levels){this._dynamicCounts=[0,0,0];return}var vertexCount=0;var shape=this.shape;var scratchBuffer=pool.mallocFloat(12*shape[0]*shape[1]);this.dynamicLevel=levels.slice();for(var d=0;d<3;++d){var u=(d+1)%3;var v=(d+2)%3;var f=this._field[d];var g=this._field[u];var h=this._field[v];var graph=surfaceNets(f,levels[d]);var edges=graph.cells;var positions=graph.positions;this._dynamicOffsets[d]=vertexCount;for(var i=0;i<edges.length;++i){var e=edges[i];for(var j=0;j<2;++j){var p=positions[e[j]];var x=+p[0];var ix=x|0;var jx=Math.min(ix+1,shape[0])|0;var fx=x-ix;var hx=1-fx;var y=+p[1];var iy=y|0;var jy=Math.min(iy+1,shape[1])|0;var fy=y-iy;var hy=1-fy;var w00=hx*hy;var w01=hx*fy;var w10=fx*hy;var w11=fx*fy;var cu=w00*g.get(ix,iy)+w01*g.get(ix,jy)+w10*g.get(jx,iy)+w11*g.get(jx,jy);var cv=w00*h.get(ix,iy)+w01*h.get(ix,jy)+w10*h.get(jx,iy)+w11*h.get(jx,jy);if(isNaN(cu)||isNaN(cv)){if(j){vertexCount-=1}break}scratchBuffer[2*vertexCount+0]=cu;scratchBuffer[2*vertexCount+1]=cv;vertexCount+=1}}this._dynamicCounts[d]=vertexCount-this._dynamicOffsets[d]}this._dynamicBuffer.update(scratchBuffer.subarray(0,2*vertexCount));pool.freeFloat(scratchBuffer)};function createSurfacePlot(gl,field,params){var shader=createShader(gl);shader.attributes.uv.location=0;shader.attributes.f.location=1;var pickShader=createPickShader(gl);pickShader.attributes.uv.location=0;pickShader.attributes.f.location=1;var contourShader=createContourShader(gl);contourShader.attributes.uv.location=0;var contourPickShader=createPickContourShader(gl);contourPickShader.attributes.uv.location=0;var coordinateBuffer=createBuffer(gl);var vao=createVAO(gl,[{buffer:coordinateBuffer,size:4,stride:SURFACE_VERTEX_SIZE,offset:0},{buffer:coordinateBuffer,size:2,stride:SURFACE_VERTEX_SIZE,offset:16},{buffer:coordinateBuffer,size:3,stride:SURFACE_VERTEX_SIZE,offset:24}]);var contourBuffer=createBuffer(gl);var contourVAO=createVAO(gl,[{buffer:contourBuffer,size:4}]);var dynamicBuffer=createBuffer(gl);var dynamicVAO=createVAO(gl,[{buffer:dynamicBuffer,size:2,type:gl.FLOAT}]);var cmap=createTexture(gl,1,256,gl.RGBA,gl.UNSIGNED_BYTE);cmap.minFilter=gl.LINEAR;cmap.magFilter=gl.LINEAR;var surface=new SurfacePlot(gl,[0,0],[[0,0,0],[0,0,0]],shader,pickShader,coordinateBuffer,vao,cmap,contourShader,contourPickShader,contourBuffer,contourVAO,dynamicBuffer,dynamicVAO);var nparams={};for(var id in params){nparams[id]=params[id]}nparams.field=field;nparams.colormap=nparams.colormap||"jet";surface.update(nparams);return surface}},{"binary-search-bounds":353,"bit-twiddle":354,colormap:356,dup:357,"gl-axes/lib/cube":31,"gl-buffer":121,"gl-mat4/invert":358,"gl-mat4/multiply":359,"gl-texture2d":362,"gl-vao":368,glslify:370,"glslify/adapter.js":369,ndarray:412,"ndarray-gradient":375,"ndarray-ops":380,"ndarray-pack":406,"surface-nets":397,"typedarray-pool":398}],400:[function(require,module,exports){"use strict";var fill=require("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_1_arg1_=_inline_1_arg2_.apply(void 0,_inline_1_arg0_)}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"cwise",blockSize:64});module.exports=function(array,f){fill(array,f);return array}},{"cwise/lib/wrapper":401}],401:[function(require,module,exports){module.exports=require(274)},{"/var/www/streambed/gl3d/node_modules/gl-select-static/node_modules/cwise/lib/wrapper.js":274,"cwise-compiler":402}],402:[function(require,module,exports){module.exports=require(103)},{"./lib/thunk.js":404,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/compiler.js":103}],403:[function(require,module,exports){module.exports=require(104)},{"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/compile.js":104,uniq:405}],404:[function(require,module,exports){module.exports=require(105)},{"./compile.js":403,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],405:[function(require,module,exports){module.exports=require(27)},{"/var/www/streambed/gl3d/node_modules/delaunay-triangulate/node_modules/uniq/uniq.js":27}],406:[function(require,module,exports){"use strict";var ndarray=require("ndarray");var do_convert=require("./doConvert.js");module.exports=function convert(arr,result){var shape=[],c=arr,sz=1;while(c instanceof Array){shape.push(c.length);sz*=c.length;c=c[0]}if(shape.length===0){return ndarray()}if(!result){result=ndarray(new Float64Array(sz),shape)}do_convert(result,arr);return result}},{"./doConvert.js":407,ndarray:412}],407:[function(require,module,exports){module.exports=require("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:true,rvalue:false,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":408}],408:[function(require,module,exports){"use strict";var createThunk=require("./lib/thunk.js");function Procedure(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function compileCwise(user_args){var proc=new Procedure;proc.pre=user_args.pre;proc.body=user_args.body;proc.post=user_args.post;var proc_args=user_args.args.slice(0);proc.argTypes=proc_args.slice(0);for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if(arg_type==="array"){proc.arrayArgs.push(i);proc.shimArgs.push("array"+i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array args")}if(i<proc.post.args.length&&proc.post.args[i].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(arg_type==="scalar"){proc.scalarArgs.push(i);proc.shimArgs.push("scalar"+i)}else if(arg_type==="index"){proc.indexArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0){throw new Error("cwise: pre() block may not reference array index")}if(i<proc.body.args.length&&proc.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array index")}if(i<proc.post.args.length&&proc.post.args[i].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(arg_type==="shape"){proc.shapeArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(i<proc.body.args.length&&proc.body.args[i].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(i<proc.post.args.length&&proc.post.args[i].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof arg_type==="object"&&arg_type.offset){proc.argTypes[i]="offset";proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset});proc.offsetArgIndex.push(i)}else{throw new Error("cwise: Unknown argument type "+proc_args[i])}}if(proc.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(proc.pre.args.length>proc_args.length){throw new Error("cwise: Too many arguments in pre() block")}if(proc.body.args.length>proc_args.length){throw new Error("cwise: Too many arguments in body() block")}if(proc.post.args.length>proc_args.length){throw new Error("cwise: Too many arguments in post() block")}proc.debug=!!user_args.printCode||!!user_args.debug;proc.funcName=user_args.funcName||"cwise";proc.blockSize=user_args.blockSize||64;return createThunk(proc)}module.exports=compileCwise},{"./lib/thunk.js":410}],409:[function(require,module,exports){"use strict";var uniq=require("uniq");function innerFill(order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0,i,j;for(i=0;i<dimension;++i){vars.push(["i",i,"=0"].join(""))}for(j=0;j<nargs;++j){for(i=0;i<dimension;++i){pidx=idx;idx=order[i];if(i===0){vars.push(["d",j,"s",i,"=t",j,"[",idx,"]"].join(""))}else{vars.push(["d",j,"s",i,"=(t",j,"[",idx,"]-s",pidx,"*t",j,"[",pidx,"])"].join(""))}}}code.push("var "+vars.join(","));for(i=dimension-1;i>=0;--i){idx=order[i];code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""))}code.push(body);for(i=0;i<dimension;++i){pidx=idx;idx=order[i];for(j=0;j<nargs;++j){code.push(["p",j,"+=d",j,"s",i].join(""))}if(has_index){if(i>0){code.push(["index[",pidx,"]-=s",pidx].join(""))}code.push(["++index[",idx,"]"].join(""))}code.push("}")}return code.join("\n")}function outerFill(matched,order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[];for(var i=0;i<nargs;++i){code.push(["var offset",i,"=p",i].join(""))}for(var i=matched;i<dimension;++i){code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join(""));code.push(["if(j",i,"<",blockSize,"){"].join(""));code.push(["s",order[i],"=j",i].join(""));code.push(["j",i,"=0"].join(""));code.push(["}else{s",order[i],"=",blockSize].join(""));code.push(["j",i,"-=",blockSize,"}"].join(""));if(has_index){code.push(["index[",order[i],"]=j",i].join(""))}}for(var i=0;i<nargs;++i){var indexStr=["offset"+i];for(var j=matched;j<dimension;++j){indexStr.push(["j",j,"*t",i,"[",order[j],"]"].join(""))}code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}code.push(innerFill(order,proc,body));for(var i=matched;i<dimension;++i){code.push("}")}return code.join("\n")}function countMatches(orders){var matched=0,dimension=orders[0].length;while(matched<dimension){for(var j=1;j<orders.length;++j){if(orders[j][matched]!==orders[0][matched]){return matched}}++matched}return matched}function processBlock(block,proc,dtypes){var code=block.body;var pre=[];var post=[];for(var i=0;i<block.args.length;++i){var carg=block.args[i];if(carg.count<=0){continue}var re=new RegExp(carg.name,"g");var ptrStr="";var arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case"offset":var offArgIndex=proc.offsetArgIndex.indexOf(i);var offArg=proc.offsetArgs[offArgIndex];arrNum=offArg.array;ptrStr="+q"+offArgIndex;case"array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i;var arrStr="a"+arrNum;if(carg.count===1){if(dtypes[arrNum]==="generic"){if(carg.lvalue){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}else{code=code.replace(re,[arrStr,".get(",ptrStr,")"].join(""))}}else{code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}}else if(dtypes[arrNum]==="generic"){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);if(carg.lvalue){post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}}else{pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join(""));code=code.replace(re,localStr);if(carg.lvalue){post.push([arrStr,"[",ptrStr,"]=",localStr].join(""))}}break;case"scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case"index":code=code.replace(re,"index");break;case"shape":code=code.replace(re,"shape");break}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}function typeSummary(dtypes){var summary=new Array(dtypes.length);var allEqual=true;for(var i=0;i<dtypes.length;++i){var t=dtypes[i];var digits=t.match(/\d+/);if(!digits){digits=""}else{digits=digits[0]}if(t.charAt(0)===0){summary[i]="u"+t.charAt(1)+digits}else{summary[i]=t.charAt(0)+digits}if(i>0){allEqual=allEqual&&summary[i]===summary[i-1]}}if(allEqual){return summary[0]}return summary.join("")}function generateCWiseOp(proc,typesig){var dimension=typesig[1].length|0;var orders=new Array(proc.arrayArgs.length);var dtypes=new Array(proc.arrayArgs.length);var arglist=["SS"];var code=["'use strict'"];var vars=[];for(var j=0;j<dimension;++j){vars.push(["s",j,"=SS[",j,"]"].join(""))}for(var i=0;i<proc.arrayArgs.length;++i){arglist.push("a"+i);arglist.push("t"+i);arglist.push("p"+i);dtypes[i]=typesig[2*i];orders[i]=typesig[2*i+1]}for(var i=0;i<proc.scalarArgs.length;++i){arglist.push("Y"+i)}if(proc.shapeArgs.length>0){vars.push("shape=SS.slice(0)")}if(proc.indexArgs.length>0){var zeros=new Array(dimension);for(var i=0;i<dimension;++i){zeros[i]="0"}vars.push(["index=[",zeros.join(","),"]"].join(""))}for(var i=0;i<proc.offsetArgs.length;++i){var off_arg=proc.offsetArgs[i];var init_string=[];for(var j=0;j<off_arg.offset.length;++j){if(off_arg.offset[j]===0){continue}else if(off_arg.offset[j]===1){init_string.push(["t",off_arg.array,"[",j,"]"].join(""))}else{init_string.push([off_arg.offset[j],"*t",off_arg.array,"[",j,"]"].join(""))}}if(init_string.length===0){vars.push("q"+i+"=0")}else{vars.push(["q",i,"=(",init_string.join("+"),")|0"].join(""))}}var thisVars=uniq([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));vars=vars.concat(thisVars);code.push("var "+vars.join(","));for(var i=0;i<proc.arrayArgs.length;++i){code.push("p"+i+"|=0")}if(proc.pre.body.length>3){code.push(processBlock(proc.pre,proc,dtypes))}var body=processBlock(proc.body,proc,dtypes);var matched=countMatches(orders);if(matched<dimension){code.push(outerFill(matched,orders[0],proc,body))}else{code.push(innerFill(orders[0],proc,body))}if(proc.post.body.length>3){code.push(processBlock(proc.post,proc,dtypes))}if(proc.debug){console.log("Generated cwise routine for ",typesig,":\n\n",code.join("\n"))}var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,typeSummary(dtypes)].join("");var f=new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""));return f()}module.exports=generateCWiseOp},{uniq:411}],410:[function(require,module,exports){arguments[4][105][0].apply(exports,arguments)},{"./compile.js":409,"/var/www/streambed/gl3d/node_modules/gl-axes/node_modules/vectorize-text/node_modules/surface-nets/node_modules/zero-crossings/node_modules/cwise-compiler/lib/thunk.js":105}],411:[function(require,module,exports){"use strict";function unique_pred(list,compare){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i){b=a;a=list[i];if(compare(a,b)){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique_eq(list){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i,b=a){b=a;a=list[i];if(a!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique(list,compare,sorted){if(list.length===0){return[]}if(compare){if(!sorted){list.sort(compare)}return unique_pred(list,compare)}if(!sorted){list.sort()}return unique_eq(list)}module.exports=unique},{}],412:[function(require,module,exports){(function(Buffer){var iota=require("iota-array");var arrayMethods=["concat","join","slice","toString","indexOf","lastIndexOf","forEach","every","some","filter","map","reduce","reduceRight"];var hasTypedArrays=typeof Float64Array!=="undefined";var hasBuffer=typeof Buffer!=="undefined";function compare1st(a,b){return a[0]-b[0]}function order(){var stride=this.stride;var terms=new Array(stride.length);var i;for(i=0;i<terms.length;++i){terms[i]=[Math.abs(stride[i]),i]}terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i){result[i]=terms[i][1]}return result}function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");if(dimension<0){className="View_Nil"+dtype}var useGetters=dtype==="generic";if(dimension===-1){var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+className+"(a){return new "+className+"(a);}";var procedure=new Function(code);return procedure()}else if(dimension===0){var code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}";var procedure=new Function("TrivialArray",code);return procedure(CACHED_CONSTRUCTORS[dtype][0])}var code=["'use strict'"];var indices=iota(dimension);var args=indices.map(function(i){return"i"+i});var index_str="this.offset+"+indices.map(function(i){return"this._stride"+i+"*i"+i}).join("+");code.push("function "+className+"(a,"+indices.map(function(i){return"b"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",d){this.data=a");for(var i=0;i<dimension;++i){code.push("this._shape"+i+"=b"+i+"|0")}for(var i=0;i<dimension;++i){code.push("this._stride"+i+"=c"+i+"|0")}code.push("this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+dtype+"'","proto.dimension="+dimension);var strideClassName="VStride"+dimension+"d"+dtype;var shapeClassName="VShape"+dimension+"d"+dtype;var props={stride:strideClassName,shape:shapeClassName};for(var prop in props){var arrayName=props[prop];code.push("function "+arrayName+"(v) {this._v=v} var aproto="+arrayName+".prototype","aproto.length="+dimension);var array_elements=[];for(var i=0;i<dimension;++i){array_elements.push(["this._v._",prop,i].join(""))}code.push("aproto.toJSON=function "+arrayName+"_toJSON(){return ["+array_elements.join(",")+"]}","aproto.valueOf=aproto.toString=function "+arrayName+"_toString(){return ["+array_elements.join(",")+"].join()}");for(var i=0;i<dimension;++i){code.push("Object.defineProperty(aproto,"+i+",{get:function(){return this._v._"+prop+i+"},set:function(v){return this._v._"+prop+i+"=v|0},enumerable:true})")}for(var i=0;i<arrayMethods.length;++i){if(arrayMethods[i]in Array.prototype){code.push("aproto."+arrayMethods[i]+"=Array.prototype."+arrayMethods[i])}}code.push(["Object.defineProperty(proto,'",prop,"',{get:function ",arrayName,"_get(){return new ",arrayName,"(this)},set: function ",arrayName,"_set(v){"].join(""));for(var i=0;i<dimension;++i){code.push("this._"+prop+i+"=v["+i+"]|0")}code.push("return v}})")}code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map(function(i){return"this._shape"+i}).join("*"),"}})");if(dimension===1){code.push("proto.order=[0]")}else{code.push("Object.defineProperty(proto,'order',{get:");if(dimension<4){code.push("function "+className+"_order(){");if(dimension===2){code.push("return (Math.abs(this._stride0)>Math.abs(this._stride1))?[1,0]:[0,1]}})")}else if(dimension===3){code.push("var s0=Math.abs(this._stride0),s1=Math.abs(this._stride1),s2=Math.abs(this._stride2);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{code.push("ORDER})")}}code.push("proto.set=function "+className+"_set("+args.join(",")+",v){");if(useGetters){code.push("return this.data.set("+index_str+",v)}")}else{code.push("return this.data["+index_str+"]=v}")}code.push("proto.get=function "+className+"_get("+args.join(",")+"){");if(useGetters){code.push("return this.data.get("+index_str+")}")}else{code.push("return this.data["+index_str+"]}")}code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}");code.push("proto.hi=function "+className+"_hi("+args.join(",")+"){return new "+className+"(this.data,"+indices.map(function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this._shape",i,":i",i,"|0"].join("")}).join(",")+","+indices.map(function(i){return"this._stride"+i}).join(",")+",this.offset)}");var a_vars=indices.map(function(i){return"a"+i+"=this._shape"+i});var c_vars=indices.map(function(i){return"c"+i+"=this._stride"+i});code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));for(var i=0;i<dimension;++i){code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}")}code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",b)}");code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map(function(i){return"a"+i+"=this._shape"+i}).join(",")+","+indices.map(function(i){return"b"+i+"=this._stride"+i}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var i=0;i<dimension;++i){code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}")}code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"b"+i}).join(",")+",c)}");var tShape=new Array(dimension);var tStride=new Array(dimension);for(var i=0;i<dimension;++i){tShape[i]="a[i"+i+"]";tStride[i]="b[i"+i+"]"}code.push("proto.transpose=function "+className+"_transpose("+args+"){"+args.map(function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}");code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(var i=0;i<dimension;++i){code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this._stride"+i+"*i"+i+")|0}else{a.push(this._shape"+i+");b.push(this._stride"+i+")}")}code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map(function(i){return"shape["+i+"]"}).join(",")+","+indices.map(function(i){return"stride["+i+"]"}).join(",")+",offset)}");var procedure=new Function("CTOR_LIST","ORDER",code.join("\n"));return procedure(CACHED_CONSTRUCTORS[dtype],order)}function arrayDType(data){if(hasBuffer){if(Buffer.isBuffer(data)){return"buffer"}}if(hasTypedArrays){switch(Object.prototype.toString.call(data)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}}if(Array.isArray(data)){return"array"}return"generic"}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var id in CACHED_CONSTRUCTORS){CACHED_CONSTRUCTORS[id].push(compileConstructor(id,-1))}});function wrappedNDArrayCtor(data,shape,stride,offset){if(data===undefined){var ctor=CACHED_CONSTRUCTORS.array[0];return ctor([])}else if(typeof data==="number"){data=[data]}if(shape===undefined){shape=[data.length]}var d=shape.length;if(stride===undefined){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i){stride[i]=sz;sz*=shape[i]}}if(offset===undefined){offset=0;for(var i=0;i<d;++i){if(stride[i]<0){offset-=(shape[i]-1)*stride[i]}}}var dtype=arrayDType(data);var ctor_list=CACHED_CONSTRUCTORS[dtype];while(ctor_list.length<=d+1){ctor_list.push(compileConstructor(dtype,ctor_list.length-1))}var ctor=ctor_list[d+1];return ctor(data,shape,stride,offset)}module.exports=wrappedNDArrayCtor}).call(this,require("buffer").Buffer)},{buffer:8,"iota-array":413}],413:[function(require,module,exports){"use strict";function iota(n){var result=new Array(n);for(var i=0;i<n;++i){result[i]=i}return result}module.exports=iota},{}],414:[function(require,module,exports){"use strict";var glm=require("gl-matrix");var vec3=glm.vec3;var mat3=glm.mat3;var mat4=glm.mat4;var quat=glm.quat;var scratch0=new Float32Array(16);var scratch1=new Float32Array(16);function OrbitCamera(rotation,center,distance){this.rotation=rotation;this.center=center;this.distance=distance}var proto=OrbitCamera.prototype;proto.view=function(out){if(!out){out=mat4.create()}scratch1[0]=scratch1[1]=0;scratch1[2]=-this.distance;mat4.fromRotationTranslation(out,quat.conjugate(scratch0,this.rotation),scratch1);mat4.translate(out,out,vec3.negate(scratch0,this.center));return out};proto.lookAt=function(eye,center,up){mat4.lookAt(scratch0,eye,center,up);mat3.fromMat4(scratch0,scratch0);quat.fromMat3(this.rotation,scratch0);vec3.copy(this.center,center);this.distance=vec3.distance(eye,center)};proto.pan=function(dpan){var d=this.distance;scratch0[0]=-d*(dpan[0]||0);scratch0[1]=d*(dpan[1]||0);scratch0[2]=d*(dpan[2]||0);vec3.transformQuat(scratch0,scratch0,this.rotation);vec3.add(this.center,this.center,scratch0)};proto.zoom=function(d){this.distance+=d;if(this.distance<0){this.distance=0}};function quatFromVec(out,da){var x=da[0];var y=da[1];var z=da[2];var s=x*x+y*y;if(s>1){s=1}out[0]=-da[0];out[1]=da[1];out[2]=da[2]||Math.sqrt(1-s);out[3]=0}proto.rotate=function(da,db){quatFromVec(scratch0,da);quatFromVec(scratch1,db);quat.invert(scratch1,scratch1);quat.multiply(scratch0,scratch0,scratch1);if(quat.length(scratch0)<1e-6){return}quat.multiply(this.rotation,this.rotation,scratch0);quat.normalize(this.rotation,this.rotation)};function createOrbitCamera(eye,target,up){eye=eye||[0,0,-1];target=target||[0,0,0];up=up||[0,1,0];var camera=new OrbitCamera(quat.create(),vec3.create(),1);camera.lookAt(eye,target,up);return camera}module.exports=createOrbitCamera},{"gl-matrix":173}],415:[function(require,module,exports){(function(){var trimLeft=/^[\s,#]+/,trimRight=/\s+$/,tinyCounter=0,math=Math,mathRound=math.round,mathMin=math.min,mathMax=math.max,mathRandom=math.random;var tinycolor=function tinycolor(color,opts){color=color?color:"";opts=opts||{};if(color instanceof tinycolor){return color}if(!(this instanceof tinycolor)){return new tinycolor(color,opts)}var rgb=inputToRGB(color);this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format;this._gradientType=opts.gradientType;if(this._r<1){this._r=mathRound(this._r)}if(this._g<1){this._g=mathRound(this._g)}if(this._b<1){this._b=mathRound(this._b)}this._ok=rgb.ok;this._tc_id=tinyCounter++};tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(rgb.r*299+rgb.g*587+rgb.b*114)/1e3},setAlpha:function(value){this._a=boundAlpha(value);this._roundA=mathRound(100*this._a)/100;return this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:hsv.h*360,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b);var h=mathRound(hsv.h*360),s=mathRound(hsv.s*100),v=mathRound(hsv.v*100);return this._a==1?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:hsl.h*360,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b);var h=mathRound(hsl.h*360),s=mathRound(hsl.s*100),l=mathRound(hsl.l*100);return this._a==1?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(){return rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(bound01(this._r,255)*100)+"%",g:mathRound(bound01(this._g,255)*100)+"%",b:mathRound(bound01(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+mathRound(bound01(this._r,255)*100)+"%, "+mathRound(bound01(this._g,255)*100)+"%, "+mathRound(bound01(this._b,255)*100)+"%)":"rgba("+mathRound(bound01(this._r,255)*100)+"%, "+mathRound(bound01(this._g,255)*100)+"%, "+mathRound(bound01(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return hexNames[rgbToHex(this._r,this._g,this._b,true)]||false},toFilter:function(secondColor){var hex8String="#"+rgbaToHex(this._r,this._g,this._b,this._a);var secondHex8String=hex8String;var gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String=s.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=false;var hasAlpha=this._a<1&&this._a>=0;var needsAlphaFormat=!formatSet&&hasAlpha&&(format==="hex"||format==="hex6"||format==="hex3"||format==="name");if(needsAlphaFormat){if(format==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(format==="rgb"){formattedString=this.toRgbString()}if(format==="prgb"){formattedString=this.toPercentageRgbString()}if(format==="hex"||format==="hex6"){formattedString=this.toHexString()}if(format==="hex3"){formattedString=this.toHexString(true)}if(format==="hex8"){formattedString=this.toHex8String()}if(format==="name"){formattedString=this.toName()}if(format==="hsl"){formattedString=this.toHslString()}if(format==="hsv"){formattedString=this.toHsvString()}return formattedString||this.toHexString()},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));this._r=color._r;this._g=color._g;this._b=color._b;this.setAlpha(color._a);return this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}};tinycolor.fromRatio=function(color,opts){if(typeof color=="object"){var newColor={};for(var i in color){if(color.hasOwnProperty(i)){if(i==="a"){newColor[i]=color[i]}else{newColor[i]=convertToPercentage(color[i])}}}color=newColor}return tinycolor(color,opts)};function inputToRGB(color){var rgb={r:0,g:0,b:0};var a=1;var ok=false;var format=false;if(typeof color=="string"){color=stringInputToObject(color)}if(typeof color=="object"){if(color.hasOwnProperty("r")&&color.hasOwnProperty("g")&&color.hasOwnProperty("b")){rgb=rgbToRgb(color.r,color.g,color.b);ok=true;format=String(color.r).substr(-1)==="%"?"prgb":"rgb"}else if(color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("v")){color.s=convertToPercentage(color.s);color.v=convertToPercentage(color.v);rgb=hsvToRgb(color.h,color.s,color.v);ok=true;format="hsv"}else if(color.hasOwnProperty("h")&&color.hasOwnProperty("s")&&color.hasOwnProperty("l")){color.s=convertToPercentage(color.s);color.l=convertToPercentage(color.l);rgb=hslToRgb(color.h,color.s,color.l);ok=true;format="hsl"}if(color.hasOwnProperty("a")){a=color.a}}a=boundAlpha(a);return{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:bound01(r,255)*255,g:bound01(g,255)*255,b:bound01(b,255)*255}}function rgbToHsl(r,g,b){r=bound01(r,255);g=bound01(g,255);b=bound01(b,255);var max=mathMax(r,g,b),min=mathMin(r,g,b);var h,s,l=(max+min)/2;if(max==min){h=s=0}else{var d=max-min;s=l>.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){var r,g,b;h=bound01(h,360);s=bound01(s,100);l=bound01(l,100);function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p}if(s===0){r=g=b=l}else{var q=l<.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3)}return{r:r*255,g:g*255,b:b*255}}function rgbToHsv(r,g,b){r=bound01(r,255);g=bound01(g,255);b=bound01(b,255);var max=mathMax(r,g,b),min=mathMin(r,g,b);var h,s,v=max;var d=max-min;s=max===0?0:d/max;if(max==min){h=0}else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=bound01(h,360)*6;s=bound01(s,100);v=bound01(v,100);var i=math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:r*255,g:g*255,b:b*255}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];if(allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)){return hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0)}return hex.join("")}function rgbaToHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("")}tinycolor.equals=function(color1,color2){if(!color1||!color2){return false}return tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()};tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})};function desaturate(color,amount){amount=amount===0?0:amount||10;var hsl=tinycolor(color).toHsl();hsl.s-=amount/100;hsl.s=clamp01(hsl.s);return tinycolor(hsl)}function saturate(color,amount){amount=amount===0?0:amount||10;var hsl=tinycolor(color).toHsl();hsl.s+=amount/100;hsl.s=clamp01(hsl.s);return tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=amount===0?0:amount||10;var hsl=tinycolor(color).toHsl();hsl.l+=amount/100;hsl.l=clamp01(hsl.l);return tinycolor(hsl)}function brighten(color,amount){amount=amount===0?0:amount||10;var rgb=tinycolor(color).toRgb();rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(255*-(amount/100))));rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(255*-(amount/100))));rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(255*-(amount/100))));return tinycolor(rgb)}function darken(color,amount){amount=amount===0?0:amount||10;var hsl=tinycolor(color).toHsl();hsl.l-=amount/100;hsl.l=clamp01(hsl.l);return tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl();var hue=(mathRound(hsl.h)+amount)%360;hsl.h=hue<0?360+hue:hue;return tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();hsl.h=(hsl.h+180)%360;return tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl();var h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl();var h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl();var h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6;slices=slices||30;var hsl=tinycolor(color).toHsl();var part=360/slices;var ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;){hsl.h=(hsl.h+part)%360;ret.push(tinycolor(hsl))}return ret}function monochromatic(color,results){results=results||6;var hsv=tinycolor(color).toHsv();var h=hsv.h,s=hsv.s,v=hsv.v;var ret=[];var modification=1/results;while(results--){ret.push(tinycolor({h:h,s:s,v:v}));v=(v+modification)%1}return ret}tinycolor.mix=function(color1,color2,amount){amount=amount===0?0:amount||50;var rgb1=tinycolor(color1).toRgb();var rgb2=tinycolor(color2).toRgb();var p=amount/100;var w=p*2-1;var a=rgb2.a-rgb1.a;var w1;if(w*a==-1){w1=w}else{w1=(w+a)/(1+w*a)}w1=(w1+1)/2;var w2=1-w1;var rgba={r:rgb2.r*w1+rgb1.r*w2,g:rgb2.g*w1+rgb1.g*w2,b:rgb2.b*w1+rgb1.b*w2,a:rgb2.a*p+rgb1.a*(1-p)};return tinycolor(rgba)};tinycolor.readability=function(color1,color2){var c1=tinycolor(color1);var c2=tinycolor(color2);var rgb1=c1.toRgb();var rgb2=c2.toRgb();var brightnessA=c1.getBrightness();var brightnessB=c2.getBrightness();var colorDiff=Math.max(rgb1.r,rgb2.r)-Math.min(rgb1.r,rgb2.r)+Math.max(rgb1.g,rgb2.g)-Math.min(rgb1.g,rgb2.g)+Math.max(rgb1.b,rgb2.b)-Math.min(rgb1.b,rgb2.b);return{brightness:Math.abs(brightnessA-brightnessB),color:colorDiff}};tinycolor.isReadable=function(color1,color2){var readability=tinycolor.readability(color1,color2);return readability.brightness>125&&readability.color>500};tinycolor.mostReadable=function(baseColor,colorList){var bestColor=null;var bestScore=0;var bestIsReadable=false;for(var i=0;i<colorList.length;i++){var readability=tinycolor.readability(baseColor,colorList[i]);var readable=readability.brightness>125&&readability.color>500;var score=3*(readability.brightness/125)+readability.color/500;if(readable&&!bestIsReadable||readable&&bestIsReadable&&score>bestScore||!readable&&!bestIsReadable&&score>bestScore){bestIsReadable=readable;bestScore=score;bestColor=tinycolor(colorList[i])}}return bestColor};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var hexNames=tinycolor.hexNames=flip(names);function flip(o){var flipped={};for(var i in o){if(o.hasOwnProperty(i)){flipped[o[i]]=i}}return flipped}function boundAlpha(a){a=parseFloat(a);if(isNaN(a)||a<0||a>1){a=1}return a}function bound01(n,max){if(isOnePointZero(n)){n="100%"}var processPercent=isPercentage(n);n=mathMin(max,mathMax(0,parseFloat(n)));if(processPercent){n=parseInt(n*max,10)/100}if(math.abs(n-max)<1e-6){return 1}return n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function isPercentage(n){return typeof n==="string"&&n.indexOf("%")!=-1}function pad2(c){return c.length==1?"0"+c:""+c}function convertToPercentage(n){if(n<=1){n=n*100+"%"}return n}function convertDecimalToHex(d){return Math.round(parseFloat(d)*255).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}var matchers=function(){var CSS_INTEGER="[-\\+]?\\d+%?";var CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?";var CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")";var PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";var PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=false;if(names[color]){color=names[color];named=true}else if(color=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var match;if(match=matchers.rgb.exec(color)){return{r:match[1],g:match[2],b:match[3]}}if(match=matchers.rgba.exec(color)){return{r:match[1],g:match[2],b:match[3],a:match[4]}}if(match=matchers.hsl.exec(color)){return{h:match[1],s:match[2],l:match[3]}}if(match=matchers.hsla.exec(color)){return{h:match[1],s:match[2],l:match[3],a:match[4]}}if(match=matchers.hsv.exec(color)){return{h:match[1],s:match[2],v:match[3]}}if(match=matchers.hex8.exec(color)){return{a:convertHexToDecimal(match[1]),r:parseIntFromHex(match[2]),g:parseIntFromHex(match[3]),b:parseIntFromHex(match[4]),format:named?"name":"hex8"}}if(match=matchers.hex6.exec(color)){return{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}}if(match=matchers.hex3.exec(color)){return{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}}return false}if(typeof module!=="undefined"&&module.exports){module.exports=tinycolor}else if(typeof define==="function"&&define.amd){define(function(){return tinycolor})}else{window.tinycolor=tinycolor}})()},{}],416:[function(require,module,exports){"use strict";module.exports=project;function xformMatrix(m,v){var out=[0,0,0,0],i,j;for(i=0;i<4;++i){for(j=0;j<4;++j){out[j]+=m[4*i+j]*v[i]}}return out}function project(camera,v){var p=xformMatrix(camera.projection,xformMatrix(camera.view,xformMatrix(camera.model,[v[0],v[1],v[2],1])));return p}},{}],417:[function(require,module,exports){"use strict";var createScatterLine=require("./line-with-markers"),tinycolor=require("tinycolor2"),arrtools=require("arraytools"),calculateError=require("./calc-errors");function Scatter3D(config){this.config=config}module.exports=Scatter3D;var proto=Scatter3D.prototype;proto.attributes={x:{type:"data_array"},y:{type:"data_array"},z:{type:"data_array"},text:{from:"Scatter"},surfaceaxis:{type:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{type:"color"},projection:{x:{show:{type:"boolean",dflt:false},opacity:{type:"number",min:0,max:1,dflt:1},scale:{type:"number",min:0,max:10,dflt:2/3}},y:{show:{type:"boolean",dflt:false},opacity:{type:"number",min:0,max:1,dflt:1},scale:{type:"number",min:0,max:10,dflt:2/3}},z:{show:{type:"boolean",dflt:false},opacity:{type:"number",min:0,max:1,dflt:1},scale:{type:"number",min:0,max:10,dflt:2/3}}},mode:{from:"Scatter"},line:{color:{from:"Scatter"},width:{from:"Scatter"},dash:{from:"Scatter"}},marker:{symbol:{from:"Scatter"},size:{from:"Scatter"},opacity:{from:"Scatter"},line:{color:{from:"Scatter"},width:{from:"Scatter"}}},textposition:{from:"Scatter"},textfont:{from:"Scatter"}};proto.supplyXYZ=function(traceIn,traceOut){var _this=this;var Plotly=this.config.Plotly;function coerce(attr,dflt){return Plotly.Lib.coerce(traceIn,traceOut,_this.attributes,attr,dflt)}var len=0,x=coerce("x"),y=coerce("y"),z=coerce("z");if(x&&y&&z){len=Math.min(x.length,y.length,z.length);if(len<x.length)traceOut.x=x.slice(0,len);if(len<y.length)traceOut.y=y.slice(0,len);if(len<z.length)traceOut.z=z.slice(0,len)}return len};proto.supplyDefaults=function(traceIn,traceOut,defaultColor,layout){var _this=this;var Plotly=this.config.Plotly;var Scatter=Plotly.Scatter;var linecolor,markercolor;function coerce(attr,dflt){return Plotly.Lib.coerce(traceIn,traceOut,_this.attributes,attr,dflt)}function coerceScatter(attr,dflt){return Plotly.Lib.coerce(traceIn,traceOut,Scatter.attributes,attr,dflt)}this.supplyXYZ(traceIn,traceOut);if(coerceScatter("text"))coerceScatter("mode","lines+markers+text");else coerceScatter("mode","lines+markers");if(Scatter.hasLines(traceOut)){linecolor=coerceScatter("line.color",(traceIn.marker||{}).color||defaultColor);coerceScatter("line.width");coerceScatter("line.dash")}if(Scatter.hasMarkers(traceOut)){markercolor=coerceScatter("marker.color",defaultColor);coerceScatter("marker.symbol");coerceScatter("marker.size",8);coerceScatter("marker.opacity",1);coerceScatter("marker.line.width",0);coerceScatter("marker.line.color","rgb(0,0,0)")}if(Scatter.hasText(traceOut)){coerceScatter("textposition","top center");coerceScatter("textfont",layout.font)}if(coerce("surfaceaxis")>=0)coerce("surfacecolor",linecolor||markercolor);var dims=["x","y","z"];for(var i=0;i<3;++i){var projection="projection."+dims[i];if(coerce(projection+".show")){coerce("projection.x.opacity");coerce("projection.x.scale");coerce(projection+".opacity");coerce(projection+".scale")}}Plotly.ErrorBars.supplyDefaults(traceIn,traceOut,defaultColor,{axis:"z"});Plotly.ErrorBars.supplyDefaults(traceIn,traceOut,defaultColor,{axis:"y",inherit:"z"});Plotly.ErrorBars.supplyDefaults(traceIn,traceOut,defaultColor,{axis:"x",inherit:"z"})};function isTrue(bool){return bool}function calculateErrorParams(errors){var capSize=[0,0,0],i,e;var color=[[0,0,0],[0,0,0],[0,0,0]];var lineWidth=[0,0,0];for(i=0;i<3;++i){e=errors[i];if(e&&e.copy_zstyle!==false){e=errors[2]}if(!e)continue;capSize[i]=e.width/100;color[i]=str2RgbaArray(e.color);lineWidth=e.thickness}return{capSize:capSize,color:color,lineWidth:lineWidth}}function calculateTextOffset(textposition){var textOffset=[0,0];if(textposition.indexOf("bottom")>=0){textOffset[1]+=1}if(textposition.indexOf("top")>=0){textOffset[1]-=1}if(textposition.indexOf("left")>=0){textOffset[0]-=1}if(textposition.indexOf("right")>=0){textOffset[0]+=1}return textOffset}function str2RgbaArray(color){color=tinycolor(color);return arrtools.str2RgbaArray(color.toRgbString())}function colorFormatter(colorIn,opacityIn){var colorOut=null,colorLength=colorIn.length;if(Array.isArray(colorIn)){colorOut=[];for(var i=0;i<colorLength;++i){colorOut[i]=str2RgbaArray(colorIn[i]);colorOut[i][3]*=opacityIn}}else{colorOut=str2RgbaArray(colorIn);colorOut[3]*=opacityIn}return colorOut}function sizeScaler(sizeIn){var sizeOut=null;function scale(size){return size*2}if(Array.isArray(sizeIn)){sizeOut=sizeIn.map(scale)}else{sizeOut=scale(sizeIn)}return sizeOut}proto.update=function update(scene,sceneLayout,data,scatter){var params,i,points=[],xaxis=sceneLayout.xaxis,yaxis=sceneLayout.yaxis,zaxis=sceneLayout.zaxis,errorParams=calculateErrorParams([data.error_x,data.error_y,data.error_z]),xc,x=data.x,yc,y=data.y,zc,z=data.z,len=x.length;for(i=0;i<len;i++){xc=xaxis.d2l(x[i]);yc=yaxis.d2l(y[i]);zc=zaxis.d2l(z[i]);points[i]=[xc,yc,zc]}params={position:points,mode:data.mode};if("line"in data){params.lineColor=str2RgbaArray(data.line.color);params.lineWidth=data.line.width;params.lineDashes=data.line.dash}if("marker"in data){params.scatterColor=colorFormatter(data.marker.color,data.marker.opacity);params.scatterSize=sizeScaler(data.marker.size);params.scatterMarker=this.markerSymbols[data.marker.symbol];params.scatterLineWidth=data.marker.line.width;params.scatterLineColor=str2RgbaArray(data.marker.line.color);params.scatterLineColor[3]*=data.marker.opacity;params.scatterAngle=0}if("textposition"in data){params.text=data.text;params.textOffset=calculateTextOffset(data.textposition);params.textColor=str2RgbaArray(data.textfont.color);params.textSize=data.textfont.size;params.textFont=data.textfont.family;params.textAngle=0}var dims=["x","y","z"];params.project=[];for(i=0;i<3;++i){var projection=data.projection[dims[i]];if(params.project[i]=projection.show){params.projectOpacity=data.projection.x.opacity;params.projectScale=data.projection.x.scale}}params.errorBounds=calculateError(data);params.errorColor=errorParams.color;params.errorLineWidth=errorParams.lineWidth;params.errorCapSize=errorParams.capSize;params.delaunayAxis=data.surfaceaxis;params.delaunayColor=str2RgbaArray(data.surfacecolor);if(scatter)scatter.update(params);else{var pickIds=scene.allocIds(4);params.pickId0=pickIds.ids[0];params.pickId1=pickIds.ids[1];params.pickId2=pickIds.ids[2];params.pickId3=pickIds.ids[3];scatter=createScatterLine(scene.shell.gl,params);scatter.groupId=pickIds.group;scatter.plotlyType=data.type}scatter.uid=data.uid;return scatter};proto.markerSymbols={circle:"●","circle-open":"○",square:"■","square-open":"□",diamond:"◆","diamond-open":"◇",cross:"+",x:"❌"}},{"./calc-errors":1,"./line-with-markers":6,arraytools:7,tinycolor2:415}],418:[function(require,module,exports){"use strict";var createOrbitCamera=require("orbit-camera");function attachCamera(shell,scene){var camera=createOrbitCamera();shell.on("tick",function(){if(!camera.keyBindingMode)camera.keyBindingMode="rotate";var rotate=camera.keyBindingMode==="rotate";var pan=camera.keyBindingMode==="pan";var zoom=camera.keyBindingMode==="zoom";var ctrl=shell.down("control");var alt=shell.down("alt");var shift=shell.down("shift");var left=shell.down("mouse-left");var right=shell.down("mouse-right");var middle=shell.down("mouse-middle");if(rotate&&left&&!ctrl&&!alt&&!shift||left&&!ctrl&&!alt&&shift){camera.rotate([shell.mouseX/shell.width-.5,shell.mouseY/shell.height-.5],[shell.prevMouseX/shell.width-.5,shell.prevMouseY/shell.height-.5]);scene.dirty=true}if(pan&&left&&!ctrl&&!alt&&!shift||right||left&&ctrl&&!alt&&!shift){scene.dirty=true;camera.pan([(shell.mouseX-shell.prevMouseX)/shell.width,(shell.mouseY-shell.prevMouseY)/shell.height])}if(shell.scroll[1]){camera.distance*=Math.exp(shell.scroll[1]/shell.height);scene.dirty=true}if(zoom&&left&&!ctrl&&!alt&&!shift||middle||left&&!ctrl&&alt&&!shift){var d=shell.mouseY-shell.prevMouseY;if(d){camera.distance*=Math.exp(d/shell.height)}scene.dirty=true}var moving=ctrl||alt||shift||left||right||middle;if(!moving&&scene.moving){scene.dirty=true;scene.selectDirty=true}scene.moving=moving});return camera}module.exports=attachCamera},{"orbit-camera":414}],419:[function(require,module,exports){"use strict";var Scene=require("./scene.js"),util=require("util"),EventEmitter=require("events").EventEmitter,Gl3dLayout=require("./gl3dlayout"),Gl3dAxes=require("./gl3daxes"),Scatter3D=require("./scatter3d"),Surface=require("./surface");function SceneFrame(){this.ID=0;this.modules=[{module:Gl3dAxes,namespace:"Gl3dAxes"},{module:Gl3dLayout,namespace:"Gl3dLayout"},{module:Scatter3D,namespace:"Scatter3D"},{module:Surface,namespace:"Surface"}]}util.inherits(SceneFrame,EventEmitter);module.exports=new SceneFrame;var proto=SceneFrame.prototype;proto.setFramePosition=function(container,viewport){container.style.position="absolute";container.style.left=viewport.left+"px";container.style.top=viewport.top+"px";container.style.width=viewport.width+"px";container.style.height=viewport.height+"px"};proto.createScene=function(opts){opts=opts||{};var container=opts.container||document.body;var newIframe=document.createElement("iframe");var glOptions=opts.glOptions||{};var _this=this;newIframe.width=opts.width||"100%";newIframe.height=opts.height||"100%";newIframe.style.zIndex=""+(opts.zIndex||"1000");newIframe.frameBorder="0";newIframe.src=opts.baseurl+"/glcontext.html";newIframe.id=opts.id||"scene-"+this.ID;this.ID++;container.appendChild(newIframe);newIframe.onload=function(){var canvas=document.createElement("canvas");var gl=canvas.getContext("webgl",glOptions)||canvas.getContext("experimental-webgl",glOptions);if(gl){var shell=newIframe.contentWindow.glnow({clearFlags:0,glOptions:glOptions,tickRate:3});shell.preventDefaults=true;shell.stopPropagation=true;shell.once("gl-init",function(){opts.container=newIframe;var scene=new Scene(opts,shell);_this.emit("scene-loaded",scene)})}else{opts.container=newIframe;var scene=new Scene(opts,null);newIframe.contentDocument.getElementById("no3D").style.display="block";_this.emit("scene-error",scene)}canvas=null;gl=null}}},{"./gl3daxes":4,"./gl3dlayout":5,"./scatter3d":417,"./scene.js":420,"./surface":421,events:12,util:16}],420:[function(require,module,exports){"use strict";var camera=require("./scene-camera"),glm=require("gl-matrix"),createAxes=require("gl-axes"),getAxesPixelRange=require("gl-axes/properties"),arrtools=require("arraytools"),createSelect=require("gl-select-static"),createSpikes=require("gl-spikes"),pixelLength=require("./compute-tick-length"),project=require("./project"),tinycolor=require("tinycolor2"),arrayCopy1D=arrtools.copy1D,arrayCopy2D=arrtools.copy2D,mat4=glm.mat4,proto;function str2RgbaArray(color){color=tinycolor(color);return arrtools.str2RgbaArray(color.toRgbString())}function ticksChanged(ticksA,ticksB){var nticks;for(var i=0;i<3;++i){if(ticksA[i].length!==ticksB[i].length)return true;nticks=Math.min(ticksA[i].length,ticksB[i].length);if(nticks===0)continue;for(var j=0;j<nticks;j++){if(ticksA[i][j].x!==ticksB[i][j].x||ticksA[i][j].text!==ticksB[i][j].text){return true}}}return false}function Scene(options,shell){if(!(this instanceof Scene))return new Scene(shell);this.shell=shell;this.container=options.container||null;this.renderQueue=[];this.glDataMap={};if(!this.shell){return void 0}this.dirty=true;this.selectDirty=true;this.moving=false;this.camera=camera(shell,this);this.axis=null;this.id=options.id;this.Plotly=options.Plotly;this.selectBuffers=[];this.pickRadius=10;this.objectCount=0;this.baseRange=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.range=[[0,0,0],[6,6,6]];this.axesOpts={};this.axesOpts.bounds=[[-10,-10,-10],[10,10,10]];this.axesOpts.ticks=[[],[],[]];this.axesOpts.tickEnable=[true,true,true];this.axesOpts.tickFont=["sans-serif","sans-serif","sans-serif"];this.axesOpts.tickSize=[12,12,12];this.axesOpts.tickAngle=[0,0,0];this.axesOpts.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.axesOpts.tickPad=[18,18,18];this.axesOpts.labels=["x","y","z"];this.axesOpts.labelEnable=[true,true,true];this.axesOpts.labelFont=["Open Sans","Open Sans","Open Sans"];this.axesOpts.labelSize=[20,20,20];this.axesOpts.labelAngle=[0,0,0];this.axesOpts.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.axesOpts.labelPad=[30,30,30];this.axesOpts.lineEnable=[true,true,true];this.axesOpts.lineMirror=[false,false,false];this.axesOpts.lineWidth=[1,1,1];this.axesOpts.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.axesOpts.lineTickEnable=[true,true,true];this.axesOpts.lineTickMirror=[false,false,false];this.axesOpts.lineTickLength=[10,10,10];this.axesOpts.lineTickWidth=[1,1,1];this.axesOpts.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.axesOpts.gridEnable=[true,true,true];this.axesOpts.gridWidth=[1,1,1];this.axesOpts.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.axesOpts.zeroEnable=[true,true,true];this.axesOpts.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.axesOpts.zeroLineWidth=[2,2,2];this.axesOpts.backgroundEnable=[false,false,false];this.axesOpts.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this.axesOpts._defaultTickPad=arrayCopy1D(this.axesOpts.tickPad);this.axesOpts._defaultLabelPad=arrayCopy1D(this.axesOpts.labelPad);this.axesOpts._defaultLineTickLength=arrayCopy1D(this.axesOpts.lineTickLength);this.axisSpikes=null;this.spikeEnable=true;this.spikeProperties={enable:[true,true,true],colors:[[0,0,0,1],[0,0,0,1],[0,0,0,1]],sides:[true,true,true],width:[1,1,1]};this.axesNames=["xaxis","yaxis","zaxis"];this.model=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.defaultView=[1.25,1.25,1.25,0,0,0,0,0,1];this.setCameraToDefault();this.cameraPositionDefault=this.getCameraPosition();this.selection=null;if(options.sceneLayout)this.plot(options.sceneLayout,null);shell.on("gl-render",this.onRender.bind(this));shell.on("tick",this.onTick.bind(this));var self=this;shell.on("resize",function(){self.dirty=true;self.selectDirty=true});return void 0}module.exports=Scene;proto=Scene.prototype;proto.groupCount=function(){if(this.objectCount===0){return 0}return((this.objectCount-1)/255|0)+1};proto.allocIds=function(count){var prevGroup=(this.objectCount-1)/255|0;var nextGroup=(this.objectCount+count-1)/255|0;if(nextGroup!==prevGroup){this.objectCount=nextGroup*255}var result=this.objectCount;this.objectCount+=count;var array=new Array(count);for(var i=0;i<count;++i){array[i]=(result+i)%255}return{group:nextGroup,ids:array}};proto.onTick=function(){if(this.moving){return}var pickResult=this.handlePick(this.shell.mouseX,this.shell.height-this.shell.mouseY);if(!pickResult){if(this.selection){this.dirty=true}}else if(this.selection){var prev=this.selection.mouseCoordinate;var next=pickResult.mouseCoordinate;if(prev[0]!==next[0]||prev[1]!==next[1]){this.dirty=true}}else{this.dirty=true}this.selection=pickResult};proto.handlePick=function(x,y){if(this.moving){return null}if(!this._lastCamera){return null}var cameraParameters=this._lastCamera;var pickResult=null,pickData=null;for(var pass=0;pass<this.selectBuffers.length;++pass){var curResult=this.selectBuffers[pass].query(x,y,this.pickRadius);if(!curResult||pickResult&&curResult.distance>pickResult.distance){continue}for(var i=0;i<this.renderQueue.length;++i){var glObject=this.renderQueue[i];if(glObject.groupId!==pass){continue}var curData=glObject.pick(curResult);if(curData){curData.glObject=glObject;var p=project(cameraParameters,curData.position);curData.zDistance=p[2]/p[3];if(!pickData||pickData.zDistance>curData.zDistance){pickResult=curResult;pickData=curData}}}}if(pickData){var glObject=pickData.glObject;switch(glObject.plotlyType){case"scatter3d":pickData.dataCoordinate=glObject.dataPoints[pickData.index];break;case"surface":pickData.dataCoordinate=[glObject._field[0].get(pickData.index[0],pickData.index[1]),glObject._field[1].get(pickData.index[0],pickData.index[1]),glObject._field[2].get(pickData.index[0],pickData.index[1])];break}var p=project(cameraParameters,pickData.dataCoordinate);pickData.screenCoordinate=[.5*this.shell.width*(1+p[0]/p[3]),.5*this.shell.height*(1-p[1]/p[3])];pickData.mouseCoordinate=pickResult.coord}return pickData};proto.renderPick=function(cameraParameters){if(this.selectBuffers.length<=0){return null}if(!this.selectDirty){return}this.selectDirty=false;var curObject=0;for(var pass=0;pass<this.selectBuffers.length;++pass){var select=this.selectBuffers[pass];select.shape=[this.shell.width,this.shell.height];select.begin();for(var i=0;i<this.renderQueue.length;++i){var glObject=this.renderQueue[i];if(glObject.groupId===pass){glObject.drawPick(cameraParameters)}}select.end()}};proto.onRender=function(){if(!this.dirty){return}this.dirty=false;var cameraParameters={view:this.camera.view(),projection:mat4.perspective(new Array(16),Math.PI/4,this.shell.width/this.shell.height,.1,1e4),model:this.model};this._lastCamera=cameraParameters;if(!this.moving){this.renderPick(cameraParameters)}else{this.pickResult=null}var i,glObject,ticks=[],gl=this.shell.gl,sceneLayout=this.sceneLayout,nticks,autoTickCached,glRange,axes,width=this.shell.width,height=this.shell.height,pickResult;gl.clearColor(this.shell.clearColor[0],this.shell.clearColor[1],this.shell.clearColor[2],this.shell.clearColor[3]);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);var centerPoint=[0,0,0];function solveLength(a,b){for(var i=0;i<3;++i){a[i]=pixelLength(cameraParameters,[width,height],centerPoint,i,b[i])/cameraParameters.model[5*i]}}gl.enable(gl.DEPTH_TEST);pickResult=this.selection;if(this.axis){glRange=getAxesPixelRange(this.axis,cameraParameters,width,height);for(i=0;i<3;++i){axes=sceneLayout[this.axesNames[i]];axes._length=(glRange[i].hi-glRange[i].lo)*glRange[i].pixelsPerDataUnit;if(Math.abs(axes._length)===Infinity){ticks[i]=[]}else{axes.range[0]=glRange[i].lo;axes.range[1]=glRange[i].hi;axes._m=1/glRange[i].pixelsPerDataUnit;autoTickCached=axes.autotick;if(axes.autotick){axes.autotick=false;nticks=axes.nticks||this.Plotly.Lib.constrain(axes._length/40,4,9);this.Plotly.Axes.autoTicks(axes,Math.abs(axes.range[1]-axes.range[0])/nticks)}ticks[i]=this.Plotly.Axes.calcTicks(axes);axes.autotick=autoTickCached}}if(ticksChanged(this.axesOpts.ticks,ticks)){this.axesOpts.ticks=ticks;this.axis.update(this.axesOpts)}for(i=0;i<3;++i){centerPoint[i]=.5*(this.axis.bounds[0][i]+this.axis.bounds[1][i])}solveLength(this.axis.lineTickLength,this.axesOpts._defaultLineTickLength);solveLength(this.axis.tickPad,this.axesOpts._defaultTickPad);solveLength(this.axis.labelPad,this.axesOpts._defaultLabelPad);this.axis.draw(cameraParameters)}for(i=0;i<this.renderQueue.length;++i){glObject=this.renderQueue[i];if(glObject.supportsTransparency&&glObject.plotlyType==="surface")continue;glObject.axesBounds=[this.axis.bounds[0].slice(),this.axis.bounds[1].slice()];glObject.draw(cameraParameters,false)}gl.enable(gl.BLEND);gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);if(pickResult&&this.axisSpikes&&this.spikeEnable){if(!this.moving){this.axisSpikes.update({position:pickResult.dataCoordinate,bounds:this.axis.bounds,colors:this.spikeProperties.colors,drawSides:this.spikeProperties.sides,enabled:this.spikeProperties.enable,lineWidth:this.spikeProperties.width});this.axisSpikes.draw(cameraParameters)}}for(i=0;i<this.renderQueue.length;++i){glObject=this.renderQueue[i];if(glObject.supportsTransparency){glObject.draw(cameraParameters,true)}}gl.disable(gl.BLEND)};proto.plot=function(sceneLayout,data){this.dirty=true;this.selectDirty=true;this.setAndSyncLayout(sceneLayout);for(var i=0;i<3;++i){var axes=sceneLayout[this.axesNames[i]];this.Plotly.Axes.setConvert(axes);axes.setScale=function(){}}if(data){var glObject=this.glDataMap[data.uid]||null;if(data.visible){glObject=data.module.update(this,sceneLayout,data,glObject)}if(!data.visible&&glObject)glObject.visible=data.visible;if(glObject)this.glDataMap[data.uid]=glObject;this.updateRenderQueue(glObject)}this.setAxesRange();this.setModelScale();this.configureAxes();var bufferCount=this.groupCount();while(this.selectBuffers.length<bufferCount){this.selectBuffers.push(createSelect(this.shell.gl,[this.shell.height,this.shell.width]))}if(!this.axisSpikes){this.axisSpikes=createSpikes(this.shell.gl)}};proto.setAndSyncLayout=function setAndSyncLayout(sceneLayout){this.sceneLayout=sceneLayout;if(sceneLayout.bgcolor){this.container.style.background=sceneLayout.bgcolor}this.dirty=true;this.selectDirty=true};proto.updateRenderQueue=function(glObject){if(!glObject)return;var visible=glObject.visible===false?false:true;var idx=this.renderQueue.indexOf(glObject);if(visible&&idx===-1){this.renderQueue.push(glObject)}else if(!visible&&idx>-1){this.renderQueue.splice(idx,1)}return};proto.getCenter=function(){return[(this.range[1][0]+this.range[0][0])/2,(this.range[1][1]+this.range[0][1])/2,(this.range[1][2]+this.range[0][2])/2]};proto.getDefaultPosition=function(mult){var center=this.getCenter(),bounds=this.range,xtarg=center[0],ytarg=center[1],ztarg=center[2],xcam=bounds[0][0]<0?bounds[1][0]:bounds[0][0],ycam=bounds[0][1]<0?bounds[1][1]:bounds[0][1],zcam=bounds[1][2];if(!mult)mult=1;return{eye:[mult*(xcam-xtarg)+xtarg,mult*(ycam-ytarg)+ytarg,mult*(zcam-ztarg)+ztarg],target:[xtarg,ytarg,ztarg]}};proto.setAxesRange=function(){var i,j,bounds,glObj;var axes,range;var sceneLayout=this.sceneLayout;if(this.renderQueue.length){range=arrayCopy2D(this.baseRange)}else{range=arrayCopy2D(this.range)}for(j=0;j<3;++j){axes=sceneLayout[this.axesNames[j]];for(i=0;i<this.renderQueue.length;++i){glObj=this.renderQueue[i];bounds=glObj.bounds;if(!axes.autorange){bounds[0][j]=axes.range[0];bounds[1][j]=axes.range[1]}range[0][j]=Math.min(range[0][j],bounds[0][j]);range[1][j]=Math.max(range[1][j],bounds[1][j]);if("rangemode"in axes&&axes.rangemode==="tozero"){if(range[0][j]>0&&range[1][j]>0)range[0][j]=0;if(range[0][j]<0&&range[1][j]<0)range[1][j]=0}}}for(i=0;i<3;++i){if(range[0][i]===range[1][i]){range[0][i]-=1;range[1][i]+=1}else if(range[0][i]>range[1][i]){range[0][i]=-1;range[1][i]=1}}for(i=0;i<this.renderQueue.length;++i){glObj=this.renderQueue[i];glObj.clipBounds=range}this.range=range;this.dirty=true;this.selectDirty=true};proto.setModelScale=function(){var lo=this.range[0];var hi=this.range[1];var r0=hi[0]-lo[0];var r1=hi[1]-lo[1];var r2=hi[2]-lo[2];var d0=-.5*(hi[0]+lo[0])/r0;var d1=-.5*(hi[1]+lo[1])/r1;var d2=-.5*(hi[2]+lo[2])/r2;this.model=new Float32Array([1/r0,0,0,0,0,1/r1,0,0,0,0,1/r2,0,d0,d1,d2,1]);this.dirty=true;this.selectDirty=true};proto.configureAxes=function configureAxes(){var axes,opts=this.axesOpts,sceneLayout=this.sceneLayout;for(var i=0;i<3;++i){axes=sceneLayout[this.axesNames[i]];opts.labels[i]=axes.title;if("titlefont"in axes){if(axes.titlefont.color)opts.labelColor[i]=str2RgbaArray(axes.titlefont.color);if(axes.titlefont.family)opts.labelFont[i]=axes.titlefont.family;if(axes.titlefont.size)opts.labelSize[i]=axes.titlefont.size}if("showline"in axes)opts.lineEnable[i]=axes.showline;if("linecolor"in axes)opts.lineColor[i]=str2RgbaArray(axes.linecolor);if("linewidth"in axes)opts.lineWidth[i]=axes.linewidth;if("showgrid"in axes)opts.gridEnable[i]=axes.showgrid;if("gridcolor"in axes)opts.gridColor[i]=str2RgbaArray(axes.gridcolor);if("gridwidth"in axes)opts.gridWidth[i]=axes.gridwidth;if("zeroline"in axes)opts.zeroEnable[i]=axes.zeroline;if("zerolinecolor"in axes)opts.zeroLineColor[i]=str2RgbaArray(axes.zerolinecolor);if("zerolinewidth"in axes)opts.zeroLineWidth[i]=axes.zerolinewidth;if("ticks"in axes&&!!axes.ticks)opts.lineTickEnable[i]=true;else opts.lineTickEnable[i]=false;if("ticklen"in axes){opts.lineTickLength[i]=this.axesOpts._defaultLineTickLength[i]=axes.ticklen}if("tickcolor"in axes)opts.lineTickColor[i]=str2RgbaArray(axes.tickcolor);if("tickwidth"in axes)opts.lineTickWidth[i]=axes.tickwidth;if("tickangle"in axes){opts.tickAngle[i]=axes.tickangle==="auto"?0:axes.tickangle}if("showticklabels"in axes)opts.tickEnable[i]=axes.showticklabels;if("tickfont"in axes){if(axes.tickfont.color)opts.tickColor[i]=str2RgbaArray(axes.tickfont.color);if(axes.tickfont.family)opts.tickFont[i]=axes.tickfont.family;if(axes.tickfont.size)opts.tickSize[i]=axes.tickfont.size}if("mirror"in axes){if(["ticks","all","allticks"].indexOf(axes.mirror)!==-1){opts.lineTickMirror[i]=true;opts.lineMirror[i]=true}else if(axes.mirror===true){opts.lineTickMirror[i]=false;opts.lineMirror[i]=true}else{opts.lineTickMirror[i]=false;opts.lineMirror[i]=false}}else opts.lineMirror[i]=false;if("showbackground"in axes&&axes.showbackground!==false){opts.backgroundEnable[i]=true;opts.backgroundColor[i]=str2RgbaArray(axes.backgroundcolor)}else opts.backgroundEnable[i]=false;this.spikeProperties.enable[i]=!!axes.showspikes;this.spikeProperties.sides[i]=!!axes.spikesides;if(typeof axes.spikethickness!=="number"){axes.spikethickness=2}this.spikeProperties.width[i]=axes.spikethickness;if(typeof axes.spikecolor==="string"){this.spikeProperties.colors[i]=str2RgbaArray(axes.spikecolor)}else{this.spikeProperties.colors[i]=[0,0,0,1]}}this.axesOpts.bounds=this.range;if(this.axis)this.axis.update(this.axesOpts);else this.axis=createAxes(this.shell.gl,this.axesOpts);this.dirty=true;this.selectDirty=true};proto.toPNG=function(){var shell=this.shell;var gl=shell.gl;var pixels=new Uint8Array(shell.width*shell.height*4);gl.readPixels(0,0,shell.width,shell.height,gl.RGBA,gl.UNSIGNED_BYTE,pixels);var w=shell.width;var h=shell.height;for(var j=0,k=h-1;j<k;++j,--k){for(var i=0;i<w;++i){for(var l=0;l<4;++l){var tmp=pixels[4*(w*j+i)+l];pixels[4*(w*j+i)+l]=pixels[4*(w*k+i)+l];pixels[4*(w*k+i)+l]=tmp}}}var canvas=document.createElement("canvas");canvas.width=shell.width;canvas.height=shell.height;var context=canvas.getContext("2d");var imageData=context.createImageData(shell.width,shell.height);imageData.data.set(pixels);context.putImageData(imageData,0,0);var dataURL=canvas.toDataURL("image/png");return dataURL};proto.setCameraToDefault=function setCameraToDefault(){this.camera.lookAt(this.defaultView.slice(0,3),this.defaultView.slice(3,6),this.defaultView.slice(6,9));this.dirty=true;this.selectDirty=true;return};proto.getCameraPosition=function getCameraPosition(){return[arrayCopy1D(this.camera.rotation),arrayCopy1D(this.camera.center),this.camera.distance]};proto.setCameraPosition=function setCameraPosition(cameraPosition){if(Array.isArray(cameraPosition)&&cameraPosition.length===3){this.camera.rotation=arrayCopy1D(cameraPosition[0]);this.camera.center=arrayCopy1D(cameraPosition[1]);this.camera.distance=cameraPosition[2]}this.dirty=true;this.selectDirty=true;return};proto.saveCameraPositionToLayout=function saveCameraPositionToLayout(layout){var lib=this.Plotly.Lib;var prop=lib.nestedProperty(layout,this.id+".cameraposition");var cameraposition=this.getCameraPosition();prop.set(cameraposition);this.dirty=true;this.selectDirty=true;return};proto.disposeAll=function disposeAll(){this.renderQueue.forEach(function(glo){glo.dispose()});this.renderQueue=[];this.glDataMap={};if(this.axis){this.axis.dispose();this.axis=null}if(this.axisSpikes){this.axisSpikes.dispose();this.axisSpikes=null}for(var i=0;i<this.selectBuffers.length;++i){this.selectBuffers[i].dispose()}};proto.destroy=function destroy(){this.disposeAll();this.container.parentNode.removeChild(this.container)}},{"./compute-tick-length":2,"./project":416,"./scene-camera":418,arraytools:7,"gl-axes":29,"gl-axes/properties":120,"gl-matrix":173,"gl-select-static":290,"gl-spikes":352,tinycolor2:415}],421:[function(require,module,exports){"use strict";var createSurface=require("gl-surface-plot"),tinycolor=require("tinycolor2"),ndarray=require("ndarray"),fill=require("ndarray-fill");function Surface(config){this.config=config;this.Plotly=config.Plotly}module.exports=Surface;function parseColorScale(colorscale,alpha){if(alpha===undefined)alpha=1;return colorscale.map(function(elem){var index=elem[0];var color=tinycolor(elem[1]);var rgb=color.toRgb();return{index:index,rgb:[rgb.r,rgb.g,rgb.b,alpha]}})}var proto=Surface.prototype;proto.attributes={x:{type:"data_array"},y:{type:"data_array"},z:{type:"data_array"},colorscale:{from:"Heatmap"},showscale:{from:"Heatmap"},reversescale:{from:"Heatmap"},lighting:{ambient:{type:"number",min:.01,max:.99,dflt:.8},diffuse:{type:"number",min:.01,max:.99,dflt:.8},specular:{type:"number",min:.01,max:.99,dflt:.05},roughness:{type:"number",min:.01,max:.99,dflt:.5},fresnel:{type:"number",min:.01,max:.99,dflt:.2}}};proto.supplyDefaults=function(traceIn,traceOut,defaultColor,layout){var i,_this=this;var Plotly=this.config.Plotly;function coerce(attr,dflt){return Plotly.Lib.coerce(traceIn,traceOut,_this.attributes,attr,dflt)}function coerceHeatmap(attr,dflt){return Plotly.Lib.coerce(traceIn,traceOut,Plotly.Heatmap.attributes,attr,dflt)}var z=coerce("z");if(!z){traceOut.visible=false;return}var xlen=z[0].length;var ylen=z.length;coerce("x");coerce("y");if(!Array.isArray(traceOut.x)){traceOut.x=[];for(i=0;i<xlen;++i){traceOut.x[i]=i}}if(!Array.isArray(traceOut.y)){traceOut.y=[];for(i=0;i<ylen;++i){traceOut.y[i]=i}}coerce("lighting.ambient");coerce("lighting.diffuse");coerce("lighting.specular");coerce("lighting.roughness");coerce("lighting.fresnel");coerceHeatmap("colorscale");var reverseScale=coerceHeatmap("reversescale"),showScale=coerceHeatmap("showscale");if(reverseScale){traceOut.colorscale=traceOut.colorscale.map(this.flipScale).reverse()}if(showScale){Plotly.Colorbar.supplyDefaults(traceIn,traceOut,defaultColor,layout)}};proto.flipScale=function(si){return[1-si[0],si[1]]};proto.update=function update(scene,sceneLayout,data,surface){var i,alpha=data.opacity,colormap=parseColorScale(data.colorscale,alpha),z=data.z,x=data.x,y=data.y,xaxis=sceneLayout.xaxis,yaxis=sceneLayout.yaxis,zaxis=sceneLayout.zaxis,ticks=[[],[]],xlen=z[0].length,ylen=z.length,field=ndarray(new Float32Array(xlen*ylen),[xlen,ylen]),coords=[ndarray(new Float32Array(xlen*ylen),[xlen,ylen]),ndarray(new Float32Array(xlen*ylen),[xlen,ylen])],xc=coords[0],yc=coords[1],hasCoords=false,gl=scene.shell.gl;fill(field,function(row,col){return zaxis.d2l(z[col][row])});if(Array.isArray(x[0])){fill(xc,function(row,col){return zaxis.d2l(x[col][row])});hasCoords=true}else{for(i=0;i<xlen;i++){ticks[0][i]=xaxis.d2l(x[i])}}if(Array.isArray(y[0])){fill(yc,function(row,col){return zaxis.d2l(y[col][row])});hasCoords=true}else{for(i=0;i<ylen;i++){ticks[1][i]=yaxis.d2l(y[i])}}var params={field:field,colormap:colormap};if(hasCoords){params.coords=coords}else{params.ticks=ticks}if(surface){surface.update(params)}else{var pickIds=scene.allocIds(1);params.pickId=pickIds.ids[0];surface=createSurface(gl,field,params);surface.groupId=pickIds.group;surface.plotlyType=data.type;scene.glDataMap[data.uid]=surface}if("lighting"in data){surface.ambientLight=data.lighting.ambient;surface.diffuseLight=data.lighting.diffuse;surface.specularLight=data.lighting.specular;surface.roughness=data.lighting.roughness;surface.fresnel=data.lighting.fresnel}surface.uid=data.uid;surface.visible=data.visible;if(alpha&&alpha<1)surface.supportsTransparency=true;return surface};proto.colorbar=function(gd,cd){this.Plotly.Heatmap.colorbar(gd,cd)}},{"gl-surface-plot":399,ndarray:412,"ndarray-fill":400,tinycolor2:415}]},{},[419])(419)});!function(){var a,b,c,d;!function(){var e={},f={};a=function(a,b,c){e[a]={deps:b,callback:c}},d=c=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d._eak_seen=e,f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var g,h=e[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)"exports"===i[l]?k.push(g={}):k.push(b(c(i[l])));var n=j.apply(this,k);return f[a]=g||n}}(),a("promise/all",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){f(a,b)}}function f(a,c){h[a]=c,0===--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)g=a[j],g&&e(g.then)?g.then(d(j),c):f(j,g)})}var d=a.isArray,e=a.isFunction;b.all=c}),a("promise/asap",["exports"],function(a){"use strict";function b(){return function(){process.nextTick(e)}}function c(){var a=0,b=new i(e),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function d(){return function(){j.setTimeout(e,1)}}function e(){for(var a=0;a<k.length;a++){var b=k[a],c=b[0],d=b[1];c(d)}k=[]}function f(a,b){var c=k.push([a,b]);1===c&&g()}var g,h="undefined"!=typeof window?window:{},i=h.MutationObserver||h.WebKitMutationObserver,j="undefined"!=typeof global?global:void 0===this?window:this,k=[];g="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?b():i?c():d(),a.asap=f}),a("promise/config",["exports"],function(a){"use strict";function b(a,b){return 2!==arguments.length?c[a]:(c[a]=b,void 0)}var c={instrument:!1};a.config=c,a.configure=b}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){"use strict";function d(){var a;a="undefined"!=typeof global?global:"undefined"!=typeof window&&window.document?window:self;var b="Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var b;return new a.Promise(function(a){b=a}),f(b)}();b||(a.Promise=e)}var e=a.Promise,f=b.isFunction;c.polyfill=d}),a("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){if(!v(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof i))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],j(a,this)}function j(a,b){function c(a){o(b,a)}function d(a){q(b,a)}try{a(c,d)}catch(e){d(e)}}function k(a,b,c,d){var e,f,g,h,i=v(c);if(i)try{e=c(d),g=!0}catch(j){h=!0,f=j}else e=d,g=!0;n(b,e)||(i&&g?o(b,e):h?q(b,f):a===D?o(b,e):a===E&&q(b,e))}function l(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+D]=c,e[f+E]=d}function m(a,b){for(var c,d,e=a._subscribers,f=a._detail,g=0;g<e.length;g+=3)c=e[g],d=e[g+b],k(b,c,d,f);a._subscribers=null}function n(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(u(b)&&(d=b.then,v(d)))return d.call(b,function(d){return c?!0:(c=!0,b!==d?o(a,d):p(a,d),void 0)},function(b){return c?!0:(c=!0,q(a,b),void 0)}),!0}catch(e){return c?!0:(q(a,e),!0)}return!1}function o(a,b){a===b?p(a,b):n(a,b)||p(a,b)}function p(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(r,a))}function q(a,b){a._state===B&&(a._state=C,a._detail=b,t.async(s,a))}function r(a){m(a,a._state=D)}function s(a){m(a,a._state=E)}var t=a.config,u=(a.configure,b.objectOrFunction),v=b.isFunction,w=(b.now,c.all),x=d.race,y=e.resolve,z=f.reject,A=g.asap;t.async=A;var B=void 0,C=0,D=1,E=2;i.prototype={constructor:i,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;t.async(function(){k(c._state,d,e[c._state-1],c._detail)})}else l(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},i.all=w,i.race=x,i.resolve=y,i.reject=z,h.Promise=i}),a("promise/race",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})}var d=a.isArray;b.race=c}),a("promise/reject",["exports"],function(a){"use strict";function b(a){var b=this;return new b(function(b,c){c(a)})}a.reject=b}),a("promise/resolve",["exports"],function(a){"use strict";function b(a){if(a&&"object"==typeof a&&a.constructor===this)return a;var b=this;return new b(function(b){b(a)})}a.resolve=b}),a("promise/utils",["exports"],function(a){"use strict";function b(a){return c(a)||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),b("promise/polyfill").polyfill()}();var micropolar={version:"0.2.2"};var µ=micropolar;µ.Axis=function module(){var c={data:[],layout:{}},f={},j={};var h,a,i=d3.dispatch("hover"),d,g;var e={};function b(k){a=k||a;var l=c.data;var m=c.layout;if(typeof a=="string"||a.nodeName){a=d3.select(a);}a.datum(l).each(function(ax,X){var ae=ax.slice();j={data:µ.util.cloneJson(ae),layout:µ.util.cloneJson(m)};var aj=0;ae.forEach(function(aB,aA){if(!aB.color){aB.color=m.defaultColorRange[aj];aj=(aj+1)%m.defaultColorRange.length;}if(!aB.strokeColor){aB.strokeColor=aB.geometry==="LinePlot"?aB.color:d3.rgb(aB.color).darker().toString();}j.data[aA].color=aB.color;j.data[aA].strokeColor=aB.strokeColor;j.data[aA].strokeDash=aB.strokeDash;j.data[aA].strokeSize=aB.strokeSize;});var aw=ae.filter(function(aC,aA){var aB=aC.visible;return typeof aB==="undefined"||aB===true;});var P=false;var Y=aw.map(function(aB,aA){P=P||typeof aB.groupId!=="undefined";return aB;});if(P){var ah=d3.nest().key(function(aB,aA){return typeof aB.groupId!="undefined"?aB.groupId:"unstacked";}).entries(Y);var S=[];var an=ah.map(function(aC,aB){if(aC.key==="unstacked"){return aC.values;}else{var aA=aC.values[0].r.map(function(aE,aD){return 0;});aC.values.forEach(function(aF,aE,aD){aF.yStack=[aA];S.push(aA);aA=µ.util.sumArrays(aF.r,aA);});return aC.values;}});aw=d3.merge(an);}aw.forEach(function(aB,aA){aB.t=Array.isArray(aB.t[0])?aB.t:[aB.t];aB.r=Array.isArray(aB.r[0])?aB.r:[aB.r];});var ak=Math.min(m.width-m.margin.left-m.margin.right,m.height-m.margin.top-m.margin.bottom)/2;ak=Math.max(10,ak);var ao=[m.margin.left+ak,m.margin.top+ak];var x;if(P){var T=d3.max(µ.util.sumArrays(µ.util.arrayLast(aw).r[0],µ.util.arrayLast(S)));x=[0,T];}else{x=d3.extent(µ.util.flattenArray(aw.map(function(aB,aA){return aB.r;})));}if(m.radialAxis.domain!=µ.DATAEXTENT){x[0]=0;}d=d3.scale.linear().domain(m.radialAxis.domain!=µ.DATAEXTENT&&m.radialAxis.domain?m.radialAxis.domain:x).range([0,ak]);j.layout.radialAxis.domain=d.domain();var ay=µ.util.flattenArray(aw.map(function(aB,aA){return aB.t;}));var az=typeof ay[0]==="string";var ag;if(az){ay=µ.util.deduplicate(ay);ag=ay.slice();ay=d3.range(ay.length);aw=aw.map(function(aC,aB){var aA=aC;aC.t=[ay];if(P){aA.yStack=aC.yStack;}return aA;});}var w=aw.filter(function(aB,aA){return aB.geometry==="LinePlot"||aB.geometry==="DotPlot";}).length===aw.length;var al=m.needsEndSpacing===null?az||!w:m.needsEndSpacing;var N=m.angularAxis.domain&&m.angularAxis.domain!=µ.DATAEXTENT&&!az&&m.angularAxis.domain[0]>=0;var E=N?m.angularAxis.domain:d3.extent(ay);var s=Math.abs(ay[1]-ay[0]);if(w&&!az){s=0;}var av=E.slice();if(al&&az){av[1]+=s;}var Z=m.angularAxis.ticksCount||4;if(Z>8){Z=Z/(Z/8)+Z%8;}if(m.angularAxis.ticksStep){Z=(av[1]-av[0])/Z;}var I=m.angularAxis.ticksStep||(av[1]-av[0])/(Z*(m.minorTicks+1));if(ag){I=Math.max(Math.round(I),1);}if(!av[2]){av[2]=I;}var Q=d3.range.apply(this,av);Q=Q.map(function(aB,aA){return parseFloat(aB.toPrecision(12));});g=d3.scale.linear().domain(av.slice(0,2)).range(m.direction==="clockwise"?[0,360]:[360,0]);j.layout.angularAxis.domain=g.domain();j.layout.angularAxis.endPadding=al?s:0;h=d3.select(this).select("svg.chart-root");if(typeof h==="undefined"||h.empty()){var M='<svg xmlns="http://www.w3.org/2000/svg" class="chart-root"><g class="outer-group"><g class="chart-group"><circle class="background-circle"></circle><g class="geometry-group"></g><g class="radial axis-group"><circle class="outside-circle"></circle></g><g class="angular axis-group"></g><g class="guides-group"><line></line><circle r="0"></circle></g></g><g class="legend-group"></g><g class="tooltips-group"></g><g class="title-group"><text></text></g></g></svg>';var B=new DOMParser().parseFromString(M,"application/xml");var ai=this.appendChild(this.ownerDocument.importNode(B.documentElement,true));h=d3.select(ai);}h.select(".guides-group").style({"pointer-events":"none"});h.select(".angular.axis-group").style({"pointer-events":"none"});h.select(".radial.axis-group").style({"pointer-events":"none"});var af=h.select(".chart-group");var F={fill:"none",stroke:m.tickColor};var aq={"font-size":m.font.size,"font-family":m.font.family,fill:m.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(aB,aA){return" "+aB+" 0 "+m.font.outlineColor;}).join(",")};var C;if(m.showLegend){C=h.select(".legend-group").attr({transform:"translate("+[ak,m.margin.top]+")"}).style({display:"block"});var z=aw.map(function(aC,aB){var aA=µ.util.cloneJson(aC);aA.symbol=aC.geometry==="DotPlot"?aC.dotType||"circle":aC.geometry!="LinePlot"?"square":"line";aA.visibleInLegend=typeof aC.visibleInLegend==="undefined"||aC.visibleInLegend;aA.color=aC.geometry==="LinePlot"?aC.strokeColor:aC.color;return aA;});var v=µ.util.deepExtend({},µ.Legend.defaultConfig().legendConfig);var u=µ.util.deepExtend(v,{container:C,elements:z,reverseOrder:m.legend.reverseOrder});var r={data:aw.map(function(aB,aA){return aB.name||"Element"+aA;}),legendConfig:u};µ.Legend().config(r)();var A=C.node().getBBox();ak=Math.min(m.width-A.width-m.margin.left-m.margin.right,m.height-m.margin.top-m.margin.bottom)/2;ak=Math.max(10,ak);ao=[m.margin.left+ak,m.margin.top+ak];d.range([0,ak]);j.layout.radialAxis.domain=d.domain();C.attr("transform","translate("+[ao[0]+ak,ao[1]-ak]+")");}else{C=h.select(".legend-group").style({display:"none"});}h.attr({width:m.width,height:m.height}).style({opacity:m.opacity});af.attr("transform","translate("+ao+")").style({cursor:"crosshair"});var K=[(m.width-(m.margin.left+m.margin.right+ak*2+(A?A.width:0)))/2,(m.height-(m.margin.top+m.margin.bottom+ak*2))/2];K[0]=Math.max(0,K[0]);K[1]=Math.max(0,K[1]);h.select(".outer-group").attr("transform","translate("+K+")");if(m.title){var W=h.select("g.title-group text").style(aq).text(m.title);var p=W.node().getBBox();W.attr({x:ao[0]-p.width/2,y:ao[1]-ak-20});}var ar=h.select(".radial.axis-group");if(m.radialAxis.gridLinesVisible){var H=ar.selectAll("circle.grid-circle").data(d.ticks(5));H.enter().append("circle").attr({"class":"grid-circle"}).style(F);H.attr("r",d);H.exit().remove();}ar.select("circle.outside-circle").attr({r:ak}).style(F);var V=h.select("circle.background-circle").attr({r:ak}).style({fill:m.backgroundColor,stroke:m.stroke});function am(aB,aA){return g(aB)%360+m.orientation;}if(m.radialAxis.visible){var L=d3.svg.axis().scale(d).ticks(5).tickSize(5);ar.call(L).attr({transform:"rotate("+m.radialAxis.orientation+")"});ar.selectAll(".domain").style(F);ar.selectAll("g>text").text(function(aB,aA){return this.textContent+m.radialAxis.ticksSuffix;}).style(aq).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(aB,aA){if(m.radialAxis.tickOrientation==="horizontal"){return"rotate("+-m.radialAxis.orientation+") translate("+[0,aq["font-size"]]+")";}else{return"translate("+[0,aq["font-size"]]+")";}}});ar.selectAll("g>line").style({stroke:"black"});}var ad=h.select(".angular.axis-group").selectAll("g.angular-tick").data(Q);var D=ad.enter().append("g").classed("angular-tick",true);ad.attr({transform:function(aB,aA){return"rotate("+am(aB,aA)+")";}}).style({display:m.angularAxis.visible?"block":"none"});ad.exit().remove();D.append("line").classed("grid-line",true).classed("major",function(aB,aA){return aA%(m.minorTicks+1)==0;}).classed("minor",function(aB,aA){return!(aA%(m.minorTicks+1)==0);}).style(F);D.selectAll(".minor").style({stroke:m.minorTickColor});ad.select("line.grid-line").attr({x1:m.tickLength?ak-m.tickLength:0,x2:ak}).style({display:m.angularAxis.gridLinesVisible?"block":"none"});D.append("text").classed("axis-text",true).style(aq);var t=ad.select("text.axis-text").attr({x:ak+m.labelOffset,dy:".35em",transform:function(aE,aC){var aD=am(aE,aC);var aA=ak+m.labelOffset;var aB=m.angularAxis.tickOrientation;if(aB=="horizontal"){return"rotate("+-aD+" "+aA+" 0)";}else{if(aB=="radial"){return aD<270&&aD>90?"rotate(180 "+aA+" 0)":null;}else{return"rotate("+(aD<=180&&aD>0?-90:90)+" "+aA+" 0)";}}}}).style({"text-anchor":"middle",display:m.angularAxis.labelsVisible?"block":"none"}).text(function(aB,aA){if(aA%(m.minorTicks+1)!=0){return"";}if(ag){return ag[aB]+m.angularAxis.ticksSuffix;}else{return aB+m.angularAxis.ticksSuffix;}}).style(aq);if(m.angularAxis.rewriteTicks){t.text(function(aB,aA){if(aA%(m.minorTicks+1)!=0){return"";}return m.angularAxis.rewriteTicks(this.textContent,aA);});}var y=d3.max(af.selectAll(".angular-tick text")[0].map(function(aB,aA){return aB.getCTM().e+aB.getBBox().width;}));C.attr({transform:"translate("+[ak+y,m.margin.top]+")"});var J=h.select("g.geometry-group").selectAll("g").size()>0;var ap=h.select("g.geometry-group").selectAll("g.geometry").data(aw);ap.enter().append("g").attr({"class":function(aB,aA){return"geometry geometry"+aA;}});ap.exit().remove();if(aw[0]||J){var ab=[];aw.forEach(function(aC,aA){var aB={};aB.radialScale=d;aB.angularScale=g;aB.container=ap.filter(function(aE,aD){return aD==aA;});aB.geometry=aC.geometry;aB.orientation=m.orientation;aB.direction=m.direction;aB.index=aA;ab.push({data:aC,geometryConfig:aB});});var au=d3.nest().key(function(aB,aA){return typeof aB.data.groupId!="undefined"||"unstacked";}).entries(ab);var o=[];au.forEach(function(aB,aA){if(aB.key==="unstacked"){o=o.concat(aB.values.map(function(aD,aC){return[aD];}));}else{o.push(aB.values);}});o.forEach(function(aD,aB){var aC;if(Array.isArray(aD)){aC=aD[0].geometryConfig.geometry;}else{aC=aD.geometryConfig.geometry;}var aA=aD.map(function(aF,aE){return µ.util.deepExtend(µ[aC].defaultConfig(),aF);});µ[aC]().config(aA)();});}var O=h.select(".guides-group");var aa=h.select(".tooltips-group");var ac=µ.tooltipPanel().config({container:aa,fontSize:8})();var n=µ.tooltipPanel().config({container:aa,fontSize:8})();var q=µ.tooltipPanel().config({container:aa,hasTick:true})();var U,G;if(!az){var R=O.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});af.on("mousemove.angular-guide",function(aD,aB){var aA=µ.util.getMousePos(V).angle;R.attr({x2:-ak,transform:"rotate("+aA+")"}).style({opacity:0.5});var aC=(aA+180+360-m.orientation)%360;U=g.invert(aC);var aE=µ.util.convertToCartesian(ak+12,aA+180);ac.text(µ.util.round(U)).move([aE[0]+ao[0],aE[1]+ao[1]]);}).on("mouseout.angular-guide",function(aB,aA){O.select("line").style({opacity:0});});}var at=O.select("circle").style({stroke:"grey",fill:"none"});af.on("mousemove.radial-guide",function(aC,aA){var aB=µ.util.getMousePos(V).radius;at.attr({r:aB}).style({opacity:0.5});G=d.invert(µ.util.getMousePos(V).radius);var aD=µ.util.convertToCartesian(aB,m.radialAxis.orientation);n.text(µ.util.round(G)).move([aD[0]+ao[0],aD[1]+ao[1]]);}).on("mouseout.radial-guide",function(aB,aA){at.style({opacity:0});q.hide();ac.hide();n.hide();});h.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(aG,aD){var aB=d3.select(this);var aC=aB.style("fill");var aH="black";var aF=aB.style("opacity")||1;aB.attr({"data-opacity":aF});if(aC!="none"){aB.attr({"data-fill":aC});aH=d3.hsl(aC).darker().toString();aB.style({fill:aH,opacity:1});var aE={t:µ.util.round(aG[0]),r:µ.util.round(aG[1])};if(az){aE.t=ag[aG[0]];}var aK="t: "+aE.t+", r: "+aE.r;var aJ=this.getBoundingClientRect();var aA=h.node().getBoundingClientRect();var aI=[aJ.left+aJ.width/2-K[0]-aA.left,aJ.top+aJ.height/2-K[1]-aA.top];q.config({color:aH}).text(aK);q.move(aI);}else{aC=aB.style("stroke");aB.attr({"data-stroke":aC});aH=d3.hsl(aC).darker().toString();aB.style({stroke:aH,opacity:1});}}).on("mousemove.tooltip",function(aB,aA){if(d3.event.which!=0){return false;}if(d3.select(this).attr("data-fill")){q.show();}}).on("mouseout.tooltip",function(aC,aA){q.hide();var aB=d3.select(this);var aD=aB.attr("data-fill");if(aD){aB.style({fill:aD,opacity:aB.attr("data-opacity")});}else{aB.style({stroke:aB.attr("data-stroke"),opacity:aB.attr("data-opacity")});}});});return e;}e.render=function(k){b(k);return this;};e.config=function(k){if(!arguments.length){return c;}var l=µ.util.cloneJson(k);l.data.forEach(function(n,m){if(!c.data[m]){c.data[m]={};}µ.util.deepExtend(c.data[m],µ.Axis.defaultConfig().data[0]);µ.util.deepExtend(c.data[m],n);});µ.util.deepExtend(c.layout,µ.Axis.defaultConfig().layout);µ.util.deepExtend(c.layout,l.layout);return this;};e.getLiveConfig=function(){return j;};e.getinputConfig=function(){return f;};e.radialScale=function(k){return d;};e.angularScale=function(k){return g;};e.svg=function(){return h;};d3.rebind(e,i,"on");return e;};µ.Axis.defaultConfig=function(c,b){var a={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:true,opacity:1}],layout:{defaultColorRange:d3.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:true,gridLinesVisible:true,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:true,gridLinesVisible:true,labelsVisible:true,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:true,legend:{reverseOrder:false},opacity:1}};return a;};µ.util={};µ.DATAEXTENT="dataExtent";µ.AREA="AreaChart";µ.LINE="LinePlot";µ.DOT="DotPlot";µ.BAR="BarChart";µ.util._override=function(c,b){for(var a in c){if(a in b){b[a]=c[a];}}};µ.util._extend=function(c,b){for(var a in c){b[a]=c[a];}};µ.util._rndSnd=function(){return Math.random()*2-1+(Math.random()*2-1)+(Math.random()*2-1);};µ.util.dataFromEquation2=function(b,a){var c=a||6;var d=d3.range(0,360+c,c).map(function(h,f){var g=h*Math.PI/180;var e=b(g);return[h,e];});return d;};µ.util.dataFromEquation=function(e,d,b){var g=d||6;var c=[],f=[];d3.range(0,360+g,g).forEach(function(k,i){var j=k*Math.PI/180;var h=e(j);c.push(k);f.push(h);});var a={t:c,r:f};if(b){a.name=b;}return a;};µ.util.ensureArray=function(c,b){if(typeof c==="undefined"){return null;}var a=[].concat(c);return d3.range(b).map(function(f,e){return a[e]||a[0];});};µ.util.fillArrays=function(c,b,a){b.forEach(function(f,e){c[f]=µ.util.ensureArray(c[f],a);});return c;};µ.util.cloneJson=function(a){return JSON.parse(JSON.stringify(a));};µ.util.deepExtend=function(a,c){for(var b in c){if(c[b]&&c[b].constructor&&c[b].constructor===Object){a[b]=a[b]||{};arguments.callee(a[b],c[b]);}else{a[b]=c[b];}}return a;};µ.util.validateKeys=function(c,b){if(typeof b==="string"){b=b.split(".");}var a=b.shift();return c[a]&&(!b.length||objHasKeys(c[a],b));};µ.util.sumArrays=function(d,c){return d3.zip(d,c).map(function(b,a){return d3.sum(b);});};µ.util.arrayLast=function(b){return b[b.length-1];};µ.util.arrayEqual=function(d,c){var e=Math.max(d.length,c.length,1);while(e-->=0&&d[e]===c[e]){}return e===-2;};µ.util.flattenArray=function(a){var b=[];while(!µ.util.arrayEqual(b,a)){b=a;a=[].concat.apply([],a);}return a;};µ.util.deduplicate=function(a){return a.filter(function(c,d,b){return b.indexOf(c)==d;});};µ.util.convertToCartesian=function(b,c){var d=c*Math.PI/180;var a=b*Math.cos(d);var e=b*Math.sin(d);return[a,e];};µ.util.round=function(b,a){var c=a||2;var d=Math.pow(10,c);return Math.round(b*d)/d;};µ.util.getMousePos=function(e){var a=d3.mouse(e.node());var d=a[0];var c=a[1];var b={};b.x=d;b.y=c;b.pos=a;b.angle=(Math.atan2(c,d)+Math.PI)*180/Math.PI;b.radius=Math.sqrt(d*d+c*c);return b;};µ.util.duplicatesCount=function(c){var f={},e;var b={};for(var d=0,a=c.length;d<a;d++){e=c[d];if(e in f){f[e]++;b[e]=f[e];}else{f[e]=1;}}return b;};µ.util.duplicates=function(a){return Object.keys(µ.util.duplicatesCount(a));};µ.util.translator=function(f,b,d,c){if(c){var a=d.slice();d=b;b=a;}var e=b.reduce(function(g,h){if(typeof g!="undefined"){return g[h];}},f);if(typeof e==="undefined"){return;}b.reduce(function(g,i,h){if(typeof g=="undefined"){return;}if(h===b.length-1){delete g[i];}return g[i];},f);d.reduce(function(g,i,h){if(typeof g[i]==="undefined"){g[i]={};}if(h===d.length-1){g[i]=e;}return g[i];},f);};µ.PolyChart=function module(){var d=[µ.PolyChart.defaultConfig()];var c=d3.dispatch("hover");var b={solid:"none",dash:[5,2],dot:[2,5]};var e;function a(){var g=d[0].geometryConfig;var f=g.container;if(typeof f=="string"){f=d3.select(f);}f.datum(d).each(function(r,t){var q=!!r[0].data.yStack;var m=r.map(function(y,x){if(q){return d3.zip(y.data.t[0],y.data.r[0],y.data.yStack[0]);}else{return d3.zip(y.data.t[0],y.data.r[0]);}});var k=g.angularScale;var u=g.radialScale.domain()[0];var p={};p.bar=function(D,z,C){var B=r[C].data;var A=g.radialScale(D[1])-g.radialScale(0);var y=g.radialScale(D[2]||0);var x=B.barWidth;d3.select(this).attr({"class":"mark bar",d:"M"+[[A+y,-x/2],[A+y,x/2],[y,x/2],[y,-x/2]].join("L")+"Z",transform:function(F,E){return"rotate("+(g.orientation+k(F[0]))+")";}});};p.dot=function(B,y,A){var x=B[2]?[B[0],B[1]+B[2]]:B;var z=d3.svg.symbol().size(r[A].data.dotSize).type(r[A].data.dotType)(B,y);d3.select(this).attr({"class":"mark dot",d:z,transform:function(D,C){var E=i(n(x));return"translate("+[E.x,E.y]+")";}});};var w=d3.svg.line.radial().interpolate(r[0].data.lineInterpolation).radius(function(x){return g.radialScale(x[1]);}).angle(function(x){return g.angularScale(x[0])*Math.PI/180;});p.line=function(A,x,z){var B=A[2]?m[z].map(function(D,C){return[D[0],D[1]+D[2]];}):m[z];d3.select(this).each(p.dot).style({opacity:function(D,C){return+r[z].data.dotVisible;},fill:j.stroke(A,x,z)}).attr({"class":"mark dot"});if(x>0){return;}var y=d3.select(this.parentNode).selectAll("path.line").data([0]);y.enter().insert("path");y.attr({"class":"line",d:w(B),transform:function(D,C){return"rotate("+(g.orientation+90)+")";},"pointer-events":"none"}).style({fill:function(D,C){return j.fill(A,x,z);},"fill-opacity":0,stroke:function(D,C){return j.stroke(A,x,z);},"stroke-width":function(D,C){return j["stroke-width"](A,x,z);},"stroke-dasharray":function(D,C){return j["stroke-dasharray"](A,x,z);},opacity:function(D,C){return j.opacity(A,x,z);},display:function(D,C){return j.display(A,x,z);}});};var o=g.angularScale.range();var l=Math.abs(o[1]-o[0])/m[0].length*Math.PI/180;var h=d3.svg.arc().startAngle(function(x){return-l/2;}).endAngle(function(x){return l/2;}).innerRadius(function(x){return g.radialScale(u+(x[2]||0));}).outerRadius(function(x){return g.radialScale(u+(x[2]||0))+g.radialScale(x[1]);});p.arc=function(z,x,y){d3.select(this).attr({"class":"mark arc",d:h,transform:function(B,A){return"rotate("+(g.orientation+k(B[0])+90)+")";}});};var j={fill:function(z,x,y){return r[y].data.color;},stroke:function(z,x,y){return r[y].data.strokeColor;},"stroke-width":function(z,x,y){return r[y].data.strokeSize+"px";},"stroke-dasharray":function(z,x,y){return b[r[y].data.strokeDash];},opacity:function(z,x,y){return r[y].data.opacity;},display:function(z,x,y){return typeof r[y].data.visible==="undefined"||r[y].data.visible?"block":"none";}};var v=d3.select(this).selectAll("g.layer").data(m);v.enter().append("g").attr({"class":"layer"});var s=v.selectAll("path.mark").data(function(y,x){return y;});s.enter().append("path").attr({"class":"mark"});s.style(j).each(p[g.geometryType]);s.exit().remove();v.exit().remove();function n(A,y){var z=g.radialScale(A[1]);var x=(g.angularScale(A[0])+g.orientation)*Math.PI/180;return{r:z,t:x};}function i(A){var z=A.r*Math.cos(A.t);var B=A.r*Math.sin(A.t);return{x:z,y:B};}});}a.config=function(f){if(!arguments.length){return d;}f.forEach(function(h,g){if(!d[g]){d[g]={};}µ.util.deepExtend(d[g],µ.PolyChart.defaultConfig());µ.util.deepExtend(d[g],h);});return this;};a.getColorScale=function(){return e;};d3.rebind(a,c,"on");return a;};µ.PolyChart.defaultConfig=function(){var a={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:false,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:true,visibleInLegend:true},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:d3.scale.category20()}};return a;};µ.BarChart=function module(){return µ.PolyChart();};µ.BarChart.defaultConfig=function(){var a={geometryConfig:{geometryType:"bar"}};return a;};µ.AreaChart=function module(){return µ.PolyChart();};µ.AreaChart.defaultConfig=function(){var a={geometryConfig:{geometryType:"arc"}};return a;};µ.DotPlot=function module(){return µ.PolyChart();};µ.DotPlot.defaultConfig=function(){var a={geometryConfig:{geometryType:"dot",dotType:"circle"}};return a;};µ.LinePlot=function module(){return µ.PolyChart();};µ.LinePlot.defaultConfig=function(){var a={geometryConfig:{geometryType:"line"}};return a;};µ.Legend=function module(){var c=µ.Legend.defaultConfig();var b=d3.dispatch("hover");function a(){var n=c.legendConfig;var k=c.data.map(function(x,w){return[].concat(x).map(function(z,y){var A=µ.util.deepExtend({},n.elements[w]);A.name=z;A.color=[].concat(n.elements[w].color)[y];return A;});});var u=d3.merge(k);u=u.filter(function(x,w){return n.elements[w]&&(n.elements[w].visibleInLegend||typeof n.elements[w].visibleInLegend==="undefined");});if(n.reverseOrder){u=u.reverse();}var m=n.container;if(typeof m=="string"||m.nodeName){m=d3.select(m);}var l=u.map(function(x,w){return x.color;});var g=n.fontSize;var r=n.isContinuous==null?typeof u[0]==="number":n.isContinuous;var o=r?n.height:g*u.length;var e=m.classed("legend-group",true);var p=e.selectAll("svg").data([0]);var v=p.enter().append("svg").attr({width:300,height:o+g,xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});v.append("g").classed("legend-axis",true);v.append("g").classed("legend-marks",true);var h=d3.range(u.length);var t=d3.scale[r?"linear":"ordinal"]().domain(h).range(l);var q=d3.scale[r?"linear":"ordinal"]().domain(h)[r?"range":"rangePoints"]([0,o]);var s=function(x,w){var y=w*3;if(x==="line"){return"M"+[[-w/2,-w/12],[w/2,-w/12],[w/2,w/12],[-w/2,w/12]]+"Z";}else{if(d3.svg.symbolTypes.indexOf(x)!=-1){return d3.svg.symbol().type(x).size(y)();}else{return d3.svg.symbol().type("square").size(y)();}}};if(r){var d=p.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(l);d.enter().append("stop");d.attr({offset:function(x,w){return w/(l.length-1)*100+"%";}}).style({"stop-color":function(x,w){return x;}});p.append("rect").classed("legend-mark",true).attr({height:n.height,width:n.colorBandWidth,fill:"url(#grad1)"});}else{var i=p.select(".legend-marks").selectAll("path.legend-mark").data(u);i.enter().append("path").classed("legend-mark",true);i.attr({transform:function(x,w){return"translate("+[g/2,q(w)+g/2]+")";},d:function(y,w){var x=y.symbol;return s(x,g);},fill:function(x,w){return t(w);}});i.exit().remove();}var j=d3.svg.axis().scale(q).orient("right");var f=p.select("g.legend-axis").attr({transform:"translate("+[r?n.colorBandWidth:g,g/2]+")"}).call(j);f.selectAll(".domain").style({fill:"none",stroke:"none"});f.selectAll("line").style({fill:"none",stroke:r?n.textColor:"none"});f.selectAll("text").style({fill:n.textColor,"font-size":n.fontSize}).text(function(x,w){return u[w].name;});return a;}a.config=function(d){if(!arguments.length){return c;}µ.util.deepExtend(c,d);return this;};d3.rebind(a,b,"on");return a;};µ.Legend.defaultConfig=function(c,b){var a={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:false}};return a;};µ.tooltipPanel=function(){var c,d,f;var b={container:null,hasTick:false,fontSize:12,color:"white",padding:5};var g="tooltip-"+µ.tooltipPanel.uid++;var e=10;var a=function(){c=b.container.selectAll("g."+g).data([0]);var h=c.enter().append("g").classed(g,true).style({"pointer-events":"none",display:"none"});f=h.append("path").style({fill:"white","fill-opacity":0.9}).attr({d:"M0 0"});d=h.append("text").attr({dx:b.padding+e,dy:+b.fontSize*0.3});return a;};a.text=function(n){var j=d3.hsl(b.color).l;var r=j>=0.5?"#aaa":"white";var i=j>=0.5?"black":"white";var p=n||"";d.style({fill:i,"font-size":b.fontSize+"px"}).text(p);var o=b.padding;var q=d.node().getBBox();var k={fill:b.color,stroke:r,"stroke-width":"2px"};var m=q.width+o*2+e;var h=q.height+o*2;f.attr({d:"M"+[[e,-h/2],[e,-h/4],[b.hasTick?0:e,0],[e,h/4],[e,h/2],[m,h/2],[m,-h/2]].join("L")+"Z"}).style(k);c.attr({transform:"translate("+[e,-h/2+o*2]+")"});c.style({display:"block"});return a;};a.move=function(h){if(!c){return;}c.attr({transform:"translate("+[h[0],h[1]]+")"}).style({display:"block"});return a;};a.hide=function(){if(!c){return;}c.style({display:"none"});return a;};a.show=function(){if(!c){return;}c.style({display:"block"});return a;};a.config=function(h){µ.util.deepExtend(b,h);return a;};return a;};µ.tooltipPanel.uid=1;µ.adapter={};µ.adapter.plotly=function module(){var a={};a.convert=function(e,h){var j={};if(e.data){j.data=e.data.map(function(n,l){var m=µ.util.deepExtend({},n);var k=[[m,["marker","color"],["color"]],[m,["marker","opacity"],["opacity"]],[m,["marker","line","color"],["strokeColor"]],[m,["marker","line","dash"],["strokeDash"]],[m,["marker","line","width"],["strokeSize"]],[m,["marker","symbol"],["dotType"]],[m,["marker","size"],["dotSize"]],[m,["marker","barWidth"],["barWidth"]],[m,["line","interpolation"],["lineInterpolation"]],[m,["showlegend"],["visibleInLegend"]]];k.forEach(function(p,o){µ.util.translator.apply(null,p.concat(h));});if(!h){delete m.marker;}if(h){delete m.groupId;}if(!h){if(m.type==="scatter"){if(m.mode==="lines"){m.geometry="LinePlot";}else{if(m.mode==="markers"){m.geometry="DotPlot";}else{if(m.mode==="lines+markers"){m.geometry="LinePlot";m.dotVisible=true;}}}}else{if(m.type==="area"){m.geometry="AreaChart";}else{if(m.type==="bar"){m.geometry="BarChart";}}}delete m.mode;delete m.type;}else{if(m.geometry==="LinePlot"){m.type="scatter";if(m.dotVisible===true){delete m.dotVisible;m.mode="lines+markers";}else{m.mode="lines";}}else{if(m.geometry==="DotPlot"){m.type="scatter";m.mode="markers";}else{if(m.geometry==="AreaChart"){m.type="area";}else{if(m.geometry==="BarChart"){m.type="bar";}}}}delete m.geometry;}return m;});if(!h&&e.layout&&e.layout.barmode==="stack"){var f=µ.util.duplicates(j.data.map(function(l,k){return l.geometry;}));j.data.forEach(function(m,l){var k=f.indexOf(m.geometry);if(k!=-1){j.data[l].groupId=k;}});}}if(e.layout){var c=µ.util.deepExtend({},e.layout);var i=[[c,["plot_bgcolor"],["backgroundColor"]],[c,["showlegend"],["showLegend"]],[c,["radialaxis"],["radialAxis"]],[c,["angularaxis"],["angularAxis"]],[c.angularaxis,["showline"],["gridLinesVisible"]],[c.angularaxis,["showticklabels"],["labelsVisible"]],[c.angularaxis,["nticks"],["ticksCount"]],[c.angularaxis,["tickorientation"],["tickOrientation"]],[c.angularaxis,["ticksuffix"],["ticksSuffix"]],[c.angularaxis,["range"],["domain"]],[c.angularaxis,["endpadding"],["endPadding"]],[c.radialaxis,["showline"],["gridLinesVisible"]],[c.radialaxis,["tickorientation"],["tickOrientation"]],[c.radialaxis,["ticksuffix"],["ticksSuffix"]],[c.radialaxis,["range"],["domain"]],[c.angularAxis,["showline"],["gridLinesVisible"]],[c.angularAxis,["showticklabels"],["labelsVisible"]],[c.angularAxis,["nticks"],["ticksCount"]],[c.angularAxis,["tickorientation"],["tickOrientation"]],[c.angularAxis,["ticksuffix"],["ticksSuffix"]],[c.angularAxis,["range"],["domain"]],[c.angularAxis,["endpadding"],["endPadding"]],[c.radialAxis,["showline"],["gridLinesVisible"]],[c.radialAxis,["tickorientation"],["tickOrientation"]],[c.radialAxis,["ticksuffix"],["ticksSuffix"]],[c.radialAxis,["range"],["domain"]],[c.font,["outlinecolor"],["outlineColor"]],[c.legend,["traceorder"],["reverseOrder"]],[c,["labeloffset"],["labelOffset"]],[c,["defaultcolorrange"],["defaultColorRange"]]];i.forEach(function(l,k){µ.util.translator.apply(null,l.concat(h));});if(!h){if(c.angularAxis&&typeof c.angularAxis.ticklen!=="undefined"){c.tickLength=c.angularAxis.ticklen;}if(c.angularAxis&&typeof c.angularAxis.tickcolor!=="undefined"){c.tickColor=c.angularAxis.tickcolor;}}else{if(typeof c.tickLength!=="undefined"){c.angularaxis.ticklen=c.tickLength;delete c.tickLength;}if(c.tickColor){c.angularaxis.tickcolor=c.tickColor;delete c.tickColor;}}if(c.legend&&typeof c.legend.reverseOrder!="boolean"){c.legend.reverseOrder=c.legend.reverseOrder!="normal";}if(c.legend&&typeof c.legend.traceorder=="boolean"){c.legend.traceorder=c.legend.traceorder?"reversed":"normal";delete c.legend.reverseOrder;}if(c.margin&&typeof c.margin.t!="undefined"){var b=["t","r","b","l","pad"];var g=["top","right","bottom","left","pad"];var d={};d3.entries(c.margin).forEach(function(l,k){d[g[b.indexOf(l.key)]]=l.value;});c.margin=d;}if(h){delete c.needsEndSpacing;delete c.minorTickColor;delete c.minorTicks;delete c.angularaxis.ticksCount;delete c.angularaxis.ticksCount;delete c.angularaxis.ticksStep;delete c.angularaxis.rewriteTicks;delete c.angularaxis.nticks;delete c.radialaxis.ticksCount;delete c.radialaxis.ticksCount;delete c.radialaxis.ticksStep;delete c.radialaxis.rewriteTicks;delete c.radialaxis.nticks;}j.layout=c;}return j;};return a;};micropolar.manager={};micropolar.manager.framework=function(){var c,d,g,f,a;var e=new Plotly.util.UndoManager();function b(i,h){if(h){a=h;}d3.select(d3.select(a).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove();c=(!c)?i:micropolar.util.deepExtend(c,i);if(!g){g=micropolar.Axis();}f=micropolar.adapter.plotly().convert(c);g.config(f).render(a);return c;}b.isPolar=true;b.svg=function(){return g.svg();};b.getConfig=function(){return c;};b.getLiveConfig=function(){return micropolar.adapter.plotly().convert(g.getLiveConfig(),true);};b.getLiveScales=function(){return{t:g.angularScale(),r:g.radialScale()};};b.setUndoPoint=function(){var i=this;var h=µ.util.cloneJson(c);(function(k,j){e.add({undo:function(){if(j){i(j);}},redo:function(){i(k);}});})(h,d);d=µ.util.cloneJson(h);};b.undo=function(){e.undo();};b.redo=function(){e.redo();};return b;};!function(){"use strict";function t(t){var e=t.type;return"r"in t?void console.log("Oops, tried to put a polar trace of type "+e+" on an incompatible graph of cartesian data. Ignoring this dataset."):b.isScatter(e)?Plotly.Scatter:b.isBar(e)?Plotly.Bars:b.isContour(e)?Plotly.Contour:b.isHeatmap(e)?Plotly.Heatmap:b.isScatter3D(e)?Plotly.Scatter3D:b.isSurface(e)?Plotly.Surface:"box"===e?Plotly.Boxes:void console.log("Unrecognized plot type "+e+". Ignoring this dataset.")}function e(t,e){t._context||(t._context=$.extend({},b.defaultConfig));var o=t._context;e&&Object.keys(e).forEach(function(t){t in o&&(o[t]=e[t])}),Object.keys(b.defaultConfig).forEach(function(o){t[o]=e&&o in e?e[o]:b.defaultConfig[o]}),o.staticPlot&&(o.workspace=!1,o.editable=!1,o.autosizable=!1,o.scrollZoom=!1,o.showTips=!1,o.showLink=!1)}function o(t,e){e.text("");var o=e.append("a").attr({"xlink:xlink:href":"#","class":"link--impt link--embedview","font-weight":"bold"}).text((Plotly.LINKTEXT||"Play with this data!")+" "+String.fromCharCode(187));if(t._context.sendData)o.on("click",function(){$(t).trigger("plotly_beforeexport");var e=$('<div id="hiddenform" style="display:none;"><form action="https://plot.ly/external" method="post" target="_blank"><input type="text" name="data" /></form></div>').appendTo(t);return e.find("input").val(b.graphJson(t,!1,"keepdata")),e.find("form").submit(),e.remove(),$(t).trigger("plotly_afterexport"),!1});else{var a=window.location.pathname.split("/");o.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+a[1]+"/"+a[2].split(".")[0]})}}function a(t){var e=t._fullLayout,o=$(t).find(".examples-container");"block"===o.css("display")&&Examples.set(),e._paperdiv.style({width:e.width+"px",height:e.height+"px",background:e.paper_bgcolor});var a=Object.keys(e).filter(function(t){return t.match(/^scene[0-9]*$/)});a.forEach(function(o,r){var i,n=e[o];n.domain.x=[r/a.length,(r+1)/a.length],n._position={left:e._size.l+n.domain.x[0]*e._size.w,top:e._size.t+(1-n.domain.y[1])*e._size.h,width:e._size.w*(n.domain.x[1]-n.domain.x[0]),height:e._size.h*(n.domain.y[1]-n.domain.y[0])},n._scene&&SceneFrame.setFramePosition(n._scene.container,n._position);var l=n._scene;Array.isArray(n._dataQueue)||(n._dataQueue=[]);var s=n._dataQueue.map(function(t){return t.uid}),c=t._fullData.filter(function(t){return t.scene===o&&-1===s.indexOf(t.uid)});if(n._dataQueue=n._dataQueue.concat(c),l)for(;n._dataQueue.length;){var d=n._dataQueue.shift();l.plot(n,d)}else n._loading||(n._loading=!0,i={container:t.querySelector(".svg-container"),zIndex:"1000",id:o,Plotly:Plotly,sceneLayout:n,width:e.width,height:e.height,baseurl:ENV.BASE_URL,glOptions:{preserveDrawingBuffer:t._context.staticPlot}},SceneFrame.createScene(i),SceneFrame.once("scene-error",function(e){n._scene=e,SceneFrame.setFramePosition(e.container,n._position),"_modebar"in t._fullLayout&&(t._fullLayout._modebar.cleanup(),t._fullLayout._modebar=null),t._fullLayout._noGL3DSupport=!0;var o=t.querySelector("#plotlybars");o&&(o.innerHTML="",o.parentNode.removeChild(o))}),SceneFrame.once("scene-loaded",function(e){var o=t._fullLayout[e.id];if(o._loading=!1,o._scene=e,o._container=e.container,"cameraposition"in o&&o.cameraposition.length){var a=o.cameraposition;e.setCameraPosition(a),e._cameraPositionLastSave=e.getCameraPosition()}else e._cameraPositionLastSave=e.getCameraPosition();for(SceneFrame.setFramePosition(o._container,o._position);o._dataQueue.length;){var r=o._dataQueue.shift();e.plot(o,r)}e.container.focus(),SceneFrame.emit("scene-ready",e)}))})}function r(t,e,o){var a=d3.select(t).selectAll(".plot-container").data([0]);a.enter().insert("div",":first-child").classed("plot-container plotly",!0);var r=a.selectAll(".svg-container").data([0]);r.enter().append("div").classed("svg-container",!0).style("position","relative"),r.html(""),e&&(t.data=e),t._fullLayout=o,t._fullLayout._container=a,t._fullLayout._paperdiv=r,"initial"===t._fullLayout.autosize&&t._context.autosizable&&(g(t,{}),t._fullLayout.autosize=t.layout.autosize=!0),r.style({width:(o.width||800)+"px",height:(o.height||600)+"px",background:o.paper_bgcolor||"white"}),t.framework=micropolar.manager.framework(),o=µ.util.deepExtend({},t._fullLayout),delete o._container,delete o._paperdiv,delete o.autosize,delete o._paper,t.framework({data:t.data,layout:o},r.node()),t.framework.setUndoPoint();var i=t.framework.svg(),n=1,l=t._fullLayout.title;""!==l&&l||(n=0);var s="Click to enter title",c=function(){this.call(Plotly.util.convertToTspans)},d=i.select(".title-group text").call(c);if(t._context.editable){d.attr({"data-unformatted":l}),l&&l!==s||(n=.2,d.attr({"data-unformatted":s}).text(s).style({opacity:n}).on("mouseover.opacity",function(){d3.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){d3.select(this).transition().duration(1e3).style("opacity",0)}));var u=function(){this.call(Plotly.util.makeEditable).on("edit",function(e){t.framework({layout:{title:e}}),this.attr({"data-unformatted":e}).text(e).call(c),this.call(u)}).on("cancel",function(){var t=this.attr("data-unformatted");this.text(t).call(c)})};d.call(u),t._fullLayout._paperdiv=r,Plotly.ToolPanel.tweakMenu(t)}return t._fullLayout._paper=i,b.addLinks(t),Promise.resolve()}function i(t){t||(t={}),t.xaxis1&&(t.xaxis||(t.xaxis=t.xaxis1),delete t.xaxis1),t.yaxis1&&(t.yaxis||(t.yaxis=t.yaxis1),delete t.yaxis1),Plotly.Axes.list({_fullLayout:t}).forEach(function(t){t.anchor&&(t.anchor=Plotly.Axes.cleanId(t.anchor)),t.overlaying&&(t.overlaying=Plotly.Axes.cleanId(t.overlaying)),t.type||(t.isdate?t.type="date":t.islog?t.type="log":t.isdate===!1&&t.islog===!1&&(t.type="linear")),("withzero"===t.autorange||"tozero"===t.autorange)&&(t.autorange=!0,t.rangemode="tozero"),delete t.islog,delete t.isdate,delete t.categories}),(t.annotations||[]).forEach(function(t){t.ref&&("paper"===t.ref?(t.xref="paper",t.yref="paper"):"data"===t.ref&&(t.xref="x",t.yref="y"),delete t.ref),t.xref&&"paper"!==t.xref&&(t.xref=Plotly.Axes.cleanId(t.xref,"x")),t.yref&&"paper"!==t.yref&&(t.yref=Plotly.Axes.cleanId(t.yref,"y"))});var e=Object.keys(t).filter(function(t){return t.match(/^scene[0-9]*$/)});e.forEach(function(e){var o=t[e],a=o.cameraposition;Array.isArray(a)&&$.isPlainObject(a[0])&&(a[0]=[a[0][0],a[0][1],a[0][2],a[0][3]],a[1]=[a[1][0],a[1][1],a[1][2]])});var o=t.legend;return o&&(o.x>3?(o.x=1.02,o.xanchor="left"):o.x<-2&&(o.x=-.02,o.xanchor="right"),o.y>3?(o.y=1.02,o.yanchor="bottom"):o.y<-2&&(o.y=-.02,o.yanchor="top")),t}function n(t,e){var o=[],a=t.concat($.isArray(e)?e:[]).filter(function(t){return"uid"in t}).map(function(t){return t.uid});t.forEach(function(t,e){function r(t){var e="middle",o="center";return-1!==t.indexOf("top")?e="top":-1!==t.indexOf("bottom")&&(e="bottom"),-1!==t.indexOf("left")?o="left":-1!==t.indexOf("right")&&(o="right"),e+" "+o}if(!("uid"in t)||-1!==o.indexOf(t.uid)){var i,n;for(n=0;100>n&&(i=Plotly.Lib.randstr(a),-1!==o.indexOf(i));n++);t.uid=Plotly.Lib.randstr(a),a.push(t.uid)}if(o.push(t.uid),"histogramy"===t.type&&"xbins"in t&&!("ybins"in t)&&(t.ybins=t.xbins,delete t.xbins),t.error_y&&"opacity"in t.error_y){var l=Plotly.Color.defaults,s=t.error_y.color||(b.isBar(t.type)?"#444":l[e%l.length]);t.error_y.color=Plotly.Color.addOpacity(Plotly.Color.rgb(s),Plotly.Color.opacity(s)*t.error_y.opacity),delete t.error_y.opacity}"bardir"in t&&("h"!==t.bardir||!b.isBar(t.type)&&"histogram"!==t.type.substr(0,9)||(t.orientation="h",f(t)),delete t.bardir),"histogramy"===t.type&&f(t),("histogramx"===t.type||"histogramy"===t.type)&&(t.type="histogram"),"scl"in t&&(t.colorscale=t.scl,delete t.scl),"reversescl"in t&&(t.reversescale=t.reversescl,delete t.reversescl),t.xaxis&&(t.xaxis=Plotly.Axes.cleanId(t.xaxis,"x")),t.yaxis&&(t.yaxis=Plotly.Axes.cleanId(t.yaxis,"y")),Array.isArray(t.textposition)?t.textposition=t.textposition.map(r):t.textposition&&(t.textposition=r(t.textposition))})}function l(t,e){var o=Object.keys(e).filter(function(t){return t.match(/^scene[0-9]*$/)});o.forEach(function(o){!t[o]&&e[o]._scene&&e[o]._scene.destroy()})}function s(t,e){for(var o,a,r,i,n=Object.keys(e),l=0;l<n.length;++l){var c=n[l];if("_"===c.charAt(0)||"function"==typeof e[c]){if(c in t)continue;t[c]=e[c]}else if(Array.isArray(e[c])&&e[c].length&&$.isPlainObject(e[c][0])){c in t?Array.isArray(t[c])||(a=t[c],t[c]=[]):t[c]=[];for(r=i=0;r<e[c].length;++r)o=t[c][i],t[c][i]={},s(t[c][i],e[c][r]),Object.keys(t[c][i]).length?++i:o?(t[c][i]=o,++i):t[c].splice(i,1);t[c].length||(a?(t[c]=a,a=void 0):delete t[c])}else $.isPlainObject(e[c])&&c in t&&(s(t[c],e[c]),Object.keys(t[c]).length||delete t[c])}}function c(e){e.calcdata=[],e._modules=[],e.firstscatter=!0,e.numboxes=0,e._hmpixcount=0,e._hmlumcount=0,Plotly.Axes.list(e).forEach(function(t){t._categories=[]}),e.calcdata=e._fullData.map(function(o,a){var r=t(o),i=[];return r&&o.visible&&(r.calc&&(i=r.calc(e,o)),-1===e._modules.indexOf(r)&&e._modules.push(r)),$.isArray(i)&&i[0]||(i=[{x:!1,y:!1}]),i[0].t||(i[0].t={}),i[0].trace=o,b.isScatter3D(o.type)&&Plotly.Scatter.arraysToCalcdata(i),Plotly.Lib.markTime("done with calcdata for "+a),i})}function d(t){var e=t._fullLayout;Plotly.Axes.getSubplots(t).forEach(function(o){var a=e._plots[o].plot;t._modules.concat(Plotly.ErrorBars).forEach(function(t){t.style&&t.style(a,e)})})}function u(t,e,o,a){var r=Plotly.Lib.nestedProperty(t,e.replace("?",o||"x")),i=Plotly.Lib.nestedProperty(t,e.replace("?",a||"y")),n=r.get();r.set(i.get()),i.set(n)}function f(t){if(u(t,"?"),u(t,"?0"),u(t,"d?"),u(t,"?bins"),u(t,"nbins?"),u(t,"autobin?"),$.isArray(t.z)&&$.isArray(t.z[0])&&(t.transpose?delete t.transpose:t.transpose=!0),u(t,"?src"),u(t,"error_?"),t.error_x&&t.error_y){var e="copy_ystyle"in t.error_y?t.error_y.copy_ystyle:t.error_y.color||t.error_y.thickness||t.error_y.width?!1:!0;u(t,"error_?.copy_ystyle"),e&&(u(t,"error_?.color"),u(t,"error_?.thickness"),u(t,"error_?.width"))}}function p(t,e){var o=t.layout,a=e.xaxis||"x",r=e.yaxis||"y",i=Plotly.Axes.getFromId(t,a),n=i._name,l=Plotly.Axes.getFromId(t,r),s=l._name,c=["anchor","domain","overlaying","position","tickangle"],d=Object.keys(o[n]).filter(function(t){return"_"!==t.charAt(0)&&"function"!=typeof o[n][t]&&-1===c.indexOf(t)});d.forEach(function(t){u(o,"?."+t,n,s)}),(o.annotations||[]).forEach(function(t){t.xref===a&&t.yref===r&&u(t,"?")}),"Click to enter Y axis title"===i.title&&(i.title="Click to enter X axis title"),"Click to enter X axis title"===l.title&&(l.title="Click to enter Y axis title")}function y(t){if(t&&t._context&&t._context.workspace&&t._fullLayout&&"plot"===t.tabtype&&"none"!==$(t).css("display")){var e=$(t).find(".plot-container"),o=t._fullLayout.width>parseInt(e.css("width"),10);t._fullLayout.autosize||!o?e.removeClass("is-fixed-size"):o&&e.addClass("is-fixed-size")}}function h(t){var e,o={left:0,right:0,bottom:0,top:0};if(t)for(e in t)t.hasOwnProperty(e)&&(o.left+=t[e].left||0,o.right+=t[e].right||0,o.bottom+=t[e].bottom||0,o.top+=t[e].top||0);return o}function g(t,e){var o,a,r,i,n=t._fullLayout,l=h(t._boundingBoxMargins);if(t._context.workspace){setFileAndCommentsSize(t);var s=n._container.node().getBoundingClientRect();a=l.left+l.right,o=l.bottom+l.top,i=Math.round(.9*(s.width-a)),r=Math.round(.9*(s.height-o))}else t._context.fillFrame?(i=$(window).width(),r=$(window).height(),$("body").css("overflow","hidden")):(r=$(t).height()||n.height,i=$(t).width()||n.width);return Math.abs(n.width-i)>1||Math.abs(n.height-r)>1?(n.height=t.layout.height=r,n.width=t.layout.width=i):"initial"!==n.autosize&&(delete e.autosize,n.autosize=t.layout.autosize=!0),e}function m(t){function e(t){t.append("g").classed("maplayer",!0),t.append("g").classed("barlayer",!0),t.append("g").classed("errorlayer",!0),t.append("g").classed("scatterlayer",!0),t.append("g").classed("boxlayer",!0)}var o=d3.select(t),a=Plotly.Axes.getSubplots(t),r=t._fullLayout;r._hasGL3D&&Plotly.Gl3dAxes.initAxes(t);var i=r._fileandcomments=o.selectAll(".file-and-comments");i.node()||(i=o),r._container=i.selectAll(".plot-container").data([0]),r._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0).classed("workspace-plot",t._context.workspace),r._paperdiv=r._container.selectAll(".svg-container").data([0]),r._paperdiv.enter().append("div").classed("svg-container",!0).style("position","relative"),"initial"===r.autosize&&(t._context.workspace&&setFileAndCommentsSize(t),g(t,{}),r.autosize=!0,t.layout.autosize=!0),r._paperdiv.selectAll("svg").remove(),r._paper=r._paperdiv.append("svg").attr({xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink","xml:xml:space":"preserve"});var n=[];r._plots={},r._paper.selectAll("g.subplot").data(a).enter().append("g").classed("subplot",!0).each(function(o){var i=r._plots[o]={},l=d3.select(this).classed(o,!0);i.id=o,i.x=function(){return Plotly.Axes.getFromId(t,o,"x")},i.y=function(){return Plotly.Axes.getFromId(t,o,"y")};var s=i.x(),c=i.y();i.overlays=[];var d=Plotly.Axes.getFromId(t,s.overlaying)||s;d!==s&&d.overlaying&&(d=s,s.overlaying=!1);var u=Plotly.Axes.getFromId(t,c.overlaying)||c;u!==c&&u.overlaying&&(u=c,c.overlaying=!1);var f=d._id+u._id;f!==o&&-1!==a.indexOf(f)?(i.mainplot=f,n.push(i),s.domain=d.domain.slice(),c.domain=u.domain.slice()):(i.bg=l.append("rect").style("stroke-width",0),i.gridlayer=l.append("g"),i.overgrid=l.append("g"),i.zerolinelayer=l.append("g"),i.overzero=l.append("g"),i.plot=l.append("svg").call(e),i.overplot=l.append("g"),i.xlines=l.append("path"),i.ylines=l.append("path"),i.overlines=l.append("g"),i.xaxislayer=l.append("g"),i.yaxislayer=l.append("g"),i.overaxes=l.append("g")),i.draglayer=r._paper.append("g")}),n.forEach(function(t){var o=r._plots[t.mainplot];o.overlays.push(t),t.gridlayer=o.overgrid.append("g"),t.zerolinelayer=o.overzero.append("g"),t.plot=o.overplot.append("svg").call(e),t.xlines=o.overlines.append("path"),t.ylines=o.overlines.append("path"),t.xaxislayer=o.overaxes.append("g"),t.yaxislayer=o.overaxes.append("g")}),a.forEach(function(t){var e=r._plots[t];e.plot.attr("preserveAspectRatio","none").style("fill","none"),e.xlines.style("fill","none").classed("crisp",!0),e.ylines.style("fill","none").classed("crisp",!0)}),r._infolayer=r._paper.append("g").classed("infolayer",!0),r._hoverlayer=r._paper.append("g").classed("hoverlayer",!0);var l=Plotly.Lib.syncOrAsync([_,function(){return Plotly.Axes.doTicks(t,"redraw")},Plotly.Fx.init],t);return l&&l.then&&t._promises.push(l),l}function x(t){var e=t._fullLayout;e._size||(e._size={}),e._pushmargin||(e._pushmargin={});var o=e._size,a=JSON.stringify(o),r=Math.max(e.margin.l||0,0),i=Math.max(e.margin.r||0,0),n=Math.max(e.margin.t||0,0),l=Math.max(e.margin.b||0,0),s=e._pushmargin;return e.margin.autoexpand!==!1&&(s.base={l:{val:0,size:r},r:{val:1,size:i},t:{val:1,size:n},b:{val:0,size:l}},Object.keys(s).forEach(function(t){var o=s[t].l||{},a=s[t].b||{},c=o.val,d=o.size,u=a.val,f=a.size;Object.keys(s).forEach(function(t){if($.isNumeric(d)&&s[t].r){var o=s[t].r.val,a=s[t].r.size;if(o>c){var p=(d*o+(a-e.width)*c)/(o-c),y=(a*(1-c)+(d-e.width)*(1-o))/(o-c);p>=0&&y>=0&&p+y>r+i&&(r=p,i=y)}}if($.isNumeric(f)&&s[t].t){var h=s[t].t.val,g=s[t].t.size;if(h>u){var m=(f*h+(g-e.height)*u)/(h-u),x=(g*(1-u)+(f-e.height)*(1-h))/(h-u);m>=0&&x>=0&&m+x>l+n&&(l=m,n=x)}}})})),o.l=Math.round(r),o.r=Math.round(i),o.t=Math.round(n),o.b=Math.round(l),o.p=Math.round(e.margin.pad),o.w=Math.round(e.width)-o.l-o.r,o.h=Math.round(e.height)-o.t-o.b,t._replotting||"{}"===a||a===JSON.stringify(e._size)?void 0:Plotly.plot(t)}function _(t){return Plotly.Lib.syncOrAsync([x,v],t)}function v(t){var e=t._fullLayout,o=e._size;Plotly.Axes.list(t).forEach(function(t){t._linepositions={}}),e._paperdiv.style({width:e.width+"px",height:e.height+"px",background:e.paper_bgcolor}),e._paper.call(Plotly.Drawing.setSize,e.width,e.height);var a=[];return e._paper.selectAll("g.subplot").each(function(r){var i=e._plots[r],n=Plotly.Axes.getFromId(t,r,"x"),l=Plotly.Axes.getFromId(t,r,"y");n.setScale(),l.setScale(),i.bg&&i.bg.call(Plotly.Drawing.setRect,n._offset-o.p,l._offset-o.p,n._length+2*o.p,l._length+2*o.p).call(Plotly.Color.fill,e.plot_bgcolor),i.plot.call(Plotly.Drawing.setRect,n._offset,l._offset,n._length,l._length);var s=$.isNumeric(n.linewidth)?n.linewidth:1,c=$.isNumeric(l.linewidth)?l.linewidth:1,d=o.p+c,u="M"+-d+",",f="h"+(n._length+2*d),p="free"===n.anchor&&-1===a.indexOf(n._id),y=o.h*(1-(n.position||0))+s/2%1,h=n.anchor===l._id&&(n.mirror||"top"!==n.side)||"all"===n.mirror||"allticks"===n.mirror||n.mirrors&&n.mirrors[l._id+"bottom"],g=l._length+o.p+s/2,m=n.anchor===l._id&&(n.mirror||"top"===n.side)||"all"===n.mirror||"allticks"===n.mirror||n.mirrors&&n.mirrors[l._id+"top"],x=-o.p-s/2,_=o.p,v=h?0:s,b=m?0:s,P=","+(-_-b)+"v"+(l._length+2*_+b+v),w="free"===l.anchor&&-1===a.indexOf(l._id),k=o.w*(l.position||0)+c/2%1,L=l.anchor===n._id&&(l.mirror||"right"!==l.side)||"all"===l.mirror||"allticks"===l.mirror||l.mirrors&&l.mirrors[n._id+"left"],A=-o.p-c/2,O=l.anchor===n._id&&(l.mirror||"right"===l.side)||"all"===l.mirror||"allticks"===l.mirror||l.mirrors&&l.mirrors[n._id+"right"],z=n._length+o.p+c/2;n._linepositions[r]=[h?g:void 0,m?x:void 0,p?y:void 0],n.anchor===l._id?n._linepositions[r][3]="top"===n.side?x:g:p&&(n._linepositions[r][3]=y),l._linepositions[r]=[L?A:void 0,O?z:void 0,w?k:void 0],l.anchor===n._id?l._linepositions[r][3]="right"===l.side?z:A:w&&(l._linepositions[r][3]=k);var E="translate("+n._offset+","+l._offset+")",S=E,D=E;p&&(S="translate("+n._offset+","+o.t+")",x+=l._offset-o.t,g+=l._offset-o.t),w&&(D="translate("+o.l+","+l._offset+")",A+=n._offset-o.l,z+=n._offset-o.l),i.xlines.attr("transform",S).attr("d",(h?u+g+f:"")+(m?u+x+f:"")+(p?u+y+f:"")||"M0,0").style("stroke-width",s+"px").call(Plotly.Color.stroke,n.showline?n.linecolor:"rgba(0,0,0,0)"),i.ylines.attr("transform",D).attr("d",(L?"M"+A+P:"")+(O?"M"+z+P:"")+(w?"M"+k+P:"")||"M0,0").attr("stroke-width",c+"px").call(Plotly.Color.stroke,l.showline?l.linecolor:"rgba(0,0,0,0)"),i.xaxislayer.attr("transform",S),i.yaxislayer.attr("transform",D),i.gridlayer.attr("transform",E),i.zerolinelayer.attr("transform",E),i.draglayer.attr("transform",E),p&&a.push(n._id),w&&a.push(l._id)}),b.titles(t,"gtitle"),Plotly.Fx.modeBar(t),y(t),t._promises.length&&Promise.all(t._promises)}window.Plotly||(window.Plotly={});var b=Plotly.Plots={};b.isScatter=function(t){return!t||"scatter"===t};var P=["bar","histogram"];b.isBar=function(t){return-1!==P.indexOf(t)};var w=["heatmap","histogram2d","contour","histogram2dcontour"];b.isHeatmap=function(t){return-1!==w.indexOf(t)};var k=["contour","histogram2dcontour"];b.isContour=function(t){return-1!==k.indexOf(t)};var L=["histogram2d","histogram2dcontour"];b.isHist2D=function(t){return-1!==L.indexOf(t)},b.isCartesian=function(t){return b.isScatter(t)||b.isBar(t)||b.isHeatmap(t)||"box"===t};var A=["scatter3d","surface"];b.isGL3D=function(t){return-1!==A.indexOf(t)},b.isScatter3D=function(t){return"scatter3d"===t},b.isScatterAny=function(t){return b.isScatter(t)||b.isScatter3D(t)},b.isSurface=function(t){return"surface"===t};var O=["scatter","box","scatter3d","surface"].concat(P,w);b.newTab=function(t,e){Plotly.ToolPanel.makeMenu(document.getElementById(t));var o={workspace:!0,editable:!0,autosizable:!0,scrollZoom:!0,showTips:!1,showLink:!1};return Plotly.plot(t,[],e,o)},b.redrawText=function(t){var e="string"==typeof t?document.getElementById(t):t;e._fullLayout._hasGL3D||e.data&&e.data[0]&&e.data[0].r||setTimeout(function(){Plotly.Annotations.drawAll(e),Plotly.Legend.draw(e,e._fullLayout.showlegend),(e.calcdata||[]).forEach(function(t){t[0]&&t[0].t&&t[0].t.cb&&t[0].t.cb()})},300)},b.defaultConfig={staticPlot:!1,workspace:!1,editable:!1,autosizable:!1,fillFrame:!1,scrollZoom:!1,showTips:!0,showLink:!0,sendData:!0,displaylogo:!0},b.addLinks=function(t){var e=t._fullLayout,a=e._paper.selectAll("text.js-plot-link-container").data([0]);a.enter().append("text").classed("js-plot-link-container",!0).style({"font-family":'"Open Sans",Arial,sans-serif',"font-size":"12px",fill:"#444"}).each(function(){var t=d3.select(this);t.append("tspan").classed("js-link-to-tool",!0),t.append("tspan").classed("js-link-spacer",!0),t.append("tspan").classed("js-sourcelinks",!0)}),a.attr({"text-anchor":"end",x:e._paper.attr("width")-7,y:e._paper.attr("height")-9});var r=a.select(".js-link-to-tool"),i=a.select(".js-link-spacer"),n=a.select(".js-sourcelinks");Plotly.Lib.showSources(t),t._context.showLink&&o(t,r),i.text(r.text()&&n.text()?" - ":"")},b.adjustReservedMargins=function(t,e,o){var a;return t._boundingBoxMargins=t._boundingBoxMargins||{},t._boundingBoxMargins[e]={},["left","right","top","bottom"].forEach(function(r){a=o[r]||0,t._boundingBoxMargins[e][r]=a}),t._boundingBoxMargins},Plotly.plot=function(t,o,l,s){function u(){return Plotly.Legend.draw(t,A.showlegend||t.calcdata.length>1&&A.showlegend!==!1),t.calcdata.forEach(function(e){var o=e[0].trace;o.visible&&o.module.colorbar?o.module.colorbar(t,e):b.autoMargin(t,"cb"+o.uid)}),x(t),b.previousPromises(t)}function f(){var e=JSON.stringify(A._size)===z?[]:[u];return Plotly.Lib.syncOrAsync(e.concat(Plotly.Fx.init),t)}function p(){return O?(Plotly.Axes.getSubplots(t).forEach(function(e){var o=t._fullLayout._plots[e];t._modules.forEach(function(e){e.setPositions&&e.setPositions(t,o)})}),Plotly.Lib.markTime("done with bar/box adjustments"),Plotly.ErrorBars.calc(t),Plotly.Lib.markTime("done Plotly.ErrorBars.calc"),Plotly.Lib.syncOrAsync([Plotly.Annotations.calcAutorange,y],t)):void 0}function y(){Plotly.Axes.list(t,"",!0).forEach(function(e){if(Plotly.Axes.doAutoRange(e),!$.isNumeric(e._m)||!$.isNumeric(e._b))throw Plotly.Lib.notifier("Something went wrong with axis scaling","long"),t._replotting=!1,new Error("axis scaling")})}function h(){return Plotly.Axes.doTicks(t,"redraw")}function g(){return t._fullLayout._hasGL3D&&a(t),t.calcdata.forEach(function(t){var e=t[0].trace;if(!e.visible||!e.module.colorbar){var o=e.uid;A._paper.selectAll(".hm"+o+",.contour"+o+",.cb"+o).remove()}}),Plotly.Axes.getSubplots(t).forEach(function(e){var o=t._fullLayout._plots[e],a=t.calcdata.filter(function(t){var o=t[0].trace;return o.xaxis+o.yaxis===e}),r=[];o.plot.selectAll("g.trace").remove(),t._modules.forEach(function(e){if(e.plot){var i=a.filter(function(t){var o=t[0].trace;return o.module===e&&o.visible});e.plot(t,o,i),Plotly.Lib.markTime("done "+(i[0]&&i[0][0].trace.type)),e.errorBarsOK&&(r=r.concat(i))}}),Plotly.ErrorBars.plot(t,o,r),Plotly.Lib.markTime("done ErrorBars")}),d(t),Plotly.Lib.markTime("done applyStyle"),Plotly.Annotations.drawAll(t),b.addLinks(t),b.previousPromises(t)}function v(){t._replotting=!1,Plotly.Lib.markTime("done plot")}Plotly.Lib.markTime("in plot"),"string"==typeof t&&(t=document.getElementById(t)),o||l||d3.select(t).classed("js-plotly-plot")||console.log("Warning: calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",t),e(t,s),l||(l={}),d3.select(t).classed("js-plotly-plot",!0),Plotly.Drawing.makeTester(t),t._promises=[];var P=0===(t.data||[]).length&&$.isArray(o);if($.isArray(o)&&(n(o,t.data),P?t.data=o:t.data.push.apply(t.data,o),t.empty=!1),(!t.layout||P)&&(t.layout=i(l)),b.supplyDefaults(t),o&&o[0]&&o[0].r)return r(t,o,l);t._context.editable&&Plotly.ToolPanel.tweakMenu(t),t._replotting=!0;var w=t._fullData.length>0;if(w){var k=Plotly.Axes.getSubplots(t).join(""),L=Object.keys(t._fullLayout._plots||{}).join("");(t.framework!==m||P||L!==k)&&(t.framework=m,m(t))}else P&&m(t);$(t).find(".data-only").attr("disabled",!w);var A=t._fullLayout,O=!t.calcdata||t.calcdata.length!==(t.data||[]).length;O&&c(t),t.calcdata.forEach(function(e,o){e[0].trace=t._fullData[o]});var z=JSON.stringify(A._size),E=Plotly.Lib.syncOrAsync([b.previousPromises,u,_,f,p,h,g],t,v);return E&&E.then?E:Promise.resolve()},b.previousPromises=function(t){return(t._promises||[]).length?Promise.all(t._promises).then(function(){t._promises=[]}):void 0},Plotly.redraw=function(t){var e="string"==typeof t?document.getElementById(t):t;return d3.select(e).classed("js-plotly-plot")?(e.calcdata=void 0,void Plotly.plot(e)):void console.log("This element is not a Plotly Plot",t,e)},b.attributes={type:{type:"enumerated",values:O,dflt:"scatter"},visible:{type:"boolean",dflt:!0},scene:{type:"sceneid",dflt:"scene"},showlegend:{type:"boolean",dflt:!0},opacity:{type:"number",min:0,max:1,dflt:1},name:{type:"string"},xaxis:{type:"axisid",dflt:"x"},yaxis:{type:"axisid",dflt:"y"},uid:{type:"string",dflt:""}},b.supplyDefaults=function(t){var e=t._fullLayout||{},o=t._fullLayout={};b.supplyLayoutGlobalDefaults(t.layout||{},o),t._fullData=(t.data||[]).map(function(t,e){return b.supplyDataDefaults(t,e,o)}),t._fullData.forEach(function(t){b.isGL3D(t.type)&&(o._hasGL3D=!0),b.isCartesian(t.type)&&("r"in t?o._hasPolar=!0:o._hasCartesian=!0)}),b.supplyLayoutModuleDefaults(t.layout||{},o,t._fullData),l(o,e),s(o,e),x(t);var a=Plotly.Axes.list(t);a.forEach(function(e){e._td=t,e.setScale()}),(t.calcdata||[]).length===t._fullData.length&&t._fullData.forEach(function(e,o){(t.calcdata[o][0]||{}).trace=e})},b.supplyDataDefaults=function(e,o,a){function r(t,o){return Plotly.Lib.coerce(e,i,b.attributes,t,o)}var i={},n=Plotly.Color.defaults[o%Plotly.Color.defaults.length];i.index=o;var l,s,c=r("type"),d=r("visible");return r("uid"),b.isGL3D(c)&&(l=r("scene")),(d||l)&&(s=t(i),i.module=s),s&&d&&s.supplyDefaults(e,i,n,a),d&&(r("name","trace "+o),b.isScatter3D(c)||r("opacity"),b.isCartesian(c)&&(r("xaxis"),r("yaxis")),b.isHeatmap(c)||b.isSurface(c)||r("showlegend")),i._input=e,i},b.layoutAttributes={font:{type:"font",dflt:{family:'"Open sans", verdana, arial, sans-serif',size:12,color:"#444"}},title:{type:"string",dflt:"Click to enter Plot title"},titlefont:{type:"font"},autosize:{type:"enumerated",values:[!0,!1,"initial"]},width:{type:"number",min:10,dflt:700},height:{type:"number",min:10,dflt:450},margin:{l:{type:"number",min:0,dflt:80},r:{type:"number",min:0,dflt:80},t:{type:"number",min:0,dflt:100},b:{type:"number",min:0,dflt:80},pad:{type:"number",min:0,dflt:0},autoexpand:{type:"boolean",dflt:!0}},paper_bgcolor:{type:"color",dflt:"#fff"},plot_bgcolor:{type:"color",dflt:"#fff"},separators:{type:"string",dflt:".,"},hidesources:{type:"boolean",dflt:!1},smith:{type:"enumerated",values:[!1],dflt:!1},showlegend:{type:"boolean"},_hasCartesian:{type:"boolean",dflt:!1},_hasGL3D:{type:"boolean",dflt:!1}},b.supplyLayoutGlobalDefaults=function(t,e){function o(o,a){return Plotly.Lib.coerce(t,e,b.layoutAttributes,o,a)}var a=o("font");o("title"),o("titlefont",{family:a.family,size:Math.round(1.4*a.size),color:a.color}),o("autosize",t.width&&t.height?!1:"initial"),o("width"),o("height"),o("margin.l"),o("margin.r"),o("margin.t"),o("margin.b"),o("margin.pad"),o("margin.autoexpand"),o("paper_bgcolor"),o("separators"),o("hidesources"),o("smith"),o("_hasCartesian"),o("_hasGL3D")},b.supplyLayoutModuleDefaults=function(t,e,o){var a=["Axes","Legend","Annotations","Fx"],r=["Bars","Boxes","Gl3dLayout"];a.forEach(function(a){Plotly[a]&&Plotly[a].supplyDefaults(t,e,o)}),r.forEach(function(a){Plotly[a]&&Plotly[a].supplyLayoutDefaults(t,e,o)})},b.purge=function(t){delete t.data,delete t.layout,delete t._fullData,delete t._fullLayout,delete t.calcdata,delete t.framework,delete t.empty,delete t.fid,delete t.undoqueue,delete t.undonum,delete t.autoplay,delete t.changed,delete t._modules,delete t._tester,delete t._testref,delete t._promises,delete t._redrawTimer,delete t._replotting,delete t.firstscatter,delete t.hmlumcount,delete t.hmpixcount,delete t.numboxes},Plotly.restyle=function(t,e,o,a){function r(){return a.map(function(){return void 0})}function i(t){var e=Plotly.Axes.id2name(t);-1===h.indexOf(e)&&h.push(e)}function n(t){return t+".autorange"}function l(t){return t+".range"}function s(t,e,o,a){if($.isArray(e))return void e.forEach(function(e){s(t,e,o,a)});if(!(e in y)){var i=Plotly.Lib.nestedProperty(t,e);e in E||(E[e]=r()),void 0===E[e][a]&&(E[e][a]=i.get()),void 0!==o&&i.set(o)}}"string"==typeof t&&(t=document.getElementById(t));var c,u=t._fullLayout,y={};if("string"==typeof e)y[e]=o;else{if(!$.isPlainObject(e))return void console.log("restyle fail",e,o,a);y=e,void 0===a&&(a=o)}Object.keys(y).length&&(t.changed=!0),$.isNumeric(a)?a=[a]:$.isArray(a)&&a.length||(a=t._fullData.map(function(t,e){return e}));var h,g=["mode","visible","type","orientation","fill","histfunc","histnorm","text","xtype","x0","dx","ytype","y0","dy","xaxis","yaxis","line.width","showscale","zauto","autobinx","nbinsx","xbins.start","xbins.end","xbins.size","autobiny","nbinsy","ybins.start","ybins.end","ybins.size","autocontour","ncontours","contours.coloring","error_y.visible","error_y.value","error_y.type","error_y.traceref","error_y.array","error_y.symmetric","error_y.arrayminus","error_y.valueminus","error_y.tracerefminus","error_x.visible","error_x.value","error_x.type","error_x.traceref","error_x.array","error_x.symmetric","error_x.arrayminus","error_x.valueminus","error_x.tracerefminus","swapxy","swapxyaxes","orientationaxes"],m=["marker.size","textfont.size","textposition","boxpoints","jitter","pointpos","whiskerwidth","boxmean"],x=["connectgaps","zmin","zmax","zauto","mincolor","maxcolor","colorscale","reversescale","zsmooth","contours.start","contours.end","contours.size","contours.showlines","line.smoothing","line.shape","error_y.width","error_x.width","error_x.copy_ystyle","marker.maxdisplayed"],_=["barmode","bargap","bargroupgap","boxmode","boxgap","boxgroupgap","?axis.autorange","?axis.range","?axis.rangemode"],v=["type","x","y","x0","y0","orientation","xaxis","yaxis"],P=!1,w=!1,k=!1,L=!1,A=!1,O=!1,z={},E={};u._hasGL3D&&(k=!0);var S=["zmin","zmax"],D=["xbins.start","xbins.end","xbins.size"],T=["ybins.start","ybins.end","ybins.size"],C=["contours.start","contours.end","contours.size"];for(var j in y){var M,B,I,F=y[j];if(z[j]=F,-1===_.indexOf(j.replace(/[xyz]axis[0-9]*/g,"?axis"))){for(E[j]=r(),c=0;c<a.length;c++){if(M=t.data[a[c]],B=t._fullData[a[c]],I=Plotly.Lib.nestedProperty(M,j),-1!==S.indexOf(j))s(M,"zauto",!1,c);else if("zauto"===j)s(M,S,void 0,c);else if(-1!==D.indexOf(j))s(M,"autobinx",!1,c);else if("autobinx"===j)s(M,D,void 0,c);else if(-1!==T.indexOf(j))s(M,"autobiny",!1,c);else if("autobiny"===j)s(M,T,void 0,c);else if(-1!==C.indexOf(j))s(M,"autocontour",!1,c);else if("autocontour"===j)s(M,C,void 0,c);else if(-1!==["x0","dx"].indexOf(j)&&B.x&&"scaled"!==B.xtype)s(M,"xtype","scaled",c);else if(-1!==["y0","dy"].indexOf(j)&&B.y&&"scaled"!==B.ytype)s(M,"ytype","scaled",c);else if("colorbar.thicknessmode"===j&&I.get()!==F&&-1!==["fraction","pixels"].indexOf(F)&&B.colorbar){var N=-1!==["top","bottom"].indexOf(B.colorbar.orient)?u.height-u.margin.t-u.margin.b:u.width-u.margin.l-u.margin.r;s(M,"colorbar.thickness",B.colorbar.thickness*("fraction"===F?1/N:N),c)}else if("colorbar.lenmode"===j&&I.get()!==F&&-1!==["fraction","pixels"].indexOf(F)&&B.colorbar){var G=-1!==["top","bottom"].indexOf(B.colorbar.orient)?u.width-u.margin.l-u.margin.r:u.height-u.margin.t-u.margin.b;s(M,"colorbar.len",B.colorbar.len*("fraction"===F?1/G:G),c)}E[j][c]=I.get();var J=["swapxy","swapxyaxes","orientation","orientationaxes"];if(-1!==J.indexOf(j)){if("orientation"===j){if(I.set($.isArray(F)?F[c%F.length]:F),I.get()===E[j][c])continue}else"orientationaxes"===j&&(M.orientation={v:"h",h:"v"}[B.orientation]);f(M)}else I.set($.isArray(F)?F[c%F.length]:F)}if(-1!==["swapxyaxes","orientationaxes"].indexOf(j)&&p(t,t.data[a[0]]),"orientationaxes"===j){var Q=Plotly.Lib.nestedProperty(t.layout,"hovermode");"x"===Q.get()?Q.set("y"):"y"===Q.get()&&Q.set("x")}if(-1!==a.indexOf(0)&&-1!==v.indexOf(j)&&(Plotly.Axes.clearTypes(t,a),P=!0),(-1===["autobinx","autobiny","zauto"].indexOf(j)||F!==!1)&&(A=!0),-1!==["colorbar","line"].indexOf(I.parts[0])&&(O=!0),-1!==g.indexOf(j)){if(-1!==["orientation","type"].indexOf(j)){for(h=[],c=0;c<a.length;c++){var H=t.data[a[c]];i(H.xaxis||"x"),i(H.yaxis||"y"),"type"===e&&s(t.data[a[c]],["autobinx","autobiny"],!0,c)}s(t.layout,h.map(n),!0,0),s(t.layout,h.map(l),[0,1],0)}P=!0}else-1!==x.indexOf(j)?k=!0:-1!==m.indexOf(j)&&(w=!0)}else I=Plotly.Lib.nestedProperty(t.layout,j),E[j]=[I.get()],I.set($.isArray(F)?F[0]:F),P=!0}Plotly.Queue&&Plotly.Queue.add(t,E,z,a);var R=!1;Plotly.Axes.list(t).forEach(function(t){t.autorange&&(R=!0)}),(P||L||w&&R)&&(t.calcdata=void 0);var U;L?U=[function(){var e=t.layout;return t.layout=void 0,Plotly.plot(t,"",e)}]:P||k||w?U=[Plotly.plot]:(b.supplyDefaults(t),U=[b.previousPromises],A&&U.push(function(){return d(t),u.showlegend&&Plotly.Legend.draw(t),b.previousPromises(t)}),O&&U.push(function(){return t.calcdata.forEach(function(t){if((t[0].t||{}).cb){var e=t[0].trace,o=t[0].t.cb;b.isContour(e.type)&&o.line({width:e.contours.showlines!==!1?e.line.width:0,dash:e.line.dash,color:"line"===e.contours.coloring?o._opts.line.color:e.line.color}),o.options(e.colorbar)()}}),b.previousPromises(t)}));var q=Plotly.Lib.syncOrAsync(U,t);return q&&q.then||(q=Promise.resolve()),q.then(function(){$(t).trigger("plotly_restyle",[z,a]),t._context.workspace&&Themes&&t.themes&&t.themes.visible&&Themes.reTile(t)})},Plotly.relayout=function(t,e,o){function a(t,e){if($.isArray(t))return void t.forEach(function(t){a(t,e)});if(!(t in f)){var o=Plotly.Lib.nestedProperty(u,t);t in L||(L[t]=o.get()),void 0!==e&&o.set(e)}}function r(e,o){var a=Plotly.Axes.id2name(e[o+"ref"]||o);return(t._fullLayout[a]||{}).autorange}if(!t.framework||!t.framework.isPolar){"string"==typeof t&&(t=document.getElementById(t));var i,n,l,s,c,d,u=t.layout,f={},p=!1,y=!1,h=!1,m=!1,x=!1,v=!1;if("string"==typeof e)f[e]=o;else{if(!$.isPlainObject(e))return void console.log("relayout fail",e,o);f=e}Object.keys(f).length&&(t.changed=!0),l=Object.keys(f),n=Plotly.Axes.list(t);for(var P=0;P<l.length;P++){if(0===l[P].indexOf("allaxes")){for(var w=0;w<n.length;w++)c=n[w]._id.substr(1),d=-1!==c.indexOf("scene")?c+".":"",i=l[P].replace("allaxes",d+n[w]._name),f[i]||(f[i]=f[l[P]]);delete f[l[P]]}l[P].match(/^annotations\[[0-9-]+\].ref$/)&&(s=f[l[P]].split("y"),f[l[P].replace("ref","xref")]=s[0],f[l[P].replace("ref","yref")]=2===s.length?"y"+s[1]:"paper",delete f[l[P]])}var k={},L={},A=["height","width"];for(var O in f){var z=Plotly.Lib.nestedProperty(u,O),E=f[O],S=z.parent,D=z.parts.length,T="string"==typeof z.parts[D-1]?D-1:D-2,C=z.parts[T],j=z.parts[T-1]+"."+C,M=z.parts.slice(0,T).join(".");if(k[O]=f[O],L[O]="reverse"===C?f[O]:z.get(),-1!==A.indexOf(O)?a("autosize",!1):"autosize"===O?a(A,void 0):j.match(/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/)?a(M+".autorange",!1):j.match(/^[xyz]axis[0-9]*\.autorange$/)&&a([M+".range[0]",M+".range[1]"],void 0),"type"===C&&("log"===S.type?"log"!==E:"log"===E)){var B=S;if(!S.range){a(M+".autorange",!0);continue}if(S.autorange)"log"===E&&B.range&&(B.range=B.range[1]>B.range[0]?[1,2]:[2,1]);else{var I=B.range[0],F=B.range[1];if("log"===E){if(0>=I&&0>=F){a(M+".autorange",!0);continue}0>=I?I=F/1e6:0>=F&&(F=I/1e6),a(M+".range[0]",Math.log(I)/Math.LN10),a(M+".range[1]",Math.log(F)/Math.LN10)}else a(M+".range[0]",Math.pow(10,I)),a(M+".range[1]",Math.pow(10,F))}}if("reverse"===C)S.range.reverse(),S.autorange?x=!0:m=!0;else if("annotations"===z.parts[0]){var N=z.parts[1],G=u.annotations,J=G&&G[N]||{};2===z.parts.length&&("add"===f[O]||$.isPlainObject(f[O])?L[O]="remove":"remove"===f[O]?-1===N?(L.annotations=G,delete L[O]):L[O]=J:console.log("???",f)),(r(J,"x")||r(J,"y"))&&-1===O.indexOf("color")&&-1===O.indexOf("opacity")&&-1===O.indexOf("align")&&(x=!0),Plotly.Annotations.draw(t,N,z.parts.slice(2).join("."),f[O]),delete f[O]}else 0===z.parts[0].indexOf("scene")?m=!0:-1!==z.parts[0].indexOf("legend")?p=!0:-1!==O.indexOf("title")?y=!0:-1!==z.parts[0].indexOf("bgcolor")?h=!0:z.parts.length>1&&(-1!==z.parts[1].indexOf("tick")||-1!==z.parts[1].indexOf("exponent")||-1!==z.parts[1].indexOf("grid")||-1!==z.parts[1].indexOf("zeroline"))?y=!0:-1!==O.indexOf(".linewidth")&&-1!==O.indexOf("axis")?y=h=!0:z.parts.length>1&&-1!==z.parts[1].indexOf("line")?h=!0:z.parts.length>1&&"mirror"===z.parts[1]?y=h=!0:"margin.pad"===O?y=h=!0:"margin"===z.parts[0]||"autorange"===z.parts[1]||"rangemode"===z.parts[1]||"type"===z.parts[1]||O.match(/^(bar|box|font)/)?x=!0:"hovermode"===O?v=!0:-1===["hovermode","dragmode","height","width","autosize"].indexOf(O)&&(m=!0),z.set(E)}Plotly.Queue&&Plotly.Queue.add(t,L,k,"relayout"),f.autosize&&(f=g(t,f)),(f.height||f.width||f.autosize)&&(x=!0);var Q=Object.keys(f),H=[b.previousPromises];m||x?H.push(function(){return t.layout=void 0,x&&(t.calcdata=void 0),Plotly.plot(t,"",u)}):Q.length&&(b.supplyDefaults(t),p&&H.push(function(){return Plotly.Legend.draw(t,t._fullLayout.showlegend),b.previousPromises(t)}),h&&H.push(_),y&&H.push(function(){return Plotly.Axes.doTicks(t,"redraw"),b.titles(t,"gtitle"),b.previousPromises(t)}),v&&Plotly.Fx.modeBar(t));var R=Plotly.Lib.syncOrAsync(H,t);return R&&R.then||(R=Promise.resolve()),R.then(function(){$(t).trigger("plotly_relayout",k),t._context.workspace&&Themes&&t.themes&&t.themes.visible&&Themes.reTile(t)})}},b.resize=function(t){"string"==typeof t&&(t=document.getElementById(t)),t._context.workspace&&setFileAndCommentsSize(t),t&&"none"!==$(t).css("display")&&(t._redrawTimer&&clearTimeout(t._redrawTimer),t._redrawTimer=setTimeout(function(){if((t._fullLayout||{}).autosize){var e=t.changed;t.autoplay=!0,Plotly.relayout(t,{autosize:!0}),t.changed=e}},100)),y(t)},b.autoMargin=function(t,e,o){var a=t._fullLayout;if(a._pushmargin||(a._pushmargin={}),a.margin.autoexpand!==!1){if(o){var r=o.pad||12;o.l+o.r>.5*a.width&&(o.l=o.r=0),o.b+o.t>.5*a.height&&(o.b=o.t=0),a._pushmargin[e]={l:{val:o.x,size:o.l+r},r:{val:o.x,size:o.r+r},b:{val:o.y,size:o.b+r},t:{val:o.y,size:o.t+r}}}else delete a._pushmargin[e];t._replotting||x(t)}},b.titles=function(t,e){function o(t){Plotly.Lib.syncOrAsync([a,r],t)}function a(e){return e.attr("transform",L?"rotate("+[L.rotate,n.x,n.y]+") translate(0, "+L.offset+")":null),e.style({"font-family":P,"font-size":d3.round(w,2)+"px",fill:Plotly.Color.rgb(k),opacity:E*Plotly.Color.opacity(k)}).attr(n).call(Plotly.util.convertToTspans).attr(n),e.selectAll("tspan.line").attr(n),b.previousPromises(t)}function r(t){var e=d3.select(t.node().parentNode);if(O&&O.selection&&O.side&&D){e.attr("transform",null);var o=0,a={left:"right",right:"left",top:"bottom",bottom:"top"}[O.side],r=-1!==["left","top"].indexOf(O.side)?-1:1,i=$.isNumeric(O.pad)?O.pad:2,n=Plotly.Drawing.bBox(e.node()),l={left:0,top:0,right:c.width,bottom:c.height},s=f?c.width:(l[O.side]-n[O.side])*("left"===O.side||"top"===O.side?-1:1);if(0>s?o=s:(n.left-=O.offsetLeft,n.right-=O.offsetLeft,n.top-=O.offsetTop,n.bottom-=O.offsetTop,O.selection.each(function(){var t=Plotly.Drawing.bBox(this);Plotly.Lib.bBoxIntersect(n,t,i)&&(o=Math.max(o,r*(t[O.side]-n[a])+i))}),o=Math.min(s,o)),o>0||0>s){var d={left:[-o,0],right:[o,0],top:[0,-o],bottom:[0,o]}[O.side];e.attr("transform","translate("+d+")")}}}function i(){E=0,S=!0,D=M,c._infolayer.select("."+e).attr({"data-unformatted":D}).text(D).on("mouseover.opacity",function(){d3.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){d3.select(this).transition().duration(1e3).style("opacity",0)})}var n;if("string"==typeof t&&(t=document.getElementById(t)),!e)return Plotly.Axes.listIds(t).forEach(function(e){b.titles(t,e+"title")}),void b.titles(t,"gtitle");var l,s,c=t._fullLayout,d=c._size,u=e.charAt(0),f="cb"===e.substr(1,2);if(f){var p=e.substr(3).replace("title","");t._fullData.some(function(e,o){return e.uid===p?(l=o,s=t.calcdata[o][0].t.cb.axis,!0):void 0})}else s=c[Plotly.Axes.id2name(e.replace("title",""))]||c;var y,h,g,m,x,_=s===c?"title":s._name+".title",v=f?"colorscale":(s._id||u).toUpperCase()+" axis",P=s.titlefont.family,w=s.titlefont.size,k=s.titlefont.color,L="",A={},O={selection:d3.select(t).selectAll("g."+s._id+"tick"),side:s.side},z=f?0:1.5;f?(O.offsetLeft=d.l,O.offsetTop=d.t):O.selection.size()&&(x=d3.select(O.selection.node().parentNode).attr("transform").match(/translate\(([-\.\d]+),([-\.\d]+)\)/),x&&(O.offsetLeft=+x[1],O.offsetTop=+x[2])),f&&s.titleside?(y=d.l+s.titlex*d.w,h=d.t+(1-s.titley)*d.h+("top"===s.titleside?3+.75*w:-3-.25*w),n={x:y,y:h,"text-anchor":"start"},O={},e="h"+e):"x"===u?(g=s,m="free"===g.anchor?{_offset:d.t+(1-(g.position||0))*d.h,_length:0}:Plotly.Axes.getFromId(t,g.anchor),y=g._offset+g._length/2,h=m._offset+("top"===g.side?-10-w*(z+(g.showticklabels?1:0)):m._length+10+w*(z+(g.showticklabels?1.5:.5))),n={x:y,y:h,"text-anchor":"middle"},O.side||(O.side="bottom")):"y"===u?(m=s,g="free"===m.anchor?{_offset:d.l+(m.position||0)*d.w,_length:0}:Plotly.Axes.getFromId(t,m.anchor),h=m._offset+m._length/2,y=g._offset+("right"===m.side?g._length+10+w*(z+(m.showticklabels?1:.5)):-10-w*(z+(m.showticklabels?.5:0))),A={center:0},n={x:y,y:h,"text-anchor":"middle"},L={rotate:"-90",offset:0},O.side||(O.side="left")):(v="Plot",w=c.titlefont.size,y=c.width/2,h=c._size.t/2,n={x:y,y:h,"text-anchor":"middle"},O={});var E=1,S=!1,D=s.title.trim();""===D&&(E=0),D.match(/Click to enter .+ title/)&&(E=.2,S=!0);var T;if(f){T=d3.select(t).selectAll("."+s._id.substr(1)+" .cbtitle");var C="h"===e.charAt(0)?e.substr(1):"h"+e;T.selectAll("."+C+",."+C+"-math-group").remove()}else T=c._infolayer.selectAll(".g-"+e).data([0]),T.enter().append("g").classed("g-"+e,!0);var j=T.selectAll("text").data([0]);j.enter().append("text"),j.text(D).attr("class",e),j.attr({"data-unformatted":D}).call(o);var M="Click to enter "+v.replace(/\d+/,"")+" title";t._context.editable?(D||i(),j.call(Plotly.util.makeEditable).on("edit",function(e){f?Plotly.restyle(t,"colorbar.title",e,l):Plotly.relayout(t,_,e)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(o)}).on("input",function(t){this.text(t||" ").attr(n).selectAll("tspan.line").attr(n)})):(!D||D.match(/Click to enter .+ title/))&&j.remove(),j.classed("js-placeholder",S)},b.graphJson=function(t,e,o,a){function r(t){if("function"==typeof t)return null;if($.isPlainObject(t)){var e,a={};for(e in t)if("function"!=typeof t[e]&&-1===["_","["].indexOf(e.charAt(0))){if("keepdata"===o){if("src"===e.substr(e.length-3))continue}else if("keepall"!==o){var i=t[e+"src"];if("string"==typeof i&&i.indexOf(":")>0)continue}a[e]=r(t[e])}return a}return $.isArray(t)?t.map(r):t&&t.getTime?Plotly.Lib.ms2DateTime(t):t}"string"==typeof t&&(t=document.getElementById(t));var i={data:(t.data||[]).map(function(t){var o=r(t);return e&&delete o.fit,o})};return e||(i.layout=r(t.layout)),t.framework&&t.framework.isPolar&&(i=t.framework.getConfig()),"object"===a?i:JSON.stringify(i)},b.viewJson=function(){var t,e,o,a=Tabs.get();if(a.framework&&a.framework.isPolar){var r=a.framework.getLiveConfig();t=JSON.stringify(r),e=r.data,o=r.layout}else t=Plotly.Plots.graphJson(a),e=JSON.parse(t).data,e.forEach(function(t){delete t.stream}),o=JSON.parse(t).layout;var i="var data = "+JSON.stringify(e)+";\n";i+="var layout = "+JSON.stringify(o)+";\n",i+="Plotly.plot(Tabs.get(), data, layout);";var n=$("#jsonModal"),l=n.find("#json-viewer").empty();l.data("jsontree","").jsontree(t,{collapsibleOuter:!1}).show(),n.modal("show");var s=n.find("#json-text").text("").append(i).hide(),c=["Switch to Plain Text","Switch to JSON Viewer"],d=$(".js-plain-text-toggle").text(c[0]);d.off("click").on("click",function(){var t=$(this).text()===c[0];return l.toggle(!t),s.toggle(t),s.get(0).select(),$(this).text(c[+t]),!1}),n.find(".close").off("click").on("click",function(){return n.modal("hide"),!1})}}();!function(){"use strict";window.Plotly||(window.Plotly={});var t=Plotly.Lib={};t.dateTime2ms=function(t){try{if(t.getTime)return+t}catch(n){return!1}var e,r,o,i,a=String(t).split(" ");if(a.length>2)return!1;var c=a[0].split("-");if(c.length>3||3!==c.length&&a[1])return!1;if(4===c[0].length)e=Number(c[0]);else{if(2!==c[0].length)return!1;var s=(new Date).getFullYear();e=((Number(c[0])-s+70)%100+200)%100+s-70}return $.isNumeric(e)?1===c.length?new Date(e,0,1).getTime():(r=Number(c[1])-1,c[1].length>2||!(r>=0&&11>=r)?!1:2===c.length?new Date(e,r,1).getTime():(o=Number(c[2]),c[2].length>2||!(o>=1&&31>=o)?!1:(o=new Date(e,r,o).getTime(),a[1]?(c=a[1].split(":"),c.length>3?!1:(i=Number(c[0]),c[0].length>2||!(i>=0&&23>=i)?!1:(o+=36e5*i,1===c.length?o:(r=Number(c[1]),c[1].length>2||!(r>=0&&59>=r)?!1:(o+=6e4*r,2===c.length?o:(t=Number(c[2]),t>=0&&60>t?o+1e3*t:!1)))))):o))):!1},t.isDateTime=function(n){return t.dateTime2ms(n)!==!1},t.ms2DateTime=function(n,e){if("undefined"==typeof d3)return void console.log("d3 is not defined");e||(e=0);var r=new Date(n),o=d3.time.format("%Y-%m-%d")(r);return 7776e6>e?(o+=" "+t.lpad(r.getHours(),2),432e6>e&&(o+=":"+t.lpad(r.getMinutes(),2),108e5>e&&(o+=":"+t.lpad(r.getSeconds(),2),3e5>e&&(o+="."+t.lpad(r.getMilliseconds(),3)))),o.replace(/([:\s]00)*\.?[0]*$/,"")):o};var n={H:["%H:%M:%S~%L","%H:%M:%S","%H:%M"],I:["%I:%M:%S~%L%p","%I:%M:%S%p","%I:%M%p"],D:["%H","%I%p","%Hh"]},e={Y:["%Y~%m~%d","%Y%m%d","%y%m%d","%m~%d~%Y","%d~%m~%Y"],Yb:["%b~%d~%Y","%d~%b~%Y","%Y~%d~%b","%Y~%b~%d"],y:["%m~%d~%y","%d~%m~%y","%y~%m~%d"],yb:["%b~%d~%y","%d~%b~%y","%y~%d~%b","%y~%b~%d"]};if("undefined"!=typeof d3){var r=d3.time.format.utc,o={Y:{H:["%Y~%m~%dT%H:%M:%S","%Y~%m~%dT%H:%M:%S~%L"].map(r),I:[],D:["%Y%m%d%H%M%S","%Y~%m","%m~%Y"].map(r)},Yb:{H:[],I:[],D:["%Y~%b","%b~%Y"].map(r)},y:{H:[],I:[],D:[]},yb:{H:[],I:[],D:[]}};["Y","Yb","y","yb"].forEach(function(t){e[t].forEach(function(e){o[t].D.push(r(e)),["H","I","D"].forEach(function(i){n[i].forEach(function(n){var a=o[t][i];a.push(r(e+"~"+n)),a.push(r(n+"~"+e))})})})})}var i=/[a-z]*/g,a=function(t){return t.substr(0,3)},c=/(mon|tue|wed|thu|fri|sat|sun|the|of|st|nd|rd|th)/g,s=/[\s,\/\-\.\(\)]+/g,l=/~?([ap])~?m(~|$)/,u=function(t,n){return n+"m "},f=/\d\d\d\d/,d=/(^|~)[a-z]{3}/,m=/[ap]m/,p=/:/,h=/q([1-4])/,g=["31~mar","30~jun","30~sep","31~dec"],v=function(t,n){return g[n-1]},b=/ ?([+\-]\d\d:?\d\d|Z)$/;t.parseDate=function(t){if(t.getTime)return t;if("string"==typeof t){t=t.toLowerCase().replace(i,a).replace(c,"").replace(s,"~").replace(l,u).replace(h,v).trim().replace(b,"");for(var n=(f.test(t)?"Y":"y")+(d.test(t)?"b":""),e=p.test(t)?m.test(t)?"I":"H":"D",r=o[n][e],g=r.length,y=null,M=0;g>M&&!(y=r[M].parse(t));M++);return y}},t.findBin=function(t,n,e){if($.isNumeric(n.start))return e?Math.ceil((t-n.start)/n.size)-1:Math.floor((t-n.start)/n.size);var r,o,i=0,a=n.length,c=0;for(o=n[n.length-1]>n[0]?e?function(t,n){return n>t}:function(t,n){return n>=t}:e?function(t,n){return t>=n}:function(t,n){return t>n};a>i&&c++<100;)r=Math.floor((i+a)/2),o(n[r],t)?i=r+1:a=r;return c>90&&console.log("Long binary search..."),i-1},t.distinctVals=function(t){var n=t.slice();n.sort(function(t,n){return t-n});for(var e=n.length-1,r=n[e]-n[0]||1,o=r/(e||1)/1e4,i=[n[0]],a=0;e>a;a++)n[a+1]>n[a]+o&&(r=Math.min(r,n[a+1]-n[a]),i.push(n[a+1]));return{vals:i,minDiff:r}},t.roundUp=function(t,n,e){for(var r,o=0,i=n.length-1,a=0,c=e?0:1,s=e?1:0,l=e?Math.ceil:Math.floor;i>o&&a++<100;)r=l((o+i)/2),n[r]<=t?o=r+c:i=r-s;return n[o]},t.nestedProperty=function(n,e){function r(n){return t.nestedProperty(n,f)}function o(t){for(u=0;u<d.length;u++)d[u].set($.isArray(t)?t[u%t.length]:t)}function i(){var t=!0,n=[];for(u=0;u<d.length;u++)n[u]=d[u].get(),n[u]!==n[0]&&(t=!1);return t?n[0]:n}for(var a,c,s,l,u,f,d,m=0,p=n,h=e.split(".");m<h.length;){if(s=String(h[m]).match(/^([^\[\]]+)((\[\-?[0-9]*\])+)$/))for(l=s[2].substr(1,s[2].length-2).split("]["),h.splice(m,1,s[1]),u=0;u<l.length;u++)m++,h.splice(m,0,Number(l[u]));m++}for(f=e.substr(e.indexOf("[-1]")+4),"."===f.charAt(0)&&(f=f.substr(1)),m=0;m<h.length-1;m++){if(-1===h[m])return d=p.map(r),{set:o,get:i,astr:e,parts:h,parent:c,obj:n};h[m]in p||(p[h[m]]="string"==typeof h[m+1]?{}:[]),c="number"==typeof h[m+1]?p:p[h[m]],p=p[h[m]]}return a=h[m],{set:function(n){void 0===n||null===n?delete p[a]:p[a]=Array.isArray(n)?n.map(t.identity):n},get:function(){return p[a]},astr:e,parts:h,parent:c,obj:n}},t.pauseEvent=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,!1},t.lpad=function(t,n){return String(t+Math.pow(10,n)).substr(1)},t.aggNums=function(n,e,r,o){var i;for(o||(o=r.length),$.isNumeric(e)||(e=!1),$.isArray(r[0])&&(r=r.map(function(r){return t.aggNums(n,e,r)})),i=0;o>i;i++)$.isNumeric(e)?$.isNumeric(r[i])&&(e=n(e,r[i])):e=r[i];return e},t.len=function(n){return t.aggNums(function(t){return t+1},0,n)},t.mean=function(n,e){return e||(e=t.len(n)),t.aggNums(function(t,n){return t+n},0,n)/e},t.stdev=function(n,e,r){return e||(e=t.len(n)),$.isNumeric(r)||(r=t.aggNums(function(t,n){return t+n},0,n)/e),Math.sqrt(t.aggNums(function(t,n){return t+Math.pow(n-r,2)},0,n)/e)},t.VERBOSE=!1,t.TIMER=(new Date).getTime(),t.log=function(){t.VERBOSE&&console.log.apply(console,arguments)},t.markTime=function(n){if(t.VERBOSE){var e=(new Date).getTime();console.log(n,e-t.TIMER,"(msec)"),"trace"===t.VERBOSE&&console.trace(),t.TIMER=e}},t.constrain=function(t,n,e){return n>e?Math.max(e,Math.min(n,t)):Math.max(n,Math.min(e,t))},t.killspin=function(t){return void 0===t&&"undefined"!=typeof Tabs&&(t=Tabs.get()),t&&t.spinner?(t.spincount--,void(t.spincount>0||(t.spinner.stop(),$(t).find(".spinner").remove()))):void $(".spinner").remove()},t.startspin=function(t,n,e){if(void 0===t&&"undefined"!=typeof Tabs&&(t=Tabs.get()),e=e||{},"number"==typeof t.spincount&&t.spincount>0)t.spincount++;else{t.spincount=1;var r={lines:17,length:30,width:6,radius:37,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"};"tiny"===n&&(r.lines=13,r.length=5,r.width=2,r.radius=5,r.corners=.6),r=$.extend({},r,e);var o=new Spinner(r).spin(t);t.spinner=o}},t.notifier=function(t,n){var e;e=$.isNumeric(n)?n:"long"===n?2e3:1e3;var r=$(".notifier-container");if(r.length||(r=$('<div class="notifier-container"></div>').appendTo("#tabs-one-line,#embedded-graph")),!($("div.notifier").text().indexOf(t)>0)){var o=$('<div class="notifier" style="display:none;"><button class="notifier__close close" data-dismiss="alert">&times;</button><p class="push-half">'+t+"</p></div>");o.appendTo(r).fadeIn(700).delay(e).fadeOut(700,function(){o.remove()})}},t.conf_modal=function(){function t(t){s={header:"",body:"",conf_btn_txt:"Done",canc_btn_txt:"",conf_func:function(){},canc_func:function(){},selector:"body",hideonclick:!0,closex:!1,backdrop:!0,alt_btn_txt:"",alt_func:function(){}},s=$.extend({},s,t);var r,o,i;"auto"===$(s.selector).css("z-index")?r=o=i="":(r=$(s.selector).css("z-index"),o=r+1,i=r+2),s.backdrop&&($(".modal-backdrop:visible").hide(),$(s.selector).first().append('<div id="confirmModalBackdrop" class="modal-backdrop confirmModal '+(""===o?"":'style="z-index:'+o)+'"></div>'));var a='<div id="confirmModal" class="modal modal--default hide confirmModal" style="z-index:'+i+'"><div class="modal__header">'+(s.closex?'<button type="button" id="closeConfirmModal" class="close cm-canc_func" aria-hidden="true">&times;</button>':"")+'<h3 class="cm-header"></h3></div><div class="modal__body"><p class="cm-body"></p></div><div class="modal__footer"><button class="btn btn--small btn--cta2 cm-alt_btn_txt cm-alt_func"></button><button class="btn btn--small btn--cta2 cm-canc_btn_txt cm-canc_func push-half--left"></button><button class="btn btn--small btn--cta  cm-conf_btn_txt cm-conf_func push-half--left"></button><div class="messages success--inline" style="text-align: right;"></div></div></div>';$(s.selector).append(a),$("#confirmModal").modal({backdrop:!1}),e(s),$("#confirmModal").on("hide",function(){n()})}function n(){$("#confirmModalBackdrop").remove(),$("#confirmModal").remove(),$(".confirmModalBackdrop").remove(),$(".confirmModal").remove()}function e(t){function e(){return s.hideonclick&&n(),t.conf_func(),!1}function r(){return s.hideonclick&&n(),t.canc_func(),!1}function o(){return s.hideonclick&&n(),t.alt_func(),!1}for(var i in t)$.inArray(i,["header","body"])>-1?$("#confirmModal .cm-"+i).html(t[i]):$.inArray(i,["alt_btn_txt","canc_btn_txt","conf_btn_txt"])>-1?""===t[i]?$("#confirmModal .cm-"+i).hide():($("#confirmModal .cm-"+i).show(),$("#confirmModal .cm-"+i).html(t[i])):"conf_func"===i?$("#confirmModal .cm-conf_func").removeClass("disabled").off("click").on("click",e):"canc_func"===i?$("#confirmModal .cm-canc_func").removeClass("disabled").off("click").on("click",r):"alt_func"===i&&$("#confirmModal .cm-alt_func").removeClass("disabled").off("click").on("click",o)}function r(t){s=$.extend({},s,t),e(t)}function o(t){$("#confirmModal .messages").html(t)}function i(){o("")}function a(){$("#confirmModal .cm-conf_func").addClass("disabled").off("click")}function c(){$("#confirmModal .cm-canc_func").addClass("disabled").off("click")}var s;return{init:t,settings:r,addMsg:o,rmMsg:i,hide:n,disableConf:a,disableCanc:c}}(),t.bBoxIntersect=function(t,n,e){return e=e||0,t.left<=n.right+e&&n.left<=t.right+e&&t.top<=n.bottom+e&&n.top<=t.bottom+e},t.identity=function(t){return t};var y=["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth"],M=["th","st","nd","rd"],x=["zero","one","two","three","four","five","six","seven","eight","nine"];t.num2ordinal=function(t){if(parseFloat(t)===parseInt(t,10)&&!isNaN(t)){if(parseInt(t,10)>=1&&parseInt(t,10)<=9)return y[parseInt(t,10)-1];var n=t%100;return t+(M[(n-20)%10]||M[n]||M[0])}return t},t.ppn=function(t){return t=parseInt(t,10),t>=0&&9>=t?x[t]:t},t.togglecontent=function(t,n,e){$(t+" .js-toggle--"+n).hide(),$(t+" .js-toggle--"+n+"__"+e).show()},t.plotlyurl=function(t){return window.location.origin+"/"+t},t.randstr=function w(t,n,e){if(e||(e=16),void 0===n&&(n=24),0>=n)return"0";var r,o,i,a=Math.log(Math.pow(2,n))/Math.log(e);for(r=2;1/0===a;r*=2)a=Math.log(Math.pow(2,n/r))/Math.log(e)*r;var c=a-Math.floor(a),s="";for(r=0;r<Math.floor(a);r++)i=Math.floor(Math.random()*e).toString(e),s=i+s;c&&(o=Math.pow(e,c),i=Math.floor(Math.random()*o).toString(e),s=i+s);var l=parseInt(s,e);return t&&t.indexOf(s)>-1||1/0!==l&&l>=Math.pow(2,n)?w(t,n,e):s},t.OptionControl=function(t,n){t||(t={}),n||(n="opt");var e={};return e.optionList=[],e._newoption=function(r){r[n]=t,e[r.name]=r,e.optionList.push(r)},e["_"+n]=t,e},t.smooth=function(t,n){var e,r,o,i,a=[],c=[];if(n=Math.round(n),2>n)return t;for(e=1;2*n>e;e++)a.push((1-Math.cos(Math.PI*e/n))/(2*n));var s=a.length,l=t.length;for(e=0;l>e;e++){for(i=0,r=0;s>r;r++)o=e+r+1-n,0>o?o=-1-o:o>=l&&(o=2*l-1-o),i+=t[o]*a[r];c.push(i)}return c},t.getSources=function(n){var e=t.fullFid(n.fid),r=(n.ref_fids||[]).join(",");(e||r)&&$.get("/getsources",{fid:e,extrarefs:r},function(e){n.sourcelist=JSON.parse(e),$.isArray(n.sourcelist)||(console.log("sourcelist error",n.sourcelist),n.sourcelist=[]),t.showSources(n)})},t.fullFid=function(t){return"number"==typeof t&&(t=String(t)),"string"!=typeof t||""===t?"":"tree"===t.substr(t.length-4)?"-1":($.isNumeric(t)&&window.user?window.user+":"+t:t).replace("\\:",":")},t.showSources=function(n){function e(){return pullf({fid:s.ref_fid}),!1}function r(){var t=$("#sourceModal"),n=t.find("#source-viewer").empty();return n.data("jsontree","").jsontree(JSON.stringify(b),{terminators:!1,collapsibleOuter:!1}).show(),h?t.find("[data-fid]").click(function(){return t.modal("hide"),pullf({fid:$(this).attr("data-fid")}),!1}):(t.find("[data-fid]").each(function(){m=$(this).attr("data-fid").split(":"),$(this).attr({href:"/~"+m[0]+"/"+m[1]})}),window.self!==window.top&&t.css({left:"10px",right:"10px",bottom:"10px",width:"auto",height:"auto",margin:0})),t.modal("show"),t.find(".close").off("click").on("click",function(){return t.modal("hide"),!1}),!1}function o(t,n){return 0>v?(console.log("infinite loop?"),t):(v--,i.forEach(function(e){if(e.ref_by_uid===n){var r;if($.isNumeric(e.ref_fid))r='<a href="'+e.ref_url+'" target="_blank">'+e.ref_filename+"</a>";else{var i=e.ref_fid.split(":")[0],a=(i!==window.user?i+": ":"")+e.ref_filename;r='<a href="#" data-fid="'+e.ref_fid+'">'+a+"</a>"}t[r]=o({},e.uid)}}),t)}if(!n._context||!n._context.staticPlot){var i=n.sourcelist;if(!i)return void t.getSources(n);var a=d3.select(n).select(".js-sourcelinks"),c=i.filter(function(t){return $.isNumeric(t.ref_fid)}),s=c[0]||i[0];if(a.text(""),n.shouldshowsources=!1,s){var l={},u={};c.forEach(function(t){l[t.url]=1}),i.forEach(function(t){$.isNumeric(t.ref_fid)||(u[t.ref_fid]=1)});var f,d,m=String(s.ref_fid).split(":"),p=$(n).hasClass("js-plotly-plot"),h=!p||n._context.workspace;if(p){var g=s.fid.split(":")[0];if(i.every(function(t){return String(t.ref_fid).split(":")[0]===g}))return;if(n.shouldshowsources=!0,n.layout.hidesources)return;a.append("tspan").text("Source: "),f=a.append("a").attr({"xlink:xlink:href":"#"}),$.isNumeric(s.ref_fid)?f.attr({"xlink:xlink:show":"new","xlink:xlink:href":s.ref_url}):h||f.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+m[1]+"/~"+m[0]}),i.length>1&&(a.append("tspan").text(" - "),d=a.append("a").attr({"xlink:xlink:href":"#"}))}else a.node()||(a=d3.select(n).select(".grid-container").append("div").attr("class","grid-sourcelinks js-sourcelinks")),a.append("span").text("Source: "),f=a.append("a").attr({href:"#","class":"link--impt"}),$.isNumeric(s.ref_fid)&&f.attr({target:"_blank",href:s.ref_url}),i.length>1&&(a.append("span").text(" - "),d=a.append("a").attr({href:"#"}).classed("link--impt",!0));f.text(s.ref_filename),(!p||h)&&f.on("click",e),d&&d.text("Full list").on("click",r);var v=i.length,b=o({},null)}}},t.isEmpty=function N(t){function n(t){return null===t||void 0===t||""===t}function e(t){return!n&&"object"!=typeof t}return n(t)?!0:"object"!=typeof t?!1:Object.keys(t).map(function(n){return e(t[n])}).some(function(t){return t})?!0:!Object.keys(t).some(function(n){return!N(t[n])})},t.purgeStream=function(t){var n=t.data;n&&n.length&&n.forEach(function(t){delete t.stream})},t.dropdownSelector=function(t){var n=t.items;t.defaults=t.defaults||0;var e=t.cls||"",r=$('<div class="dropdown '+e+'"><a class="link--default link--blocky dropdown-toggle--fixed-width js-dropdown-text" data-toggle="dropdown" data-target="#" href="/"><span class="caret user-caret"></span></a><ul class="dropdown-menu dropdown-toggle--fixed-width" role="menu"></ul></div>'),o=r.find("ul"),i=d3.select(o[0]),a=r.find(".js-dropdown-text").html('<span class="js-selected-val"></span><span class="caret user-caret"></span>'),c=d3.select(a[0]).select(".js-selected-val"),s=i.selectAll("li").data(n).enter().append("li").on("click",function(n,e){c.text(Plotly.util.plainText(n)),t.callback&&t.callback(n,e)});return s.append("a").attr("href","#").text(Plotly.util.plainText),s.each(function(n,e){e===t.defaults&&$(this).click()}),r},t.promiseError=function(t){console.log(t,t.stack)},t.syncOrAsync=function(n,e,r){function o(){return t.markTime("async done "+a.name),t.syncOrAsync(n,e,r)}for(var i,a;n.length;){if(a=n.splice(0,1)[0],i=a(e),i&&i.then)return i.then(o).then(void 0,t.promiseError);t.markTime("sync done "+a.name)}return r&&r(e)},t.dot=function(n,e){function r(t){return Object.keys(t[0]).map(function(n){return t.map(function(t){return t[n]})})}function o(t,n){for(var e=[],r=0;r<t.length;++r)e=e.concat([[t[r],n[r]]]);return e}function i(t,n){return t+n[0]*n[1]}function a(e){return t.dot(n,e)}function c(n){return t.dot(n,e)}return n.length&&e.length&&n.length===e.length?0===n.length?n:n[0].length?n.map(c):e[0].length?r(e).map(a):o(n,e).reduce(i,0):null},t.translationMatrix=function(t,n){return[[1,0,t],[0,1,n],[0,0,1]]},t.rotationMatrix=function(t){var n=t*Math.PI/180;return[[Math.cos(n),-Math.sin(n),0],[Math.sin(n),Math.cos(n),0],[0,0,1]]},t.rotationXYMatrix=function(n,e,r){return t.dot(t.dot(t.translationMatrix(e,r),t.rotationMatrix(n)),t.translationMatrix(-e,-r))},t.apply2DTransform=function(n){return function(){var e=arguments;3===e.length&&(e=e[0]);var r=1===arguments.length?e[0]:[e[0],e[1]];return t.dot(n,[r[0],r[1],1]).slice(0,2)}},t.apply2DTransform2=function(n){var e=t.apply2DTransform(n);return function(t){return e(t.slice(0,2)).concat(e(t.slice(2,4)))}},t.stripTrailingSlash=function(t){return"/"===t.substr(-1)?t.substr(0,t.length-1):t};var _={family:{type:"string"},size:{type:"number",min:1},color:{type:"color"}},k={data_array:function(t,n,e){Array.isArray(t)?n.set(t):void 0!==e&&n.set(e)},enumerated:function(t,n,e,r){n.set(-1===r.values.indexOf(t)?e:t)},"boolean":function(t,n,e){n.set(t===!0||t===!1?t:e)},number:function(t,n,e,r){n.set(!$.isNumeric(t)||void 0!==r.min&&t<r.min||void 0!==r.max&&t>r.max?e:+t)},integer:function(t,n,e,r){n.set(t%1||!$.isNumeric(t)||void 0!==r.min&&t<r.min||void 0!==r.max&&t>r.max?e:+t)},string:function(t,n,e,r){var o=String(t);n.set(void 0===t||r.noBlank===!1&&!o?e:String(t))},color:function(t,n,e){n.set(tinycolor(t).ok?t:e)},colorscale:function(t,n,e){n.set(Plotly.Color.getScale(t,e))},font:function(n,e,r){n||(n={});var o={};t.coerce(n,o,_,"family",r.family),o.family||(o.family=r.family),t.coerce(n,o,_,"size",r.size),t.coerce(n,o,_,"color",r.color),e.set(o)},angle:function(t,n,e){"auto"===t?n.set("auto"):$.isNumeric(t)?(Math.abs(t)>180&&(t-=360*Math.round(t/360)),n.set(+t)):n.set(e)},axisid:function(t,n,e){if("string"==typeof t&&t.charAt(0)===e){var r=Number(t.substr(1));if(r%1===0&&r>1)return void n.set(t)}n.set(e)},sceneid:function(t,n,e){if("string"==typeof t&&t.substr(0,5)===e){var r=Number(t.substr(5));if(r%1===0&&r>1)return void n.set(t)}n.set(e)},any:function(t,n,e){n.set(void 0===t?e:t)}};t.coerce=function(n,e,r,o,i){var a=t.nestedProperty(r,o).get(),c=t.nestedProperty(n,o),s=t.nestedProperty(e,o),l=c.get();return void 0===i&&(i=a.dflt),a.arrayOk&&Array.isArray(l)?(s.set(l),l):(k[a.type](l,s,i,a),s.get())},t.mergeArray=function(t,n,e){if($.isArray(t))for(var r=Math.min(t.length,n.length),o=0;r>o;o++)n[o][e]=t[o]},t.minExtend=function(n,e){var r={};"object"!=typeof e&&(e={});var o=3;return Object.keys(n).forEach(function(i){var a=n[i];"_"!==i.charAt(0)&&"function"!=typeof a&&(r[i]="module"===i?a:Array.isArray(a)?a.slice(0,o):a&&"object"==typeof a?t.minExtend(n[i],e[i]):a)}),Object.keys(e).forEach(function(t){var n=e[t];"object"==typeof n&&t in r&&"object"==typeof r[t]||(r[t]=n)}),r}}();(function(){if(!window.Plotly){window.Plotly={};}var b=window.Plotly.util={};b.scriptLoader=function(h,e){var g={loadDelay:0};function f(t){var l=g.loadDelay;var q=[].concat(t);var r,m=h.getElementsByTagName("script")[0];function j(x,v,u,w){if(h.getElementById(x)){return;}setTimeout(function(){r=h.createElement("script");r.type="text/javascript";r.id=x;r.async=true;r.src=v;m.parentNode.insertBefore(r,m);if(w){w.call(window);}},u);}var s=/^http:/.test(h.location)?"http":"https";var p=(s==="https")?"https://ssl":"http://www";if(q.indexOf("facebook")!==-1){var o=document.querySelector("body");var n=o.firstChild;var i=document.createElement("div");i.id="fb-root";o.insertBefore(i,n);e.fbAsyncInit=function(){FB.init({appId:ENV.FACEBOOK_PAGE_APP_ID,status:true,cookie:true,xfbml:true});};var k=false;j("facebook-jssdk","//connect.facebook.net/en_US/all"+(k?"/debug":"")+".js",l);}if(q.indexOf("googleAnalytics")!==-1){e._gaq=e._gaq||[];e._gaq.push(["_setAccount",ENV.GOOGLEANALYTICS_ACCOUNT]);e._gaq.push(["_setSiteSpeedSampleRate",10]);e._gaq.push(["_trackPageview"]);j("google-analytics",p+".google-analytics.com/ga.js",l);}if(q.indexOf("googlePlus")!==-1){j("google-plus","https://apis.google.com/js/plusone.js",l);}if(q.indexOf("twitter")!==-1){j("twitter-wjs",s+"://platform.twitter.com/widgets.js",l);}}f.config=function(i){g=i;return this;};return f;};b.imageExporter=function d(){var o=d3.dispatch("success","error");var k="png",i={width:300,height:150},f={width:300,height:150},e="url",g=0,n,p="Converted Image",h="canvasEl",m="canvasContainer";function j(B){var A,D,z;if(typeof B==="string"){A=B;D=f.width;z=f.height;}else{if(!!B.append||!!B.className){var t=(!!B.append)?B.node():B;var C=new XMLSerializer();A=C.serializeToString(t);D=t.offsetWidth;z=t.offsetHeight;}else{l("wrong input svg (d3 selection or DOM node)");}}if(n){n.html("");}n=d3.select("body").append("div").attr({id:m}).style({position:"absolute",top:0,left:0,"z-index":1000});if(g<2){n.style({visibility:"hidden"});}var r=n.append("canvas").attr({id:h,width:D,height:z});var s=r.node();var E=s.getContext("2d");var u=self.URL||self.webkitURL||self;var v=new Image();var y=new Blob([A],{type:"image/svg+xml;charset=utf-8"});var q=u.createObjectURL(y);v.onload=function(){E.drawImage(v,0,0);u.revokeObjectURL(q);x();};v.onerror=function(){u.revokeObjectURL(q);l("img didnt load");};v.src=q;function x(){setTimeout(function(){var G;if(k==="jpeg"){G=s.toDataURL("image/jpeg");}else{if(k==="png"){G=s.toDataURL("image/png");}else{if(k==="svg"){G=B;}else{if(k==="pdf"){G=s.toDataURL("image/jpeg");var H=700/1058;var w=D>z?"landscape":"portrait";var F=new jsPDF(w,"pt",[z*H,D*H]);F.addImage(G,"JPEG",0,0,D*H,z*H);G=F.output("dataurlstring");}else{l({err:"Image format is not jpeg, png, svg, or pdf",code:400});}}}}if(g===0){n.remove();r.remove();}if(G){o.success(G);}else{l({err:"Image is empty",code:530});}},0);}}function l(q){o.error(q);if(g===1){console.log("Error: "+q);}else{if(g===2){throw(q);}}}d3.rebind(j,o,"on");j.imageFormat=function(q){k=q;return this;};j.outputType=function(q){e=q;return this;};j.debugLevel=function(q){g=q;return this;};j.title=function(q){p=q;return this;};j.sourceSize=function(q){f=q;return this;};j.targetSize=function(q){i=q;return this;};j.canvasContainerId=function(q){m=q;return this;};j.canvasElId=function(q){h=q;return this;};return j;};d3.selection.prototype.appendSVG=function(f){var g='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+f+"</svg>",h=new DOMParser().parseFromString(g,"application/xml"),e=h.documentElement.firstChild;while(e){this.node().appendChild(this.node().ownerDocument.importNode(e,true));e=e.nextSibling;}if(h.querySelector("parsererror")){console.log(h.querySelector("parsererror div").innerText);return null;}return d3.select(this.node().lastChild);};b.compileTemplate=function(f,e){return[].concat(e).map(function(g){return f.replace(/{([^}]*)}/g,function(i,h){return g[h]||"";});}).join("\n");};b.tmpl=function(r,j){var i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var l=/\\|'|\r|\n|\u2028|\u2029/g;var k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var s=function(e){return"\\"+k[e];};var q=/(.)^/;var m=new RegExp([(i.escape||q).source,(i.interpolate||q).source,(i.evaluate||q).source].join("|")+"|$","g");var n=0;var f="__p+='";r.replace(m,function(t,u,e,w,v){f+=r.slice(n,v).replace(l,s);n=v+t.length;if(u){f+="'+\n((__t=("+u+"))==null?'':_.escape(__t))+\n'";}else{if(e){f+="'+\n((__t=("+e+"))==null?'':__t)+\n'";}else{if(w){f+="';\n"+w+"\n__p+='";}}}return t;});f+="';\n";if(!i.variable){f="with(obj||{}){\n"+f+"}\n";}f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";var h;try{h=new Function(i.variable||"obj","_",f);}catch(o){o.source=f;throw o;}if(j){return h(j);}var p=function(e){return h.call(this,e);};var g=i.variable||"obj";p.source="function("+g+"){\n"+f+"}";return p;};b.getSVGBBoxFromString=function(i,e){var g=d3.select("body").append("div").style({visibility:"none"});var f=g.append("svg").append("text").text(i).style(e);var h=f.node().getBBox();g.remove();return h;};b.html_entity_decode=function(f){var e=d3.select("body").append("div").style({display:"none"}).html("");var g=f.replace(/(&[^;]*;)/gi,function(h){if(h==="&lt;"){return"&#60;";}if(h==="&rt;"){return"&#62;";}return e.html(h).text();});e.remove();return g;};b.xml_entity_encode=function(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;");};b.toCamelCase=function(e){return e.toLowerCase().replace(/-(.)/g,function(g,f){return f.toUpperCase();});};b.jsHook=function(f){var e=f.className.match(/js-[^ ]+/);return(e)?e[0]:null;};b.wrap=function(e){return function(){var j=this;function m(){var n=this.node().getBBox().height;this.text("").selectAll("tspan").data(g).enter().append("tspan").attr({x:0,y:function(p,o){return(o+1)*n;}}).text(function(o){return o.join(" ");});}function l(p){var o=j.style({visibility:"hidden"}).text(p);var n=o.node().getBBox().width;j.style({visibility:"visible"}).text(k);return n;}var k=this.text();var f=this.node().parentNode;var i=k.split(" ");var g=[[]];var h=0;i.forEach(function(n){if(l(g[h].concat(n).join(" "),f)>=e){h++;g[h]=[];}g[h].push(n);});this.call(m);};};b.getSize=function(e,f){return e.node().getBoundingClientRect()[f];};b.convertToTspans=function(f,m){var i=f.text();var l=Plotly.util.convertToSvg(i);var h=f;var k=(!h.attr("data-notex"))&&l.match(/([^$]*)([$]+[^$]*[$]+)([^$]*)/);var n=i;var j=d3.select(h.node().parentNode);if(j.empty()){return;}var e=(h.attr("class"))?h.attr("class").split(" ")[0]:"text";e+="-math";j.selectAll("svg."+e).remove();j.selectAll("g."+e+"-group").remove();f.style({visibility:null}).attr("data-bb",null);$(f.node()).parents().attr("data-bb",null);if(k){var g=$(h.node()).parents(".js-plotly-plot")[0];((g&&g._promises)||[]).push(new Promise(function(p){h.style({visibility:"hidden"});var o={fontSize:parseInt(h.style("font-size"),10)};Plotly.util.texToSVG(k[2],o,function(s,y,B){var v='<g class="'+e+'-group">'+s+"</g>";j.selectAll("svg."+e).remove();j.selectAll("g."+e+"-group").remove();var t=j.appendSVG(v).select("svg");if(!t){return;}if(y&&y.node()){t.node().insertBefore(y.node().cloneNode(true),t.node().firstChild);}var w=j.select("g."+e+"-group").attr({"pointer-events":"none"});var x={width:Plotly.util.getSize(h,"width"),height:parseInt(h.style("font-size"),10)||Plotly.util.getSize(h,"height")};t.attr({"class":e,height:B.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var A=h.style("fill")||"black";t.select("g").attr({fill:A,stroke:A});var u=Plotly.util.getSize(t,"width"),r=Plotly.util.getSize(t,"height"),q=+h.attr("x")-u*{start:0,middle:0.5,end:1}[h.attr("text-anchor")||"start"],z=-x.height/4;if(e[0]==="y"){w.attr({transform:"rotate("+[-90,+h.attr("x"),+h.attr("y")]+") translate("+[-u/2,z-r/2]+")"});t.attr({x:+h.attr("x"),y:+h.attr("y")});}else{if(e[0]==="l"){t.attr({x:h.attr("x"),y:z-(r/2)});}else{if(e[0]==="a"){t.attr({x:0,y:z});}else{t.attr({x:q,y:(+h.attr("y")+z-r/2)});}}}if(m){m.call(h,w);}p(w);});}));}else{if(!j.empty()){e=h.attr("class")+"-math";j.select("svg."+e).remove();}f.text("");n=f.appendSVG(l);if(!n){f.text(i);}if(m){m.call(h);}}return f;};b.texToSVG=function(g,h,e){var i="math-output-"+Math.random();var f=d3.select("body").append("div").attr({id:i}).style({visibility:"hidden",position:"absolute"}).style({"font-size":h.fontSize+"px"}).text(g);MathJax.Hub.Queue(["Typeset",MathJax.Hub,f.node()],function(){var k=d3.select("body").select("#MathJax_SVG_glyphs"),j;if(!f.select(".MathJax_SVG").empty()&&f.select("svg").node()){j=f.select("svg").node().getBoundingClientRect();e(f.select(".MathJax_SVG").html(),k,j);}else{console.log("There was an error in the tex syntax.");f.html("<svg><text>"+g+"</text></svg>");j=f.select("svg").node().getBoundingClientRect();e(f.html(),null,j);}f.remove();});};var a={sup:'font-size:70%" dy="-0.6em',sub:'font-size:70%" dy="0.3em',b:"font-weight:bold",i:"font-style:italic",a:"",font:"",span:"",br:"",em:"font-style:italic;font-weight:bold"};var c=new RegExp("</?("+Object.keys(a).join("|")+")( [^>]*)?/?>","g");b.plainText=function(e){return(e||"").replace(c," ");};b.convertToSvg=function(j){var f=d3.keys(a).map(function(n){return n.toUpperCase();});var e=Plotly.util.html_entity_decode(j);var m=e.split(/(<[^<>]*>)/).map(function(o){var n=o.match(/<(\/?)([^ >]*)[ ]?(.*)>/i);if(n&&(n[2]in a||f.indexOf(n[2])!==-1)){if((n[2]==="a"||n[2]==="A")&&n[3]){return'<a xlink:show="new" xlink:'+a[n[2]]+n[3]+">";}else{if((n[2]==="a"||n[2]==="A")&&n[1]){return"</a>";}else{if(n[1]){if(n[2]==="sup"||n[2]==="SUP"){return'</tspan><tspan dy="0.42em">&#x200b;</tspan>';}if(n[2]==="sub"||n[2]==="SUB"){return'</tspan><tspan dy="-0.21em">&#x200b;</tspan>';}return"</tspan>";}else{if(n[3]){return"<tspan "+a[n[2]]+n[3]+">";}else{if(n[2]==="br"||n[2]==="BR"){return o;}else{return'<tspan style="'+a[n[2]]+'">';}}}}}}else{return Plotly.util.xml_entity_encode(o).replace(/</g,"&lt;");}});var k=[];for(var h=m.indexOf("<br>");h>0;h=m.indexOf("<br>",h+1)){k.push(h);}var g=0;k.forEach(function(r){var s=r+g;var o=m.slice(0,s);var n="";for(var p=o.length-1;p>=0;p--){var q=o[p].match(/<(\/?).*>/i);if(q&&o[p]!=="<br>"){if(!q[1]){n=o[p];}break;}}if(n){m.splice(s+1,0,n);m.splice(s,0,"</tspan>");g+=2;}});var l=m.join("");var i=l.split(/<br>/gi);if(i.length>1){m=i.map(function(o,n){return'<tspan class="line" dy="'+(n*1.3)+'em">'+o+"</tspan>";});}return m.join("");};b.alignSVGWith=function(f,e){return function(){var k=f.node().getBBox();var i="50%";var j=i;var h="middle";var l=0;var g=e.horizontalMargin||0;if(e.orientation==="under"){l=k.y+k.height;}else{if(e.orientation==="over"){l=k.y;}else{if(e.orientation==="inside"){l=k.y;}}}if(e.verticalMargin){l+=e.verticalMargin;}if(e.horizontalAlign==="center"){i="50%";h="middle";g=g/4;}else{if(e.horizontalAlign==="right"){i="0%";h="start";}else{if(e.horizontalAlign==="left"){i="100%";h="end";g=-g;}else{if(typeof e.horizontalAlign==="number"){i=e.horizontalAlign;h="middle";}}}}if(e.orientation==="inside"){j=0;}this.attr({x:j,dx:g,y:l}).style({"text-anchor":h}).selectAll("tspan.line").attr({x:i,dx:g,y:l});return this;};};b.alignHTMLWith=function(e){return function(){var f=e.node().getBoundingClientRect();this.style({top:f.top+"px",left:f.left+"px","z-index":1000});return this;};};b.alignHTMLWith2=function(e){return function(){var f=e.node().getBoundingClientRect();this.style({left:f.left+"px","z-index":1000});return this;};};b.makeEditable=function(j,l){var k=this;var i=d3.dispatch("edit","input","cancel");var e=d3.select(this.node()).style({"pointer-events":"all"}).attr({"xml:space":"preserve"});var f=l||e;if(l){e.style({"pointer-events":"none"});}f.on("click",function(){g();k.style({opacity:0});var n=d3.select(this).attr("class"),m;if(n){m="."+n.split(" ")[0]+"-math-group";}else{m="[class*=-math-group]";}if(m){d3.select(k.node().parentNode).select(m).style({opacity:0});}});function h(p){var n=p.node();var m=document.createRange();m.selectNodeContents(n);var o=window.getSelection();o.removeAllRanges();o.addRange(m);n.focus();}function g(){var m=d3.select("body").append("div").classed("plugin-editable editable",true);m.style({position:"absolute","font-family":k.style("font-family")||"Arial","font-size":k.style("font-size")||12,color:k.style("fill")||"black",opacity:1,"background-color":"transparent",outline:"#ffffff33 1px solid",margin:[-parseFloat(k.style("font-size"))/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:true}).text(k.attr("data-unformatted")).call(Plotly.util.alignHTMLWith(k)).on("blur",function(){k.text(this.textContent).style({opacity:1});var o=d3.select(this).attr("class"),n;if(o){n="."+o.split(" ")[0]+"-math-group";}else{n="[class*=-math-group]";}if(n){d3.select(k.node().parentNode).select(n).style({opacity:0});}var p=this.textContent;d3.select(this).transition().duration(0).remove();d3.select(document).on("mouseup",null);i.edit.call(k,p);}).on("focus",function(){var n=this;d3.select(document).on("mouseup",function(){if(d3.event.target===n){return false;}if(document.activeElement===m.node()){m.node().blur();}});}).on("keyup",function(){if(d3.event.which===27){k.style({opacity:1});d3.select(this).style({opacity:0}).on("blur",function(){return false;}).transition().remove();i.cancel.call(k,this.textContent);}else{i.input.call(k,this.textContent);d3.select(this).call(Plotly.util.alignHTMLWith2(k));}}).on("keydown",function(){if(d3.event.which===13){this.blur();}}).call(h);}return d3.rebind(this,i,"on");};b.deepExtend=function(e,g){for(var f in g){if(g[f]&&g[f].constructor&&g[f].constructor===Object){e[f]=e[f]||{};b.deepExtend(e[f],g[f]);}else{e[f]=g[f];}}return e;};b.UndoManager=function(){var h=[],e=-1,g=false,i;function f(k,j){if(!k){return this;}g=true;k[j]();g=false;return this;}return{add:function(j){if(g){return this;}h.splice(e+1,h.length-e);h.push(j);e=h.length-1;return this;},setCallback:function(j){i=j;},undo:function(){var j=h[e];if(!j){return this;}f(j,"undo");e-=1;if(i){i(j.undo);}return this;},redo:function(){var j=h[e+1];if(!j){return this;}f(j,"redo");e+=1;if(i){i(j.redo);}return this;},clear:function(){h=[];e=-1;},hasUndo:function(){return e!==-1;},hasRedo:function(){return e<(h.length-1);},getCommands:function(){return h;},getPreviousCommand:function(){return h[e-1];},getIndex:function(){return e;}};};}());!function(){"use strict";function n(n,t,r,o){var e=n[0]-t[0],d=n[1]-t[1],u=r[0]-t[0],l=r[1]-t[1],a=Math.pow(e*e+d*d,i/2),s=Math.pow(u*u+l*l,i/2),c=(s*s*e-a*a*u)*o,f=(s*s*d-a*a*l)*o,h=3*s*(a+s),L=3*a*(a+s);return[[d3.round(t[0]+(h&&c/h),2),d3.round(t[1]+(h&&f/h),2)],[d3.round(t[0]-(L&&c/L),2),d3.round(t[1]-(L&&f/L),2)]]}var t=Plotly.Drawing={};t.font=function(n,t,r,o){t&&t.family&&(o=t.color,r=t.size,t=t.family),t&&n.style("font-family",t),r&&n.style("font-size",r+"px"),o&&n.call(Plotly.Color.fill,o)},t.setPosition=function(n,t,r){n.attr("x",t).attr("y",r)},t.setSize=function(n,t,r){n.attr("width",t).attr("height",r)},t.setRect=function(n,r,o,e,d){n.call(t.setPosition,r,o).call(t.setSize,e,d)},t.translatePoints=function(n,t,r){n.each(function(n){var o=n.xp||t.c2p(n.x),e=n.yp||r.c2p(n.y),d=d3.select(this);$.isNumeric(o)&&$.isNumeric(e)?"text"===this.nodeName?d.attr("x",o).attr("y",e):d.attr("transform","translate("+o+","+e+")"):d.remove()})},t.getPx=function(n,t){return Number(n.style(t).replace(/px$/,""))},t.lineGroupStyle=function(n,t,r,o){n.style("fill","none").each(function(n){var e=(((n||[])[0]||{}).trace||{}).line||{},d=t||e.width||0,u=o||e.dash||"",i=Math.max(d,3);"solid"===u?u="":"dot"===u?u=i+"px,"+i+"px":"dash"===u?u=3*i+"px,"+3*i+"px":"longdash"===u?u=5*i+"px,"+5*i+"px":"dashdot"===u?u=3*i+"px,"+i+"px,"+i+"px,"+i+"px":"longdashdot"===u&&(u=5*i+"px,"+2*i+"px,"+i+"px,"+2*i+"px"),d3.select(this).call(Plotly.Color.stroke,r||e.color).style({"stroke-dasharray":u,"stroke-width":d+"px"})})},t.fillGroupStyle=function(n){n.style("stroke-width",0).each(function(t){var r=d3.select(this);try{r.call(Plotly.Color.fill,t[0].trace.fillcolor)}catch(o){console.log(o,n),r.remove()}})};var r={circle:{n:0,f:function(n){var t=d3.round(n,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(n){var t=d3.round(n,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(n){var t=d3.round(1.3*n,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(n){var t=d3.round(.4*n,2),r=d3.round(1.2*n,2);return"M"+r+","+t+"H"+t+"V"+r+"H-"+t+"V"+t+"H-"+r+"V-"+t+"H-"+t+"V-"+r+"H"+t+"V-"+t+"H"+r+"Z"}},x:{n:4,f:function(n){var t=d3.round(.8*n/Math.sqrt(2),2),r="l"+t+","+t,o="l"+t+",-"+t,e="l-"+t+",-"+t,d="l-"+t+","+t;return"M0,"+t+r+o+e+o+e+d+e+d+r+d+r+"Z"}},"triangle-up":{n:5,f:function(n){var t=d3.round(2*n/Math.sqrt(3),2),r=d3.round(n/2,2),o=d3.round(n,2);return"M-"+t+","+r+"H"+t+"L0,-"+o+"Z"}},"triangle-down":{n:6,f:function(n){var t=d3.round(2*n/Math.sqrt(3),2),r=d3.round(n/2,2),o=d3.round(n,2);return"M-"+t+",-"+r+"H"+t+"L0,"+o+"Z"}},"triangle-left":{n:7,f:function(n){var t=d3.round(2*n/Math.sqrt(3),2),r=d3.round(n/2,2),o=d3.round(n,2);return"M"+r+",-"+t+"V"+t+"L-"+o+",0Z"}},"triangle-right":{n:8,f:function(n){var t=d3.round(2*n/Math.sqrt(3),2),r=d3.round(n/2,2),o=d3.round(n,2);return"M-"+r+",-"+t+"V"+t+"L"+o+",0Z"}},"triangle-ne":{n:9,f:function(n){var t=d3.round(.6*n,2),r=d3.round(1.2*n,2);return"M-"+r+",-"+t+"H"+t+"V"+r+"Z"}},"triangle-se":{n:10,f:function(n){var t=d3.round(.6*n,2),r=d3.round(1.2*n,2);return"M"+t+",-"+r+"V"+t+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(n){var t=d3.round(.6*n,2),r=d3.round(1.2*n,2);return"M"+r+","+t+"H-"+t+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(n){var t=d3.round(.6*n,2),r=d3.round(1.2*n,2);return"M-"+t+","+r+"V-"+t+"H"+r+"Z"}},pentagon:{n:13,f:function(n){var t=d3.round(.951*n,2),r=d3.round(.588*n,2),o=d3.round(-n,2),e=d3.round(n*-.309,2),d=d3.round(.809*n,2);return"M"+t+","+e+"L"+r+","+d+"H-"+r+"L-"+t+","+e+"L0,"+o+"Z"}},hexagon:{n:14,f:function(n){var t=d3.round(n,2),r=d3.round(n/2,2),o=d3.round(n*Math.sqrt(3)/2,2);return"M"+o+",-"+r+"V"+r+"L0,"+t+"L-"+o+","+r+"V-"+r+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(n){var t=d3.round(n,2),r=d3.round(n/2,2),o=d3.round(n*Math.sqrt(3)/2,2);return"M-"+r+","+o+"H"+r+"L"+t+",0L"+r+",-"+o+"H-"+r+"L-"+t+",0Z"}},octagon:{n:16,f:function(n){var t=d3.round(.924*n,2),r=d3.round(.383*n,2);return"M-"+r+",-"+t+"H"+r+"L"+t+",-"+r+"V"+r+"L"+r+","+t+"H-"+r+"L-"+t+","+r+"V-"+r+"Z"}},star:{n:17,f:function(n){var t=1.4*n,r=d3.round(.225*t,2),o=d3.round(.951*t,2),e=d3.round(.363*t,2),d=d3.round(.588*t,2),u=d3.round(-t,2),i=d3.round(t*-.309,2),l=d3.round(.118*t,2),a=d3.round(.809*t,2),s=d3.round(.382*t,2);return"M"+r+","+i+"H"+o+"L"+e+","+l+"L"+d+","+a+"L0,"+s+"L-"+d+","+a+"L-"+e+","+l+"L-"+o+","+i+"H-"+r+"L0,"+u+"Z"}},hexagram:{n:18,f:function(n){var t=d3.round(.66*n,2),r=d3.round(.38*n,2),o=d3.round(.76*n,2);return"M-"+o+",0l-"+r+",-"+t+"h"+o+"l"+r+",-"+t+"l"+r+","+t+"h"+o+"l-"+r+","+t+"l"+r+","+t+"h-"+o+"l-"+r+","+t+"l-"+r+",-"+t+"h-"+o+"Z"}},"star-triangle-up":{n:19,f:function(n){var t=d3.round(n*Math.sqrt(3)*.8,2),r=d3.round(.8*n,2),o=d3.round(1.6*n,2),e=d3.round(4*n,2),d="A "+e+","+e+" 0 0 1 ";return"M-"+t+","+r+d+t+","+r+d+"0,-"+o+d+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(n){var t=d3.round(n*Math.sqrt(3)*.8,2),r=d3.round(.8*n,2),o=d3.round(1.6*n,2),e=d3.round(4*n,2),d="A "+e+","+e+" 0 0 1 ";return"M"+t+",-"+r+d+"-"+t+",-"+r+d+"0,"+o+d+t+",-"+r+"Z"}},"star-square":{n:21,f:function(n){var t=d3.round(1.1*n,2),r=d3.round(2*n,2),o="A "+r+","+r+" 0 0 1 ";return"M-"+t+",-"+t+o+"-"+t+","+t+o+t+","+t+o+t+",-"+t+o+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(n){var t=d3.round(1.4*n,2),r=d3.round(1.9*n,2),o="A "+r+","+r+" 0 0 1 ";return"M-"+t+",0"+o+"0,"+t+o+t+",0"+o+"0,-"+t+o+"-"+t+",0Z"}},"diamond-tall":{n:23,f:function(n){var t=d3.round(.7*n,2),r=d3.round(1.4*n,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(n){var t=d3.round(1.4*n,2),r=d3.round(.7*n,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},hourglass:{n:25,f:function(n){var t=d3.round(n,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:!0},bowtie:{n:26,f:function(n){var t=d3.round(n,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:!0},"circle-cross":{n:27,f:function(n){var t=d3.round(n,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(n){var t=d3.round(n,2),r=d3.round(n/Math.sqrt(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(n){var t=d3.round(n,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(n){var t=d3.round(n,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(n){var t=d3.round(1.3*n,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(n){var t=d3.round(1.3*n,2),r=d3.round(.65*n,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"ZM-"+r+",-"+r+"L"+r+","+r+"M-"+r+","+r+"L"+r+",-"+r},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(n){var t=d3.round(1.4*n,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:!0,noDot:!0},"x-thin":{n:34,f:function(n){var t=d3.round(n,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0},asterisk:{n:35,f:function(n){var t=d3.round(1.2*n,2),r=d3.round(.85*n,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r},needLine:!0,noDot:!0},hash:{n:36,f:function(n){var t=d3.round(n/2,2),r=d3.round(n,2);return"M"+t+","+r+"V-"+r+"m-"+r+",0V"+r+"M"+r+","+t+"H-"+r+"m0,-"+r+"H"+r},needLine:!0},"y-up":{n:37,f:function(n){var t=d3.round(1.2*n,2),r=d3.round(1.6*n,2),o=d3.round(.8*n,2);return"M-"+t+","+o+"L0,0M"+t+","+o+"L0,0M0,-"+r+"L0,0"},needLine:!0,noDot:!0},"y-down":{n:38,f:function(n){var t=d3.round(1.2*n,2),r=d3.round(1.6*n,2),o=d3.round(.8*n,2);return"M-"+t+",-"+o+"L0,0M"+t+",-"+o+"L0,0M0,"+r+"L0,0"},needLine:!0,noDot:!0},"y-left":{n:39,f:function(n){var t=d3.round(1.2*n,2),r=d3.round(1.6*n,2),o=d3.round(.8*n,2);return"M"+o+","+t+"L0,0M"+o+",-"+t+"L0,0M-"+r+",0L0,0"},needLine:!0,noDot:!0},"y-right":{n:40,f:function(n){var t=d3.round(1.2*n,2),r=d3.round(1.6*n,2),o=d3.round(.8*n,2);return"M-"+o+","+t+"L0,0M-"+o+",-"+t+"L0,0M"+r+",0L0,0"},needLine:!0,noDot:!0},"line-ew":{n:41,f:function(n){var t=d3.round(1.4*n,2);return"M"+t+",0H-"+t},needLine:!0,noDot:!0},"line-ns":{n:42,f:function(n){var t=d3.round(1.4*n,2);return"M0,"+t+"V-"+t},needLine:!0,noDot:!0},"line-ne":{n:43,f:function(n){var t=d3.round(n,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:!0,noDot:!0},"line-nw":{n:44,f:function(n){var t=d3.round(n,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:!0,noDot:!0}};t.symbolNames=[],t.symbolFuncs=[],t.symbolNeedLines={},t.symbolNoDot={},t.symbolList=[],Object.keys(r).forEach(function(n){var o=r[n];t.symbolList=t.symbolList.concat([o.n,n,o.n+100,n+"-open"]),t.symbolNames[o.n]=n,t.symbolFuncs[o.n]=o.f,o.needLine&&(t.symbolNeedLines[o.n]=!0),o.noDot?t.symbolNoDot[o.n]=!0:t.symbolList=t.symbolList.concat([o.n+200,n+"-dot",o.n+300,n+"-open-dot"])});var o=t.symbolNames.length,e="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";t.symbolNumber=function(n){if("string"==typeof n){var r=0;n.indexOf("-open")>0&&(r=100,n=n.replace("-open","")),n.indexOf("-dot")>0&&(r+=200,n=n.replace("-dot","")),n=t.symbolNames.indexOf(n),n>=0&&(n+=r)}return n%100>=o||n>=400?0:Math.floor(Math.max(n,0))},t.pointStyle=function(n,r){if(n.size()){var o=r.marker,d=o.line;if(Plotly.Plots.isScatterAny(r.type)||"box"===r.type){var u,i=o.sizeref||1,l="area"===o.sizemode?function(n){return Math.sqrt(n/i)}:function(n){return n/i};n.attr("d",function(n){u=n.ms+1?l(n.ms/2):o.size/2,n.mrc=u,(!$.isNumeric(u)||0>u)&&(u=3);var r=t.symbolNumber(n.mx||o.symbol)||0,d=r%100;return n.om=r%200>=100,t.symbolFuncs[d](u)+(r>=200?e:"")}).style("opacity",function(n){return(n.mo+1||o.opacity+1)-1})}var a=(r._input||{}).marker||{},s=t.tryColorscale(o,a,""),c=t.tryColorscale(o,a,"line.");n.each(function(n){var t,r,e;n.so?(e=d.outlierwidth,r=d.outliercolor,t=o.outliercolor):(e=(n.mlw+1||d.width+1||(n.trace?n.trace.marker.line.width:0)+1)-1,r="mlc"in n?n.mlcc=c(n.mlc):Array.isArray(d.color)?"#444":d.color,t="mc"in n?n.mcc=s(n.mc):Array.isArray(o.color)?"#444":o.color);var u=d3.select(this);n.om?u.call(Plotly.Color.stroke,t).style({"stroke-width":(e||1)+"px",fill:"none"}):(u.style("stroke-width",e+"px").call(Plotly.Color.fill,t),e&&u.call(Plotly.Color.stroke,r))})}},t.tryColorscale=function(n,t,r){var o=Plotly.Lib.nestedProperty(n,r+"color").get(),e=Plotly.Lib.nestedProperty(n,r+"colorscale").get(),d=Plotly.Lib.nestedProperty(n,r+"cauto").get(),u=Plotly.Lib.nestedProperty(n,r+"cmin"),i=Plotly.Lib.nestedProperty(n,r+"cmax"),l=u.get(),a=i.get();if(e&&Array.isArray(o)){"string"==typeof e&&(e=Plotly.Color.scales[e]),e||(e=Plotly.Color.defaultScale),!d&&$.isNumeric(l)&&$.isNumeric(a)||(l=1/0,a=-1/0,o.forEach(function(n){$.isNumeric(n)&&(l>n&&(l=n),n>a&&(a=n))}),l>a&&(l=0,a=1),u.set(l),i.set(a),Plotly.Lib.nestedProperty(t,r+"cmin").set(l),Plotly.Lib.nestedProperty(t,r+"cmax").set(a));var s=d3.scale.linear().domain(e.map(function(n){return l+n[0]*(a-l)})).interpolate(d3.interpolateRgb).range(e.map(function(n){return n[1]}));return function(n){return $.isNumeric(n)?s(n):n}}return Plotly.Lib.identity};var d={start:1,end:-1,middle:0,bottom:1,top:-1},u=1.3;t.textPointStyle=function(n,r){n.each(function(n){var o=d3.select(this);if(!n.tx)return void o.remove();var e=n.tp||r.textposition,i=-1!==e.indexOf("top")?"top":-1!==e.indexOf("bottom")?"bottom":"middle",l=-1!==e.indexOf("left")?"end":-1!==e.indexOf("right")?"start":"middle",a=n.ts||r.textfont.size,s=n.mrc?n.mrc/.8+1:0;o.call(t.font,n.tf||r.textfont.family,a,n.tc||r.textfont.color).attr("text-anchor",l).text(n.tx).call(Plotly.util.convertToTspans);var c=d3.select(this.parentNode),f=o.selectAll("tspan.line"),h=((f[0].length||1)-1)*u+1,L=d[l]*s,m=.75*a+d[i]*s+(d[i]-1)*h*a/2;c.attr("transform","translate("+L+","+m+")"),h>1&&f.attr({x:o.attr("x"),y:o.attr("y")})})};var i=.5;t.smoothopen=function(t,r){if(t.length<3)return"M"+t.join("L");var o,e="M"+t[0],d=[];for(o=1;o<t.length-1;o++)d.push(n(t[o-1],t[o],t[o+1],r));for(e+="Q"+d[0][0]+" "+t[1],o=2;o<t.length-1;o++)e+="C"+d[o-2][1]+" "+d[o-1][0]+" "+t[o];return e+="Q"+d[t.length-3][1]+" "+t[t.length-1]},t.smoothclosed=function(t,r){if(t.length<3)return"M"+t.join("L")+"Z";var o,e="M"+t[0],d=t.length-1,u=[n(t[d],t[0],t[1],r)];for(o=1;d>o;o++)u.push(n(t[o-1],t[o],t[o+1],r));for(u.push(n(t[d-1],t[d],t[0],r)),o=1;d>=o;o++)e+="C"+u[o-1][1]+" "+u[o][0]+" "+t[o];return e+="C"+u[d][1]+" "+u[0][0]+" "+t[0]+"Z"};var l={hv:function(n,t){return"H"+d3.round(t[0],2)+"V"+d3.round(t[1],2)},vh:function(n,t){return"V"+d3.round(t[1],2)+"H"+d3.round(t[0],2)},hvh:function(n,t){return"H"+d3.round((n[0]+t[0])/2,2)+"V"+d3.round(t[1],2)+"H"+d3.round(t[0],2)},vhv:function(n,t){return"V"+d3.round((n[1]+t[1])/2,2)+"H"+d3.round(t[0],2)+"V"+d3.round(t[1],2)}},a=function(n,t){return"L"+d3.round(t[0],2)+","+d3.round(t[1],2)};t.steps=function(n){var t=l[n]||a;return function(n){for(var r="M"+d3.round(n[0][0],2)+","+d3.round(n[0][1],2),o=1;o<n.length;o++)r+=t(n[o-1],n[o]);return r}},t.makeTester=function(n){var t=d3.select("body").selectAll("#js-plotly-tester").data([0]);t.enter().append("svg").attr({id:"js-plotly-tester",xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink","xml:xml:space":"preserve"}).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px"});var r=t.selectAll(".js-reference-point").data([0]);r.enter().append("path").classed("js-reference-point",!0).attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"}),t.node()._cache||(t.node()._cache={}),n._tester=t,n._testref=r};var s=[],c=1e4;t.bBox=function(n){var t=n.attributes["data-bb"];if(t)return $.extend({},s[t.value]);var r=d3.select("#js-plotly-tester"),o=r.node(),e=n.cloneNode(!0);o.appendChild(e),d3.select(e).attr({x:0,y:0,transform:""});var d=e.getBoundingClientRect(),u=r.select(".js-reference-point").node().getBoundingClientRect();o.removeChild(e);var i={height:d.height,width:d.width,left:d.left-u.left,top:d.top-u.top,right:d.right-u.left,bottom:d.bottom-u.top};return s.length>=c&&($("[data-bb]").attr("data-bb",null),s=[]),n.setAttribute("data-bb",s.length),s.push(i),$.extend({},i)}}();!function(){"use strict";function r(r){var g=r.toRgb();return"rgb("+Math.round(g.r)+", "+Math.round(g.g)+", "+Math.round(g.b)+")"}var g=Plotly.Color={};g.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],g.scales={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YIGnBu:[[0,"rgb(8, 29, 88)"],[.125,"rgb(37, 52, 148)"],[.25,"rgb(34, 94, 168)"],[.375,"rgb(29, 145, 192)"],[.5,"rgb(65, 182, 196)"],[.625,"rgb(127, 205, 187)"],[.75,"rgb(199, 233, 180)"],[.875,"rgb(237, 248, 217)"],[1,"rgb(255, 255, 217)"]],Greens:[[0,"rgb(0, 68, 27)"],[.125,"rgb(0, 109, 44)"],[.25,"rgb(35, 139, 69)"],[.375,"rgb(65, 171, 93)"],[.5,"rgb(116, 196, 118)"],[.625,"rgb(161, 217, 155)"],[.75,"rgb(199, 233, 192)"],[.875,"rgb(229, 245, 224)"],[1,"rgb(247, 252, 245)"]],YIOrRd:[[0,"rgb(128, 0, 38)"],[.125,"rgb(189, 0, 38)"],[.25,"rgb(227, 26, 28)"],[.375,"rgb(252, 78, 42)"],[.5,"rgb(253, 141, 60)"],[.625,"rgb(254, 178, 76)"],[.75,"rgb(254, 217, 118)"],[.875,"rgb(255, 237, 160)"],[1,"rgb(255, 255, 204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5, 10, 172)"],[.35,"rgb(106, 137, 247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220, 170, 132)"],[.7,"rgb(230, 145, 90)"],[1,"rgb(178, 10, 28)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0, 0, 200)"],[.25,"rgb(0, 25, 255)"],[.375,"rgb(0, 152, 255)"],[.5,"rgb(44, 255, 150)"],[.625,"rgb(151, 255, 0)"],[.75,"rgb(255, 234, 0)"],[.875,"rgb(255, 111, 0)"],[1,"rgb(255, 0, 0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]]},g.defaultScale=g.scales.RdBu,g.getScale=function(r,b){function t(){try{r=g.scales[r]||JSON.parse(r)}catch(t){r=b}}if(b||(b=g.defaultScale),!r)return b;if("string"==typeof r&&(t(),"string"==typeof r&&t()),!Array.isArray(r))return b;var e=0,n=r.some(function(r){return 2!==r.length?!0:r[0]<e?!0:(e=r[0],!tinycolor(r[1]).ok)});return n?b:r},function(){function r(r,g){e.insertRule?e.insertRule(r+"{"+g+"}",0):e.addRule?e.addRule(r,g,0):console.log("addStyleRule failed")}function b(r){return String(Math.round(100*(1-r[0])))+"%"}if($("#plotlyMainMarker").length){var t=document.createElement("style");t.appendChild(document.createTextNode("")),document.head.appendChild(t);var e=t.sheet;for(var n in g.scales){for(var o=g.scales[n],a="",l="",i=o.length-1;i>=0;i--)a+=", "+o[i][1]+" "+b(o[i]),l+=", color-stop("+b(o[i])+","+o[i][1]+")";var c="background: "+o[o.length-1][1]+";background: -moz-linear-gradient(top"+a+");background: -webkit-gradient(linear, left top, left bottom"+l+");background: -webkit-linear-gradient(top"+a+");background: -o-linear-gradient(top"+a+");background: -ms-linear-gradient(top"+a+");background: linear-gradient(to bottom"+a+');filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="'+o[o.length-1][1]+'",endColorstr="'+o[0][1]+'",GradientType=0);';r("."+n,c)}}}(),g.rgb=function(g){return r(tinycolor(g))},g.opacity=function(r){return tinycolor(r).alpha},g.addOpacity=function(r,g){var b=tinycolor(r).toRgb();return"rgba("+Math.round(b.r)+", "+Math.round(b.g)+", "+Math.round(b.b)+", "+g+")"},g.stroke=function(g,b){var t=tinycolor(b);g.style({stroke:r(t),"stroke-opacity":t.alpha})},g.fill=function(g,b){var t=tinycolor(b);g.style({fill:r(t),"fill-opacity":t.alpha})}}();!function(){"use strict";function t(t,e){if("-"===t.type){var r=t._id,n=r.charAt(0);if(-1!==r.indexOf("scene")&&(r=n),e=e.filter(function(t){return(t[n+"axis"]||n)===r}),e.length){var i=e[0];return"histogram"===i.type&&n==={v:"y",h:"x"}[i.orientation||"v"]?void(t.type="linear"):void(t.type=c.autoType("box"!==i.type||"x"!==n||"x"in i||"x0"in i?i[n]||[i[n+"0"]]:e.filter(function(t){return"box"===t.type}).map(function(t){return"x"in t?t.x[0]:"name"in t?t.name:"text"})))}}}function e(t){return t&&t.some(function(t){return $.isNumeric(t)})}function r(t){var e,r=t.dtick;if(t._tickexponent=0,$.isNumeric(r)||"string"==typeof r||(r=1),"category"===t.type)t._tickround=null;else if($.isNumeric(r)||"L"===r.charAt(0))if("date"===t.type)t._tickround=r>=864e5?"d":r>=36e5?"H":r>=6e4?"M":r>=1e3?"S":3-Math.round(Math.log(r/2)/Math.LN10);else{$.isNumeric(r)||(r=Number(r.substr(1))),t._tickround=2-Math.floor(Math.log(r)/Math.LN10+.01),e="log"===t.type?Math.pow(10,Math.max(t.range[0],t.range[1])):Math.max(Math.abs(t.range[0]),Math.abs(t.range[1]));var n=Math.floor(Math.log(e)/Math.LN10+.01);Math.abs(n)>3&&(t._tickexponent=-1!==["SI","B"].indexOf(t.exponentformat)?3*Math.round((n-1)/3):n)}else t._tickround="M"===r.charAt(0)?2===r.length?"m":"y":null}function n(t,e){var r=t.match(v),n=new Date(e);if(r){var i=Math.min(+r[1]||6,6),a=String(e/1e3%1+2.0000005).substr(2,i).replace(/0+$/,"")||"0";return d3.time.format(t.replace(v,a))(n)}return d3.time.format(t)(n)}function i(t,e,n,i){var o=0>t,l=e._tickround,c=n||e.exponentformat||"B",u=e._tickexponent;if(i){var s={exponentformat:e.exponentformat,dtick:"none"===e.showexponent?e.dtick:$.isNumeric(t)?Math.abs(t)||1:1,range:"none"===e.showexponent?e.range:[0,t||1]};r(s),l=(Number(s._tickround)||0)+2,u=s._tickexponent}var d=Math.pow(10,-l)/2;if("none"===c&&(u=0),t=Math.abs(t),d>t)t="0",o=!1;else{if(t+=d,u&&(t*=Math.pow(10,-u),l+=u),0===l)t=String(Math.floor(t));else if(0>l){t=String(Math.round(t)),t=t.substr(0,t.length+l);for(var f=l;0>f;f++)t+="0"}else{t=String(t);var m=t.indexOf(".")+1;m&&(t=t.substr(0,m+l).replace(/\.?0+$/,""))}t=a(t,e._td._fullLayout.separators)}return u&&"hide"!==c&&("e"===c||("SI"===c||"B"===c)&&(u>12||-15>u)?t+="e"+(u>0?"+":"")+u:"E"===c?t+="E"+(u>0?"+":"")+u:"power"===c?t+="&times;10"+String(u).sup():"B"===c&&9===u?t+="B":"SI"===c||"B"===c?t+=x[u/3+5]:console.log("unknown exponent format "+c)),(o?"-":"")+t}function a(t,e){var r=e.charAt(0),n=e.charAt(1),i=t.split("."),a=i[0],o=i.length>1?r+i[1]:"";if(n&&(i.length>1||a.length>4))for(;k.test(a);)a=a.replace(k,"$1"+n+"$2");return a+o}function o(t,e,r){function n(t){return Object.keys(t).filter(function(t){return e&&t.charAt(0)!==e?!1:t.match(/^[xyz]axis[0-9]*/g)}).sort()}var i=t._fullLayout;if(!i)return[];var a=n(i);if(r)return a;var o=[],l=Object.keys(i).filter(function(t){return t.match(/^scene[0-9]*$/)});return l&&l.forEach(function(t){o=o.concat(n(i[t]).map(function(e){return t+"."+e}))}),a.concat(o)}function l(t,e){return(t%e+e)%e}var c=Plotly.Axes={};c.attributes={title:{type:"string"},titlefont:{type:"font"},type:{type:"enumerated",values:["-","linear","log","date","category"],dflt:"-"},autorange:{type:"enumerated",values:[!0,!1,"reversed"],dflt:!0},rangemode:{type:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal"},range:[{type:"number"},{type:"number"}],autotick:{type:"boolean",dflt:!0},nticks:{type:"integer",min:0,dflt:0},tick0:{type:"number",dflt:0},dtick:{type:"number",dflt:1},ticks:{type:"enumerated",values:["outside","inside",""]},mirror:{type:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1},ticklen:{type:"number",min:0,dflt:5},tickwidth:{type:"number",min:0,dflt:1},tickcolor:{type:"color",dflt:"#444"},showticklabels:{type:"boolean",dflt:!0},tickfont:{type:"font"},tickangle:{type:"angle",dflt:"auto"},showexponent:{type:"enumerated",values:["all","first","last","none"],dflt:"all"},exponentformat:{type:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B"},tickformat:{type:"string",dflt:""},hoverformat:{type:"string",dflt:""},showline:{type:"boolean",dflt:!1},linecolor:{type:"color",dflt:"#444"},linewidth:{type:"number",min:0,dflt:1},showgrid:{type:"boolean"},gridcolor:{type:"color",dflt:"#eee"},gridwidth:{type:"number",min:0,dflt:1},zeroline:{type:"boolean"},zerolinecolor:{type:"color",dflt:"#444"},zerolinewidth:{type:"number",dflt:1},anchor:{type:"enumerated"},side:{type:"enumerated"},overlaying:{type:"enumerated"},domain:[{type:"number",min:0,max:1,dflt:0},{type:"number",min:0,max:1,dflt:1}],position:{type:"number",min:0,max:1,dflt:0}},c.supplyDefaults=function(t,e,r){function n(t,e){var r=Number(t.substr(5)||1),n=Number(e.substr(5)||1);return r-n}var i=Object.keys(t).filter(function(t){return t.match(/^xaxis[0-9]*$/)}),a=Object.keys(t).filter(function(t){return t.match(/^yaxis[0-9]*$/)}),o={},l={};r.forEach(function(t){var e=c.id2name(t.xaxis),r=c.id2name(t.yaxis);if(e&&-1===i.indexOf(e)&&i.push(e),r&&-1===a.indexOf(r)&&a.push(r),Plotly.Plots.isHeatmap(t.type)&&(o[e]=!0,o[r]=!0),Plotly.Plots.isBar(t.type)||"box"===t.type){var n="h"===t.orientation?r:e;l[n]=!0}}),(e._hasCartesian||!r.length)&&(i.length?i.sort(n):i=["xaxis"],a.length?a.sort(n):a=["yaxis"]),i.concat(a).forEach(function(n){var u=n.charAt(0),s=t[n]||{},d={letter:u,font:e.font,outerTicks:o[n],showGrid:!l[n],name:n,data:r},f={letter:u,counterAxes:{x:a,y:i}[u].map(c.name2id),overlayableAxes:{x:i,y:a}[u].filter(function(e){return e!==n&&!(t[e]||{}).overlaying}).map(c.name2id)};e[n]=c.supplyAxisDefaults(s,null,d),c.supplyAxisPositioningDefaults(s,e[n],f),t[n]||"-"===s.type||(t[n]={type:s.type})}),i.length&&a.length&&Plotly.Lib.coerce(t,e,Plotly.Plots.layoutAttributes,"plot_bgcolor")},c.supplyAxisDefaults=function(e,r,n){function i(t,n){return Plotly.Lib.coerce(e,r,c.attributes,t,n)}r=r||{};var a=n.letter,o="Click to enter "+(n.title||a.toUpperCase()+" axis")+" title",l=n.font||{},u=n.outerTicks,s=n.showGrid;n.name&&(r._name=n.name,r._id=c.name2id(n.name));var d=i("type");"-"===d&&(t(r,n.data),"-"===r.type?r.type="linear":d=e.type=r.type),c.setConvert(r),i("title",o),i("titlefont",{family:l.family,size:Math.round(1.2*l.size),color:l.color});var f=2===(e.range||[]).length&&$.isNumeric(e.range[0])&&$.isNumeric(e.range[1]),m=i("autorange",!f);m&&i("rangemode");var p=i("range[0]",-1),h=i("range[1]","x"===a?6:4);p===h&&(r.range=[p-1,p+1]);var g=i("autotick");("log"===d||"date"===d)&&(g=r.autotick=!0),g?"category"!==d&&i("nticks"):(i("tick0",0),i("dtick"));var y=i("ticks",u?"outside":"");y&&(i("ticklen"),i("tickwidth"),i("tickcolor"));var v=i("showticklabels");v&&(i("tickfont",l),i("tickangle"),"date"===d?(i("tickformat"),i("hoverformat")):(i("showexponent"),i("exponentformat")));var x=i("showline");x&&(i("linecolor"),i("linewidth")),(x||y)&&i("mirror");var k=i("showgrid",s);k&&(i("gridcolor"),i("gridwidth"));var _=i("zeroline",s);return _&&(i("zerolinecolor"),i("zerolinewidth")),r},c.supplyAxisPositioningDefaults=function(t,e,r){function n(r,n){return Plotly.Lib.coerce(t,e,c.attributes,r,n)}e||(e={});var i=r.counterAxes||[],a=r.overlayableAxes||[],o=r.letter,l=Plotly.Lib.coerce(t,e,{anchor:{type:"enumerated",values:["free"].concat(i),dflt:$.isNumeric(t.position)?"free":i[0]||"free"}},"anchor");"free"===l&&n("position"),Plotly.Lib.coerce(t,e,{side:{type:"enumerated",values:"x"===o?["bottom","top"]:["left","right"],dflt:"x"===o?"bottom":"left"}},"side");var u=!1;if(a.length&&(u=Plotly.Lib.coerce(t,e,{overlaying:{type:"enumerated",values:[!1].concat(a),dflt:!1}},"overlaying")),!u){var s=n("domain[0]"),d=n("domain[1]");s>d-.01&&(e.domain=[0,1])}return e},c.clearTypes=function(t,e){$.isArray(e)&&e.length||(e=t._fullData.map(function(t,e){return e})),e.forEach(function(e){var r=t.data[e];delete(c.getFromId(t,r.xaxis)||{}).type,delete(c.getFromId(t,r.yaxis)||{}).type})};var u=/^[xyz][0-9]*$/,s=/^[xyz]axis[0-9]*$/;c.id2name=function(t){if("string"==typeof t&&t.match(u)){var e=t.substr(1);return"1"===e&&(e=""),t.charAt(0)+"axis"+e}},c.name2id=function(t){if(t.match(s)){var e=t.substr(5);return"1"===e&&(e=""),t.charAt(0)+e}},c.cleanId=function(t,e){if(t.match(u)&&(!e||t.charAt(0)===e)){var r=t.substr(1).replace(/^0+/,"");return"1"===r&&(r=""),t.charAt(0)+r}},c.cleanName=function(t,e){if(t.match(u)&&(!e||t.charAt(0)===e)){var r=t.substr(5).replace(/^0+/,"");return"1"===r&&(r=""),t.charAt(0)+"axis"+r}},c.counterLetter=function(t){return{x:"y",y:"x"}[t.charAt(0)]},c.autoType=function(t){return c.moreDates(t)?"date":c.category(t)?"category":e(t)?"linear":"-"},c.moreDates=function(t){for(var e,r=0,n=0,i=Math.max(1,(t.length-1)/1e3),a=0;a<t.length;a+=i)e=t[Math.round(a)],Plotly.Lib.isDateTime(e)&&(r+=1),$.isNumeric(e)&&(n+=1);return r>2*n},c.category=function(t){function e(t){return!$.isNumeric(t)&&-1===["","None"].indexOf("v")}for(var r,n=Math.max(1,(t.length-1)/1e3),i=0,a=0,o=0;o<t.length;o+=n)r=c.cleanDatum(t[Math.round(o)]),$.isNumeric(r)?i++:r&&e(r)&&a++;return a>2*i},c.cleanDatum=function(t){try{if("object"==typeof t&&null!==t&&t.getTime)return Plotly.Lib.ms2DateTime(t);if("string"!=typeof t&&!$.isNumeric(t))return"";t=t.toString().replace(/['"%,$# ]/g,"")}catch(e){console.log(e,t)}return t},c.setConvert=function(t){function e(t){return t>0?Math.log(t)/Math.LN10:i}function r(t){return Math.pow(10,t)}function n(t){return $.isNumeric(t)?Number(t):i}var i=void 0;t.c2l="log"===t.type?e:n,t.l2c="log"===t.type?r:n,t.setScale=function(){var e,r=t._td._fullLayout._size;if(t._categories||(t._categories=[]),t.overlaying){var n=c.getFromId(t._td,t.overlaying);t.domain=n.domain}for(t.range&&2===t.range.length&&t.range[0]!==t.range[1]||(t.range=[-1,1]),e=0;2>e;e++)$.isNumeric(t.range[e])||(t.range[e]=$.isNumeric(t.range[1-e])?t.range[1-e]*(e?10:.1):e?1:-1),t.range[e]<-(Number.MAX_VALUE/2)?t.range[e]=-(Number.MAX_VALUE/2):t.range[e]>Number.MAX_VALUE/2&&(t.range[e]=Number.MAX_VALUE/2);"y"===t._id.charAt(0)?(t._offset=r.t+(1-t.domain[1])*r.h,t._length=r.h*(t.domain[1]-t.domain[0]),t._m=t._length/(t.range[0]-t.range[1]),t._b=-t._m*t.range[1]):(t._offset=r.l+t.domain[0]*r.w,t._length=r.w*(t.domain[1]-t.domain[0]),t._m=t._length/(t.range[1]-t.range[0]),t._b=-t._m*t.range[0])};var a=10;if(t.l2p=function(e){return d3.round(Plotly.Lib.constrain(t._b+t._m*e,-a*t._length,(1+a)*t._length),2)},t.p2l=function(e){return(e-t._b)/t._m},t.c2p=function(e,r){var n=t.c2l(e);if($.isNumeric(n))return t.l2p(n);if(r&&$.isNumeric(e)){var o=t.range[0],l=t.range[1];return t.l2p(.5*(o+l-3*a*Math.abs(o-l)))}return i},t.p2c=function(e){return t.l2c(t.p2l(e))},-1!==["linear","log","-"].indexOf(t.type))t.c2d=n,t.d2c=function(t){return t=c.cleanDatum(t),$.isNumeric(t)?Number(t):i},t.d2l=function(e){return"log"===t.type?t.c2l(t.d2c(e)):t.d2c(e)};else if("date"===t.type){if(t.c2d=function(t){return $.isNumeric(t)?Plotly.Lib.ms2DateTime(t):i},t.d2c=function(t){return $.isNumeric(t)?Number(t):Plotly.Lib.dateTime2ms(t)},t.d2l=t.d2c,t.range&&t.range.length>1)try{var o=t.range.map(Plotly.Lib.dateTime2ms);!$.isNumeric(t.range[0])&&$.isNumeric(o[0])&&(t.range[0]=o[0]),!$.isNumeric(t.range[1])&&$.isNumeric(o[1])&&(t.range[1]=o[1])}catch(l){console.log(l,t.range)}}else"category"===t.type&&(t.c2d=function(e){return t._categories[Math.round(e)]},t.d2c=function(e){-1===t._categories.indexOf(e)&&t._categories.push(e);var r=t._categories.indexOf(e);return-1===r?i:r},t.d2l=t.d2c);t.makeCalcdata=function(e,r){if(r in e)return e[r].map(t.d2c);var n=r+"0"in e?t.d2c(e[r+"0"]):0,i=e["d"+r]?Number(e["d"+r]):1,a=e[{x:"y",y:"x"}[r]];return a.map(function(t,e){return n+e*i})},t._min=[],t._max=[],t._minDtick=null,t._forceTick0=null},c.minDtick=function(t,e,r,n){-1===["log","category"].indexOf(t.type)&&n?null===t._minDtick?(t._minDtick=e,t._forceTick0=r):t._minDtick&&((t._minDtick/e+1e-6)%1<2e-6&&((r-t._forceTick0)/e%1+1.000001)%1<2e-6?(t._minDtick=e,t._forceTick0=r):((e/t._minDtick+1e-6)%1>2e-6||((r-t._forceTick0)/t._minDtick%1+1.000001)%1>2e-6)&&(t._minDtick=0)):t._minDtick=0},c.doAutoRange=function(t){function e(t){return t.val}if(t._length||t.setScale(),t.autorange&&t._min&&t._max&&t._min.length&&t._max.length){var r,n,i,a,o,l,c,u,s=0,d=Math.min.apply(null,t._min.map(e)),f=Math.max.apply(null,t._max.map(e)),m=t.range&&t.range[1]<t.range[0];for("reversed"===t.autorange&&(m=!0,t.autorange=!0),r=0;r<t._min.length;r++)for(i=t._min[r],n=0;n<t._max.length;n++)a=t._max[n],u=a.val-i.val,c=t._length-i.pad-a.pad,u>0&&c>0&&u/c>s&&(o=i,l=a,s=u/c);d===f?t.range=m?[d+1,d-1]:[d-1,d+1]:s&&(("linear"===t.type||"-"===t.type)&&("tozero"===t.rangemode&&o.val>=0?o={val:0,pad:0}:"nonnegative"===t.rangemode&&(o.val-s*o.pad<0&&(o={val:0,pad:0}),l.val<0&&(l={val:1,pad:0})),s=(l.val-o.val)/(t._length-o.pad-l.pad)),t.range=[o.val-s*o.pad,l.val+s*l.pad],t.range[0]===t.range[1]&&(t.range=[t.range[0]-1,t.range[0]+1]),m&&t.range.reverse());var p=t._td.layout[t._name];p||(t._td.layout[t._name]=p={}),p!==t&&(p.range=t.range.slice(),p.autorange=t.autorange)}};var d=Number.MAX_VALUE/2;c.expand=function(t,e,r){function n(t){if($.isArray(t))return function(e){return Math.max(Number(t[e]||0),0)};var e=Math.max(Number(t||0),0);return function(){return e}}function i(r){function n(t){return $.isNumeric(t)&&Math.abs(t)<d}if(c=e[r],$.isNumeric(c)){if(f=k(r)+v,m=_(r)+v,h=c-M(r),g=c+b(r),"log"===t.type&&g/10>h&&(h=g/10),u=t.c2l(h),s=t.c2l(g),x&&(u=Math.min(0,u),s=Math.max(0,s)),n(u)){for(p=!0,o=0;o<t._min.length&&p;o++)l=t._min[o],l.val<=u&&l.pad>=m?p=!1:l.val>=u&&l.pad<=m&&(t._min.splice(o,1),o--);p&&t._min.push({val:u,pad:x&&0===u?0:m})}if(n(s)){for(p=!0,o=0;o<t._max.length&&p;o++)l=t._max[o],l.val>=s&&l.pad>=f?p=!1:l.val<=s&&l.pad<=f&&(t._max.splice(o,1),o--);p&&t._max.push({val:s,pad:x&&0===s?0:f})}}}if(t.autorange&&e){t._min||(t._min=[]),t._max||(t._max=[]),r||(r={}),t._m||t.setScale();var a,o,l,c,u,s,f,m,p,h,g,y=e.length,v=r.padded?.05*t._length:0,x=r.tozero&&("linear"===t.type||"-"===t.type),k=n((t._m>0?r.ppadplus:r.ppadminus)||r.ppad||0),_=n((t._m>0?r.ppadminus:r.ppadplus)||r.ppad||0),b=n(r.vpadplus||r.vpad),M=n(r.vpadminus||r.vpad);for(a=0;6>a;a++)i(a);for(a=y-1;a>5;a--)i(a)}},c.autoBin=function(t,e,r,n){function i(t){return(1+100*(t-p)/f.dtick)%100<2}var a=Plotly.Lib.aggNums(Math.min,null,t),o=Plotly.Lib.aggNums(Math.max,null,t);if("category"===e.type)return{start:a-.5,end:o+.5,size:1};var l;if(r)l=(o-a)/r;else{var u=Plotly.Lib.distinctVals(t),s=Math.pow(10,Math.floor(Math.log(u.minDiff)/Math.LN10)),d=s*Plotly.Lib.roundUp(u.minDiff/s,[.9,1.9,4.9,9.9],!0);l=Math.max(d,2*Plotly.Lib.stdev(t)/Math.pow(t.length,n?.25:.4))}var f={type:"log"===e.type?"linear":e.type,range:[a,o]};c.autoTicks(f,l);var m,p=c.tickIncrement(c.tickFirst(f),f.dtick,"reverse");if("number"==typeof f.dtick){for(var h=0,g=0,y=0,v=0,x=0;x<t.length;x++)t[x]%1===0?y++:$.isNumeric(t[x])||v++,i(t[x])&&h++,i(t[x]+f.dtick/2)&&g++;var k=t.length-v;if(y===k&&"date"!==e.type)f.dtick<1?p=a-.5*f.dtick:p-=.5;else if(.1*k>g&&(h>.3*k||i(a)||i(o))){var _=f.dtick/2;p+=a>p+_?_:-_}var b=1+Math.floor((o-p)/f.dtick);m=p+b*f.dtick}else for(m=p;o>=m;)m=c.tickIncrement(m,f.dtick);return{start:p,end:m,size:f.dtick}},c.calcTicks=function(t){if(t.autotick||!t.dtick){var e=t.nticks||Plotly.Lib.constrain(t._length/("y"===t._id.charAt(0)?40:80),4,9)+1;c.autoTicks(t,Math.abs(t.range[1]-t.range[0])/e),t._minDtick>0&&t.dtick<2*t._minDtick&&(t.dtick=t._minDtick,t.tick0=t._forceTick0)}t.tick0||(t.tick0="date"===t.type?new Date(2e3,0,1).getTime():0),r(t),t._tmin=c.tickFirst(t);var n=t.range[1]<t.range[0],i=[],a=1.0001*t.range[1]-1e-4*t.range[0];"category"===t.type&&(a=n?Math.max(-.5,a):Math.min(t._categories.length-.5,a));for(var o=t._tmin;(n?o>=a:a>=o)&&(i.push(o),!(i.length>1e3));o=c.tickIncrement(o,t.dtick,n));return t._tmax=i[i.length-1],i.map(function(e){return c.tickText(t,e)})},c.autoTicks=function(t,e){var r,n;if("date"===t.type)t.tick0=new Date(2e3,0,1).getTime(),e>157788e5?(e/=315576e5,n=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),t.dtick="M"+String(12*n*Plotly.Lib.roundUp(e/n,[2,5,10]))):e>12096e5?(e/=26298e5,t.dtick="M"+Plotly.Lib.roundUp(e,[1,2,3,6])):e>432e5?(r=864e5,t.tick0=new Date(2e3,0,2).getTime(),t.dtick=r*Plotly.Lib.roundUp(e/r,[1,2,3,7,14])):e>18e5?(r=36e5,t.dtick=r*Plotly.Lib.roundUp(e/r,[1,2,3,6,12])):e>3e4?(r=6e4,t.dtick=r*Plotly.Lib.roundUp(e/r,[1,2,5,10,15,30])):e>500?(r=1e3,t.dtick=r*Plotly.Lib.roundUp(e/r,[1,2,5,10,15,30])):(n=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),t.dtick=n*Plotly.Lib.roundUp(e/n,[2,5,10]));else if("log"===t.type)if(t.tick0=0,e>.7)t.dtick=Math.ceil(e);else if(Math.abs(t.range[1]-t.range[0])<1){var i=1.5*Math.abs((t.range[1]-t.range[0])/e);e=Math.abs(Math.pow(10,t.range[1])-Math.pow(10,t.range[0]))/i,n=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),t.dtick="L"+String(n*Plotly.Lib.roundUp(e/n,[2,5,10]))}else t.dtick=e>.3?"D2":"D1";else"category"===t.type?(t.tick0=0,t.dtick=1):(t.tick0=0,n=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),t.dtick=n*Plotly.Lib.roundUp(e/n,[2,5,10]));if(0===t.dtick&&(t.dtick=1),!$.isNumeric(t.dtick)&&"string"!=typeof t.dtick){var a=t.dtick;throw t.dtick=1,"ax.dtick error: "+String(a)}},c.tickIncrement=function(t,e,r){if($.isNumeric(e))return t+(r?-e:e);var n=e.charAt(0),i=Number(e.substr(1)),a=r?-i:i;if("M"===n){var o=new Date(t);return o.setMonth(o.getMonth()+a)}if("L"===n)return Math.log(Math.pow(10,t)+a)/Math.LN10;if("D"===n){var c="D2"===e?[-.301,0,.301,.699,1]:[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],u=t+(r?-.01:.01),s=Plotly.Lib.roundUp(l(u,1),c,r);return Math.floor(u)+Math.log(d3.round(Math.pow(10,s),1))/Math.LN10}throw"unrecognized dtick "+String(e)},c.tickFirst=function(t){var e=t.range[1]<t.range[0],r=e?Math.floor:Math.ceil,n=1.0001*t.range[0]-1e-4*t.range[1];if($.isNumeric(t.dtick)){var i=r((n-t.tick0)/t.dtick)*t.dtick+t.tick0;return"category"===t.type&&(i=Plotly.Lib.constrain(i,0,t._categories.length-1)),i}var a,o,u,s=t.dtick.charAt(0),d=Number(t.dtick.substr(1));if("M"===s){for(a=new Date(t.tick0),n=new Date(n),o=12*(n.getFullYear()-a.getFullYear())+n.getMonth()-a.getMonth(),u=a.setMonth(a.getMonth()+(Math.round(o/d)+(e?1:-1))*d);e?u>n:n>u;)u=c.tickIncrement(u,t.dtick,e);return u}if("L"===s)return Math.log(r((Math.pow(10,n)-t.tick0)/d)*d+t.tick0)/Math.LN10;if("D"===s){var f="D2"===t.dtick?[-.301,0,.301,.699,1]:[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],m=Plotly.Lib.roundUp(l(n,1),f,e);return Math.floor(n)+Math.log(d3.round(Math.pow(10,m),1))/Math.LN10}throw"unrecognized dtick "+String(t.dtick)};var f=d3.time.format("%Y"),m=d3.time.format("%b %Y"),p=d3.time.format("%b %-d"),h=d3.time.format("%b %-d %Hh"),g=d3.time.format("%H:%M"),y=d3.time.format(":%S"),v=/%(\d?)f/g;c.tickText=function(t,e,r){var a,o=t.tickfont||t._td._fullLayout.font,c=t._tickround,u=t.dtick,s=o.size,d=0,v=0,x="",k="none"!==t.exponentformat&&(r?"none"===t.showexponent:"all"!==t.showexponent&&e!=={first:t._tmin,last:t._tmax}[t.showexponent]);if(k&&(k="hide"),"date"===t.type){var _=new Date(e);r&&t.hoverformat?a=n(t.hoverformat,e):t.tickformat?a=n(t.tickformat,e):(r&&($.isNumeric(c)?c+=2:c={y:"m",m:"d",d:"H",H:"M",M:"S",S:2}[c]),"y"===c?a=f(_):"m"===c?a=m(_):(e!==t._tmin||r||(x="<br>"+f(_)),"d"===c?a=p(_):"H"===c?a=h(_):(e!==t._tmin||r||(x="<br>"+p(_)+", "+f(_)),a=g(_),"M"!==c&&(a+=y(_),"S"!==c&&(a+=i(l(e/1e3,1),t,"none",r).substr(1))))))}else if("log"===t.type)if(r&&($.isNumeric(u)||"L"!==u.charAt(0))&&(u="L3"),$.isNumeric(u)||"D"===u.charAt(0)&&l(e+.01,1)<.1){var b=Math.round(e);-1!==["e","E","power"].indexOf(t.exponentformat)?(a=0===b?"1":1===b?"10":"10"+String(b).sup(),s*=1.25):(a=i(Math.pow(10,e),t,"","fakehover"),"D1"===u&&"y"===t._id.charAt(0)&&(v-=s/6))}else if("D"===u.charAt(0))a=Math.round(Math.pow(10,l(e,1))),s*=.75;else{if("L"!==u.charAt(0))throw"unrecognized dtick "+String(u);a=i(Math.pow(10,e),t,k,r)}else if("category"===t.type){var M=t._categories[Math.round(e)];void 0===M&&(M=""),a=String(M)}else"all"===t.showexponent&&Math.abs(e/u)<1e-6&&(k="hide"),a=i(e,t,k,r);return"D1"===t.dtick&&-1!==["0","1"].indexOf(String(a).charAt(0))&&("y"===t._id.charAt(0)?d-=s/4:(v+=s/2,d+=(t.range[1]>t.range[0]?1:-1)*s*(0>e?.5:.25))),a+=x,"category"!==t.type&&(a=a.replace(/-/g,"−")),{x:e,dx:d,dy:v,text:a,fontSize:s,font:o.family,fontColor:o.color}};var x=["f","p","n","&mu;","m","","k","M","G","T"],k=/(\d+)(\d{3})/;c.list=function(t,e,r){return o(t,e,r).map(function(e){return Plotly.Lib.nestedProperty(t._fullLayout,e).get()})},c.listIds=function(t,e){return o(t,e,!0).map(c.name2id)},c.getFromId=function(t,e,r){var n=t._fullLayout;return"x"===r?e=e.replace(/y[0-9]*/,""):"y"===r&&(e=e.replace(/x[0-9]*/,"")),n[c.id2name(e)]},c.getFromTrace=function(t,e,r){var n=t._fullLayout,i=null;if(Plotly.Plots.isGL3D(e.type)){var a=e.scene||"scene";i=n[a][r+"axis"]}else i=Plotly.Axes.getFromId(t,e[r+"axis"]||r);return i},c.getSubplots=function(t,e){var r=t.data,n=[];(r||[]).forEach(function(t){if(t.visible!==!1&&!Plotly.Plots.isGL3D(t.type)){var e=t.xaxis||"x",r=t.yaxis||"y",i=e+r;-1===n.indexOf(i)&&n.push(i)}}),c.list(t,"",!0).forEach(function(e){function r(t){return-1!==t.indexOf(e._id)}var i=e._id.charAt(0),a="free"===e.anchor?{x:"y",y:"x"}[i]:e.anchor,o=Plotly.Axes.getFromId(t,a);if("free"!==e.anchor||!n.some(r)){if(!o)return void console.log("warning: couldnt find anchor "+a+" for axis "+e._id);var l="x"===i?e._id+o._id:o._id+e._id;-1===n.indexOf(l)&&n.push(l)}});var i=/^x([0-9]*)y([0-9]*)$/,a=n.filter(function(t){return t.match(i)}).sort(function(t,e){var r=t.match(i),n=e.match(i);return r[1]===n[1]?+(r[2]||1)-(n[2]||1):+(r[1]||0)-(n[1]||0)});if(e){var o=new RegExp("x"===e._id.charAt(0)?"^"+e._id+"y":e._id+"$");return a.filter(function(t){return t.match(o)})}return a},c.doTicks=function(t,e,r){function n(t){var e=l.l2p(t.x);return e>1&&e<l._length-1}function i(t,e){var r=t.selectAll("path."+k).data("inside"===l.ticks?P:v,x);e&&l.ticks?(r.enter().append("path").classed(k,1).classed("ticks",1).classed("crisp",1).call(Plotly.Color.stroke,l.tickcolor||"#444").style("stroke-width",(l.tickwidth||1)+"px").attr("d",e),r.attr("transform",f),r.exit().remove()):r.remove()}function a(n,i){function a(t,e){t.each(function(t){var r=m(e),n=d3.select(this),i=n.select(".text-math-group"),a=f(t)+($.isNumeric(e)&&0!==+e?" rotate("+e+","+s(t)+","+(d(t)-t.fontSize/2)+")":"");if(i.empty()){var o=n.select("text").attr({transform:a,"text-anchor":r});o.empty()||o.selectAll("tspan.line").attr({x:o.attr("x"),y:o.attr("y")})}else{var l=Plotly.Drawing.bBox(i.node()).width*{end:-.5,start:.5}[r];i.attr("transform",a+(l?"translate("+l+",0)":""))}})}function o(){return N.length&&Promise.all(N)}function c(){if(a(u,l.tickangle),"x"===g&&!$.isNumeric(l.tickangle)&&("log"!==l.type||"D"!==String(l.dtick).charAt(0))){var n=[];for(u.each(function(t){var e=d3.select(this),r=e.select(".text-math-group"),i=l.l2p(t.x);r.empty()&&(r=e.select("text"));var a=Plotly.Drawing.bBox(r.node());n.push({top:0,bottom:10,height:10,left:i-a.width/2,right:i+a.width/2+2,width:a.width+2})}),h=0;h<n.length-1;h++)if(Plotly.Lib.bBoxIntersect(n[h],n[h+1])){b=30;break}if(b){var i=Math.abs((v[v.length-1].x-v[0].x)*l._m)/(v.length-1);2.5*_>i&&(b=90),a(u,b)}l._lastangle=b}return r||Plotly.Plots.titles(t,e+"title"),e+" done"}var u=n.selectAll("g."+k).data(v,x);if(!l.showticklabels||!$.isNumeric(i))return u.remove(),void Plotly.Plots.titles(t,e+"title");var s,d,m,p;if("x"===g){var y="bottom"===L?1:-1;s=function(t){return t.dx},p=i+(w+M)*y,d=function(t){return t.dy+p+t.fontSize*("bottom"===L?1:-.5)},m=function(t){return $.isNumeric(t)&&0!==t&&180!==t?0>t*y?"end":"start":"middle"}}else d=function(t){return t.dy+t.fontSize/2},s=function(t){return t.dx+i+(w+M+(90===Math.abs(l.tickangle)?t.fontSize/2:0))*("right"===L?1:-1)},m=function(t){return $.isNumeric(t)&&90===Math.abs(t)?"middle":"right"===L?"start":"end"};var _=0,b=0,N=[];u.enter().append("g").classed(k,1).append("text").attr("text-anchor","middle").each(function(e){var r=d3.select(this),n=t._promises.length;r.call(Plotly.Drawing.setPosition,s(e),d(e)).call(Plotly.Drawing.font,e.font,e.fontSize,e.fontColor).text(e.text).call(Plotly.util.convertToTspans),n=t._promises[n],n?N.push(t._promises.pop().then(function(){a(r,l.tickangle)})):a(r,l.tickangle)}),u.exit().remove(),u.each(function(t){_=Math.max(_,t.fontSize)}),a(u,l._lastangle||l.tickangle);var A=Plotly.Lib.syncOrAsync([o,c]);return A&&A.then&&t._promises.push(A),A}function o(e,r,i){var a=e.gridlayer,o=e.zerolinelayer,c=e["hidegrid"+g]?[]:P,u="M0,0"+("x"===g?"v":"h")+r._length,s=a.selectAll("path."+_).data(l.showgrid===!1?[]:c,x);s.enter().append("path").classed(_,1).classed("crisp",1).attr("d",u).each(function(t){l.zeroline&&("linear"===l.type||"-"===l.type)&&Math.abs(t.x)<l.dtick/100&&d3.select(this).remove()}),s.attr("transform",f).call(Plotly.Color.stroke,l.gridcolor||"#ddd").style("stroke-width",N+"px"),s.exit().remove();var d=(t.data||[]).filter(function(t){return t.visible!==!1&&(t.xaxis||"x")+(t.yaxis||"y")===i&&(Plotly.Plots.isBar(t.type)&&(t.orientation||"v")==={x:"h",y:"v"}[g]||"scatter"===(t.type||"scatter")&&t.fill&&t.fill.charAt(t.fill.length-1)===g)}).length,m=l.range[0]*l.range[1]<=0&&l.zeroline&&("linear"===l.type||"-"===l.type)&&c.length&&(d||n({x:0})||!l.showline),p=o.selectAll("path."+b).data(m?[{x:0}]:[]);p.enter().append("path").classed(b,1).classed("zl",1).classed("crisp",1).attr("d",u),p.attr("transform",f).call(Plotly.Color.stroke,l.zerolinecolor||"#444").style("stroke-width",(l.zerolinewidth||N)+"px"),p.exit().remove()}var l,u=t._fullLayout,s=!1;if("object"==typeof e)l=e,e=l._id,s=!0;else if(l=c.getFromId(t,e),"redraw"===e&&u._paper.selectAll("g.subplot").each(function(t){var e=u._plots[t],r=e.x(),n=e.y();e.plot.attr("viewBox","0 0 "+r._length+" "+n._length),e.xaxislayer.selectAll("."+r._id+"tick").remove(),e.yaxislayer.selectAll("."+n._id+"tick").remove(),e.gridlayer.selectAll("path").remove(),e.zerolinelayer.selectAll("path").remove()}),!e||"redraw"===e)return Plotly.Lib.syncOrAsync(c.list(t,"",!0).map(function(r){return function(){if(r._id){var n=c.doTicks(t,r._id);return"redraw"===e&&(r._r=r.range.slice()),n}}}));-1===["none","e","E","power","SI","B"].indexOf(l.exponentformat)&&(l.exponentformat="e"),-1===["all","first","last","none"].indexOf(l.showexponent)&&(l.showexponent="all"),l.range=l.range.map(Number),l.setScale();var d,f,m,p,h,g=e.charAt(0),y=c.counterLetter(e),v=c.calcTicks(l),x=function(t){return t.text+t.x+l.mirror},k=e+"tick",_=e+"grid",b=e+"zl",M=(l.linewidth||1)/2,w=("outside"===l.ticks?l.ticklen:1)+(l.linewidth||0),N=l.gridwidth||1;if("x"===g)d=["bottom","top"],f=function(t){return"translate("+l.l2p(t.x)+",0)"},m="M0,",p="v";else{if("y"!==g)return void console.log("unrecognized doTicks axis",e);d=["left","right"],f=function(t){return"translate(0,"+l.l2p(t.x)+")"},m="M",p=",0h"}var L=l.side||d[0],A=[-1,1,L===d[1]?1:-1];"inside"!==l.ticks==("x"===g)&&(A=A.map(function(t){return-t}));var P=v.filter(n);if(s)return i(l._axislayer,m+(l._pos+M*A[2])+p+A[2]*l.ticklen),a(l._axislayer,l._pos);var D=c.getSubplots(t,l).map(function(t){var e=u._plots[t],r=e[g+"axislayer"],n=l._linepositions[t]||[],c=e[y](),s=c._id===l.anchor,f=[!1,!1,!1],v="";if("allticks"===l.mirror?f=[!0,!0,!1]:s&&("ticks"===l.mirror?f=[!0,!0,!1]:f[d.indexOf(L)]=!0),l.mirrors)for(h=0;2>h;h++){var x=l.mirrors[c._id+d[h]];("ticks"===x||"labels"===x)&&(f[h]=!0)}return void 0!==n[2]&&(f[2]=!0),f.forEach(function(t,e){var r=n[e],i=A[e];t&&$.isNumeric(r)&&(v+=m+(r+M*i)+p+i*l.ticklen)}),i(r,v),o(e,c,t),a(r,n[3])}).filter(function(t){return t&&t.then});return D.length?Promise.all(D):0}}();!function(){"use strict";function t(t,e){function o(a,e){return Plotly.Lib.coerce(t,n,r.attributes,a,e)}var n={};o("opacity"),o("align"),o("bgcolor");var l=o("bordercolor"),i=Plotly.Color.opacity(l);o("borderpad");var s=o("borderwidth"),d=o("showarrow");return d&&(o("arrowcolor",i?n.bordercolor:"#444"),o("arrowhead"),o("arrowsize"),o("arrowwidth",2*(i&&s||1)),o("ax"),o("ay")),o("text",d?"&nbsp;":"new text"),o("textangle"),o("font",e.font),["x","y"].forEach(function(r){var l={_fullLayout:e},i=a(t,n,l,r),s=.5;if("paper"!==i){var y=Plotly.Axes.getFromId(l,i);if(s=y.range[0]+s*(y.range[1]-y.range[0]),-1!==["date","category"].indexOf(y.type)&&"string"==typeof t[r]){var c;"date"===y.type?(c=Plotly.Lib.dateTime2ms(t[r]),c!==!1&&(t[r]=c)):(y._categories||[]).length&&(c=y._categories.indexOf(t[r]),-1!==c&&(t[r]=c))}}o(r,s),d||o(r+"anchor")}),n}function a(t,a,e,o){var n=Plotly.Axes.listIds(e,o),r=o+"ref",l={};return l[r]={type:"enumerated",values:n.concat(["paper"]),dflt:n[0]},Plotly.Lib.coerce(t,a,l,r,o)}function e(t,a,e,o){$.isNumeric(o)||(o=1);var n=t.node(),r=l[a||0];if(r){"string"==typeof e&&e||(e="end");var i,s,d,y,c;"line"===n.nodeName?(i={x:t.attr("x1"),y:t.attr("y1")},s={x:t.attr("x2"),y:t.attr("y2")},d=s,y=i):"path"===n.nodeName&&(i=n.getPointAtLength(0),d=n.getPointAtLength(.1),c=n.getTotalLength(),s=n.getPointAtLength(c),y=n.getPointAtLength(c-.1));var u=function(e,l){var i=180*Math.atan2(e.y-l.y,e.x-l.x)/Math.PI,s=(Plotly.Drawing.getPx(t,"stroke-width")||1)*o,d=t.style("stroke")||"#444",y=t.style("stroke-opacity")||1;a>5&&(i=0),d3.select(n.parentElement).append("path").attr({"class":t.attr("class"),d:r.path,transform:"translate("+e.x+","+e.y+")rotate("+i+")translate("+r.centerx*s*(1/o-1)+",0)scale("+s+")"}).style({fill:d,opacity:y,"stroke-width":0})};e.indexOf("start")>=0&&u(i,d),e.indexOf("end")>=0&&u(s,y)}}function o(t){var a=t._fullLayout,e={left:0,right:0,top:0,bottom:0,width:0,height:0};a.annotations.forEach(function(o,n){var r=Plotly.Axes.getFromId(t,o.xref),l=Plotly.Axes.getFromId(t,o.yref);if(r||l){var i,s=a._infolayer.selectAll('g.annotation[data-index="'+n+'"] rect.bg').node(),d=s?Plotly.Drawing.bBox(s):e,y=o.borderwidth,c=d.width+y,u=d.height+y;if(o.showarrow){var f=3*o.arrowsize*o.arrowwidth;i={left:Math.min(o.ax-c/2,-f),right:Math.max(o.ax+c/2,f),top:Math.min(o.ay-u/2,-f),bottom:Math.max(o.ay+u/2,f)}}else i={left:c*({center:-.5,right:-1}[o.xanchor]||0),right:c*({center:.5,right:0}[o.xanchor]||1),top:u*({middle:-.5,top:0}[o.yanchor]||1),bottom:u*({middle:.5,top:1}[o.yanchor]||0)};r&&r.autorange&&Plotly.Axes.expand(r,[r.l2c(o.x)],{ppadplus:i.right,ppadminus:-i.left}),l&&l.autorange&&Plotly.Axes.expand(l,[l.l2c(o.y)],{ppadplus:i.bottom,ppadminus:-i.top})}})}function n(t,a,e,o,n,r,l,i){var s=e-t,d=n-t,y=l-n,c=o-a,u=r-a,f=i-r,p=s*f-y*c;if(0===p)return null;var g=(d*f-y*u)/p,x=(d*c-s*u)/p;return 0>x||x>1||0>g||g>1?null:{x:t+s*g,y:a+c*g}}var r=Plotly.Annotations={},l=["",{path:"M-2,-3V3L1,0Z",centerx:.4},{path:"M-3,-2.5V2.5L2,0Z",centerx:.7},{path:"M-4,-3L-1.2,-0.2V0.2L-4,3L2,0Z",centerx:.45},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",centerx:0},{path:"M-4.2,-2.1L-0.4,-0.2V0.2L-4.2,2.1L-3.8,3L2.2,0L-3.8,-3Z",centerx:.2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",centerx:0},{path:"M2,2V-2H-2V2Z",centerx:0}];r.attributes={text:{type:"string",blankOk:!1},textangle:{type:"angle",dflt:0},font:{type:"font"},opacity:{type:"number",min:0,max:1,dflt:1},align:{type:"enumerated",values:["left","center","right"],dflt:"center"},bgcolor:{type:"color",dflt:"rgba(0,0,0,0)"},bordercolor:{type:"color",dflt:"rgba(0,0,0,0)"},borderpad:{type:"number",min:0,dflt:1},borderwidth:{type:"number",min:0,dflt:1},showarrow:{type:"boolean",dflt:!0},arrowcolor:{type:"color"},arrowhead:{type:"integer",min:0,max:l.length,dflt:1},arrowsize:{type:"number",min:.3,dflt:1},arrowwidth:{type:"number",min:.1},ax:{type:"number",dflt:-10},ay:{type:"number",dflt:-30},xref:{type:"enumerated"},x:{type:"number"},xanchor:{type:"enumerated",values:["auto","left","center","right"],dflt:"auto"},yref:{type:"enumerated"},y:{type:"number"},yanchor:{type:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto"}},r.supplyDefaults=function(a,e){var o=a.annotations||[];e.annotations=o.map(function(a){return t(a,e)})},r.drawAll=function(t){var a=t._fullLayout;return a._infolayer.selectAll(".annotation").remove(),a.annotations.forEach(function(a,e){r.draw(t,e)}),Plotly.Plots.previousPromises(t)},r.add=function(t){var a=t._fullLayout.annotations.length;Plotly.relayout(t,"annotations["+a+"]","add")},r.draw=function(o,l,i,s){function d(t){return t.call(Plotly.Drawing.font,k).attr({"text-anchor":{left:"start",right:"end"}[v.align]||"middle"}),Plotly.util.convertToTspans(t,y),t}function y(){function t(t,a){return"auto"===a?Plotly.Lib.constrain(Math.floor(3*t-1),-.5,.5):{center:0,middle:0,left:-.5,bottom:-.5,right:.5,top:.5}[a]}C.selectAll("tspan.line").attr({y:0,x:0});var a=D.select(".annotation-math-group"),r=!a.empty(),i=Plotly.Drawing.bBox((r?a:C).node()),s=i.width,d=i.height;v._w=s,v._h=d;var y=!1;if(["x","y"].forEach(function(a){var e=Plotly.Axes.getFromId(o,v[a+"ref"]||a),n="x"===a?s:-d,r=v[a+"anchor"];e?(!e.autorange&&(v[a]-e.range[0])*(v[a]-e.range[1])>0&&(y=!0),L[a]=e._offset+e.l2p(v[a])):L[a]="x"===a?p.l+p.w*v[a]:p.t+p.h*(1-v[a]),v.showarrow||(L[a]-=n*t(e?0:v[a],r)),v["_"+a+"type"]=e&&e.type}),y)return void D.remove();var c,u;v.showarrow&&(c=Plotly.Lib.constrain(L.x,1,f.width-1),u=Plotly.Lib.constrain(L.y,1,f.height-1),L.x+=v.ax,L.y+=v.ay),L.x=Plotly.Lib.constrain(L.x,1,f.width-1),L.y=Plotly.Lib.constrain(L.y,1,f.height-1);var x=Number(v.borderpad),h=E+x,m=h-i.top,w=h-i.left;r?a.select("svg").attr({x:h-1,y:h}):(C.attr({x:w,y:m}),C.selectAll("tspan.line").attr({y:m,x:w}));var k=Math.round(s+2*h),N=Math.round(d+2*h);F.call(Plotly.Drawing.setRect,E/2,E/2,k-E,N-E),D.call(Plotly.Drawing.setRect,Math.round(L.x-k/2),Math.round(L.y-N/2),k,N);var I=function(t,a){$(o).find('.annotation-arrow-g[data-index="'+l+'"]').remove();var r=L.x+t,i=L.y+a,s=Plotly.Lib.rotationXYMatrix(A,r,i),d=Plotly.Lib.apply2DTransform(s),y=Plotly.Lib.apply2DTransform2(s),f=F.attr("width")/2,x=F.attr("height")/2,h=[[r-f,i-x,r-f,i+x],[r-f,i+x,r+f,i+x],[r+f,i+x,r+f,i-x],[r+f,i-x,r-f,i-x]].map(y);if(!h.reduce(function(t,a){return t^!!n(c,u,c+1e6,u+1e6,a[0],a[1],a[2],a[3])},!1)){h.forEach(function(t){var a=n(r,i,c,u,t[0],t[1],t[2],t[3]);a&&(r=a.x,i=a.y)});var m=v.arrowwidth,w=v.arrowcolor,E=_.append("g").style({opacity:Plotly.Color.opacity(w)}).classed("annotation-arrow-g",!0).attr("data-index",String(l)),k=E.append("path").attr("d","M"+r+","+i+"L"+c+","+u).style("stroke-width",m+"px").call(Plotly.Color.stroke,Plotly.Color.rgb(w));e(k,v.arrowhead,"end",v.arrowsize);var C=E.append("path").classed("annotation",!0).classed("anndrag",!0).attr({"data-index":String(l),d:"M3,3H-3V-3H3ZM0,0L"+(r-c)+","+(i-u),transform:"translate("+c+","+u+")"}).style("stroke-width",m+6+"px").call(Plotly.Color.stroke,"rgba(0,0,0,0)").call(Plotly.Color.fill,"rgba(0,0,0,0)");o._context.editable&&(C.node().onmousedown=function(t){if(Plotly.Fx.dragClear(o))return!0;var a=Number(D.attr("x")),e=Number(D.attr("y")),n={},r="annotations["+l+"]",i=!1;return P&&P.autorange&&(n[P._name+".autorange"]=!0),b&&b.autorange&&(n[b._name+".autorange"]=!0),window.onmousemove=function(o){var l=o.clientX-t.clientX,s=o.clientY-t.clientY;Math.abs(l)<g&&(l=0),Math.abs(s)<g&&(s=0),(l||s)&&(i=!0),E.attr("transform","translate("+l+","+s+")");var y=d(a,e),f=y[0]+l,x=y[1]+s;return D.call(Plotly.Drawing.setPosition,f,x),n[r+".x"]=P?v.x+l/P._m:(c+l-p.l)/p.w,n[r+".y"]=b?v.y+s/b._m:1-(u+s-p.t)/p.h,M.attr({transform:"rotate("+A+","+f+","+x+")"}),Plotly.Lib.pauseEvent(o)},window.onmouseup=function(t){return window.onmousemove=null,window.onmouseup=null,i&&Plotly.relayout(o,n),Plotly.Lib.pauseEvent(t)},Plotly.Lib.pauseEvent(t)})}};v.showarrow&&I(0,0);var O=Plotly.Lib.rotationXYMatrix(A,L.x,L.y),V=Plotly.Lib.apply2DTransform(O);o._context.editable&&(D.node().onmousedown=function(t){if(Plotly.Fx.dragClear(o))return!0;var a=d3.select(this),e=Number(a.attr("x")),n=Number(a.attr("y")),r={},i="annotations["+l+"]",y=!1;return P&&P.autorange&&(r[P._name+".autorange"]=!0),b&&b.autorange&&(r[b._name+".autorange"]=!0),Plotly.Fx.setCursor(a),window.onmousemove=function(o){var l=o.clientX-t.clientX,c=o.clientY-t.clientY;Math.abs(l)<g&&(l=0),Math.abs(c)<g&&(c=0),(l||c)&&(y=!0),a.call(Plotly.Drawing.setPosition,e+l,n+c);var u="pointer";v.showarrow?(r[i+".ax"]=v.ax+l,r[i+".ay"]=v.ay+c,I(l,c)):(r[i+".x"]=P?v.x+l/P._m:Plotly.Fx.dragAlign(e+l+h,s,p.l,p.l+p.w,v.xanchor),r[i+".y"]=b?v.y+c/b._m:Plotly.Fx.dragAlign(n+c+h+d,-d,p.t+p.h,p.t,v.yanchor),P&&b||(u=Plotly.Fx.dragCursors(P?.5:r[i+".x"],b?.5:r[i+".y"],v.xanchor,v.yanchor)));var f=V(e,n),x=f[0]+l,m=f[1]+c;return a.call(Plotly.Drawing.setPosition,x,m),M.attr({transform:"rotate("+A+","+x+","+m+")"}),Plotly.Fx.setCursor(a,u),Plotly.Lib.pauseEvent(o)},window.onmouseup=function(t){return window.onmousemove=null,window.onmouseup=null,Plotly.Fx.setCursor(a),y&&Plotly.relayout(o,r),Plotly.Lib.pauseEvent(t)},Plotly.Lib.pauseEvent(t)})}var c,u=o.layout,f=o._fullLayout,p=f._size,g=Plotly.Fx.MINDRAG;if(!$.isNumeric(l)||-1===l){if(!l&&$.isArray(s))return u.annotations=s,r.supplyDefaults(u,f),void r.drawAll(o);if("remove"===s)return delete u.annotations,f.annotations=[],void r.drawAll(o);if(i&&"add"!==s)return void f.annotations.forEach(function(t,a){r.draw(o,a,i,s)});l=f.annotations.length,f.annotations.push({})}if(!i&&s){if("remove"===s){for(f._infolayer.selectAll('.annotation[data-index="'+l+'"]').remove(),f.annotations.splice(l,1),u.annotations.splice(l,1),c=l;c<f.annotations.length;c++)f._infolayer.selectAll('.annotation[data-index="'+(c+1)+'"]').attr("data-index",String(c)),r.draw(o,c);return}if("add"===s||$.isPlainObject(s))for(f.annotations.splice(l,0,{}),u.annotations.splice(l,0,$.isPlainObject(s)?$.extend({},s):{text:"New text"}),c=f.annotations.length-1;c>l;c--)f._infolayer.selectAll('.annotation[data-index="'+(c-1)+'"]').attr("data-index",String(c)),r.draw(o,c)}f._infolayer.selectAll('.annotation[data-index="'+l+'"]').remove();var x=u.annotations[l],h=f.annotations[l],m={xref:x.xref,yref:x.yref},w={};"string"==typeof i&&i?w[i]=s:$.isPlainObject(i)&&(w=i),Object.keys(w).forEach(function(t){Plotly.Lib.nestedProperty(x,t).set(w[t])}),["x","y"].forEach(function(t){if(void 0===w[t]&&void 0!==x[t]){var e=Plotly.Axes.getFromId(o,a(m,{},o,t)),n=Plotly.Axes.getFromId(o,a(x,{},o,t)),r=x[t],l=h["_"+t+"type"];void 0!==w[t+"ref"]&&(e&&(r=(r-e.range[0])/(e.range[1]-e.range[0])),n&&(r=n.range[0]+r*(n.range[1]-n.range[0]))),n&&n===e&&l&&("log"===l&&"log"!==n.type?r=Math.pow(10,r):"log"!==l&&"log"===n.type&&(r=r>0?Math.log(r)/Math.LN10:void 0)),x[t]=r}});var v=t(x,f);f.annotations[l]=v;var P=Plotly.Axes.getFromId(o,v.xref),b=Plotly.Axes.getFromId(o,v.yref),L={x:0,y:0},A=+v.textangle||0,_=f._infolayer.append("g").classed("annotation",!0).attr("data-index",String(l)).style("opacity",v.opacity),M=_.append("g").classed("annotation-text-g",!0).attr("data-index",String(l)),D=M.append("svg").call(Plotly.Drawing.setPosition,0,0),E=v.borderwidth,F=D.append("rect").attr("class","bg").style("stroke-width",E+"px").call(Plotly.Color.stroke,v.bordercolor).call(Plotly.Color.fill,v.bgcolor),k=v.font,C=D.append("text").classed("annotation",!0).attr("data-unformatted",v.text).text(v.text);o._context.editable?C.call(Plotly.util.makeEditable,F).call(d).on("edit",function(t){v.text=t,this.attr({"data-unformatted":v.text}),this.call(d);var a={};a["annotations["+l+"].text"]=v.text,P&&P.autorange&&(a[P._name+".autorange"]=!0),b&&b.autorange&&(a[b._name+".autorange"]=!0),Plotly.relayout(o,a)}):C.call(d),M.attr({transform:"rotate("+A+","+L.x+","+L.y+")"}).call(Plotly.Drawing.setPosition,L.x,L.y)},r.allArrowheads=function(t){if(t)return void $(t).find("[data-arrowhead]").each(function(){var t=d3.select(this);e(t.select("line"),Number(t.attr("data-arrowhead")))});for(var a=[],o=0;o<l.length;o++)a.push({val:o,name:'<svg width="40" height="20" data-arrowhead="'+o+'" style="position: relative; top: 2px;"><line stroke="rgb(0,0,0)" style="fill: none;" x1="5" y1="10" x2="25" y2="10" stroke-width="2"></line></svg>'});return a},r.calcAutorange=function(t){var a=t._fullLayout,e=a.annotations;if(e.length&&t._fullData.length){var n={};e.forEach(function(t){n[t.xref]=!0,n[t.yref]=!0});var l=Plotly.Axes.list(t).filter(function(t){return t.autorange&&n[t._id]});if(l.length)return Plotly.Lib.syncOrAsync([r.drawAll,o],t)}}}();!function(){"use strict";var t=Plotly.Legend={};t.attributes={bgcolor:{type:"color"},bordercolor:{type:"color",dflt:"#444"},borderwidth:{type:"number",min:0,dflt:0},font:{type:"font"},traceorder:{type:"enumerated",values:["normal","reversed"]},x:{type:"number",min:-2,max:3,dflt:1.02},xanchor:{type:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{type:"number",min:-2,max:3,dflt:1},yanchor:{type:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto"}},t.supplyDefaults=function(e,l,a){function r(e,l){return Plotly.Lib.coerce(n,o,t.attributes,e,l)}var n=e.legend||{},o=l.legend={},s=0,i="normal";a.forEach(function(t){t.visible&&Plotly.Plots.isCartesian(t.type)&&!Plotly.Plots.isHeatmap(t.type)&&s++,(Plotly.Plots.isBar(t.type)&&"stack"===l.barmode||-1!==["tonextx","tonexty"].indexOf(t.fill))&&(i="reversed")});var d=Plotly.Lib.coerce(e,l,Plotly.Plots.layoutAttributes,"showlegend",s>1);d&&(r("bgcolor",l.paper_bgcolor),r("bordercolor"),r("borderwidth"),r("font",l.font),r("traceorder",i),r("x"),r("xanchor"),r("y"),r("yanchor"))},t.lines=function(t){var e=t[0].trace,l=Plotly.Plots.isScatterAny(e.type)&&e.visible,a=l&&e.fill&&"none"!==e.fill,r=l&&Plotly.Scatter.hasLines(e),n=d3.select(this).select(".legendfill").selectAll("path").data(a?[t]:[]);n.enter().append("path").classed("js-fill",!0),n.exit().remove(),n.attr("d","M5,0h30v6h-30z").call(Plotly.Drawing.fillGroupStyle);var o=d3.select(this).select(".legendlines").selectAll("path").data(r?[t]:[]);o.enter().append("path").classed("js-line",!0).attr("d","M5,0h30"),o.exit().remove(),o.call(Plotly.Drawing.lineGroupStyle)},t.points=function(t){var e,l,a=t[0],r=a.trace,n=r.marker||{},o=Plotly.Plots.isScatterAny(r.type)&&r.visible,s=o&&Plotly.Scatter.hasMarkers(r),i=o&&Plotly.Scatter.hasText(r),d=o&&Plotly.Scatter.hasLines(r);if(o){var c={tx:"Aa",mo:Math.max(.2,(a.mo+1||n.opacity+1||2)-1)};a.ms&&(c.ms=10),a.mlw>5&&(c.mlw=5),e=[Plotly.Lib.minExtend(a,c)];var y={textfont:{size:10}};s&&(y.marker={size:Math.max(Math.min(n.size,16),2),sizeref:1,sizemode:"diameter",line:{width:Math.min(n.line.width,n.size)}}),d&&(y.line={width:Math.min(r.line.width,10)}),l=Plotly.Lib.minExtend(r,y)}var h=d3.select(this).select("g.legendpoints"),g=h.selectAll("path.scatterpts").data(s?e:[]);g.enter().append("path").classed("scatterpts",!0).attr("transform","translate(20,0)"),g.exit().remove(),g.call(Plotly.Drawing.pointStyle,l);var p=h.selectAll("g.pointtext").data(i?e:[]);p.enter().append("g").classed("pointtext",!0).append("text").attr("transform","translate(20,0)"),p.exit().remove(),p.selectAll("text").call(Plotly.Drawing.textPointStyle,l)},t.bars=function(t){var e=t[0].trace,l=e.marker||{},a=l.line||{},r=d3.select(this).select("g.legendpoints").selectAll("path.legendbar").data(Plotly.Plots.isBar(e.type)?[t]:[]);r.enter().append("path").classed("legendbar",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),r.exit().remove(),r.each(function(t){var e=(t.mlw+1||a.width+1)-1,r=d3.select(this);r.style("stroke-width",e+"px").call(Plotly.Color.fill,t.mc||l.color),e&&r.call(Plotly.Color.stroke,t.mlc||a.color)})},t.boxes=function(t){var e=t[0].trace,l=d3.select(this).select("g.legendpoints").selectAll("path.legendbox").data("box"===e.type&&e.visible?[t]:[]);l.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)"),l.exit().remove(),l.each(function(t){var l=(t.lw+1||e.line.width+1)-1,a=d3.select(this);a.style("stroke-width",l+"px").call(Plotly.Color.fill,t.fc||e.fillcolor),l&&a.call(Plotly.Color.stroke,t.lc||e.line.color)})},t.style=function(e){e.each(function(t){var e=d3.select(this).selectAll("g.legendfill").data([t]);e.enter().append("g").classed("legendfill",!0);var l=d3.select(this).selectAll("g.legendlines").data([t]);l.enter().append("g").classed("legendlines",!0);var a=d3.select(this).selectAll("g.legendsymbols").data([t]);a.enter().append("g").classed("legendsymbols",!0),a.style("opacity",t[0].trace.opacity),a.selectAll("g.legendpoints").data([t]).enter().append("g").classed("legendpoints",!0)}).each(t.bars).each(t.boxes).each(t.lines).each(t.points)},t.texts=function(e,l,a,r,n){function o(e){Plotly.util.convertToTspans(e,function(){l.firstRender&&t.repositionLegend(l,n)}),e.selectAll("tspan.line").attr({x:e.attr("x")})}var s=l._fullLayout,i=a[0].trace,d=i.index,c=i.name,y=d3.select(e).selectAll("text.legendtext").data([0]);y.enter().append("text").classed("legendtext",!0),y.attr({x:40,y:0}).style("text-anchor","start").call(Plotly.Drawing.font,s.legend.font).text(c).attr({"data-unformatted":c}),l._context.editable?y.call(Plotly.util.makeEditable).call(o).on("edit",function(t){this.attr({"data-unformatted":t}),this.text(t).call(o),this.text()||(t="    "),Plotly.restyle(l,"name",t,d)}):y.call(o)},t.draw=function(e,l){var a=e.layout,r=e._fullLayout;if(r._infolayer&&e.calcdata){void 0!==l&&(a.showlegend=l),t.supplyDefaults(a,r,e._fullData),l=r.showlegend;var n=r.legend,o=e.calcdata.filter(function(t){var e=t[0].trace;return e.visible&&e.showlegend&&!Plotly.Plots.isHeatmap(e.type)&&!Plotly.Plots.isSurface(e.type)}).map(function(t){return[t[0]]});if("reversed"===n.traceorder&&o.reverse(),!l||!o.length)return r._infolayer.selectAll(".legend").remove(),void Plotly.Plots.autoMargin(e,"legend");"undefined"==typeof e.firstRender?e.firstRender=!0:e.firstRender&&(e.firstRender=!1);var s=r._infolayer.selectAll("svg.legend").data([0]);s.enter(0).append("svg").attr("class","legend");var i=s.selectAll("rect.bg").data([0]);i.enter(0).append("rect").attr("class","bg"),i.call(Plotly.Color.stroke,n.bordercolor).call(Plotly.Color.fill,n.bgcolor).style("stroke-width",n.borderwidth+"px");var d=s.selectAll("g.traces").data(o);d.enter().append("g").attr("class","traces"),d.exit().remove(),d.call(t.style).each(function(l,a){t.texts(this,e,l,a,d)}),t.repositionLegend(e,d),e._context.editable&&(s.node().onmousedown=function(t){if(Plotly.Fx.dragClear(e))return!0;var l=d3.select(this),a=+l.attr("x"),o=+l.attr("y"),s=null,i=null;return e.dragged=!1,Plotly.Fx.setCursor(l),window.onmousemove=function(d){var c=d.clientX-t.clientX,y=d.clientY-t.clientY,h=r._size,g=+l.attr("width"),p=+l.attr("height"),u=Plotly.Fx.MINDRAG;Math.abs(c)<u&&(c=0),Math.abs(y)<u&&(y=0),(c||y)&&(e.dragged=!0),l.call(Plotly.Drawing.setPosition,a+c,o+y),s=Plotly.Fx.dragAlign(a+c,g,h.l,h.l+h.w,n.xanchor),i=Plotly.Fx.dragAlign(o+y+p,-p,h.t+h.h,h.t,n.yanchor);var f=Plotly.Fx.dragCursors(s,i,n.xanchor,n.yanchor);return Plotly.Fx.setCursor(l,f),Plotly.Lib.pauseEvent(d)},window.onmouseup=function(t){return window.onmousemove=null,window.onmouseup=null,Plotly.Fx.setCursor(l),e.dragged&&null!==s&&null!==i&&Plotly.relayout(e,{"legend.x":s,"legend.y":i}),Plotly.Lib.pauseEvent(t)},Plotly.Lib.pauseEvent(t)})}},t.repositionLegend=function(t,e){var l=t._fullLayout,a=l._size,r=l.legend,n=r.borderwidth,o=0,s=0;e.each(function(t){var e,l,a=t[0].trace,i=d3.select(this),d=i.select(".legendtext"),c=i.selectAll(".legendtext>tspan"),y=1.3*r.font.size,h=c[0].length||1,g=d.node()&&Plotly.Drawing.bBox(d.node()).width,p=i.select("g[class*=math-group]");if(!a.showlegend)return void i.remove();if(p.node()){var u=Plotly.Drawing.bBox(p.node());y=u.height,g=u.width,p.attr("transform","translate(0,"+y/4+")")}else e=y*(.3+(1-h)/2),d.attr("y",e),c.attr("y",e);l=Math.max(y*h,16)+3,i.attr("transform","translate("+n+","+(5+n+s+l/2)+")"),s+=l,o=Math.max(o,g||0)}),o+=45+2*n,s+=10+2*n;var i=a.l+a.w*r.x,d=a.t+a.h*(1-r.y),c="left";"right"===r.xanchor||"auto"===r.xanchor&&r.x>=2/3?(i-=o,c="right"):("center"===r.xanchor||"auto"===r.xanchor&&r.x>1/3)&&(i-=o/2,c="center");var y="top";"bottom"===r.yanchor||"auto"===r.yanchor&&r.y<=1/3?(d-=s,y="bottom"):("middle"===r.yanchor||"auto"===r.yanchor&&r.y<2/3)&&(d-=s/2,y="middle"),o=Math.ceil(o),s=Math.ceil(s),i=Math.round(i),d=Math.round(d),l._infolayer.selectAll("svg.legend").call(Plotly.Drawing.setRect,i,d,o,s),l._infolayer.selectAll("svg.legend .bg").call(Plotly.Drawing.setRect,n/2,n/2,o-n,s-n),Plotly.Plots.autoMargin(t,"legend",{x:r.x,y:r.y,l:o*({right:1,center:.5}[c]||0),r:o*({left:1,center:.5}[c]||0),b:s*({top:1,middle:.5}[y]||0),t:s*({bottom:1,middle:.5}[y]||0)})}}();"use strict";!function(){function t(e){if(!(this instanceof t))return new t;var o=this;this.Plotly=e.Plotly,this.graphInfo=e.graphInfo,this.element=document.createElement("div"),this.element.className="modebar",this.buttons=e.buttons,this.buttonElements=[],this.buttons.forEach(function(t){var e=o.createGroup();t.forEach(function(t){var a=o.config()[t];if(!a)throw new Error(t+" not specfied in modebar configuration");var n=o.createButton(a);o.buttonElements.push(n),e.appendChild(n)}),o.element.appendChild(e)}),this.graphInfo.displaylogo&&this.element.appendChild(this.getLogo()),e.container.appendChild(this.element),this.updateActiveButton()}function e(t){var e=t.currentTarget,o=e.getAttribute("data-attr"),a=e.getAttribute("data-val")||!0,n={},i=this.graphInfo,r=this.graphInfo._fullLayout,l=this.Plotly,c=this;if("zoom"===o){var s=r.xaxis.range,u=r.yaxis.range,d="in"===a?.5:2,p=(1+d)/2,h=(1-d)/2;n={"xaxis.range[0]":p*s[0]+h*s[1],"xaxis.range[1]":p*s[1]+h*s[0],"yaxis.range[0]":p*u[0]+h*u[1],"yaxis.range[1]":p*u[1]+h*u[0]}}"hovermode"!==o||"x"!==a&&"y"!==a||(a=r._isHoriz?"y":"x",e.setAttribute("data-val",a)),n[o]=a,l.relayout(i,n).then(function(){c.updateActiveButton(),"dragmode"===o&&l.Fx.setCursor(r._paper.select(".nsewdrag"),{pan:"move",zoom:"crosshair"}[a])})}function o(t){var e=this,o=t.currentTarget,a=o.getAttribute("data-attr"),n=o.getAttribute("data-val")||!0,i={},r=this.graphInfo,l=r._fullLayout,c=Object.keys(l).filter(function(t){return t.match(/^scene[0-9]*$/)}).map(function(t){return l[t]});i[a]=n,c.forEach(function(t){t._scene.spikeEnable=!t._scene.spikeEnable}),this.Plotly.relayout(r,i).then(function(){e.updateActiveButton(),c[0]._container.focus()})}function a(t){var e=this,o=t.currentTarget,a=o.getAttribute("data-attr"),n=o.getAttribute("data-val")||!0,i={},r=this.graphInfo,l=r._fullLayout,c=Object.keys(l).filter(function(t){return t.match(/^scene[0-9]*$/)}).map(function(t){return l[t]});i[a]=n,c.forEach(function(t){"_scene"in t&&"camera"in t._scene&&(t._scene.camera.keyBindingMode=n)}),this.Plotly.relayout(r,i).then(function(){e.updateActiveButton(),c[0]._container.focus()})}function n(t){var e=t.currentTarget,o=e.getAttribute("data-attr"),a=(e.getAttribute("data-val")||!0,this.graphInfo),n=a._fullLayout,i=(Object.keys(n).filter(function(t){return t.match(/^scene[0-9]*$/)}).map(function(t){return n[t]}),n.scene._scene);if("resetDefault"===o)i.setCameraToDefault();else if("resetLastSave"===o){var r=i._cameraPositionLastSave;i.setCameraPosition(r)}}window.ModeBar=t,t.prototype.createGroup=function(){var t=document.createElement("div");return t.className="btn-group float--left",t},t.prototype.createButton=function(t){var e=document.createElement("button"),o=document.createElement("i");return e.setAttribute("rel","tooltip"),e.className="btn btn--icon btn--plot ploticon",e.setAttribute("data-attr",t.attr),e.setAttribute("data-val",t.val),e.setAttribute("title",t.title),e.setAttribute("data-gravity",t.gravity||"n"),e.addEventListener("click",t.click.bind(this)),o.className=t.icon,e.appendChild(o),e},t.prototype.updateActiveButton=function(){var t=this.graphInfo;this.buttonElements.forEach(function(e){var o=e.getAttribute("data-val")||!0,a=e.getAttribute("data-attr"),n=t._fullLayout[a];e.classList.toggle("active",n===o)})},t.prototype.hasButtons=function(t){var e=this.buttons;if(t.length!==e.length)return!1;for(var o=0;o<t.length;++o){if(t[o].length!==e[o].length)return!1;for(var a=0;a<t[o].length;a++)if(t[o][a]!==e[o][a])return!1}return!0},t.prototype.getLogo=function(){var t=this.createGroup(),e=document.createElement("a");return e.setAttribute("rel","tooltip"),e.href="https://plot.ly/",e.target="_blank",e.title="Produced with Plotly",e.className="ploticon-plotlylogo",e.setAttribute("data-gravity","ne"),t.appendChild(e),t.classList.add("btn-group--logo"),t},t.prototype.cleanup=function(){this.element.innerHTML="";var t=this.element.parentNode;t.removeChild(this.element)},t.prototype.config=function(){return{zoom2d:{title:"Zoom",attr:"dragmode",val:"zoom",icon:"ploticon-zoombox",click:e},pan2d:{title:"Pan",attr:"dragmode",val:"pan",icon:"ploticon-pan",click:e},zoomIn2d:{title:"Zoom in",attr:"zoom",val:"in",icon:"ploticon-zoom_plus",click:e},zoomOut2d:{title:"Zoom out",attr:"zoom",val:"out",icon:"ploticon-zoom_minus",click:e},autoScale2d:{title:"Autoscale",attr:"allaxes.autorange",val:"",icon:"ploticon-autoscale",click:e},hoverClosest2d:{title:"Show closest data on hover",attr:"hovermode",val:"closest",icon:"ploticon-tooltip_basic",gravity:"ne",click:e},hoverCompare2d:{title:"Compare data on hover",attr:"hovermode",val:this.graphInfo._fullLayout._isHoriz?"y":"x",icon:"ploticon-tooltip_compare",gravity:"ne",click:e},zoom3d:{title:"Zoom",attr:"dragmode",val:"zoom",icon:"ploticon-zoombox",click:a},pan3d:{title:"Pan",attr:"dragmode",val:"pan",icon:"ploticon-pan",click:a},rotate3d:{title:"Rotate",attr:"dragmode",val:"rotate",icon:"icon-undo",click:a},resetCameraDefault3d:{title:"Reset camera to default",attr:"resetDefault",val:!1,icon:"icon-home",click:n},resetCameraLastSave3d:{title:"Reset camera to last save",attr:"resetLastSave",val:!1,icon:"icon-camera-retro",click:n},closest3d:{title:"Toggle show closest data on hover",attr:"hovermode",val:"closest",icon:"ploticon-tooltip_basic",click:o}}}}();!function(){"use strict";function t(t,n,o,r,l,i,c,s){function u(t){return t._id}function h(t){t.range=t.range.map(Number)}function d(e){if(t._context.scrollZoom||M._enablescrollzoom){var n=$(t).find(".plotly")[0];if(!(n.scrollHeight-n.clientHeight>10||n.scrollWidth-n.clientWidth>10)){clearTimeout(Z);var o=Math.exp(-Math.min(Math.max(-e.deltaY,-20),20)/100),r=R.draglayer.select(".nsewdrag").node().getBoundingClientRect(),a=(e.clientX-r.left)/r.width,l=T[0]+T[2]*a,i=(r.bottom-e.clientY)/r.height,u=T[1]+T[3]*(1-i);return s&&(P.forEach(function(t){h(t);var e=t.range[0]+(t.range[1]-t.range[0])*a;t.range=[e+(t.range[0]-e)*o,e+(t.range[1]-e)*o]}),T[2]*=o,T[0]=l-T[2]*a),c&&(L.forEach(function(t){h(t);var e=t.range[0]+(t.range[1]-t.range[0])*i;t.range=[e+(t.range[0]-e)*o,e+(t.range[1]-e)*o]}),T[3]*=o,T[1]=u-T[3]*(1-i)),b(T),g(c,s),Z=setTimeout(function(){T=[0,0,z,N],x()},B),Plotly.Lib.pauseEvent(e)}}}function f(e){function o(){$(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}var r=R.draglayer.select(".nsewdrag").node().getBoundingClientRect(),l=e.clientX-r.left,i=e.clientY-r.top,c={l:l,r:l,w:0,t:i,b:i,h:0},s=t._hmpixcount?t._hmlumcount/t._hmpixcount:tinycolor(t._fullLayout.plot_bgcolor).toHsl().l,u="M0,0H"+z+"V"+N+"H0V0",d=n.plot.append("path").attr("class","zoombox").style({fill:s>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0","stroke-width":0}).attr("d",u+"Z"),f=n.plot.append("path").attr("class","zoombox-corners").style({fill:"#FFF",stroke:"#444","stroke-width":1,opacity:0}).attr("d","M0,0Z"),p=!1,y="xy";P.forEach(h),L.forEach(h),window.onmousemove=function(t){var n=Math.max(0,Math.min(z,t.clientX-r.left)),o=Math.max(0,Math.min(N,t.clientY-r.top)),h=Math.abs(n-l),m=Math.abs(o-i),g=Math.floor(Math.min(m,h,a.MINZOOM)/2);return c={l:Math.min(l,n),r:Math.max(l,n),t:Math.min(i,o),b:Math.max(i,o)},m<Math.min(Math.max(.6*h,a.MINDRAG),a.MINZOOM)?h<a.MINDRAG?(y="",c.r=c.l,c.t=c.b,f.attr("d","M0,0Z")):(c.t=0,c.b=N,y="x",f.attr("d","M"+(c.l-.5)+","+(i-a.MINZOOM-.5)+"h-3v"+(2*a.MINZOOM+1)+"h3ZM"+(c.r+.5)+","+(i-a.MINZOOM-.5)+"h3v"+(2*a.MINZOOM+1)+"h-3Z")):h<Math.min(.6*m,a.MINZOOM)?(c.l=0,c.r=z,y="y",f.attr("d","M"+(l-a.MINZOOM-.5)+","+(c.t-.5)+"v-3h"+(2*a.MINZOOM+1)+"v3ZM"+(l-a.MINZOOM-.5)+","+(c.b+.5)+"v3h"+(2*a.MINZOOM+1)+"v-3Z")):(y="xy",f.attr("d","M"+(c.l-3.5)+","+(c.t-.5+g)+"h3v"+-g+"h"+g+"v-3h-"+(g+3)+"ZM"+(c.r+3.5)+","+(c.t-.5+g)+"h-3v"+-g+"h"+-g+"v-3h"+(g+3)+"ZM"+(c.r+3.5)+","+(c.b+.5-g)+"h-3v"+g+"h"+-g+"v3h"+(g+3)+"ZM"+(c.l-3.5)+","+(c.b+.5-g)+"h3v"+g+"h"+g+"v3h-"+(g+3)+"Z")),c.w=c.r-c.l,c.h=c.b-c.t,d.attr("d",u+"M"+c.l+","+c.t+"v"+c.h+"h"+c.w+"v-"+c.h+"h-"+c.w+"Z"),p||(d.transition().style("fill",s>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),f.transition().style("opacity",1).duration(200),p=!0),Plotly.Lib.pauseEvent(e)},window.onmouseup=function(n){function l(){y.indexOf("x")>-1&&P.forEach(function(t){var e=t.range;t.range=[e[0]+(e[1]-e[0])*c.l/z,e[0]+(e[1]-e[0])*c.r/z]}),y.indexOf("y")>-1&&L.forEach(function(t){var e=t.range;t.range=[e[0]+(e[1]-e[0])*(N-c.b)/N,e[0]+(e[1]-e[0])*(N-c.t)/N]}),o(),x(y),m&&t.data&&!t._context.showTips&&(Plotly.Lib.notifier("Double-click to<br>zoom back out","long"),m=!1)}function i(){y.indexOf("y")>-1&&P.forEach(function(t){var e=t.range;t.range=[(e[0]*c.r+e[1]*-c.l)/c.w,(e[0]*(c.r-z)+e[1]*(z-c.l))/c.w]}),y.indexOf("y")>-1&&L.forEach(function(t){var e=t.range;t.range=[(e[0]*(N-c.t)+e[1]*(c.b-N))/c.h,(e[0]*-c.t+e[1]*c.b)/c.h]}),o(),x()}if(t._dragging=!1,window.onmousemove=null,window.onmouseup=null,Math.min(c.h,c.w)<2*a.MINDRAG)return 2===w&&(new Date).getTime()-_<a.DBLCLICKDELAY&&v(),o();if(e.altKey||e.ctrlKey||e.metaKey||n.altKey||n.ctrlKey||n.metaKey){$('<div class="modal-backdrop fade" id="js-zoombox-backdrop"></div><div class="open" id="js-zoombox-menu"><ul class="dropdown-menu"><li><a id="zoomboxin">Zoom In</a></li><li><a id="zoomboxout">Zoom Out</a></li></ul></div>').appendTo("body");var s=$(".js-zoombox-menu ul")[0].getBoundingClientRect();$(".js-zoombox-menu ul").css({left:Math.min(n.clientX,r.right-s.width)+window.scrollX+"px",top:Math.min(n.clientY,r.bottom-s.height)+window.scrollY+"px","z-index":20001}),$(".js-zoombox-backdrop,.zoombox").click(o),$(".js-zoombox-in").click(l),$(".js-zoombox-out").click(i)}else l();return Plotly.Lib.pauseEvent(n)}}function p(n){var o=!1;window.onmousemove=function(t){var e=t.clientX-n.clientX,r=t.clientY-n.clientY;return o=(s?Math.abs(e):0)+(c?Math.abs(r):0)>a.MINDRAG,o?y(e,r):y(0,0),Plotly.Lib.pauseEvent(t)},window.onmouseup=function(n){return window.onmousemove=null,window.onmouseup=null,t._dragging=!1,o?x():(new Date).getTime()-_<a.DBLCLICKDELAY&&(2===w&&1!==(c+s).length?v():1===w&&1===(c+s).length&&e(A)),Plotly.Lib.pauseEvent(n)}}function y(t,e){function n(t){return 1-(t>=0?Math.min(t,.9):1/(1/Math.max(t,-.3)+3.222))}function o(t,e,o){return t.forEach(function(t){t.range[e]=t._r[1-e]+(t._r[e]-t._r[1-e])/n(o/t._length)}),t[0]._length*(t[0]._r[e]-t[0].range[e])/(t[0]._r[e]-t[0]._r[1-e])}return"ew"===s||"ns"===c?(s&&P.forEach(function(e){e.range=[e._r[0]-t/e._m,e._r[1]-t/e._m]}),c&&L.forEach(function(t){t.range=[t._r[0]-e/t._m,t._r[1]-e/t._m]}),b([s?-t:0,c?-e:0,z,N]),void g(c,s)):("w"===s?t=o(P,0,t):"e"===s?t=o(P,1,-t):s||(t=0),"n"===c?e=o(L,1,e):"s"===c?e=o(L,0,-e):c||(e=0),b(["w"===s?t:0,"n"===c?e:0,z-t,N-e]),void g(c,s))}function g(e,n){(n?P:[]).concat(e?L:[]).forEach(function(e){Plotly.Axes.doTicks(t,e._id,!0)}),(M.annotations||[]).forEach(function(o,r){(n&&-1!==k.indexOf(o.xref)||e&&-1!==I.indexOf(o.yref))&&Plotly.Annotations.draw(t,r)})}function v(){var e={};(s?P:[]).concat(c?L:[]).forEach(function(t){e[t._name+".autorange"]=!0}),Plotly.relayout(t,e)}function x(e){var n={};C.forEach(function(t){e&&-1===e.indexOf(t._id.charAt(0))||([0,1].forEach(function(e){t._r[e]!==t.range[e]&&(n[t._name+".range["+e+"]"]=t.range[e])}),t.range=t._r.slice())}),b([0,0,z,N]),Plotly.relayout(t,n)}function b(t){Object.keys(M._plots).forEach(function(e){var n=M._plots[e],o=n.x(),r=n.y(),a=s&&-1!==P.indexOf(o),l=c&&-1!==L.indexOf(r);if(a||l){var i=[0,0,o._length,r._length];a&&(i[0]=t[0],i[2]=t[2]),l&&(i[1]=t[1],i[3]=t[3]),n.plot.attr("viewBox",i.join(" "))}})}var _=0,w=1,M=t._fullLayout,P=[n.x()],L=[n.y()],z=P[0]._length,N=L[0]._length,D=c+s==="nsew"?{pan:"move",zoom:"crosshair"}[M.dragmode]:(c+s).toLowerCase()+"-resize",E=c+s+"drag",O=[n].concat(c&&s?n.overlays:[]),A=n.draglayer.selectAll("."+E).data([0]);A.enter().append("rect").classed("drag",!0).classed(E,!0).style({fill:"black",opacity:0,"stroke-width":0}).attr("data-subplot",n.id),A.call(Plotly.Drawing.setRect,o,r,l,i).call(a.setCursor,D),A=A.node(),O.forEach(function(t){var e=t.x(),n=t.y();-1===P.indexOf(e)&&P.push(e),-1===L.indexOf(n)&&L.push(n)});var k=P.map(u),I=L.map(u),C=P.concat(L);A.onmousedown=function(e){if(a.dragClear(t))return!0;t._dragging=!0;var n=(new Date).getTime();return n-_<a.DBLCLICKDELAY?w+=1:(w=1,_=n),c+s==="nsew"&&("zoom"===M.dragmode?!e.shiftKey:e.shiftKey)?f(e):p(e),Plotly.Lib.pauseEvent(e)};var T=[0,0,z,N],Z=null,B=300,R=n.mainplot?M._plots[n.mainplot]:n;return c.length*s.length!==1&&(void 0!==A.onwheel?A.onwheel=d:void 0!==A.onmousewheel&&(A.onmousewheel=d)),A}function e(t){function e(){return Plotly.Lib.constrain(N.width()+y.comfortZone,y.minWidth,y.maxWidth)}function o(){M.remove(),N.remove(),h._input=null}var r,a,l,i,c,s,u,h=$(t).parents(".js-plotly-plot")[0],d=h._fullLayout,f=d3.select(t),p=f.attr("class"),m=$(t),y={maxWidth:1e3,minWidth:20},g={},v=$(t).attr("data-subplot").match(/(x[0-9]*)(y[0-9]*)/)||["","x","y"];a=-1!==["n","s"].indexOf(p.charAt(5))?"y":"x",l=v["x"===a?1:2],i=Plotly.Axes.getFromId(h,l),c=-1!==["s","w"].indexOf(p.charAt(5))?0:1,r=Plotly.Lib.nestedProperty(d,i._name+".range["+c+"]"),y.align="drag edrag"===p||"right"===i.side?"right":"left",m=$(h).find("."+i._id+"title");var x=["font-size","font-family","font-weight","font-style","font-stretch","font-variant","letter-spacing","word-spacing"],b=["font-size","letter-spacing","word-spacing"];for(s in x){var _=m.attr(x[s]);b.indexOf(x[s])>=0&&Number(_)>0&&(_+="px"),_&&(g[x[s]]=_)}y.comfortZone=3+(Number(String(g["font-size"]).split("px")[0])||20);var w=t.getBoundingClientRect(),M=$("<input/>").appendTo(h);h._input=M,M.css(g).css({position:"absolute",top:0,left:0,"z-index":6e3});var P=r.get(),L=Math.abs(P-i.range[1-c]);"date"===i.type?M.val(Plotly.Lib.ms2DateTime(P,L)):"log"===i.type?(u=Math.ceil(Math.max(0,-Math.log(L)/Math.LN10))+3,M.val(d3.format("."+String(u)+"g")(Math.pow(10,P)))):(u=Math.floor(Math.log(Math.abs(P))/Math.LN10)-Math.floor(Math.log(L)/Math.LN10)+4,M.val(d3.format("."+String(u)+"g")(P)));var z=M.val(),N=$("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",whiteSpace:"nowrap"}).css(g).insertAfter(M).html(n(z));M.width(e());var D=M[0].getBoundingClientRect(),E=w.left-D.left;M.css("top",w.top-D.top+(w.height-D.height)/2+"px"),"right"===y.align?E+=w.width-D.width:"center"===y.align&&(E+=(w.width+y.comfortZone-D.width)/2),M.css("left",E+"px");var O={left:0,center:.5,right:1}[y.align],A=M.position().left+M.width()*O;M[0].select(),M.bind("keyup keydown blur update",function(t){var a=z;z=M.val();var l=$.trim(z);if(h._input&&d)if("blur"===t.type||"keydown"===t.type&&13===t.which){if(l=i.c2l("category"===i.type?l:i.d2c(l)),!$.isNumeric(l))return;var c={};c[r.astr]=l,Plotly.relayout(h,c),o()}else if("keydown"===t.type&&27===t.which)o();else if(z!==a){N.html(n(z));var s=e();M.css({width:s,left:A-s*O})}})}function n(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s/g,"&nbsp;")}function o(t,e,n){var o=tinycolor(t).toRgb(),r=tinycolor(e||"#FFF").toRgb();if(1===o.a)return tinycolor(t).toRgbString();n&&o.a<n&&(o.a=n);var a=1===r.a?r:{r:255*(1-r.a)+r.r*r.a,g:255*(1-r.a)+r.g*r.a,b:255*(1-r.a)+r.b*r.a},l={r:a.r*(1-o.a)+o.r*o.a,g:a.g*(1-o.a)+o.g*o.a,b:a.b*(1-o.a)+o.b*o.a};return tinycolor(l).toRgbString()}function r(t,e){return 0>t*e||0===t?a.MAXDIST*(.6-.3/Math.max(3,Math.abs(t-e))):1/0}var a=Plotly.Fx={};a.attributes={dragmode:{type:"enumerated",values:["zoom","pan"],dflt:"zoom"},hovermode:{type:"enumerated",values:["x","y","closest",!1]}},a.supplyDefaults=function(t,e,n){function o(n,o){return Plotly.Lib.coerce(t,e,a.attributes,n,o)}void 0===e._isHoriz&&(e._isHoriz=a.isHoriz(n)),o("dragmode"),o("hovermode",e._isHoriz?"y":"x")},a.isHoriz=function(t){return t.every(function(t){return"h"===t.orientation})},a.DBLCLICKDELAY=600,a.MINDRAG=8,a.MINZOOM=20,a.init=function(e){var n=e._fullLayout,o=e._fullData;if(void 0===n._isHoriz&&(n._isHoriz=a.isHoriz(o)),!n._hasGL3D&&!e._context.staticPlot){var r=Object.keys(n._plots).sort(function(t,e){if((n._plots[t].mainplot&&!0)===(n._plots[e].mainplot&&!0)){var o=t.split("y"),r=e.split("y");return o[0]===r[0]?Number(o[1]||1)-Number(r[1]||1):Number(o[0]||1)-Number(r[0]||1)}return n._plots[t].mainplot?1:-1});r.forEach(function(o){var r=n._plots[o],l=r.x(),i=r.y(),c=(l._linepositions[o]||[])[3],s=(i._linepositions[o]||[])[3],u=20;if($.isNumeric(c)&&"top"===l.side&&(c-=u),$.isNumeric(s)&&"right"!==i.side&&(s-=u),!r.mainplot){var h=t(e,r,0,0,l._length,i._length,"ns","ew");$(h).mousemove(function(t){a.hover(e,t,o),n._lasthover=h,n._hoversubplot=o}).mouseout(function(t){a.unhover(e,t)}).click(function(t){a.click(e,t)}),t(e,r,-u,-u,u,u,"n","w"),t(e,r,l._length,-u,u,u,"n","e"),t(e,r,-u,i._length,u,u,"s","w"),t(e,r,l._length,i._length,u,u,"s","e")}$.isNumeric(c)&&("free"===l.anchor&&(c-=n._size.h*(1-i.domain[1])),t(e,r,.1*l._length,c,.8*l._length,u,"","ew"),t(e,r,0,c,.1*l._length,u,"","w"),t(e,r,.9*l._length,c,.1*l._length,u,"","e")),$.isNumeric(s)&&("free"===i.anchor&&(s-=n._size.w*l.domain[0]),t(e,r,s,.1*i._length,u,.8*i._length,"ns",""),t(e,r,s,.9*i._length,u,.1*i._length,"s",""),t(e,r,s,0,u,.1*i._length,"n",""))}),$(n._hoverlayer.node()).off("mousemove click").on("mousemove",function(t){t.target=n._lasthover,a.hover(e,t,n._hoversubplot)}).on("click",function(t){t.target=n._lasthover,a.click(e,t)}),n._hoverlayer.node().onmousedown=function(t){n._lasthover.onmousedown(t)}}};var l=60,i=Math.PI*l/180,c=1/Math.sin(i),s=Math.cos(i),u=Math.sin(i);a.MAXDIST=20;var h,d=0;a.hover=function(t,e,n){return h&&(clearTimeout(h),h=void 0),Date.now()>d+100?(f(t,e,n),void(d=Date.now())):void(h=setTimeout(function(){f(t,e,n),d=Date.now(),h=void 0},100))},a.unhover=function(t,e,n){h&&(clearTimeout(h),h=void 0),p(t,e,n)};var f=function(t,e,n){function i(t){return b.map(function(){return t})}function h(t,e){return t.map(function(t){return t.c2p(e)})}function d(t,e){return t.map(function(t){return t.p2c(e)})}function f(t){se+=t.dp}function m(t){t.dp+=ae}function y(t){t.dp-=le}function g(t){var e=t[0],n=t[t.length-1];if(ae=de-e.pos-e.dp+e.size,le=n.pos+n.dp+n.size-fe,ae>.01&&(t.forEach(m),re=!1),!(.01>le)&&(-.01>ae&&(t.forEach(y),re=!1),re)){pe.length>1&&console.log("hover error... how did we get here?",pe);var o=0;for(ie=0;ie<t.length;ie++)ce=t[ie],ce.pos+ce.dp+ce.size>fe&&o++;for(ie=t.length-1;ie>=0&&!(0>=o);ie--)ce=t[ie],ce.pos>fe-1&&(ce.del=!0,o--);for(ie=0;ie<t.length&&!(0>=o);ie++)ce=t[ie],ce.pos<de+1&&(ce.del=!0,o--,le=2*ce.size,t.forEach(y));for(ie=t.length-1;ie>=0&&!(0>=o);ie--)ce=t[ie],ce.pos+ce.dp+ce.size>fe&&(ce.del=!0,o--)}}"string"==typeof t&&(t=document.getElementById(t)),n||(n="xy");var v=t._fullLayout,x=v._plots[n],b=[n].concat(x.overlays.map(function(t){return t.id})),_=b.map(function(e){return Plotly.Axes.getFromId(t,e,"x")}),w=b.map(function(e){return Plotly.Axes.getFromId(t,e,"y")}),M=e.hovermode||v.hovermode;if(-1===["x","y","closest"].indexOf(M)||!t.calcdata||$(t).find(".zoombox").length||t._dragging)return p(t,e);var P,L,z,N,D,E,O,A=[];if($.isArray(e))M="array",P=e.map(function(e){var n=t.calcdata.filter(function(t){return t[0].trace.index===Number(e.curveNumber)});return n.length?n[0]:null});else{if(P=t.calcdata.filter(function(t){return-1!==b.indexOf(t[0].trace.xaxis+t[0].trace.yaxis)}),e.target&&"clientX"in e&&"clientY"in e){if($(t).triggerHandler("plotly_beforehover",e)===!1)return;var k=e.target.getBoundingClientRect(),I=e.clientX-k.left,C=e.clientY-k.top;if(0>I||I>k.width||0>C||C>k.height)return p(t,e);L=i(I),z=i(C)}if("xval"in e?(N=i(e.xval),L=h(_,N[0])):"xpx"in e&&(L=i(e.xpx)),void 0===L&&(L=i(_[0]._length/2)),void 0===N&&(N=d(_,L[0])),"yval"in e?(D=i(e.yval),z=h(w,D)):"ypx"in e&&(z=i(e.ypx)),void 0===z&&(z=i(w[0]._length/2)),void 0===D&&(D=d(w,z[0])),!$.isNumeric(L[0])||!$.isNumeric(z[0]))return console.log("Plotly.Fx.hover failed",e,t),p(t,e)}var T=1/0;P=P.filter(function(t){return t&&t[0]&&t[0].t&&t[0].t.visible!==!1});var Z=P.filter(function(t){return!(Plotly.Plots.isBar(t[0].t.type)&&"h"===t[0].t.orientation)});"x"!==M||Z.length||(M="y");var B="y"===M&&P.length>1;P.forEach(function(t,n){if(t){var o,l,i,c,s,u,h,d,f,p,m,y,g,x,P,k,I=null,C=t[0].t,Z=t[0].trace,B=b.indexOf(Z.xaxis+Z.yaxis),R=_[B],H=w[B],S=M;if("closest"!==S&&(T=1/0),"array"===S){var F=e[n];"pointNumber"in F?(I=F.pointNumber,S="closest"):(S="","xval"in F&&(l=F.xval,o=R.c2p(l),S="x"),"yval"in F&&(c=F.yval,i=H.c2p(c),S=S?"closest":"y"))}else o=L[B],i=z[B],l=N[B],c=D[B];if(Plotly.Plots.isHeatmap(Z.type)){if(T<a.MAXDIST)return;S="closest";var X=t[0].z,Y=Plotly.Plots.isContour(Z.type);E=t[0].x,O=t[0].y;var j,K,G=E,V=O;if(null!==I){try{P=Math.round(I[1]),k=Math.round(I[0])}catch(W){return void console.log("Error hovering on heatmap, pointNumber must be [row,col], found:",I)}if(0>P||P>=X[0].length||0>k||k>X.length)return}else{if(r(l-E[0],l-E[E.length-1])>a.MAXDIST||r(c-O[0],c-O[O.length-1])>a.MAXDIST)return;if(Y){G=[2*E[0]-E[1]];for(var q=1;q<E.length;q++)G.push((E[q]+E[q-1])/2);for(G.push([2*E[E.length-1]-E[E.length-2]]),V=[2*O[0]-O[1]],q=1;q<O.length;q++)V.push((O[q]+O[q-1])/2);V.push([2*O[O.length-1]-O[O.length-2]])}P=Math.max(0,Math.min(G.length-2,Plotly.Lib.findBin(l,G))),k=Math.max(0,Math.min(V.length-2,Plotly.Lib.findBin(c,V)))}return s=R.c2p(E[P]),u=R.c2p(E[P+1]),h=H.c2p(O[k]),d=H.c2p(O[k+1]),Y?(u=s,j=E[P],d=h,K=O[k]):(j=(E[P]+E[P+1])/2,K=(O[k]+O[k+1])/2,Z.zsmooth&&(s=u=(s+u)/2,h=d=(h+d)/2)),void A.push({i:0,dist:a.MAXDIST+10,curvenum:n,x0:s,x1:u,y0:h,y1:d,xLabel:j,yLabel:K,zLabel:X[k][P],xa:R,ya:H})}if(Plotly.Plots.isBar(Z.type)){var U=C.dbar*(1-v.bargap)/2;"h"===Z.orientation?(g=function(t){return[R.c2p(t.x,!0)]},f=function(t){var e=R.c2p(t.b,!0),n=R.c2p(t.x,!0);return r(e-o,n-o)+(o-n)/(e-n)},m=function(t){return t.s},x="y"===M?function(t){return[H.c2p(t.p-U,!0),H.c2p(t.p+U,!0)]}:function(t){return[H.c2p(t.y-C.barwidth/2,!0),H.c2p(t.y+C.barwidth/2,!0)]},p=function(t){var e=x(t);return r(e[0]-i,e[1]-i)},y=function(t){return t.p}):(x=function(t){return[H.c2p(t.y,!0)]},p=function(t){var e=H.c2p(t.b,!0),n=H.c2p(t.y,!0);return r(e-i,n-i)+(i-n)/(e-n)},y=function(t){return t.s},g="x"===M?function(t){return[R.c2p(t.p-U,!0),R.c2p(t.p+U,!0)]}:function(t){return[R.c2p(t.x-C.barwidth/2,!0),R.c2p(t.x+C.barwidth/2,!0)]},f=function(t){var e=g(t);return r(e[0]-o,e[1]-o)},m=function(t){return t.p})}else if("box"===Z.type){var J="closest"===S?a.MAXDIST/5:0;g=function(t){return[R.c2p(t.x+C.bx-C.bdx,!0),R.c2p(t.x+C.bx+C.bdx,!0)]},f=function(t){var e=g(t);return r(e[0]-o,e[1]-o)+J},p=function(t){return r(H.c2p(t.min,!0)-i,H.c2p(t.max,!0)-i)},m=function(t){return t.x}}else f=function(t){return Math.abs(R.c2p(t.x)-o)},p=function(t){return Math.abs(H.c2p(t.y)-i)},g=function(t){var e=R.c2p(t.x),n=t.mrc||0;return[e-n,e+n]},x=function(t){var e=H.c2p(t.y),n=t.mrc||0;return[e-n,e+n]},m=function(t){return t.x},y=function(t){return t.y};if(null!==I){if(0>I||I>=t.length)return;T=0}else{var Q={x:f,y:p,closest:function(t){return Math.sqrt(Math.pow(f(t),2)+Math.pow(p(t),2))}}[S];t.forEach(function(t,e){var n=Q(t);if(t.mrc){var o=Math.max(3,t.mrc);n=Math.max(n-o,1-3/o)}T>n&&(T=n,I=e)})}if($.isNumeric(I)&&!(T>a.MAXDIST)){"closest"===M&&(A=[]);var te=t[I];E=g(te);var ee,ne={i:I,dist:T,curvenum:n,x0:E[0],x1:E[E.length-1],xLabel:m(te),name:Z.name,xa:R,ya:H};if("box"===Z.type){var oe=[];["med","min","lf","q1","mean","q3","uf","max"].forEach(function(t){("mean"!==t||C.mean)&&t in te&&("lf"!==t||te.lf!==te.min)&&("uf"!==t||te.uf!==te.max)&&(O=H.c2p(te[t],!0),-1===oe.indexOf(O)&&(oe.push(O),ee=$.extend({},ne,{y0:O,y1:O,yLabel:te[t],attr:t,type:"box"}),"mean"===t&&"sd"in te&&"sd"===C.mean&&(ee.ysd=te.sd),"med"!==t&&(ee.name=""),A.push(ee)))})}else O=x(te),$.extend(ne,{y0:O[0],y1:O[O.length-1],yLabel:y(te)}),te.tx&&(ne.text=te.tx),A.push(ne)}}});var R=1/0;if(A=A.filter(function(t){return t&&"dist"in t&&(R=Math.min(R,t.dist)),t&&$.isNumeric(t.curvenum)&&t.i>=0&&t.i<P[t.curvenum].length&&$.isNumeric(t.x0)&&$.isNumeric(t.y0)&&$.isNumeric(t.xa.c2l(t.xLabel))&&$.isNumeric(t.ya.c2l(t.yLabel))}),0===A.length)return p(t,e);var H,S=_[0],F=w[0];A.forEach(function(t,e){t.posref="y"===M?(t.x0+t.x1)/2:(t.y0+t.y1)/2,t.x0=Plotly.Lib.constrain(t.x0,0,S._length),t.x1=Plotly.Lib.constrain(t.x1,0,S._length),t.y0=Plotly.Lib.constrain(t.y0,0,F._length),t.y1=Plotly.Lib.constrain(t.y1,0,F._length),t.xLabel=Plotly.Axes.tickText(t.xa,t.xa.c2l(t.xLabel),"hover"),t.yLabel=Plotly.Axes.tickText(t.ya,t.ya.c2l(t.yLabel),"hover"),t.dist===R&&void 0===H&&(H=e),"xsd"in t&&(t.xLabel.text+=" &plusmn; "+Plotly.Axes.tickText(t.xa,t.xa.c2l(t.xsd),"hover").text),"ysd"in t&&(t.yLabel.text+=" &plusmn; "+Plotly.Axes.tickText(t.ya,t.ya.c2l(t.ysd),"hover").text)}),H||(H=0),v._hoverlayer.selectAll("g.axistext").remove();var X=A[H],Y=13,j="Arial, sans-serif",K=3,G=6,V=v._paperdiv.node().getBoundingClientRect().top,W=X["y"===M?"yLabel":"xLabel"].text;if(R<=a.MAXDIST&&-1===["array","closest"].indexOf(M)){var q=v._hoverlayer.append("g").classed("axistext",!0),U=q.append("path").style({fill:"#444","stroke-width":"1px",stroke:"#fff"}),J=q.append("text").call(Plotly.Drawing.font,j,Y,"#fff").text(W).attr("data-notex",1).call(Plotly.util.convertToTspans);J.selectAll("tspan.line").call(Plotly.Drawing.setPosition,0,0);var Q=J.node().getBoundingClientRect();if("x"===M){J.attr("text-anchor","middle").call(Plotly.Drawing.setPosition,0,"top"===S.side?V-Q.bottom-G-K:V-Q.top+G+K).selectAll("tspan.line").attr({x:J.attr("x"),y:J.attr("y")});var te="top"===S.side?"-":"";U.attr("d","M0,0L"+G+","+te+G+"H"+(K+Q.width/2)+"v"+te+(2*K+Q.height)+"H-"+(K+Q.width/2)+"V"+te+G+"H-"+G+"Z"),q.attr("transform","translate("+(S._offset+(X.x0+X.x1)/2)+","+(F._offset+("top"===S.side?0:F._length))+")")}else{J.attr("text-anchor","right"===F.side?"start":"end").call(Plotly.Drawing.setPosition,("right"===F.side?1:-1)*(K+G),V-Q.top-Q.height/2).selectAll("tspan.line").attr({x:J.attr("x"),y:J.attr("y")});var ee="right"===F.side?"":"-";U.attr("d","M0,0L"+ee+G+","+G+"V"+(K+Q.height/2)+"h"+ee+(2*K+Q.width)+"V-"+(K+Q.height/2)+"H"+ee+G+"V-"+G+"Z"),q.attr("transform","translate("+(S._offset+("right"===F.side?S._length:0))+","+(F._offset+(X.y0+X.y1)/2)+")")}A=A.filter(function(t){return"zLabel"in t||t["y"===M?"yLabel":"xLabel"].text===W})}var ne=o(v.plot_bgcolor,v.paper_bgcolor),oe=v._hoverlayer.selectAll("g.hovertext").data(A,function(t){return[t.curvenum,t.i,t.x0,t.y0,t.name,t.attr||""].join(",")});oe.enter().append("g").classed("hovertext",!0).each(function(){var t=d3.select(this);t.append("rect").call(Plotly.Color.fill,Plotly.Color.addOpacity(ne,.8)),t.append("text").classed("name",!0).call(Plotly.Drawing.font,j,Y),t.append("path").style("stroke-width","1px"),t.append("text").classed("nums",!0).call(Plotly.Drawing.font,j,Y)}),oe.exit().remove(),oe.each(function(e){var n,r,a,i,c,s,u,h=d3.select(this).attr("transform",""),d=P[e.curvenum][0].trace,f=P[e.curvenum][e.i],p=e.name&&!("zLabel"in e)&&t.data.length>1?$("<p>"+e.name+"</p>").text():"",m=0;if(d.visible?Plotly.Plots.isScatter(d.type)?"lines"===d.mode?(u=d.line.color,a=u&&Plotly.Color.opacity(u)?u:d.fillcolor):"none"===d.mode?a=d.fill?d.fillcolor:"":(c=f.mcc||(d.marker||{}).color,s=f.mlcc||((d.marker||{}).line||{}).color,a=c&&Plotly.Color.opacity(c)?c:s&&Plotly.Color.opacity(s)&&(f.mlw||((d.marker||{}).line||{}).width)?s:"",a?m=.3:(u=(d.line||{}).color,a=u&&Plotly.Color.opacity(u)&&Plotly.Scatter.hasLines(d)&&d.line.width?u:d.fillcolor)):Plotly.Plots.isBar(d.type)?(c=d.marker.color,s=d.marker.line.color,a=c&&Plotly.Color.opacity(c)?c:s&&Plotly.Color.opacity(s)&&d.marker.line.width?s:""):"box"===d.type&&(u=d.line.color,c=(d.marker||{}).color,a=u&&Plotly.Color.opacity(u)&&d.line.width?u:c&&Plotly.Color.opacity(c)&&d.boxpoints?c:d.fillcolor):a="",a&&Plotly.Color.opacity(a)||(a="#444"),a=o(a,ne,m),r=tinycolor(a).toRgb(),i=.299*r.r+.587*r.g+.114*r.b>128?"#000":"#FFF",p.length>15&&(p=p.substr(0,12)+"..."),"zLabel"in e)n="x: "+e.xLabel.text+"<br>y: "+e.yLabel.text+"<br>z: "+e.zLabel;else if("x"===M&&e.xLabel.text===W)n=e.yLabel.text;else if("y"===M&&e.yLabel.text===W)n=e.xLabel.text;else if("box"===e.type){if(n=e.yLabel.text,p){var y=$("<p>"+e.xLabel.text+"</p>").text();y!==p&&(p+=": "+y)}}else n="("+e.xLabel.text+", "+e.yLabel.text+")";e.text&&(n+="<br>"+e.text);var g=h.select("text.nums").style("fill",i).call(Plotly.Drawing.setPosition,0,0).text(n).attr("data-notex",1).call(Plotly.util.convertToTspans);g.selectAll("tspan.line").call(Plotly.Drawing.setPosition,0,0);var x=h.select("text.name"),b=0;p?(x.style("fill",a).text(p).call(Plotly.Drawing.setPosition,0,0).attr("data-notex",1).call(Plotly.util.convertToTspans),x.selectAll("tspan.line").call(Plotly.Drawing.setPosition,0,0),b=x.node().getBoundingClientRect().width+2*K):(x.remove(),h.select("rect").remove()),h.select("path").style({fill:a,stroke:i});var _=g.node().getBoundingClientRect(),w=S._offset+(e.x0+e.x1)/2,L=F._offset+(e.y0+e.y1)/2,z=Math.abs(e.x1-e.x0),N=Math.abs(e.y1-e.y0),D=_.width+G+K+b;e.ty0=V-_.top,e.bx=_.width+2*K,e.by=_.height+2*K,e.anchor="start",e.txwidth=_.width,e.tx2width=b,B?(e.pos=w,L+=N/2,L+D>v.height&&(e.anchor="end",L-=N,0>L-D&&(e.anchor="middle",L+=N/2))):(e.pos=L,w+=z/2,w+D>v.width&&(e.anchor="end",w-=z,0>w-D&&(e.anchor="middle",w+=z/2))),g.attr("text-anchor",e.anchor),b&&x.attr("text-anchor",e.anchor),h.attr("transform","translate("+w+","+L+")"+(B?"rotate("+l+")":""))});for(var re,ae,le,ie,ce,se,ue=0,he=B?S:F,de=he._offset,fe=he._offset+he._length,pe=A.map(function(t,e){return[{i:e,dp:0,pos:t.pos,posref:t.posref,size:t.by*(B?c:1)/2}]}).sort(function(t,e){return t[0].posref-e[0].posref});!re&&ue<=A.length;){for(ue++,re=!0,ie=0;ie<pe.length-1;){var me=pe[ie],ye=pe[ie+1],ge=me[me.length-1],ve=ye[0];ae=ge.pos+ge.dp+ge.size-ve.pos-ve.dp+ve.size,ae>.01?(ye.forEach(m),me.push.apply(me,ye),pe.splice(ie+1,1),se=0,me.forEach(f),le=se/me.length,me.forEach(y),re=!1):ie++}pe.forEach(g)}pe.forEach(function(t){t.forEach(function(t){A[t.i].offset=t.dp,A[t.i].del=t.del})}),oe.each(function(t){var e=d3.select(this);if(t.del)return void e.remove();var n="end"===t.anchor?-1:1,o=e.select("text.nums"),r={start:1,end:-1,middle:0}[t.anchor],a=r*(G+K),l=a+r*(t.txwidth+K),i=0,c=t.offset;"middle"===t.anchor&&(a-=t.tx2width/2,l-=t.tx2width/2),B&&(c*=-u,i=t.offset*s),e.select("path").attr("d","middle"===t.anchor?"M-"+t.bx/2+",-"+t.by/2+"h"+t.bx+"v"+t.by+"h-"+t.bx+"Z":"M0,0L"+(n*G+i)+","+(G+c)+"v"+(t.by/2-G)+"h"+n*t.bx+"v-"+t.by+"H"+(n*G+i)+"V"+(c-G)+"Z"),o.call(Plotly.Drawing.setPosition,a+i,c+t.ty0-t.by/2+K).selectAll("tspan.line").attr({x:o.attr("x"),y:o.attr("y")}),t.tx2width&&(e.select("text.name, text.name tspan.line").call(Plotly.Drawing.setPosition,l+r*K+i,c+t.ty0-t.by/2+K),e.select("rect").call(Plotly.Drawing.setRect,l+(r-1)*t.tx2width/2+i,c-t.by/2-1,t.tx2width,t.by+2))});var xe=t._hoverdata;if(t._hoverdata=A.map(function(e){var n=P[e.curvenum][0].trace.index,o={data:t.data[n],curveNumber:n,pointNumber:e.i,x:e.xLabel.x,y:e.yLabel.x,xaxis:e.xa,yaxis:e.ya};return"zLabel"in e&&(o.z=e.zLabel),o}),e.target){var be=!xe||xe.length!==t._hoverdata.length;be||xe.forEach(function(e,n){(e.curveNumber!==t._hoverdata[n].curveNumber||e.pointNumber!==t._hoverdata[n].pointNumber)&&(be=!0)}),be&&(xe&&$(t).trigger("plotly_unhover",{points:xe}),$(t).trigger("plotly_hover",{points:t._hoverdata,xaxes:_,yaxes:w,xvals:N,yvals:D}))}},p=function(t,e){var n=t._fullLayout;if(e||(e={}),"string"==typeof t&&(t=document.getElementById(t)),!e.fromUnhover)if(e.relatedTarget&&$(e.relatedTarget).parents('[class="hoverlayer"]').length)e.fromUnhover=!0,f(t,e,n._hoversubplot);else{if(e.target&&$(t).triggerHandler("plotly_beforehover",e)===!1)return;n._hoverlayer.selectAll("g").remove(),e.target&&t.hoverdata&&$(t).trigger("plotly_unhover",{points:t.hoverdata}),t._hoverdata=void 0}};a.click=function(t,e){t._hoverdata&&e&&e.target&&($(t).trigger("plotly_click",{points:t._hoverdata}),e.stopImmediatePropagation())},a.modeBar=function(t){function e(){return this.getAttribute("data-gravity")||"n"}function n(){var n=new ModeBar({buttons:i,container:r._paperdiv.node(),Plotly:Plotly,graphInfo:t});return $(n.element).find("button, a").tipsy({opacity:1,gravity:e}),r._privateplot&&$(n.element).append('<span class="badge-private float--left">PRIVATE</span>'),n}var o,r=t._fullLayout||{};if(!(t._context.staticPlot||r._hasGL3D&&r._noGL3DSupport)){var a=[["zoom2d","pan2d"],["zoomIn2d","zoomOut2d","autoScale2d"],["hoverClosest2d","hoverCompare2d"]],l=[["rotate3d","zoom3d","pan3d"],["resetCameraDefault3d","resetCameraLastSave3d"],["closest3d"]],i=r._hasGL3D?l:a;if(!r._modebar){var c=t.querySelector(".modebar");c&&c.parentNode.removeChild(c),r._modebar=n()}o=r._modebar,o.hasButtons(i)||(r._modebar.cleanup(),r._modebar=n()),r&&$(o.element).find('[data-attr="hovermode"]').toggle(r.hovermode!==!1)}};var m=!0;a.dragAlign=function(t,e,n,o,r){var a=(t-n)/(o-n),l=a+e/(o-n),i=(a+l)/2;return"left"===r||"bottom"===r?a:"center"===r||"middle"===r?i:"right"===r||"top"===r?l:2/3-i>a?a:l>4/3-i?l:i};var y=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];a.dragCursors=function(t,e,n,o){return t="left"===n?0:"center"===n?1:"right"===n?2:Plotly.Lib.constrain(Math.floor(3*t),0,2),e="bottom"===o?0:"middle"===o?1:"top"===o?2:Plotly.Lib.constrain(Math.floor(3*e),0,2),y[e][t]},a.dragClear=function(t){return t._input&&t._input.trigger("blur"),!1},a.dragElement=function(t){t.element.onmousedown=function(e){var n=!1,o=$(t.element).parents(".js-plotly-plot")[0];return o&&a.dragClear(o)?!0:(t.prepFn&&t.prepFn(),window.onmousemove=function(o){var r=o.clientX-e.clientX,l=o.clientY-e.clientY;return Math.abs(r)<a.MINDRAG&&(r=0),Math.abs(l)<a.MINDRAG&&(l=0),(r||l)&&(n=!0),t.moveFn&&t.moveFn(r,l,n),Plotly.Lib.pauseEvent(o)},window.onmouseup=function(e){return window.onmousemove=null,window.onmouseup=null,t.doneFn&&t.doneFn(n),Plotly.Lib.pauseEvent(e)},Plotly.Lib.pauseEvent(e))}},a.setCursor=function(t,e){(t.attr("class")||"").split(" ").forEach(function(e){0===e.indexOf("cursor-")&&t.classed(e,!1)}),e&&t.classed("cursor-"+e,!0)}}();!function(){"use strict";function r(r,e,t){return"percent"===r?Math.abs(e*t/100):"constant"===r?Math.abs(t):"sqrt"===r?Math.sqrt(Math.abs(e)):(console.log("unrecognized errorbar type",r,t,e),0)}function e(r,e,t){var a={x:e.c2p(r.x),y:t.c2p(r.y)};return void 0!==r.yh&&(a.yh=t.c2p(r.yh),a.ys=t.c2p(r.ys),$.isNumeric(a.ys)||(a.noYS=!0,a.ys=t.c2p(r.ys,!0))),void 0!==r.xh&&(a.xh=e.c2p(r.xh),a.xs=e.c2p(r.xs),$.isNumeric(a.xs)||(a.noXS=!0,a.xs=e.c2p(r.xs,!0))),a}var t=window.Plotly.ErrorBars={};t.attributes={visible:{type:"boolean"},type:{type:"enumerated",values:["percent","constant","sqrt","data"]},symmetric:{type:"boolean"},array:{type:"data_array"},arrayminus:{type:"data_array"},value:{type:"number",min:0,dflt:10},valueminus:{type:"number",min:0,dflt:10},traceref:{type:"integer",min:0,dflt:0},tracerefminus:{type:"integer",min:0,dflt:0},copy_ystyle:{type:"boolean"},copy_zstyle:{type:"boolean"},color:{type:"color"},thickness:{type:"number",min:0,dflt:2},width:{type:"number",min:0}},t.supplyDefaults=function(r,e,a,i){function s(r,e){return Plotly.Lib.coerce(c,o,t.attributes,r,e)}var l="error_"+i.axis,o=e[l]={},c=r[l]||{},n=s("visible","array"in c||"value"in c);if(n){var y=s("type","array"in c?"data":"percent"),u=!0;if("sqrt"!==y&&(u=s("symmetric",!(("data"===y?"arrayminus":"valueminus")in c))),"data"===y){var p=s("array");if(p||(o.array=[]),s("traceref"),!u){var m=s("arrayminus");m||(o.arrayminus=[]),s("tracerefminus")}}else("percent"===y||"constant"===y)&&(s("value"),u||s("valueminus"));var d="copy_"+i.inherit+"style";if(i.inherit){var v=e["error_"+i.inherit];(v||{}).visible&&s(d,!(c.color||$.isNumeric(c.thickness)||$.isNumeric(c.width)))}i.inherit&&o[d]||(s("color",a),s("thickness"),s("width",Plotly.Plots.isScatter3D(e.type)?0:4))}},t.pushRef2GDC=function(r,e,t,a){function i(e){var t=r.data[e][c];t["tracerefminus"===n?"arrayminus":"array"]=u}var s,l=!1,o=t.split("."),c=o[0],n=o[1],y=c.charAt(c.length-1);"type"===n?("various"===e&&(l=!0,e=0),s=Number(r.calcdata[Number(e)][0].trace["error_"+y].traceref)||0):("traceref"===n||"tracerefminus"===n)&&("various"===e&&(l=!0),s=Number(a)||0);var u=r.data[s][y].map(Number);if(l)for(var p=0;p<r.data.length;p++)i(p);else i(Number(e))},t.calc=function(e){(e.calcdata||[]).forEach(function(t){var a=t[0].trace;if((a.module||{}).errorBarsOK){var i=a.error_x||{},s=a.error_y||{},l=Plotly.Axes.getFromId(e,a.xaxis),o=Plotly.Axes.getFromId(e,a.yaxis),c=i.visible&&-1!==["linear","log"].indexOf(l.type),n=s.visible&&-1!==["linear","log"].indexOf(o.type);if(c||n){var y=[],u=[];t.forEach(function(e,t){try{$.isNumeric(o.c2l(e.y))&&$.isNumeric(l.c2l(e.x))&&[{letter:"x",obj:i,visible:c,vals:y},{letter:"y",obj:s,visible:n,vals:u}].forEach(function(a){if(a.visible){var i,s,l=e[a.letter],o=a.obj;if("data"===a.obj.type?(i=Number(o.array[t]),s=!o.symmetric&&"arrayminus"in o?Number(o.arrayminus[t]):i):(i=r(o.type,l,o.value),s=!o.symmetric&&"valueminus"in o?r(o.type,l,o.valueminus):i),$.isNumeric(i)&&$.isNumeric(s)){var c=e[a.letter+"h"]=l+i,n=e[a.letter+"s"]=l-s;a.vals.push(c,n)}}})}catch(a){console.log(a)}}),Plotly.Axes.expand(o,u,{padded:!0}),Plotly.Axes.expand(l,y,{padded:!0})}}})},t.plot=function(r,t,a){var i=t.x(),s=t.y();t.plot.select(".errorlayer").selectAll("g.errorbars").remove();var l;t.plot.select(".errorlayer").selectAll("g.errorbars").data(a).enter().append("g").attr("class","errorbars").each(function(r){var t=r[0].trace,a=t.error_x,o=t.error_y,c=Plotly.Scatter.hasMarkers(t)&&t.marker.maxdisplayed>0;(o.visible||a.visible)&&d3.select(this).selectAll("g").data(Plotly.Lib.identity).enter().append("g").each(function(r){l=e(r,i,s);var t,n=d3.select(this);if(!c||r.vis){if(o.visible&&$.isNumeric(l.x)&&$.isNumeric(l.yh)&&$.isNumeric(l.ys)){var y=o.width;t="M"+(l.x-y)+","+l.yh+"h"+2*y+"m-"+y+",0V"+l.ys,l.noYS||(t+="m-"+y+",0h"+2*y),n.append("path").classed("yerror",!0).attr("d",t)}if(a.visible&&$.isNumeric(l.y)&&$.isNumeric(l.xh)&&$.isNumeric(l.xs)){var u=(a.copy_ystyle?o:a).width;t="M"+l.xh+","+(l.y-u)+"v"+2*u+"m0,-"+u+"H"+l.xs,l.noXS||(t+="m0,-"+u+"v"+2*u),n.append("path").classed("xerror",!0).attr("d",t)}}})})},t.style=function(r){r.selectAll("g.errorbars").each(function(r){var e=d3.select(this),t=r[0].trace,a=t.error_y||{},i=t.error_x||{};e.selectAll("g path.yerror").style("stroke-width",a.thickness+"px").call(Plotly.Color.stroke,a.color),i.copy_ystyle&&(i=a),e.selectAll("g path.xerror").style("stroke-width",i.thickness+"px").call(Plotly.Color.stroke,i.color)})}}();!function(){"use strict";function e(e,r){function l(l,a){return Plotly.Lib.coerce(e,r,t.attributes,l,a)}var a=l("line.shape");"spline"===a&&l("line.smoothing")}var t=window.Plotly.Scatter={};t.errorBarsOK=!0,t.PTS_LINESONLY=20,t.attributes={x:{type:"data_array"},x0:{type:"any",dflt:0},dx:{type:"number",dflt:1},y:{type:"data_array"},y0:{type:"any",dflt:0},dy:{type:"number",dflt:1},text:{type:"string",dflt:"",arrayOk:!0},mode:{type:"enumerated",values:["none","lines","markers","lines+markers","text","lines+text","markers+text","lines+markers+text"]},line:{color:{type:"color"},width:{type:"number",min:0,dflt:2},shape:{type:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear"},smoothing:{type:"number",min:0,max:1.3,dflt:1},dash:{type:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid"}},connectgaps:{type:"boolean",dflt:!1},fill:{type:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx"],dflt:"none"},fillcolor:{type:"color"},marker:{symbol:{type:"enumerated",values:Plotly.Drawing.symbolList,dflt:"circle",arrayOk:!0},opacity:{type:"number",min:0,max:1,arrayOk:!0},size:{type:"number",min:0,dflt:6,arrayOk:!0},color:{type:"color",arrayOk:!0},maxdisplayed:{type:"number",min:0,dflt:0},sizeref:{type:"number",dflt:1},sizemode:{type:"enumerated",values:["diameter","area"],dflt:"diameter"},colorscale:{type:"colorscale",dflt:Plotly.Color.defaultScale},cauto:{type:"boolean",dflt:!0},cmax:{type:"number",dflt:10},cmin:{type:"number",dflt:-10},line:{color:{type:"color",arrayOk:!0},width:{type:"number",min:0,arrayOk:!0},colorscale:{type:"colorscale",dflt:Plotly.Color.defaultScale},cauto:{type:"boolean",dflt:!0},cmax:{type:"number",dflt:10},cmin:{type:"number",dflt:-10}}},textposition:{type:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0},textfont:{type:"font"}},t.supplyXY=function(e,r){function l(l,a){return Plotly.Lib.coerce(e,r,t.attributes,l,a)}var a,i=l("x"),n=l("y");if(i)n?(a=Math.min(i.length,n.length),a<i.length&&(r.x=i.slice(0,a)),a<n.length&&(r.y=n.slice(0,a))):(a=i.length,l("y0"),l("dy"));else{if(!n)return 0;a=r.y.length,l("x0"),l("dx")}return a},t.supplyDefaults=function(r,l,a,i){function n(e,a){return Plotly.Lib.coerce(r,l,t.attributes,e,a)}var o=t.supplyXY(r,l),s=o<t.PTS_LINESONLY?"lines+markers":"lines";if(!o)return void(l.visible=!1);if(n("text"),n("mode",s),t.hasLines(l)&&t.lineDefaults(r,l,a,i),t.hasMarkers(l)&&t.markerDefaults(r,l,a,i),t.hasText(l)&&(n("textposition"),n("textfont",i.font),t.hasMarkers(l)||n("marker.maxdisplayed")),n("fill"),"none"!==l.fill){var c=!1;if(l.marker){var y=l.marker.color,d=(l.marker.line||{}).color;y&&!Array.isArray(y)?c=y:d&&!Array.isArray(d)&&(c=d)}n("fillcolor",Plotly.Color.addOpacity((l.line||{}).color||c||a,.5)),t.hasLines(l)||e(r,l)}Plotly.ErrorBars.supplyDefaults(r,l,a,{axis:"y"}),Plotly.ErrorBars.supplyDefaults(r,l,a,{axis:"x",inherit:"y"})},t.lineDefaults=function(r,l,a){function i(e,a){return Plotly.Lib.coerce(r,l,t.attributes,e,a)}var n=(r.marker||{}).color;i("line.color",(Array.isArray(n)?!1:n)||a),i("line.width"),e(r,l),i("connectgaps"),i("line.dash")},t.markerDefaults=function(e,r,l){function a(l,a){return Plotly.Lib.coerce(e,r,t.attributes,l,a)}var i,n=$.isArray((e.marker||{}).size),o=(e.line||{}).color;o&&(l=o),a("marker.symbol"),a("marker.opacity",n?.7:1),a("marker.size"),a("marker.maxdisplayed"),t.colorScalableDefaults("marker.",a,l),i=o&&r.marker.color!==o?o:n?"#fff":"#444",t.colorScalableDefaults("marker.line.",a,i),a("marker.line.width",n?1:0),n&&(a("marker.sizeref"),a("marker.sizemode"))},t.colorScalableDefaults=function(e,t,r){var l=e+"color",a=t(l,r),i=[e+"colorscale",e+"cauto",e+"cmax",e+"cmin"];$.isArray(a)&&i.forEach(t)},t.hasLines=function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("lines")},t.hasMarkers=function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("markers")},t.hasText=function(e){return e.visible&&e.mode&&-1!==e.mode.indexOf("text")},t.calc=function(e,r){var l=Plotly.Axes.getFromId(e,r.xaxis||"x"),a=Plotly.Axes.getFromId(e,r.yaxis||"y");Plotly.Lib.markTime("in Scatter.calc");var i=l.makeCalcdata(r,"x");Plotly.Lib.markTime("finished convert x");var n=a.makeCalcdata(r,"y");Plotly.Lib.markTime("finished convert y");var o=Math.min(i.length,n.length);l._minDtick=0,a._minDtick=0,i.length>o&&i.splice(o,i.length-o),n.length>o&&n.splice(o,n.length-o);var s={padded:!0},c={padded:!0};if(t.hasMarkers(r)){var y,d=1.6*(r.marker.sizeref||1);y="area"===r.marker.sizemode?function(e){return Math.max(Math.sqrt((e||0)/d),3)}:function(e){return Math.max((e||0)/d,3)},s.ppad=c.ppad=$.isArray(r.marker.size)?r.marker.size.map(y):y(r.marker.size)}!("tozerox"===r.fill||"tonextx"===r.fill&&e.firstscatter)||i[0]===i[o-1]&&n[0]===n[o-1]?r.error_y.visible||-1===["tonexty","tozeroy"].indexOf(r.fill)&&(t.hasMarkers(r)||t.hasText(r))||(s.padded=!1,s.ppad=0):s.tozero=!0,!("tozeroy"===r.fill||"tonexty"===r.fill&&e.firstscatter)||i[0]===i[o-1]&&n[0]===n[o-1]?-1!==["tonextx","tozerox"].indexOf(r.fill)&&(c.padded=!1):c.tozero=!0,Plotly.Lib.markTime("ready for Axes.expand"),Plotly.Axes.expand(l,i,s),Plotly.Lib.markTime("done expand x"),Plotly.Axes.expand(a,n,c),Plotly.Lib.markTime("done expand y");for(var m=[],f=0;o>f;f++)m.push($.isNumeric(i[f])&&$.isNumeric(n[f])?{x:i[f],y:n[f]}:{x:!1,y:!1});return e.firstscatter=!1,m},t.selectMarkers=function(e,r,l){var a=r.x(),i=r.y(),n=d3.extent(a.range.map(a.l2c)),o=d3.extent(i.range.map(i.l2c));l.forEach(function(e,r){var a=e[0].trace;if(t.hasMarkers(a)){var i=a.marker.maxdisplayed;if(0!==i){var s=e.filter(function(e){return e.x>=n[0]&&e.x<=n[1]&&e.y>=o[0]&&e.y<=o[1]}),c=Math.ceil(s.length/i),y=0;l.forEach(function(e,l){var a=e[0].trace;t.hasMarkers(a)&&a.marker.maxdisplayed>0&&r>l&&y++});var d=Math.round(y*c/3+Math.floor(y/3)*c/7.1);e.forEach(function(e){delete e.vis}),s.forEach(function(e,t){0===Math.round((t+d)%c)&&(e.vis=!0)})}}})},t.arraysToCalcdata=function(e){var t=e[0].trace,r=t.marker;if(Plotly.Lib.mergeArray(t.text,e,"tx"),Plotly.Lib.mergeArray(t.textposition,e,"tp"),t.textfont&&(Plotly.Lib.mergeArray(t.textfont.size,e,"ts"),Plotly.Lib.mergeArray(t.textfont.color,e,"tc"),Plotly.Lib.mergeArray(t.textfont.family,e,"tf")),r&&r.line){var l=r.line;Plotly.Lib.mergeArray(r.opacity,e,"mo"),Plotly.Lib.mergeArray(r.size,e,"ms"),Plotly.Lib.mergeArray(r.symbol,e,"mx"),Plotly.Lib.mergeArray(r.color,e,"mc"),Plotly.Lib.mergeArray(l.color,e,"mlc"),Plotly.Lib.mergeArray(l.width,e,"mlw")}},t.plot=function(e,r,l){function a(e,t,r){return(.75+10*Math.max(0,Math.max(-e,e-n._length)/n._length,Math.max(-t,t-o._length)/o._length))*Math.max(r||1,1)}function i(e){return e.filter(function(e){return e.vis})}t.selectMarkers(e,r,l);var n=r.x(),o=r.y(),s=r.plot.select(".scatterlayer").selectAll("g.trace.scatter").data(l);s.enter().append("g").attr("class","trace scatter").style("stroke-miterlimit",2);var c,y,d,m="";s.each(function(e){function r(e){u=!0,l(e),S=e}function l(e){$.isNumeric(e[0])&&$.isNumeric(e[1])&&T.push(e)}function i(e){e&&(g=e),g===x?x!==b&&l(b):g===b||b===x?l(x):"high"===v?(l(b),l(x)):(l(x),l(b)),r(g),h=g,x=b=null,P=-1}var s=e[0].trace,f=s.line;if(s.visible!==!1&&(t.arraysToCalcdata(e),t.hasLines(s)||"none"!==s.fill)){var p,u,h,x,b,g,k,v,P,L,A,M,z,D=-1,w=d3.select(this),O=null,S=null,T=[],_="",N="";for(c="tozero"===s.fill.substr(0,6)||"to"===s.fill.substr(0,2)&&!m?w.append("path").classed("js-fill",!0):null,d&&(y=d.datum(e)),d=w.append("path").classed("js-fill",!0),-1!==["hv","vh","hvh","vhv"].indexOf(f.shape)?(A=Plotly.Drawing.steps(f.shape),M=Plotly.Drawing.steps(f.shape.split("").reverse().join(""))):A=M="spline"===f.shape?function(e){return Plotly.Drawing.smoothopen(e,f.smoothing)}:function(e){return"M"+e.join("L")},z=function(e){return"L"+M(e.reverse()).substr(1)};D<e.length;){for(T=[],u=!1,h=null,P=-1,D++;D<e.length;D++){if(k=[n.c2p(e[D].x),o.c2p(e[D].y)],!$.isNumeric(k[0])||!$.isNumeric(k[1])){if(s.connectgaps)continue;break}if(h){if(L=a(k[0],k[1],f.width),0>P)if(Math.abs(k[0]-h[0])<L)P=0;else{if(!(Math.abs(k[0]-h[1])<L)){h=k,r(h);continue}P=1}else if(Math.abs(k[P]-h[P])>=L){i(k);continue}g=k,(!x||g[1-P]>x[1-P])&&(x=g,v="high"),(!b||g[1-P]<b[1-P])&&(b=g,v="low")}else h=k,T.push(h),O||(O=h)}P>=0&&i(k),T.length&&(p=A(T),_+=_?"L"+p.substr(1):p,N=z(T)+N,t.hasLines(s)&&u&&w.append("path").classed("js-line",!0).attr("d",p))}_&&(c?O&&S&&("y"===s.fill.charAt(s.fill.length-1)?O[1]=S[1]=o.c2p(0,!0):O[0]=S[0]=n.c2p(0,!0),c.attr("d",_+"L"+S+"L"+O+"Z")):"tonext"===s.fill.substr(0,6)&&_&&m&&y.attr("d",_+m+"Z"),m=N)}}),s.selectAll("path:not([d])").remove(),s.append("g").attr("class","points").each(function(e){var r=e[0].trace,l=d3.select(this),a=t.hasMarkers(r),s=t.hasText(r);!a&&!s||r.visible===!1?l.remove():(a&&l.selectAll("path.point").data(r.marker.maxdisplayed?i:Plotly.Lib.identity).enter().append("path").classed("point",!0).call(Plotly.Drawing.translatePoints,n,o),s&&l.selectAll("g").data(r.marker.maxdisplayed?i:Plotly.Lib.identity).enter().append("g").append("text").call(Plotly.Drawing.translatePoints,n,o))})},t.style=function(e){var t=e.selectAll("g.trace.scatter");t.style("opacity",function(e){return e[0].trace.opacity}),t.selectAll("g.points").each(function(e){d3.select(this).selectAll("path.point").call(Plotly.Drawing.pointStyle,e.trace||e[0].trace),d3.select(this).selectAll("text").call(Plotly.Drawing.textPointStyle,e.trace||e[0].trace)}),t.selectAll("g.trace path.js-line").call(Plotly.Drawing.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(Plotly.Drawing.fillGroupStyle)}}();!function(){"use strict";function t(t){var r=t[0].trace,a=r.marker,e=a.line;Plotly.Lib.mergeArray(r.text,t,"tx"),Plotly.Lib.mergeArray(a.opacity,t,"mo"),Plotly.Lib.mergeArray(a.color,t,"mc"),Plotly.Lib.mergeArray(e.color,t,"mlc"),Plotly.Lib.mergeArray(e.width,t,"mlw")}var r=window.Plotly.Bars={};r.errorBarsOK=!0,r.attributes={orientation:{type:"enumerated",values:["v","h"]}},r.layoutAttributes={barmode:{type:"enumerated",values:["stack","group","overlay"],dflt:"group"},bargap:{type:"number",min:0,max:1},bargroupgap:{type:"number",min:0,max:1,dflt:0},x:{from:"Scatter"},x0:{from:"Scatter"},dx:{from:"Scatter"},y:{from:"Scatter"},y0:{from:"Scatter"},dy:{from:"Scatter"},marker:{color:{from:"Scatter"},colorscale:{from:"Scatter"},cauto:{from:"Scatter"},cmax:{from:"Scatter"},cmin:{from:"Scatter"},line:{color:{from:"Scatter"},colorscale:{from:"Scatter"},cauto:{from:"Scatter"},cmax:{from:"Scatter"},cmin:{from:"Scatter"},width:{from:"Scatter"}}},error_x:{allFrom:"Errorbars"},error_y:{allFrom:"Errorbars"}},r.supplyDefaults=function(t,a,e){function o(e,o){return Plotly.Lib.coerce(t,a,r.attributes,e,o)}function l(r,e){return Plotly.Lib.coerce(t,a,Plotly.Scatter.attributes,r,e)}if("histogram"===a.type){if(Plotly.Histogram.supplyDefaults(t,a),!a.visible)return}else{var c=Plotly.Scatter.supplyXY(t,a);if(!c)return void(a.visible=!1);o("orientation",a.x&&!a.y?"h":"v")}Plotly.Scatter.colorScalableDefaults("marker.",l,e),Plotly.Scatter.colorScalableDefaults("marker.line.",l,"#444"),l("marker.line.width",0),l("text"),Plotly.ErrorBars.supplyDefaults(t,a,"#444",{axis:"y"}),Plotly.ErrorBars.supplyDefaults(t,a,"#444",{axis:"x",inherit:"y"})},r.supplyLayoutDefaults=function(t,a,e){function o(e,o){return Plotly.Lib.coerce(t,a,r.layoutAttributes,e,o)}var l=!1,c=!1;e.forEach(function(t){if(Plotly.Plots.isBar(t.type)&&(l=!0),t.visible&&"histogram"===t.type){var r=Plotly.Axes.getFromId({_fullLayout:a},t["v"===t.orientation?"xaxis":"yaxis"]);"category"!==r.type&&(c=!0)}}),l&&(o("barmode"),o("bargap",c?0:.2),o("bargroupgap"))},r.calc=function(t,r){if("histogram"===r.type)return Plotly.Histogram.calc(t,r);var a,e,o,l=Plotly.Axes.getFromId(t,r.xaxis||"x"),c=Plotly.Axes.getFromId(t,r.yaxis||"y"),i=r.orientation||(r.x&&!r.y?"h":"v");"h"===i?(e=l.makeCalcdata(r,"x"),a=c.makeCalcdata(r,"y")):(e=c.makeCalcdata(r,"y"),a=l.makeCalcdata(r,"x"));var n=Math.min(a.length,e.length),s=[];for(o=0;n>o;o++)$.isNumeric(a[o])&&$.isNumeric(e[o])&&s.push({p:a[o],s:e[o],b:0});return s},r.setPositions=function(t,r){var a,e,o=t._fullLayout,l=r.x(),c=r.y();["v","h"].forEach(function(i){function n(r){function a(t){t[f]=t.p+y}var e=[];r.forEach(function(r){t.calcdata[r].forEach(function(t){e.push(t.p)})});var l=Plotly.Lib.distinctVals(e),c=l.vals,i=l.minDiff,n=!1,u=[];"group"===o.barmode&&r.forEach(function(r){n||(t.calcdata[r].forEach(function(t){n||u.forEach(function(r){Math.abs(t.p-r)<i&&(n=!0)})}),n||t.calcdata[r].forEach(function(t){u.push(t.p)}))}),Plotly.Axes.minDtick(p,i,c[0],n),Plotly.Axes.expand(p,c,{vpad:i/2}),i*=1-o.bargap,n&&(i/=s.length);for(var y,m=0;m<r.length;m++){var d=t.calcdata[r[m]][0].t;d.barwidth=i*(1-o.bargroupgap),d.poffset=((n?(2*m+1-r.length)*i:0)-d.barwidth)/2,d.dbar=l.minDiff,y=d.poffset+d.barwidth/2,t.calcdata[r[m]].forEach(a)}}var s=[],f={v:"x",h:"y"}[i],u={v:"y",h:"x"}[i],p=r[f](),y=r[u]();if(t._fullData.forEach(function(t,r){t.visible&&Plotly.Plots.isBar(t.type)&&t.orientation===i&&t.xaxis===l._id&&t.yaxis===c._id&&s.push(r)}),s.length)if("overlay"===o.barmode?s.forEach(function(t){n([t])}):n(s),"stack"===o.barmode){var m=y.l2c(y.c2l(0)),d=m,h={},b=0,g=t.calcdata[s[0]][0].t.barwidth/100,x=0;for(a=0;a<s.length;a++){var v=t.calcdata[s[a]];for(e=0;e<v.length;e++)x=Math.round(v[e].p/g),v[e].b=h[x]||0,b=v[e].b+v[e].s,v[e][u]=b,h[x]=b,$.isNumeric(y.c2l(b))&&(m=Math.max(m,b),d=Math.min(d,b))}Plotly.Axes.expand(y,[d,m],{tozero:!0,padded:!0})}else{var P=function(t){return t[u]=t.s,t.s};for(a=0;a<s.length;a++)Plotly.Axes.expand(y,t.calcdata[s[a]].map(P),{tozero:!0,padded:!0})}})},r.plot=function(r,a,e){var o=a.x(),l=a.y(),c=r._fullLayout,i=a.plot.select(".barlayer").selectAll("g.trace.bars").data(e).enter().append("g").attr("class","trace bars");i.append("g").attr("class","points").each(function(a){var e=a[0].t,i=a[0].trace;t(a),d3.select(this).selectAll("path").data(Plotly.Lib.identity).enter().append("path").each(function(t){function a(t){return 0===c.bargap&&0===c.bargroupgap?d3.round(Math.round(t)-m,2):t}function n(t,r){return Math.abs(t-r)>=2?a(t):t>r?Math.ceil(t):Math.floor(t)}var s,f,u,p;if("h"===i.orientation?(u=l.c2p(e.poffset+t.p,!0),p=l.c2p(e.poffset+t.p+e.barwidth,!0),s=o.c2p(t.b,!0),f=o.c2p(t.s+t.b,!0)):(s=o.c2p(e.poffset+t.p,!0),f=o.c2p(e.poffset+t.p+e.barwidth,!0),p=l.c2p(t.s+t.b,!0),u=l.c2p(t.b,!0)),!($.isNumeric(s)&&$.isNumeric(f)&&$.isNumeric(u)&&$.isNumeric(p)&&s!==f&&u!==p))return void d3.select(this).remove();var y=(t.mlw+1||i.marker.line.width+1||(t.trace?t.trace.marker.line.width:0)+1)-1,m=d3.round(y/2%1,2);if(!r._context.staticPlot){var d=Plotly.Color.opacity(t.mc||i.marker.color),h=1>d||y>.01?a:n;s=h(s,f),f=h(f,s),u=h(u,p),p=h(p,u)}d3.select(this).attr("d","M"+s+","+u+"V"+p+"H"+f+"V"+u+"Z")})})},r.style=function(t,r){var a=t.selectAll("g.trace.bars"),e=a.size();a.style("opacity",function(t){return t[0].trace.opacity}).each(function(t){("stack"===r.barmode&&e>1||0===r.bargap&&0===r.bargroupgap&&!t[0].trace.marker.line.width)&&d3.select(this).attr("shape-rendering","crispEdges")}),a.selectAll("g.points").each(function(t){var r=t[0].trace,a=r.marker,e=a.line,o=(r._input||{}).marker||{},l=Plotly.Drawing.tryColorscale(a,o,""),c=Plotly.Drawing.tryColorscale(a,o,"line.");d3.select(this).selectAll("path").each(function(t){var r,o,i=(t.mlw+1||e.width+1)-1,n=d3.select(this);r="mc"in t?t.mcc=l(t.mc):Array.isArray(a.color)?"#444":a.color,n.style("stroke-width",i+"px").call(Plotly.Color.fill,r),i&&(o="mlc"in t?t.mlcc=c(t.mlc):Array.isArray(e.color)?"#444":e.color,n.call(Plotly.Color.stroke,o))})})}}();!function(){"use strict";var t=window.Plotly.Boxes={},e=Plotly.Scatter.attributes.marker;t.attributes={x0:{type:"any"},whiskerwidth:{type:"number",min:0,max:1,dflt:.5},boxpoints:{type:"enumerated",values:["all","outliers","suspectedoutliers",!1],dflt:"outliers"},boxmean:{type:"enumerated",values:[!0,"sd",!1],dflt:!1},jitter:{type:"number",min:0,max:1},pointpos:{type:"number",min:-2,max:2},marker:{outliercolor:{type:"color",dflt:"rgba(0,0,0,0)"},symbol:$.extend({arrayOk:!1},e.symbol),opacity:$.extend({arrayOk:!1,dflt:1},e.opacity),size:$.extend({arrayOk:!1},e.size),color:$.extend({arrayOk:!1},e.color),line:{color:$.extend({arrayOk:!1},e.line.color),width:$.extend({arrayOk:!1},e.line.width),outliercolor:{type:"color"},outlierwidth:{type:"number",min:0,dflt:1}}},y:{from:"Scatter"},x:{from:"Scatter"},line:{color:{from:"Scatter"},width:{from:"Scatter"}},fillcolor:{from:"Scatter"}},t.layoutAttributes={boxmode:{type:"enumerated",values:["group","overlay"],dflt:"overlay"},boxgap:{type:"number",min:0,max:1,dflt:.3},boxgroupgap:{type:"number",min:0,max:1,dflt:.3}},t.supplyDefaults=function(e,o,l){function a(l,a){return Plotly.Lib.coerce(e,o,t.attributes,l,a)}function r(t,l){return Plotly.Lib.coerce(e,o,Plotly.Scatter.attributes,t,l)}var n=r("y");if(!n)return void(o.visible=!1);var i=r("x");i||a("x0"),r("line.color",(e.marker||{}).color||l),r("line.width",2),r("fillcolor",Plotly.Color.addOpacity(o.line.color,.5)),a("whiskerwidth"),a("boxmean");var c=a("boxpoints");c&&(a("jitter","all"===c?.3:0),a("pointpos","all"===c?-1.5:0),a("marker.symbol"),a("marker.opacity"),a("marker.size"),a("marker.color",o.line.color),a("marker.line.color"),a("marker.line.width"),"suspectedoutliers"===c&&(a("marker.outliercolor"),a("marker.line.outliercolor",o.marker.color),a("marker.line.outlierwidth")))},t.supplyLayoutDefaults=function(e,o,l){function a(l,a){return Plotly.Lib.coerce(e,o,t.layoutAttributes,l,a)}var r=l.some(function(t){return"box"===t.type});r&&(a("boxmode"),a("boxgap"),a("boxgroupgap"))},t.calc=function(t,e){function o(t,e){if(e-=.5,0>e)return t[0];if(e>t.length-1)return t[t.length-1];var o=e%1;return o*t[Math.ceil(e)]+(1-o)*t[Math.floor(e)]}var l,a=Plotly.Axes.getFromId(t,e.xaxis||"x"),r=Plotly.Axes.getFromId(t,e.yaxis||"y"),n=r.makeCalcdata(e,"y");if("x"in e)l=a.makeCalcdata(e,"x");else{var i;i="x0"in e?e.x0:"name"in e&&("category"===a.type||$.isNumeric(e.name)&&-1!==["linear","log"].indexOf(a.type)||Plotly.Lib.isDateTime(e.name)&&"date"===a.type)?e.name:t.numboxes,i=a.d2c(i),l=n.map(function(){return i})}var c=Plotly.Lib.distinctVals(l),s=c.vals,u=c.minDiff/2,p=s.map(function(t){return{x:t}}),x=s.map(function(){return[]}),m=s.map(function(t){return t-u}),d=s.length;return m.push(s[d-1]+u),Plotly.Axes.expand(r,n,{padded:!0}),n.forEach(function(t,e){if($.isNumeric(t)){var o=Plotly.Lib.findBin(l[e],m);o>=0&&d>o&&x[o].push(t)}}),x.forEach(function(t,e){t.sort(function(t,e){return t-e});var l=t.length,a=p[e];a.y=t,a.min=t[0],a.max=t[l-1],a.mean=Plotly.Lib.mean(t,l),a.sd=Plotly.Lib.stdev(t,l,a.mean),a.q1=o(t,l/4),a.med=o(t,l/2),a.q3=o(t,.75*l),a.lf=Math.min(a.q1,t[Math.min(Plotly.Lib.findBin(2.5*a.q1-1.5*a.q3,t,!0)+1,l-1)]),a.uf=Math.max(a.q3,t[Math.max(Plotly.Lib.findBin(2.5*a.q3-1.5*a.q1,t),0)]),a.lo=4*a.q1-3*a.q3,a.uo=4*a.q3-3*a.q1}),p=p.filter(function(t){return t.y&&t.y.length}),p.length?(p[0].t={boxnum:t.numboxes,dx:u},t.numboxes++,p):[{t:{emptybox:!0}}]},t.setPositions=function(t,e){var o=t._fullLayout,l=e.x(),a=e.y(),r=[],n=0,i=0;t.calcdata.forEach(function(t,e){var o=t[0].t,c=t[0].trace;c.visible===!1||o.emptybox||"box"!==c.type||c.xaxis!==l._id||c.yaxis!==a._id||(r.push(e),c.boxpoints!==!1&&(n=Math.max(n,c.jitter-c.pointpos-1),i=Math.max(i,c.jitter+c.pointpos-1)))});var c=[];if(r.forEach(function(e){t.calcdata[e].forEach(function(t){c.push(t.x)})}),c.length){var s=Plotly.Lib.distinctVals(c),u=s.minDiff/2;c.length===s.vals.length&&(t.numboxes=1),Plotly.Axes.minDtick(l,s.minDiff,s.vals[0],!0),r.forEach(function(e){t.calcdata[e][0].t.dx=u});var p=(1-o.boxgap)*(1-o.boxgroupgap)*u/t.numboxes;Plotly.Axes.expand(l,s.vals,{vpadminus:u+n*p,vpadplus:u+i*p})}},t.plot=function(t,e,o){var l=t._fullLayout,a=e.x(),r=e.y(),n=e.plot.select(".boxlayer").selectAll("g.trace.boxes").data(o).enter().append("g").attr("class","trace boxes");n.each(function(e){var o=e[0].t,n=e[0].trace,i="group"===l.boxmode&&t.numboxes>1,c=o.dx*(1-l.boxgap)*(1-l.boxgroupgap)/(i?t.numboxes:1),s=i?2*o.dx*(-.5+(o.boxnum+.5)/t.numboxes)*(1-l.boxgap):0,u=c*n.whiskerwidth;return n.visible===!1||o.emptybox?void d3.select(this).remove():(o.bx=s,o.bdx=c,d3.select(this).selectAll("path.box").data(Plotly.Lib.identity).enter().append("path").attr("class","box").each(function(t){var e=a.c2p(t.x+s,!0),o=a.c2p(t.x+s-c,!0),l=a.c2p(t.x+s+c,!0),i=a.c2p(t.x+s-u,!0),p=a.c2p(t.x+s+u,!0),x=r.c2p(t.q1,!0),m=r.c2p(t.q3,!0),d=Plotly.Lib.constrain(r.c2p(t.med,!0),Math.min(x,m)+1,Math.max(x,m)-1),y=r.c2p(n.boxpoints===!1?t.min:t.lf,!0),f=r.c2p(n.boxpoints===!1?t.max:t.uf,!0);d3.select(this).attr("d","M"+o+","+d+"H"+l+"M"+o+","+x+"H"+l+"V"+m+"H"+o+"ZM"+e+","+x+"V"+y+"M"+e+","+m+"V"+f+(0===n.whiskerwidth?"":"M"+i+","+y+"H"+p+"M"+i+","+f+"H"+p))}),n.boxpoints&&d3.select(this).selectAll("g.points").data(function(t){return t.forEach(function(t){t.t=o,t.trace=n}),t}).enter().append("g").attr("class","points").selectAll("path").data(function(t){var e="all"===n.boxpoints?t.y:t.y.filter(function(e){return e<t.lf||e>t.uf});return e.map(function(e){var o=(n.jitter?n.jitter*(Math.random()-.5)*2:0)+n.pointpos,l={x:t.x+o*c+s,y:e};return"suspectedoutliers"===n.boxpoints&&e<t.uo&&e>t.lo&&(l.so=!0),l})}).enter().append("path").call(Plotly.Drawing.translatePoints,a,r),void(n.boxmean&&d3.select(this).selectAll("path.mean").data(Plotly.Lib.identity).enter().append("path").attr("class","mean").style("fill","none").each(function(t){var e=a.c2p(t.x+s,!0),o=a.c2p(t.x+s-c,!0),l=a.c2p(t.x+s+c,!0),i=r.c2p(t.mean,!0),u=r.c2p(t.mean-t.sd,!0),p=r.c2p(t.mean+t.sd,!0);d3.select(this).attr("d","M"+o+","+i+"H"+l+("sd"!==n.boxmean?"":"m0,0L"+e+","+u+"L"+o+","+i+"L"+e+","+p+"Z"))})))})},t.style=function(t){var e=t.selectAll("g.trace.boxes");e.style("opacity",function(t){return t[0].trace.opacity}).each(function(t){var e=t[0].trace,o=e.line.width;d3.select(this).selectAll("path.box").style("stroke-width",o+"px").call(Plotly.Color.stroke,e.line.color).call(Plotly.Color.fill,e.fillcolor),d3.select(this).selectAll("path.mean").style({"stroke-width":o,"stroke-dasharray":2*o+"px,"+o+"px"}).call(Plotly.Color.stroke,e.line.color)}).selectAll("g.points").each(function(t){var e=t.trace;d3.select(this).selectAll("path").call(Plotly.Drawing.pointStyle,e)})}}();!function(){"use strict";function t(t){return[1-t[0],t[1]]}function o(t){return t||0===t?Number(t):null}function e(t,o,e,l,r,n){var a,i,s,u=[];if($.isArray(o)&&!Plotly.Plots.isHist2D(t)&&"category"!==n.type){o=o.map(n.d2c);var c=o.length;if(c!==r)return o.slice(0,r+1);if(Plotly.Plots.isContour(t))return o.slice(0,r);if(1===r)return[o[0]-.5,o[0]+.5];for(u=[1.5*o[0]-.5*o[1]],s=1;c>s;s++)u.push(.5*(o[s-1]+o[s]));u.push(1.5*o[c-1]-.5*o[c-2])}else if(i=l||1,a=void 0===e?0:Plotly.Plots.isHist2D(t)||"category"===n.type?e:n.d2c(e),Plotly.Plots.isContour(t))for(s=0;r>s;s++)u.push(a+i*s);else for(s=0;r>=s;s++)u.push(a+i*(s-.5));return u}function l(t,o,e){function l(t,o){var e=o.length-2,l=Plotly.Lib.constrain(Plotly.Lib.findBin(t,o),0,e),r=o[l],n=o[l+1],a=Plotly.Lib.constrain(l+(t-r)/(n-r)-.5,0,e),i=Math.round(a),s=Math.abs(a-i);return a&&a!==e&&s?{bin0:i,frac:s,bin1:Math.round(i+s/(a-i))}:{bin0:i,bin1:i,frac:0}}function r(t,o){if($.isNumeric(t)){var e=Plotly.Lib.constrain(Math.round(254*(t-x)/(P-x)),0,254),l=F(e);return U+=o,O[e]||(O[e]=[tinycolor(l).toHsl().l,T.color("0x"+l.substr(1,2),"0x"+l.substr(3,2),"0x"+l.substr(5,2))]),V+=o*O[e][0],O[e][1]}return O[256]}Plotly.Lib.markTime("in Heatmap.plot");var n=e[0].trace,a=n.uid,i=o.x(),s=o.y(),u=t._fullLayout,c="hm"+a,m="cb"+a;if(u._paper.selectAll(".contour"+a).remove(),!n.visible)return u._paper.selectAll("."+c).remove(),void u._paper.selectAll("."+m).remove();var f,y,p,h,d,b,g=e[0].z,x=n.zmin,P=n.zmax,v=Plotly.Color.getScale(n.colorscale),z=e[0].x,L=e[0].y,M=-1!==[!0,"fast"].indexOf(n.zsmooth),_=g.length,N=Plotly.Lib.aggNums(Math.max,null,g.map(function(t){return t.length})),k=!1,w=!1;for(b=0;void 0===f&&b<z.length-1;)f=i.c2p(z[b]),b++;for(b=z.length-1;void 0===y&&b>0;)y=i.c2p(z[b]),b--;for(f>y&&(p=y,y=f,f=p,k=!0),b=0;void 0===h&&b<L.length-1;)h=s.c2p(L[b]),b++;for(b=L.length-1;void 0===d&&b>0;)d=s.c2p(L[b]),b--;if(h>d&&(p=h,h=d,d=p,w=!0),Plotly.Plots.isContour(n.type)&&(z=e[0].xfill,L=e[0].yfill),!M){var C="best"===n.zsmooth?0:.5;f=Math.max(-C*i._length,f),y=Math.min((1+C)*i._length,y),h=Math.max(-C*s._length,h),d=Math.min((1+C)*s._length,d)}var A=Math.round(y-f),D=Math.round(d-h);if(!(0>=A||0>=D)){var H,S,T=M?new PNGlib(N,_,256):new PNGlib(A,D,256),F=d3.scale.linear().domain(v.map(function(t){return 255*t[0]})).interpolate(d3.interpolateRgb).range(v.map(function(t){return t[1]}));M?(H=k?function(t){return N-1-t}:Plotly.Lib.identity,S=w?function(t){return _-1-t}:Plotly.Lib.identity):(H=function(t){return Plotly.Lib.constrain(Math.round(i.c2p(z[t])-f),0,A)},S=function(t){return Plotly.Lib.constrain(Math.round(s.c2p(L[t])-h),0,D)});var O={};O[256]=T.color(0,0,0,0),Plotly.Lib.markTime("done init png");var B,G,I,R,E,j,q=S(0),J=[q,q],K=k?0:1,Q=w?0:1,U=0,V=0;if("best"===n.zsmooth){var W,X,Y,Z,to,oo,eo,lo,ro=z.map(function(t){return Math.round(i.c2p(t)-f)}),no=L.map(function(t){return Math.round(s.c2p(t)-h)}),ao=[],io=[];for(b=0;A>b;b++)ao.push(l(b,ro));for(G=0;D>G;G++)io.push(l(G,no));for(G=0;D>G;G++)for(X=io[G],Y=g[X.bin0],Z=g[X.bin1],Y&&Z||console.log(G,X,g),b=0;A>b;b++)W=ao[b],to=Y[W.bin0],$.isNumeric(to)?(eo=Y[W.bin1],oo=Z[W.bin0],lo=Z[W.bin1],$.isNumeric(eo)||(eo=to),$.isNumeric(oo)||(oo=to),$.isNumeric(lo)||(lo=to),R=r(to+W.frac*(eo-to)+X.frac*(oo-to+W.frac*(to+lo-eo-oo)))):R=r(null,1),T.buffer[T.index(b,G)]=R}else if(M)for(G=0;_>G;G++)for(j=g[G],J=S(G),b=0;N>b;b++)T.buffer[T.index(H(b),J)]=r(j[b],1);else for(G=0;_>G;G++)if(j=g[G],J.reverse(),J[Q]=S(G+1),J[0]!==J[1]&&void 0!==J[0]&&void 0!==J[1])for(I=H(0),B=[I,I],b=0;N>b;b++)if(B.reverse(),B[K]=H(b+1),B[0]!==B[1]&&void 0!==B[0]&&void 0!==B[1])for(E=j[b],R=r(E,(B[1]-B[0])*(J[1]-J[0])),I=B[0];I<B[1];I++)for(q=J[0];q<J[1];q++)T.buffer[T.index(I,q)]=R;Plotly.Lib.markTime("done filling png"),t._hmpixcount=(t._hmpixcount||0)+U,t._hmlumcount=(t._hmlumcount||0)+V;var so="data:image/png;base64,\n"+T.getBase64();u._paper.selectAll("."+c).remove(),o.plot.select(".maplayer").append("svg:image").classed(c,!0).datum(e[0]).attr({xmlns:"http://www.w3.org/2000/svg","xlink:xlink:href":so,height:D,width:A,x:f,y:h,preserveAspectRatio:"none"}),Plotly.Lib.markTime("done showing png")}}var r=window.Plotly.Heatmap={};r.attributes={z:{type:"data_array"},transpose:{type:"boolean",dflt:!1},xtype:{type:"enumerated",values:["array","scaled"]},ytype:{type:"enumerated",values:["array","scaled"]},zauto:{type:"boolean",dflt:!0},zmin:{type:"number",dflt:null},zmax:{type:"number",dflt:null},colorscale:{type:"colorscale"},reversescale:{type:"boolean",dflt:!1},showscale:{type:"boolean",dflt:!0},zsmooth:{type:"enumerated",values:["fast","best",!1],dflt:!1},x:{from:"Scatter"},x0:{from:"Scatter"},dx:{from:"Scatter"},y:{from:"Scatter"},y0:{from:"Scatter"},dy:{from:"Scatter"},colorbar:{allFrom:"Colorbar"}},r.supplyDefaults=function(o,e,l,n){function a(t,l){return Plotly.Lib.coerce(o,e,r.attributes,t,l)}function i(t,l){return Plotly.Lib.coerce(o,e,Plotly.Scatter.attributes,t,l)}if(Plotly.Plots.isHist2D(e.type)){if(Plotly.Histogram.supplyDefaults(o,e),!e.visible)return}else{var s=a("z");if(!s)return void(e.visible=!1);a("transpose");var u=i("x"),c=u?a("xtype","array"):"scaled";"scaled"===c&&(i("x0"),i("dx"));var m=i("y"),f=m?a("ytype","array"):"scaled";"scaled"===f&&(i("y0"),i("dy"))}if(a("zauto"),a("zmin"),a("zmax"),!Plotly.Plots.isContour(e.type)||"none"!==(e.contours||{}).coloring){a("colorscale");var y=a("reversescale"),p=a("showscale");y&&(e.colorscale=e.colorscale.map(t).reverse()),p&&Plotly.Colorbar.supplyDefaults(o,e,l,n)}Plotly.Plots.isContour(e.type)&&"heatmap"!==(e.contours||{}).coloring||a("zsmooth")},r.calc=function(t,l){Plotly.Lib.markTime("start convert x&y");var r,n,a,i,s,u,c,m,f=Plotly.Axes.getFromId(t,l.xaxis||"x"),y=Plotly.Axes.getFromId(t,l.yaxis||"y");if(f._minDtick=0,y._minDtick=0,Plotly.Lib.markTime("done convert x&y"),Plotly.Plots.isHist2D(l.type)){var p=Plotly.Histogram.calc2d(t,l);r=p.x,n=p.x0,a=p.dx,i=p.y,s=p.y0,u=p.dy,c=p.z}else if(r=l.x?f.makeCalcdata(l,"x"):[],n=l.x0||0,a=l.dx||1,i=l.y?y.makeCalcdata(l,"y"):[],s=l.y0||0,u=l.dy||1,l.transpose){var h=Plotly.Lib.aggNums(Math.max,0,l.z.map(function(t){return t.length}));c=[];for(var d=0;h>d;d++){for(var b=[],g=0;g<l.z.length;g++)b.push(o(l.z[g][d]));c.push(b)}}else c=l.z.map(function(t){return t.map(o)});if(-1!==[!0,"fast"].indexOf(l.zsmooth))if("log"===f.type||"log"===y.type)l._input.zsmooth=l.zsmooth=!1,Plotly.Lib.notifier("cannot fast-zsmooth: log axis found");else if(!Plotly.Plots.isHist2D(l.type)){if(r.length){var x=(r[r.length-1]-r[0])/(r.length-1),P=Math.abs(x/100);for(m=0;m<r.length-1;m++)if(Math.abs(r[m+1]-r[m]-x)>P){l._input.zsmooth=l.zsmooth=!1,Plotly.Lib.notifier("cannot fast-zsmooth: x scale is not linear");break}}if(i.length&&-1!==[!0,"fast"].indexOf(l.zsmooth)){var v=(i[i.length-1]-i[0])/(i.length-1),z=Math.abs(v/100);for(m=0;m<i.length-1;m++)if(Math.abs(i[m+1]-i[m]-v)>z){l._input.zsmooth=l.zsmooth=!1,Plotly.Lib.notifier("cannot fast-zsmooth: y scale is not linear");break}}}var L=Plotly.Lib.aggNums(Math.max,null,c.map(function(t){return t.length})),M="scaled"===l.xtype?"":l.x,_=e(l.type,M,n,a,L,f),N="scaled"===l.ytype?"":l.y,k=e(l.type,N,s,u,c.length,y);Plotly.Axes.expand(f,_),Plotly.Axes.expand(y,k);var w={x:_,y:k,z:c};if(l.zauto===!1&&"zmin"in l||(l.zmin=Plotly.Lib.aggNums(Math.min,null,c)),l.zauto===!1&&"zmax"in l||(l.zmax=Plotly.Lib.aggNums(Math.max,null,c)),l.zmin===l.zmax&&(l.zmin-=.5,l.zmax+=.5),l._input.zmin=l.zmin,l._input.zmax=l.zmax,Plotly.Plots.isContour(l.type)&&l.contours&&"heatmap"===l.contours.coloring){var C="contour"===l.type?"heatmap":"histogram2d";w.xfill=e(C,M,n,a,L,f),w.yfill=e(C,N,s,u,c.length,y)}return[w]},r.plot=function(t,o,e){e.forEach(function(e){l(t,o,e)})},r.colorbar=function(t,o){var e=o[0].trace,l="cb"+e.uid,r=Plotly.Color.getScale(e.colorscale),n=e.zmin,a=e.zmax;if($.isNumeric(n)||(n=Plotly.Lib.aggNums(Math.min,null,e.z)),$.isNumeric(a)||(a=Plotly.Lib.aggNums(Math.max,null,e.z)),t._fullLayout._infolayer.selectAll("."+l).remove(),!e.showscale)return void Plotly.Plots.autoMargin(t,l);var i=o[0].t.cb=Plotly.Colorbar(t,l);i.fillcolor(d3.scale.linear().domain(r.map(function(t){return n+t[0]*(a-n)})).range(r.map(function(t){return t[1]}))).filllevels({start:n,end:a,size:(a-n)/254}).options(e.colorbar)(),Plotly.Lib.markTime("done colorbar")},r.style=function(t){t.selectAll("image").style("opacity",function(t){return t.trace.opacity})}}();!function(){"use strict";function t(t,e,c){function u(t,e){var n=(e[0][0]>t?0:1)+(e[0][1]>t?0:2)+(e[1][1]>t?0:4)+(e[1][0]>t?0:8);if(5===n||10===n){var o=(e[0][0]+e[0][1]+e[1][0]+e[1][1])/4;return t>o?5===n?713:1114:5===n?104:208}return 15===n?0:n}function p(t){var e=u(t.level,Z);if(e){t.crossings[T]=e;var n=F.indexOf(e);if(-1!==n){var o=T.split(",").map(Number);t.starts.push(o),J&&-1!==F.indexOf(e,n+1)&&t.starts.push(o)}}}function h(t,e){var n=I[e][t];return $.isNumeric(n)?n:P.zmin}function f(t,e,n){var o=(t-h(e,n))/(h(e+1,n)-h(e,n));return[k.c2p((1-o)*R[e]+o*R[e+1]),L.c2p(q[n])]}function d(t,e,n){var o=(t-h(e,n))/(h(e,n+1)-h(e,n));return[k.c2p(R[e]),L.c2p((1-o)*q[n]+o*q[n+1])]}function g(t,e){return Math.abs(t[0]-e[0])<.01&&Math.abs(t[1]-e[1])<.01}function m(t,e){var n=t[0]-e[0],o=t[1]-e[1];return Math.sqrt(n*n+o*o)}function v(t,e,r){function c(t){return M[t%M.length]}var u,p=_[t],h=e.split(",").map(Number),v=p.crossings[e],y=p.level,z=[],b=0,x=0;v>20&&r?208===v||1114===v?(u=d,b=0===h[0]?1:-1):(u=f,x=0===h[1]?1:-1):-1!==n.indexOf(v)?(u=f,x=1):-1!==l.indexOf(v)?(u=d,b=1):-1!==o.indexOf(v)?(u=f,x=-1):(u=d,b=-1);for(var P,M=[u(y,h[0]+Math.max(-b,0),h[1]+Math.max(-x,0))],A=b+","+x,k=h.join(","),L=0;1e4>L;L++){if(z.push(k),v>20?(P=s[v][0>(b||x)?0:1],p.crossings[k]=i[P]):(P=v,delete p.crossings[k]),!a[P]){console.log("found bad marching index",v,P,h,t);break}if(b=a[P][0],x=a[P][1],b?(M.push(d(y,h[0]+Math.max(b,0),h[1])),h[0]+=b):(M.push(f(y,h[0],h[1]+Math.max(x,0))),h[1]+=x),g(M[M.length-1],M[M.length-2])&&M.pop(),k=h.join(","),k===e&&b+","+x===A||r&&(b&&(h[0]<0||h[0]>B-2)||x&&(h[1]<0||h[1]>G-2)))break;v=p.crossings[k]}1e4===L&&console.log("Infinite loop in contour?");var O,S,E,j,D,C,H,N=g(M[0],M[M.length-1]),F=0,T=.2*w,Z=[],I=0;for(L=1;L<M.length;L++)H=m(M[L],M[L-1]),F+=H,Z.push(H);var R=F/Z.length*T;for(L=M.length-2;L>=I;L--)if(O=Z[L],R>O){for(E=0,S=L-1;S>=I&&O+Z[S]<R;S--)O+=Z[S];if(N&&L===M.length-2)for(E=0;S>E&&O+Z[E]<R;E++)O+=Z[E];D=L-S+E+1,C=Math.floor((L+S+E+2)/2),j=N||L!==M.length-2?N||-1!==S?D%2?c(C):[(c(C)[0]+c(C+1)[0])/2,(c(C)[1]+c(C+1)[1])/2]:M[0]:M[M.length-1],M.splice(S+1,L-S+1,j),L=S+1,E&&(I=E),N&&(L===M.length-2?M[E]=M[M.length-1]:0===L&&(M[M.length-1]=M[0]))}if(M.splice(0,I),!(M.length<2))if(N)M.pop(),p.paths.push(M);else{r||console.log("unclosed interior contour?",t,e,z,M.join("L"));var q=!1;p.edgepaths.forEach(function(t,e){if(!q&&g(t[0],M[M.length-1])){M.pop(),q=!0;var n=!1;p.edgepaths.forEach(function(t,o){!n&&g(t[t.length-1],M[0])&&(n=!0,M.splice(0,1),p.edgepaths.splice(e,1),o===e?p.paths.push(M.concat(t)):p.edgepaths[o]=p.edgepaths[o].concat(M,t))}),n||(p.edgepaths[e]=M.concat(t))}}),p.edgepaths.forEach(function(t,e){!q&&g(t[t.length-1],M[0])&&(M.splice(0,1),p.edgepaths[e]=t.concat(M),q=!0)}),q||p.edgepaths.push(M)}}function y(t){return Math.abs(t[1]-W)<.01}function z(t){return Math.abs(t[1]-V)<.01}function b(t){return Math.abs(t[0]-Q)<.01}function x(t){return Math.abs(t[0]-U)<.01}Plotly.Lib.markTime("in Contour.plot");var P=c[0].trace,M=P.contours,w=(P.line||{}).smoothing,A=P.uid,k=e.x(),L=e.y(),O=t._fullLayout,S="contour"+A,E=[],_=[],j=M.size||1;if(P.visible===!1)return void O._paper.selectAll("."+S+",.cb"+A+",.hm"+A).remove();for(var D=M.start;D<M.end+j/10;D+=j)E.push(D),_.push({level:D,crossings:{},starts:[],edgepaths:[],paths:[]});"heatmap"===M.coloring?(P.zsmooth="best",P.zauto&&P.autocontour===!1&&(P._input.zmin=P.zmin=M.start-M.size/2,P._input.zmax=P.zmax=P.zmin+E.length*M.size),Plotly.Heatmap.plot(t,e,[c])):O._paper.selectAll(".hm"+A).remove();var C,H,N,F,T,Z,I=c[0].z,R=c[0].x,q=c[0].y,G=I.length,B=Plotly.Lib.aggNums(Math.max,null,I.map(function(t){return t.length})),J=2===G||2===B;for(H=0;G-1>H;H++)for(N=[],0===H&&(N=N.concat(n)),H===G-2&&(N=N.concat(o)),C=0;B-1>C;C++)F=[].concat(N),0===C&&(F=F.concat(l)),C===B-2&&(F=F.concat(r)),T=C+","+H,Z=[[h(C,H),h(C+1,H)],[h(C,H+1),h(C+1,H+1)]],_.forEach(p);_.forEach(function(t,e){var n=0;for(t.starts.forEach(function(t){v(e,String(t),"edge")});Object.keys(t.crossings).length&&1e4>n;)n++,v(e,Object.keys(t.crossings)[0]);1e4===n&&console.log("Infinite loop in contour?")});var K=e.plot.select(".maplayer").selectAll("g.contour."+S).data(c);K.enter().append("g").classed("contour",!0).classed(S,!0),K.exit().remove();var Q=k.c2p(R[0]),U=k.c2p(R[R.length-1]),V=L.c2p(q[0]),W=L.c2p(q[q.length-1]),X=[[Q,W],[U,W],[U,V],[Q,V]],Y=K.selectAll("g.contourbg").data([0]);Y.enter().append("g").classed("contourbg",!0);var te=Y.selectAll("path").data("fill"===M.coloring?[0]:[]);te.enter().append("path"),te.exit().remove(),te.attr("d","M"+X.join("L")+"Z").style("stroke","none");var ee=K.selectAll("g.contourfill").data([0]);ee.enter().append("g").classed("contourfill",!0);var ne=ee.selectAll("path").data("fill"===M.coloring?_:[]);ne.enter().append("path"),ne.exit().remove(),ne.each(function(t){for(var e,n,o,l,r,a,s=t.edgepaths.length||h(0,0)<t.level?"":"M"+X.join("L")+"Z",i=0,c=t.edgepaths.map(function(t,e){return e}),u=!0;c.length;){for(a=Plotly.Drawing.smoothopen(t.edgepaths[i],w),s+=u?a:a.replace(/^M/,"L"),c.splice(c.indexOf(i),1),e=t.edgepaths[i][t.edgepaths[i].length-1],l=-1,o=0;4>o;o++){if(!e){console.log("missing end?",i,t);break}for(y(e)&&!x(e)?n=[U,W]:b(e)?n=[Q,W]:z(e)?n=[Q,V]:x(e)&&(n=[U,V]),r=0;r<t.edgepaths.length;r++){var p=t.edgepaths[r][0];Math.abs(e[0]-n[0])<.01?Math.abs(e[0]-p[0])<.01&&(p[1]-e[1])*(n[1]-p[1])>=0&&(n=p,l=r):Math.abs(e[1]-n[1])<.01?Math.abs(e[1]-p[1])<.01&&(p[0]-e[0])*(n[0]-p[0])>=0&&(n=p,l=r):console.log("endpt to newendpt is not vert. or horz.",e,n,p)}if(e=n,l>=0)break;s+="L"+n}if(l===t.edgepaths.length){console.log("unclosed perimeter path");break}i=l,u=-1===c.indexOf(i),u&&(i=c[0],s+="Z")}t.paths.forEach(function(t){s+=Plotly.Drawing.smoothclosed(t,w)}),s?d3.select(this).attr("d",s).style("stroke","none"):d3.select(this).remove()});var oe=K.selectAll("g.contourlevel").data(M.showlines===!1?[]:_);oe.enter().append("g").classed("contourlevel",!0),oe.exit().remove();var le=oe.selectAll("path.openline").data(function(t){return t.edgepaths});le.enter().append("path").classed("openline",!0),le.exit().remove(),le.attr("d",function(t){return Plotly.Drawing.smoothopen(t,w)}).style("stroke-miterlimit",1);var re=oe.selectAll("path.closedline").data(function(t){return t.paths});re.enter().append("path").classed("closedline",!0),re.exit().remove(),re.attr("d",function(t){return Plotly.Drawing.smoothclosed(t,w)}).style("stroke-miterlimit",1),Plotly.Lib.markTime("done Contour.plot")}var e=window.Plotly.Contour={};e.attributes={allFrom:"Heatmap",autocontour:{type:"boolean",dflt:!0},ncontours:{type:"integer",dflt:0},contours:{start:{type:"number",dflt:null},end:{type:"number",dflt:null},size:{type:"number",dflt:null},coloring:{type:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill"},showlines:{type:"boolean",dflt:!0}},line:{color:{from:"Scatter"},width:{from:"Scatter"},dash:{from:"Scatter"},smoothing:{from:"Scatter"}}},e.supplyDefaults=function(t,n,o,l){function r(o,l){return Plotly.Lib.coerce(t,n,e.attributes,o,l)}function a(e,o){return Plotly.Lib.coerce(t,n,Plotly.Scatter.attributes,e,o)}var s=r("autocontour");s&&r("ncontours"),r("contours.start"),r("contours.end"),r("contours.size");var i=r("contours.coloring");"fill"===i&&r("contours.showlines"),n.contours.showlines!==!1&&("lines"!==i&&a("line.color","#000"),a("line.width",.5),a("line.dash"),a("line.smoothing")),Plotly.Heatmap.supplyDefaults(t,n,o,l)},e.calc=function(t,e){var n=Plotly.Heatmap.calc(t,e),o=e.contours;if(e.autocontour!==!1||!o.size||void 0===o.start||void 0===o.end){var l={type:"linear",range:[e.zmin,e.zmax]};Plotly.Axes.autoTicks(l,(e.zmax-e.zmin)/(e.ncontours||15)),o.start=Plotly.Axes.tickFirst(l),o.size=l.dtick,l.range.reverse(),o.end=Plotly.Axes.tickFirst(l),o.start===e.zmin&&(o.start+=o.size),o.end===e.zmax&&(o.end-=o.size),o.end+=o.size/100,e._input.contours=o}return n},e.plot=function(e,n,o){o.forEach(function(o){t(e,n,o)})};var n=[1,9,13,104,713],o=[4,6,7,104,713],l=[8,12,14,208,1114],r=[2,3,11,208,1114],a=[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],s={104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},i={1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11};e.style=function(t){t.selectAll("g.contour").style("opacity",function(t){return t.trace.opacity}).each(function(t){var e=d3.select(this),n=t.trace,o=n.contours,l=n.line,r="lines"===o.coloring,a=o.size||1,s=Math.floor((o.end+a/10-o.start)/a)+1,i=Plotly.Color.getScale(n.colorscale),c=r?0:1,u=d3.scale.linear().domain(i.map(function(t){return(t[0]*(s+c-1)-c/2)*a+o.start})).interpolate(d3.interpolateRgb).range(i.map(function(t){return t[1]}));e.selectAll("g.contourlevel").each(function(t,e){d3.select(this).selectAll("path").call(Plotly.Drawing.lineGroupStyle,l.width,r?u(o.start+e*a):l.color,l.dash)}),e.selectAll("g.contourbg path").style("fill",u(o.start-a/2)),e.selectAll("g.contourfill path").style("fill",function(t,e){return u(o.start+(e+.5)*a)})}),Plotly.Heatmap.style(t)},e.colorbar=function(t,e){var n=e[0].trace,o="cb"+n.uid;if(t._fullLayout._infolayer.selectAll("."+o).remove(),n.showscale===!1)return void Plotly.Plots.autoMargin(t,o);var l=Plotly.Colorbar(t,o);e[0].t.cb=l;var r=n.contours,a=n.line,s=r.size||1,i=Math.floor((r.end+s/10-r.start)/s)+1,c=Plotly.Color.getScale(n.colorscale),u="lines"===r.coloring?0:1,p=d3.scale.linear().interpolate(d3.interpolateRgb),h=c.map(function(t){return(t[0]*(i+u-1)-u/2)*s+r.start}),f=c.map(function(t){return t[1]});if("heatmap"===r.coloring){n.zauto&&n.autocontour===!1&&(n.zmin=r.start-s/2,n.zmax=n.zmin+i*s),l.filllevels({start:n.zmin,end:n.zmax,size:(n.zmax-n.zmin)/254}),h=c.map(function(t){return t[0]*(n.zmax-n.zmin)+n.zmin});var d=d3.extent([n.zmin,n.zmax,r.start,r.start+s*(i-1)]),g=d[n.zmin<n.zmax?0:1],m=d[n.zmin<n.zmax?1:0];g!==n.zmin&&(h.splice(0,0,g),f.splice(0,0,f[0])),m!==n.zmax&&(h.push(m),f.push(f[f.length-1]))}p.domain(h).range(f),l.fillcolor("fill"===r.coloring||"heatmap"===r.coloring?p:"").line({color:"lines"===r.coloring?p:a.color,width:r.showlines!==!1?a.width:0,dash:a.dash}).levels({start:r.start,end:r.end,size:s}).options(n.colorbar)()}}();!function(){"use strict";var t=window.Plotly.Colorbar=function(e,l){function i(){function t(){if(-1!==["top","bottom"].indexOf(o.titleside)){var t=N.select(".cbtitle"),l=t.select("text"),i=[-o.outlinewidth/2,o.outlinewidth/2],n=t.select(".h"+F._id+"title-math-group").node(),s=15.6;if(l.node()&&(s=1.3*parseInt(l.style("font-size"),10)),n?(G=Plotly.Drawing.bBox(n).height,G>s&&(i[1]-=(G-s)/2)):l.node()&&!l.classed("js-placeholder")&&(G=Plotly.Drawing.bBox(t.node()).height),G){if(G+=5,"top"===o.titleside)F.domain[1]-=G/r._size.h,i[1]*=-1;else{F.domain[0]+=G/r._size.h;var f=Math.max(1,l.selectAll("tspan.line").size());i[1]+=(1-f)*s}t.attr("transform","translate("+i+")"),F.setScale()}}N.selectAll(".cbfills,.cblines,.cbaxis").attr("transform","translate(0,"+Math.round(r._size.h*(1-F.domain[1]))+")");var p=N.select(".cbfills").selectAll("rect.cbfill").data(d);p.enter().append("rect").classed("cbfill",!0).style("stroke","none"),p.exit().remove(),p.each(function(t,e){var l=[0===e?a[0]:(d[e]+d[e-1])/2,e===d.length-1?a[1]:(d[e]+d[e+1])/2].map(F.c2p).map(Math.round);e!==d.length-1&&(l[1]+=l[1]>l[0]?1:-1),d3.select(this).attr({x:A,width:Math.max(v,2),y:d3.min(l),height:Math.max(d3.max(l)-d3.min(l),2)}).style("fill",h(t))});var y=N.select(".cblines").selectAll("path.cbline").data(o.line.color&&o.line.width?c:[]);return y.enter().append("path").classed("cbline",!0),y.exit().remove(),y.each(function(t){d3.select(this).attr("d","M"+A+","+(Math.round(F.c2p(t))+o.line.width/2%1)+"h"+v).call(Plotly.Drawing.lineGroupStyle,o.line.width,u(t),o.line.dash)}),F._axislayer.selectAll("g."+F._id+"tick,path").remove(),F._pos=A+v+(o.outlinewidth||0)/2-("outside"===o.ticks?1:0),F.side=o.orient,Plotly.Axes.doTicks(e,F)}function n(){var t=v+o.outlinewidth/2+Plotly.Drawing.bBox(F._axislayer.node()).width;if(b=S.select("text"),b.node()&&!b.classed("js-placeholder")){var i,n=S.select(".h"+F._id+"title-math-group").node();i=n&&-1!==["top","bottom"].indexOf(o.titleside)?Plotly.Drawing.bBox(n).width:Plotly.Drawing.bBox(S.node()).right-A-r._size.l,t=Math.max(t,i)}var s=2*o.xpad+t+o.borderwidth+o.outlinewidth/2,a=L-O;N.select(".cbbg").attr({x:A-o.xpad-(o.borderwidth+o.outlinewidth)/2,y:O-z,width:Math.max(s,2),height:Math.max(a+2*z,2)}).call(Plotly.Color.fill,o.bgcolor).call(Plotly.Color.stroke,o.bordercolor).style({"stroke-width":o.borderwidth}),N.selectAll(".cboutline").attr({x:A,y:O+o.ypad+("top"===o.titleside?G:0),width:Math.max(v,2),height:Math.max(a-2*o.ypad-G,2)}).call(Plotly.Color.stroke,o.outlinecolor).style({fill:"None","stroke-width":o.outlinewidth});var c=({center:.5,right:1}[o.xanchor]||0)*s;N.attr("transform","translate("+(r._size.l-c)+","+r._size.t+")"),Plotly.Plots.autoMargin(e,l,{x:o.x,y:o.y,l:s*({right:1,center:.5}[o.xanchor]||0),r:s*({left:1,center:.5}[o.xanchor]||0),t:a*({bottom:1,middle:.5}[o.yanchor]||0),b:a*({top:1,middle:.5}[o.yanchor]||0)})}var r=e._fullLayout;if("function"!=typeof o.fillcolor&&"function"!=typeof o.line.color)return void r._infolayer.selectAll("g."+l).remove();var s,a=d3.extent(("function"==typeof o.fillcolor?o.fillcolor:o.line.color).domain()),c=[],d=[],u="function"==typeof o.line.color?o.line.color:function(){return o.line.color},h="function"==typeof o.fillcolor?o.fillcolor:function(){return o.fillcolor},f=o.levels.end+o.levels.size/100,p=o.levels.size,y=1.001*a[0]-.001*a[1],m=1.001*a[1]-.001*a[0];for(s=o.levels.start;0>(s-f)*p;s+=p)s>y&&m>s&&c.push(s);if("function"==typeof o.fillcolor)if(o.filllevels)for(f=o.filllevels.end+o.filllevels.size/100,p=o.filllevels.size,s=o.filllevels.start;0>(s-f)*p;s+=p)s>a[0]&&s<a[1]&&d.push(s);else d=c.map(function(t){return t-o.levels.size/2}),d.push(d[d.length-1]+o.levels.size);else o.fillcolor&&"string"==typeof o.fillcolor&&(d=[0]);o.levels.size<0&&(c.reverse(),d.reverse());var b,x=r.height-r.margin.t-r.margin.b,k=r.width-r.margin.l-r.margin.r,v=Math.round(o.thickness*("fraction"===o.thicknessmode?k:1)),g=v/r._size.w,w=Math.round(o.len*("fraction"===o.lenmode?x:1)),P=w/r._size.h,_=o.xpad/r._size.w,z=(o.borderwidth+o.outlinewidth)/2,M=o.ypad/r._size.h,A=Math.round(o.x*r._size.w+o.xpad),D=o.x-g*({middle:.5,right:1}[o.xanchor]||0),C=o.y+P*(({top:-.5,bottom:.5}[o.yanchor]||0)-.5),L=Math.round(r._size.h*(1-C)),O=L-w,F=Plotly.Axes.supplyAxisDefaults({type:"linear",range:a,autotick:o.autotick,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,ticks:o.ticks,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,tickfont:o.tickfont,tickangle:o.tickangle,exponentformat:o.exponentformat,showexponent:o.showexponent,title:o.title,titlefont:o.titlefont},null,{letter:"y"});if(Plotly.Axes.supplyAxisPositioningDefaults({anchor:"free",position:1},F,{letter:"y"}),F._id="y"+l,F._td=e,F.position=o.x+_+g,i.axis=F,-1!==["top","bottom"].indexOf(o.titleside)&&(F.titleside=o.titleside,F.titlex=o.x+_,F.titley=C+("top"===o.titleside?P-M:M)),o.line.color&&o.autotick!==!1){F.autotick=!1,F.tick0=o.levels.start;var j=o.levels.size,E=Plotly.Lib.constrain((L-O)/50,4,15)+1,B=(a[1]-a[0])/((o.nticks||E)*j);if(B>1){var $=Math.pow(10,Math.floor(Math.log(B)/Math.LN10));j*=$*Plotly.Lib.roundUp(B/$,[2,5,10]),(Math.abs(o.levels.start)/o.levels.size+1e-6)%1<2e-6&&(F.tick0=0)}F.dtick=j}F.domain=[C+M,C+P-M],F.setScale();var N=r._infolayer.selectAll("g."+l).data([0]);N.enter().append("g").classed(l,!0).each(function(){var t=d3.select(this);t.append("rect").classed("cbbg",!0),t.append("g").classed("cbfills",!0),t.append("g").classed("cblines",!0),t.append("g").classed("cbaxis",!0).classed("crisp",!0),t.append("g").classed("cbtitleunshift",!0).append("g").classed("cbtitle",!0),t.append("rect").classed("cboutline",!0)}),N.attr("transform","translate("+Math.round(r._size.l)+","+Math.round(r._size.t)+")");var S=N.select(".cbtitleunshift").attr("transform","translate(-"+Math.round(r._size.l)+",-"+Math.round(r._size.t)+")");F._axislayer=N.select(".cbaxis");var G=0;-1!==["top","bottom"].indexOf(o.titleside)&&Plotly.Plots.titles(e,F._id+"title");var I=Plotly.Lib.syncOrAsync([Plotly.Plots.previousPromises,t,Plotly.Plots.previousPromises,n],e);return I&&I.then&&(e._promises||[]).push(I),e._context.editable&&(N.node().onmousedown=function(t){if(Plotly.Fx.dragClear(e))return!0;var i=d3.select(this),n=i.attr("transform"),s=r._size,a=null,c=null,d=!1;return Plotly.Fx.setCursor(i),window.onmousemove=function(e){var l=e.clientX-t.clientX,r=e.clientY-t.clientY,u=Plotly.Fx.MINDRAG;Math.abs(l)<u&&(l=0),Math.abs(r)<u&&(r=0),(l||r)&&(d=!0),i.attr("transform",n+" translate("+l+","+r+")"),a=Plotly.Fx.dragAlign(D+l/s.w,g,0,1,o.xanchor),c=Plotly.Fx.dragAlign(C-r/s.h,P,0,1,o.yanchor);var h=Plotly.Fx.dragCursors(a,c,o.xanchor,o.yanchor);return Plotly.Fx.setCursor(i,h),Plotly.Lib.pauseEvent(e)},window.onmouseup=function(t){if(window.onmousemove=null,window.onmouseup=null,Plotly.Fx.setCursor(i),d&&null!==a&&null!==c){var o,n=l.substr(2);e._fullData.some(function(t){return t.uid===n?(o=t.index,!0):void 0}),Plotly.restyle(e,{"colorbar.x":a,"colorbar.y":c},o)}return Plotly.Lib.pauseEvent(t)},Plotly.Lib.pauseEvent(t)}),I}var o={};return Object.keys(t.attributes).forEach(function(t){o[t]=null}),o.fillcolor=null,o.line={color:null,width:null,dash:null},o.levels={start:null,end:null,size:null},o.filllevels=null,Object.keys(o).forEach(function(t){i[t]=function(e){return arguments.length?($.isPlainObject(o[t])?$.extend(o[t],e):o[t]=e,i):o[t]}}),i.options=function(t){return Object.keys(t).forEach(function(e){"function"==typeof i[e]&&i[e](t[e])}),i},i._opts=o,i},e=Plotly.Axes.attributes;t.attributes={orient:{type:"enumerated",values:["left","right","top","bottom"],dflt:"right"},thicknessmode:{type:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{type:"number",min:0,dflt:30},lenmode:{type:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{type:"number",min:0,dflt:1},x:{type:"number",dflt:1.02},xanchor:{type:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{type:"number",min:0,dflt:10},y:{type:"number",dflt:.5},yanchor:{type:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{type:"number",min:0,dflt:10},outlinecolor:e.linecolor,outlinewidth:$.extend({dflt:0},e.linewidth),bordercolor:e.linecolor,borderwidth:{type:"number",min:0,dflt:0},bgcolor:{type:"color",dflt:"rgba(0,0,0,0)"},autotick:e.autotick,nticks:e.nticks,tick0:e.tick0,dtick:e.dtick,ticks:$.extend({dflt:""},e.ticks),ticklen:e.ticklen,tickwidth:e.tickwidth,tickcolor:e.tickcolor,showticklabels:e.showticklabels,tickfont:e.tickfont,tickangle:e.tickangle,exponentformat:e.exponentformat,showexponent:e.showexponent,title:{type:"string",dflt:"Click to enter colorscale title"},titlefont:e.titlefont,titleside:{type:"enumerated",values:["right","top","bottom"],dflt:"top"}},t.supplyDefaults=function(e,l,i,o){function n(e,l){return Plotly.Lib.coerce(s,r,t.attributes,e,l)}var r=l.colorbar={},s=e.colorbar||{};n("orient");var a=n("thicknessmode");n("thickness","fraction"===a?30/(o.width-o.margin.l-o.margin.r):30);var c=n("lenmode");n("len","fraction"===c?1:o.height-o.margin.t-o.margin.b),n("x"),n("xanchor"),n("xpad"),n("y"),n("yanchor"),n("ypad"),n("outlinecolor"),n("outlinewidth"),n("bordercolor"),n("borderwidth"),n("bgcolor");var d=n("autotick");d?n("nticks"):(n("tick0"),n("dtick"));var u=n("ticks");u&&(n("ticklen"),n("tickwidth"),n("tickcolor"));var h=n("showticklabels");if(h){n("tickfont",o.font),n("tickangle");var f=n("showexponent");"none"!==f&&n("exponentformat")}n("title"),n("titlefont",o.font),n("titleside")}}();!function(){"use strict";function t(t,n){for(var i=t.length,r=0,e=0;i>e;e++)n[e]?(t[e]/=n[e],r+=t[e]):t[e]=null;return r}var n=window.Plotly.Histogram={},i={start:{type:"number",dflt:0},end:{type:"number",dflt:1},size:{type:"any",dflt:1}};n.attributes={allFrom:{histogram:"Bars",histogram2d:"Heatmap",histogram2dcontour:"Contour"},z:{type:"data_array"},marker:{color:{type:"data_array"}},histfunc:{type:"enumerated",values:["count","sum","avg","min","max"],dflt:"count"},histnorm:{type:"enumerated",values:["","percent","probability","density","probability density"],dflt:""},autobinx:{type:"boolean",dflt:!0},nbinsx:{type:"integer",min:0,dflt:0},xbins:i,autobiny:{type:"boolean",dflt:!0},nbinsy:{type:"integer",min:0,dflt:0},ybins:i},n.supplyDefaults=function(t,i){function r(r,e){return Plotly.Lib.coerce(t,i,n.attributes,r,e)}function e(n,r,e){return Plotly.Lib.coerce(t,i,Plotly[n].attributes,r,e)}var s,a=["x"],o=e("Scatter","x"),l=e("Scatter","y");if(Plotly.Plots.isHist2D(i.type)){if(!o||!l)return void(i.visible=!1);s=r("z")||r("marker.color"),a=["x","y"]}else{if(e("Bars","orientation",l&&!o?"h":"v"),!i["v"===i.orientation?"x":"y"])return void(i.visible=!1);"h"===i.orientation&&(a=["y"]),s=i["h"===i.orientation?"x":"y"]}s&&r("histfunc"),r("histnorm"),a.forEach(function(t){var n=r("autobin"+t);n?r("nbins"+t):(r(t+"bins.start"),r(t+"bins.end"),r(t+"bins.size"))})};var r={count:function(t,n,i){return i[t]++,1},sum:function(t,n,i,r){var e=r[n];return $.isNumeric(e)?(i[t]+=e,e):0},avg:function(t,n,i,r,e){var s=r[n];return $.isNumeric(s)&&(i[t]+=s,e[t]++),0},min:function(t,n,i,r){var e=r[n];if($.isNumeric(e)){if(!$.isNumeric(i[t]))return i[t]=e,e;if(i[t]>e)return i[t]=e,e-i[t]}return 0},max:function(t,n,i,r){var e=r[n];if($.isNumeric(e)){if(!$.isNumeric(i[t]))return i[t]=e,e;if(i[t]<e)return i[t]=e,e-i[t]}return 0}},e={percent:function(t,n){for(var i=t.length,r=100/n,e=0;i>e;e++)t[e]*=r},probability:function(t,n){for(var i=t.length,r=0;i>r;r++)t[r]/=n},density:function(t,n,i,r){var e=t.length;r=r||1;for(var s=0;e>s;s++)t[s]*=i[s]*r},"probability density":function(t,n,i,r){var e=t.length;r&&(n/=r);for(var s=0;e>s;s++)t[s]*=i[s]/n}};n.calc=function(n,i){if(i.visible!==!1){var s,a=[],o=[],l=Plotly.Axes.getFromId(n,"h"===i.orientation?i.yaxis||"y":i.xaxis||"x"),u="h"===i.orientation?"y":"x",y={x:"y",y:"x"}[u],c=l.makeCalcdata(i,u);i["autobin"+u]===!1&&u+"bins"in i||(i[u+"bins"]=Plotly.Axes.autoBin(c,l,i["nbins"+u]),i._input[u+"bins"]=i[u+"bins"]);var b,f,m,x,d=i[u+"bins"],h="string"==typeof d.size,p=h?[]:d,g=[],v=[],P=0,k=i.histnorm,z=i.histfunc,A=-1!==k.indexOf("density"),B="max"===z||"min"===z,I=B?null:0,L=r.count,N=e[k],C=!1;y in i&&"count"!==z&&(x=l.makeCalcdata(i,y),C="avg"===z,L=r[z]),s=d.start,f=d.end+(d.start-Plotly.Axes.tickIncrement(d.start,d.size))/1e6;for(;f>s&&a.length<5e3;)b=Plotly.Axes.tickIncrement(s,d.size),a.push((s+b)/2),o.push(I),h&&p.push(s),A&&g.push(1/(b-s)),C&&v.push(0),s=b;var _=o.length;for(s=0;s<c.length;s++)m=Plotly.Lib.findBin(c[s],p),m>=0&&_>m&&(P+=L(m,s,o,x,v));C&&(P=t(o,v)),N&&N(o,P,g);var F=Math.min(a.length,o.length),T=[],H=0,w=F-1;for(s=0;F>s;s++)if(o[s]){H=s;break}for(s=F-1;s>H;s--)if(o[s]){w=s;break}for(s=H;w>=s;s++)$.isNumeric(a[s])&&$.isNumeric(o[s])&&T.push({p:a[s],s:o[s],b:0});return T}},n.calc2d=function(n,i){var s,a,o,l,u,y,c=Plotly.Axes.getFromId(n,i.xaxis||"x"),b=i.x?c.makeCalcdata(i,"x"):[],f=Plotly.Axes.getFromId(n,i.yaxis||"y"),m=i.y?f.makeCalcdata(i,"y"):[],x=Math.min(b.length,m.length);b.length>x&&b.splice(x,b.length-x),m.length>x&&m.splice(x,m.length-x),Plotly.Lib.markTime("done convert data"),!i.autobinx&&"xbins"in i||(i.xbins=Plotly.Axes.autoBin(b,c,i.nbinsx,"2d"),"histogram2dcontour"===i.type&&(i.xbins.start-=i.xbins.size,i.xbins.end+=i.xbins.size),i._input.xbins=i.xbins),!i.autobiny&&"ybins"in i||(i.ybins=Plotly.Axes.autoBin(m,f,i.nbinsy,"2d"),"histogram2dcontour"===i.type&&(i.ybins.start-=i.ybins.size,i.ybins.end+=i.ybins.size),i._input.ybins=i.ybins),Plotly.Lib.markTime("done autoBin"),u=[];var d,h,p,g=[],v=[],P="string"==typeof i.xbins.size?[]:i.xbins,k="string"==typeof i.xbins.size?[]:i.ybins,z=0,A=[],B=i.histnorm,I=i.histfunc,L=-1!==B.indexOf("density"),N="max"===I||"min"===I,C=N?null:0,_=r.count,F=e[B],T=!1,H=[],w=[],D="z"in i?i.z:"marker"in i&&$.isArray(i.marker.color)?i.marker.color:"";D&&"count"!==I&&(p=D.map(Number),T="avg"===I,_=r[I]);var M=i.xbins,O=M.end+(M.start-Plotly.Axes.tickIncrement(M.start,M.size))/1e6;for(y=M.start;O>y;y=Plotly.Axes.tickIncrement(y,M.size))g.push(C),$.isArray(P)&&P.push(y),T&&v.push(0);$.isArray(P)&&P.push(y);var S=g.length;for(s=i.xbins.start,a=(y-s)/S,s+=a/2,M=i.ybins,O=M.end+(M.start-Plotly.Axes.tickIncrement(M.start,M.size))/1e6,y=M.start;O>y;y=Plotly.Axes.tickIncrement(y,M.size))u.push(g.concat()),$.isArray(k)&&k.push(y),T&&A.push(v.concat());$.isArray(k)&&k.push(y);var E=u.length;for(o=i.ybins.start,l=(y-o)/E,o+=l/2,L&&(H=g.map(function(t,n){return $.isArray(P)?1/(P[n+1]-P[n]):1/a}),w=u.map(function(t,n){return $.isArray(k)?1/(k[n+1]-k[n]):1/l})),Plotly.Lib.markTime("done making bins"),y=0;x>y;y++)d=Plotly.Lib.findBin(b[y],P),h=Plotly.Lib.findBin(m[y],k),d>=0&&S>d&&h>=0&&E>h&&(z+=_(d,y,u[h],p,A[h]));if(T)for(h=0;E>h;h++)z+=t(u[h],A[h]);if(F)for(h=0;E>h;h++)F(u[h],z,H,w[h]);return Plotly.Lib.markTime("done binning"),{x:b,x0:s,dx:a,y:m,y0:o,dy:l,z:u}}}();!function(){"use strict";var o=window.Plotly,e=window.SceneFrame;return e?void e.modules.forEach(function(e){var n=e.namespace,i=e.module;o[n]=new i({Plotly:o,jQuery:window.jQuery})}):console.log("3D not initialized")}();function are_cookies_enabled(){var e=navigator.cookieEnabled?!0:!1;if("undefined"!=typeof navigator.cookieEnabled||e||(document.cookie="testcookie",e=-1!=document.cookie.indexOf("testcookie")?!0:!1),!e){var n="Cookies are not enabled in your browser. Plotly will not work properly without cookies, and you won't be able to sign in or sign up. Please enable cookies for Plotly, then refresh this page.";"undefined"==typeof calltoaction?alert(n):calltoaction('<img src="/static/img/glyphicons/png/glyphicons_078_warning_sign.png"/><br><br>'+n,"Cool, got it","")}return e}function pwreset(){addMessage("Loading password reset..."),$.ajax({type:"POST",url:"/checkpw/",data:{},dataType:"json",async:!1,success:function(e){delMessage("Loading password reset..."),console.log(e),url="/accounts/password/reset/",window.open(url,"_blank")}})}function launchCreateAccount(){return requireAuth({trigger:"USER"}).done()}function launchSignIn(){return requireAuth({trigger:"USER"}).done()}function requireAuth(e){var e=e||{},n={USER:"User intent",SUGGEST:"Auto suggested",URL:"URL flow or redirection",ACTION:"Action required auth"};return startAuthDialog(e).then(function(o){return e.trigger&&(n[e.trigger]||console.error("triggeredBy '"+e.trigger+"' passed to requireAuth() invalid."),o.triggeredBy=n[e.trigger],o.trigger=e.trigger),concludeAuth(o)})}function startAuthDialog(e){if(isUserSignedIn())return Promise.resolve({alreadySignedIn:!0,createdAccount:!1,signedIn:!1});if("SUGGEST"==e.trigger){var n=Plotly.Storage.notificationMemoryGet("signup");if(null!==n.last&&n.last<86400)return Promise.resolve({alreadySignedIn:!1,createdAccount:!1,signedIn:!1})}return $("#createresp").html(""),$("#submituser").show(),$("#signupModal").modal("show"),Plotly.Storage.notificationMemoryViewed("signup"),e.email&&$("#signupModal #signup-email").val(e.email),new Promise(function(e,n){$("#signupModal").on("hidden.incompleteAuth",function(){$("#signupModal").off("hidden.incompleteAuth"),n(new Error("ClosedModal"))}),hookSocialAuthButtons(e,n),hookCreateAccountForm(e,n),hookSignInForm(e,n)})}function hookSocialAuthButtons(e,n){$("a.link--social").each(function(o,t){var i=$(t).attr("data-social-url");$(t).on("click",function(){launchsocialauth(i,e,n)})})}function hookCreateAccountForm(e){$("#submituser").off("click").on("click",function(e){e.preventDefault(),$("#signupform").submit()}),$("#signupform").off("submit").on("submit",function(){$(".js--signup-error").remove(),$("#createloading").html('<p style="color:#3a87ad;">Loading...</p>');var n=$.cookie("csrftoken"),o=$(this).serialize();return o+="&csrfmiddlewaretoken="+encodeURIComponent(n),console.log("sign up values",o),console.log("--- SENDING SIGN UP TO SERVER ---"),$.post("/mkacct/",o,function(n){var o=JSON.parse(n).err;console.log("--- SIGN UP RETURNED FROM SERVER ---");$("#signup-email").val();if($("#createloading").html(""),o){analytics.track("Error signing up",{err:o,$username:$("#signup-username").val(),$email:$("#signup-email").val()}),$("#signupModal .error--inline").remove();var t,i=o.toLowerCase();return-1!=i.indexOf("username")?t=$("#signup-username"):-1!=i.indexOf("email")?t=$("#signup-email"):-1!=i.indexOf("password")?t=$("#signup-pw"):-1!=i.indexOf("first name")?t=$("#first_name"):-1!=i.indexOf("last name")?t=$("#last_name#"):-1!=i.indexOf("the server encountered an error")?(o="Uh oh, there was an error signing up. We'll be working on this. Want to try again?",t=$("#pw2")):t=$("#pw2"),$(t).after('<span class="js--signup-error error--inline">'+o+"</span>"),void $(t).parents("div.control-group").addClass("error")}setTimeout(function(){e({alreadySignedIn:!1,createdAccount:!0,signedIn:!0})},1e3)}),!1})}function hookSignInForm(e,n){$("#loginuser").off("click").on("click",function(e){return e.preventDefault(),$("#loginform").submit(),!1}),$("#loginform").off("submit").on("submit",function(){function o(t){t+=1,$.post("/signin/",i,function(i){Plotly.Lib.killspin(),delMessage(),$(".signinloading").remove(),$(".error--inline").remove();var r=JSON.parse(i).err;if(r){console.log(r);var a,s=r.toLowerCase();-1!=s.indexOf("traceback")?(a=$("#login-pw"),r="Error signing in. Are you sure your info is correct?"):a=$(-1!=s.indexOf("username")?"#login-username":-1!=s.indexOf("password")?"#login-pw":"#login-pw"),a.after('<span class="error--inline">'+r+"</span>"),a.parents("div.control-group").addClass("error"),console.log("error signing in: "+r)}else $.post("/is_auth/",function(i){var r=JSON.parse(i),a=r.is_auth;return a?void setTimeout(function(){e({alreadySignedIn:!1,createdAccount:!1,signedIn:!0})},1e3):5>t?(console.log("try: ",t),void o(t)):(console.log("si error"),$("#loginModal").modal("hide"),void n(new Error("AuthenticationError")))}).then(function(){document.querySelector(".header-bar__user-stuff").remove()})})}console.log("loginform submitted"),analytics.track("User logged in"),$(".error--inline").html("");var t=$.cookie("csrftoken"),i=$(this).serialize();return i+="&csrfmiddlewaretoken="+encodeURIComponent(t),$("#login-pw").after('<div class="signinloading style="color:#3a87ad!important;">Loading...</div>'),o(0),!1})}function launchsocialauth(e,n,o){console.log(e);var t=window.open(e,"Sign into Plotly","height=600,width=600,modal=yes,alwaysRaised=yes"),i=window.setInterval(function(){t.closed!==!1&&(window.clearInterval(i),console.log("POP UP CLOSED"),$.post("/is_auth/",function(e){var t=JSON.parse(e);return t.is_auth?n({alreadySignedIn:!1,createdAccount:!!e.created_last_minute,signedIn:!0}):o(new Error("Wasn't logged in after Social login"))}).then(function(){document.querySelector(".header-bar__user-stuff").remove()}))},200)}function concludeAuth(e){var n=$("#signupModal");return n.off("hidden.incompleteAuth"),e.alreadySignedIn?e:((e.createdAccount||e.signedIn)&&analytics.track("Concluded authentication",e),e.signedIn&&analytics.track("User signed in"),Boolean($("#plotlyMainMarker").length)?(getuser("notree"),userSettings.init(function(){Raven.setUser({username:userObj.info().un})}),n.modal("hide"),e.createdAccount&&Plotly.Lib.notifier("High Five! You're good to go."),"ACTION"!=e.trigger&&triggerPostSignupModal(),e):e.signedIn?("/"==window.location.pathname?e.createdAccount?(n.find("#createloading").html('<p style="color:#3a87ad;">Thanks for signing up! Redirecting you...</p>'),window.setTimeout(function(){window.location.replace(ENV.HOMEPAGE)},1e3)):window.location.replace(ENV.HOMEPAGE):e.createdAccount?(n.find("#createloading").html('<p style="color:#3a87ad;">Thanks for signing up! Reloading with your new account...</p>'),window.setTimeout(function(){location.reload()},1e3)):location.reload(),e):e)}function resend_activation(e){var n=$("#loginform .error--inline"),o="Aw, snap! An error occurred. Try again soon or get in touch at support@plot.ly.";n.text("Sending..."),$.post("/resend_activation/",{un:e},function(e){var t=JSON.parse(e);n.html(t.err?o:"Sent! Check "+t.em+" for an activation email.<br>Questions? support@plot.ly")}).fail(function(){n.text(o)})}function swapModal(e,n){$("#"+e).modal("hide"),$("#"+n).modal("show")}function getuser(e){return new Promise(function(n,o){return _getuser(e,n,o)})}function _getuser(e,n){$.post("/getuser/",{},function(o){userobj=JSON.parse(o),user=userobj.user,_username=userobj.user,userobj.err&&console.log(userobj.err),userobj.servertime&&userobj.utcnow&&(userobj.clientoffset=(new Date).getTime()-Plotly.Lib.dateTime2ms(userobj.servertime),userobj.utcoffset=(new Date).getTime()-Plotly.Lib.dateTime2ms(userobj.utcnow));var t=userobj.plan,i=userobj.last4,r=$("#plotlyMainMarker").length>0;if($(".currentPlan").val(t),$(".cc_msg").text("Card to be charged: xxxx-xxxx-xxxx-"+i),r){$(".notifs__bell").on("click",function(e){e.preventDefault(),$(".notifs__box").toggle(),$("li.notif").hover(function(){$(this).children(".notif__close-tab").addClass("hover")},function(){$(this).children(".notif__close-tab").removeClass("hover")})}),$(document).mouseup(function(e){0!==$(".notifs__box").has(e.target).length||$(".notifs__bell").has(e.target).length||$(".notifs__box").hide()});try{console.log("notree value",e),e||($("#privatetree").jstree("refresh"),$("#sharedtree").jstree("refresh"))}catch(a){}isUserSignedIn()&&analytics.identifyUser(getSignedInUsername(),userobj.email,userobj.date_joined)}n(userobj),$(".avatar-container").length>0&&$("#username").unbind("click").click(function(){$("#usermenu").show()}),window.refreshFileTrees&&(refreshFileTrees(),fileFabricListenters())})}function addMessage(e,n){Plotly.STATUS_MSGS.push(e),$("#statustab").show().find("p").text(Plotly.STATUS_MSGS.join("... ")),window.setTimeout(function(){(n||"undefined"==typeof n)&&delMessage(e)},4e3)}function delMessage(e){e||(Plotly.STATUS_MSGS=[]);for(var n=0;n<Plotly.STATUS_MSGS.length;n++)if(Plotly.STATUS_MSGS[n]==e){Plotly.STATUS_MSGS.splice(n,1);break}Plotly.STATUS_MSGS.length?$("#statustab").show().find("p").text(Plotly.STATUS_MSGS.join(" ")):$("#statustab").hide()}function updateTSRel(){$(".tsrel").each(function(){var e,n,o=$(this),t=o.parents("[data-ts], [data-rev-ts]").first();if(0!==t.length){e=t.data("ts")?Plotly.Lib.dateTime2ms(t.data("ts"))+userobj.utcoffset:Plotly.Lib.dateTime2ms(t.data("rev-ts"))+userobj.clientoffset;var i=Math.round(((new Date).getTime()-e)/6e4),r=Math.floor(i/60),a=Math.floor(r/24);if(60>i)n=i+" min"+(i>1?"s":"")+" ago";else if(24>r)n=r+" hour"+(r>1?"s":"")+" ago";else if(31>a)n=a+" day"+(a>1?"s":"")+" ago";else{var s=(new Date).getFullYear(),l=new Date(e),u=l.getFullYear();n=d3.time.format("%b %d")(new Date(e)).replace(" 0"," "),s!=u&&(n+=", "+u)}o.html(n)}})}function initSignupModal(){var e={$menu:!1,menuSelector:"a",panelSelector:"section",namespace:".panelSnap",onSnapStart:function(){},onSnapFinish:function(){},directionThreshold:1e3,slideSpeed:500};$("#postSignupModal").panelSnap(e),$("#postSignupModal a").on("click",function(e){var n=$(e.currentTarget),o=n.text(),t=n.parents("section").attr("id");analytics.track("Post signup modal: clicked link",{label:o,section:t})}),$("#postSignupModal button.close").on("click",function(e){var n=$(e.currentTarget).parents("section").attr("id");analytics.track("Post signup modal: clicked link",{label:"Close",section:n})}),$("#postSignupModal").on("hidden",function(){analytics.track("Post signup modal: closed",{})})}function triggerPostSignupModal(e,n){if(!n){var o=Plotly.Storage.notificationMemoryGet("postSignupModal");if(o.last)return e;Plotly.Storage.notificationMemoryViewed("postSignupModal")}return $("#postSignupModal").modal("show"),analytics.track("Post signup modal: opened",{}),$(".tour-cont-js").click(function(){var e=$(this),n=e.attr("next-section"),o=parseInt(e.attr("offset"));o=600*o,$("#postSignupModal").animate({scrollTop:$(n).offset().top+o},500)}),new Promise(function(n){$("#postSignupModal").one("hidden",function(){n(e)})})}$("#loginModal").on("show",function(){return are_cookies_enabled()?void setTimeout(function(){$("#login-username").focus()},500):!1}),$("#signupModal").on("show",function(){return are_cookies_enabled()?void setTimeout(function(){$("#signup-email").focus()},500):!1}),$(document).ajaxError(function(e,n,o,t){console.log("--- AJAX failure ---");var i=JSON.stringify(o);if(-1==i.indexOf("/getnotifs/"))try{Raven.captureException(Error(JSON.stringify(t)),{tags:{ajaxurl:o.url}})}catch(r){console.log(r)}}),$("#first_name").validate({expression:"if (VAL) return true; else return false;",message:"Please enter a first name."}),$("#last_name").validate({expression:"if (VAL) return true; else return false;",message:"Please enter a last name."});var emailre=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;$("#email").validate({expression:"if (emailre.test(VAL)) return true; else return false;",message:"Not a valid email! Try again."});var unre=/^[.a-zA-Z0-9_-]+$/;$("#un").validate({expression:"if (VAL.length > 3 && unre.text(VAL)) return true; else return false;",message:'Please enter a username > 3 characters. Only letters, numbers, "-", ".", "@", and "_" are allowed.'}),$("#signup-pw").validate({expression:"if (VAL.length > 3 && VAL) return true; else return false;",message:"Passwords must be > 3 characters."}),$("#pw2").validate({expression:"if ((VAL == jQuery('#signup-pw').val()) && VAL) return true; else return false;",message:"Passwords must match."}),$("#submitcomment").on("click",function(e){WARN_ON_LEAVE=!1,e.preventDefault(),delMessage();var n=$.trim($("#commentbox").val());return n.length<3?(addMessage("Please, enter your message"),!1):void $("#commentform").submit()}),$("#commentform").on("submit",function(){var e=$("#commentbox").val(),n=JSON.stringify($.browser),o=$.cookie("csrftoken");return addMessage("Sending Feedback"),$.post("/feedback/",{comment:e,csrfmiddlewaretoken:o,browser:n,user:user},function(){$("#feedbackModal").modal("hide"),delMessage("Sending Feedback")}),!1}),$(window).click(function(e){"block"==$("#usermenu").css("display")&&(console.log(e),$("#usermenu").hide()),"block"==$(".tipsy.tipsy-ne").css("display")&&$(e.target).closest('div:not(".notif-content")').hasClass("tipsy-inner")===!1&&$(e.target).closest("div").hasClass("notif-content")===!1&&"notif-bell"!=$(e.target).closest("div").attr("id")&&$("#notif-bell").tipsy("hide")}),Plotly.STATUS_MSGS=[],userobj={user:"",clientoffset:0,utcoffset:0},$("#toolsignin").click(function(){return launchSignIn(),!1}),$("#splashsignin").click(function(){return launchSignIn(),!1}),$("#signup").click(function(){return launchCreateAccount(),!1}),$("#bannersignin")&&$("#bannersignin").click(function(){return launchSignIn(),!1}),$(function(){window.IS_EMBEDPLOT_PAGE||window.PREVENT_POST_SIGNUP_MODALS||(initSignupModal(),isUserSignedIn()&&triggerPostSignupModal())});MathJax.Hub.Config({messageStyle:'none',skipStartupTypeset:true,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});(function($,ENV,window){'use strict';var graphDiv=$('#embedded-graph')[0];graphDiv.fid=$('#plot-fid').text();var layout=null;var plotResizeTimeout;var externalScripts=[];function getRavenConfig(){var config={};config.tags={'host':location.host,'server':'browser','ie':getIEVersion()};return config;}
function onWindowResize(ev){clearTimeout(plotResizeTimeout);ev.stopPropagation();plotResizeTimeout=setTimeout(resizePlot,100);}
function resizePlot(){if(window.__plotIsFullScreenMode){Plotly.relayout(graphDiv,{width:layout._realWidth,height:layout._realHeight,autosize:layout._realAutosize});}else{Plotly.relayout(graphDiv,{width:layout.width,height:layout.height,autosize:layout._realAutosize});}
$('.svg-container').css({'background':'none'});}
function getLayoutAutosize(){var autosize=$('#plot-autosize').text();switch(autosize){case"true":return true;case"false":return false;}
return null;}
function getLayoutWidth(){var width=$('#plot-width').text();width=parseInt(width,10);return isNaN(width)?null:width;}
function getLayoutHeight(){var height=$('#plot-height').text();height=parseInt(height,10);return isNaN(height)?null:height;}
function getLayout(){var layout=JSON.parse($('#plot-layout').text()),width=getLayoutWidth(),height=getLayoutHeight(),autosize=getLayoutAutosize();layout._realWidth=layout.width;layout._realHeight=layout.height;layout._realAutosize=layout.autosize;if(autosize===true){layout.autosize=true;}
if(!layout.hasOwnProperty('autosize')&&!width&&!height){layout.autosize=true;}
if(layout.autosize===true){layout.autosize='initial';layout._realAutosize=layout.autosize;}else{if(width){layout.width=width;}
if(height){layout.height=height;}}
return layout;}
function getDisplayLogo(){return $('#plot-logo').text()==='true';}
function getIEVersion(){return document.documentMode?document.documentMode:0;}
function stopLoading(){$('#plotlybars').remove();}
function initScriptLoader(){if(ENV.GOOGLEANALYTICS_ENABLED){externalScripts.push('googleAnalytics');}
if(ENV.SOCIALSHARING_ENABLED){externalScripts=externalScripts.concat(['facebook','googlePlus','twitter']);}
if(externalScripts.length>0){var scriptLoader=Plotly.util.scriptLoader(document,window);scriptLoader(externalScripts);}}
function initStream(){if(typeof NODE==='undefined'){return;}
var streamhead=NODE.StreamHead(graphDiv,{host:ENV.WEBSOCKET_HOST,port:ENV.WEBSOCKET_PORT});streamhead.beginStreaming();}
function isShareplot(){if(window.self===window.top)return false;try{var myLocation=window.location.href,parentLocation=window.parent.location.href;return parentLocation.indexOf(myLocation.split('.embed')[0])===0;}
catch(e){return false;}}
function init(){var data=JSON.parse($('#plot-data').text());layout=getLayout();var shareplot=isShareplot();var config={displaylogo:getDisplayLogo(),autosizable:true,fillFrame:true,sendData:false,showLink:!shareplot,scrollZoom:shareplot};Plotly.plot(graphDiv,data,layout,config).then(function(){initScriptLoader();stopLoading();$(window).resize(onWindowResize);$('html').addClass('is-iframe');$('.svg-container').css({'margin':'auto','background':'none'});document.body.style.backgroundColor=layout.paper_bgcolor;if(!document.body.style.backgroundColor){document.body.style.backgroundColor='white';}
Plotly.Plots.redrawText(graphDiv);initStream();});analytics.track('Embedded plot viewed',{},{embeddingDomain:true});}
function csrfSafeMethod(method){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));}
$.ajaxSetup({crossDomain:false,beforeSend:function(xhr,settings){if(!csrfSafeMethod(settings.type)){xhr.setRequestHeader('X-CSRFToken',$.cookie('csrftoken'));}}});$(document).ready(function(){Raven.context(getRavenConfig(),init);});window.addEventListener('message',function(e){var message=e.data;if(message.restyle){Plotly.restyle(graphDiv,message.restyle,null,message.traces);}
if(message.relayout){Plotly.relayout(graphDiv,message.relayout);}});})(jQuery,ENV,window);